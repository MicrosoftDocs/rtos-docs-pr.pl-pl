---
title: Rozdział 3 — funkcjonalne składniki platformy Azure RTO NetX Duo
description: Ten rozdział zawiera opis stosu TCP/IP o wysokiej wydajności usługi Azure RTO NetX Duo z perspektywy funkcjonalnej.
author: philmea
ms.author: philmea
ms.date: 05/19/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 07e51643c828afc8e6c0b968e78380316e84ccd7
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/22/2021
ms.locfileid: "104822116"
---
# <a name="chapter-3---functional-components-of-azure-rtos-netx-duo"></a><span data-ttu-id="e11b4-103">Rozdział 3 — funkcjonalne składniki platformy Azure RTO NetX Duo</span><span class="sxs-lookup"><span data-stu-id="e11b4-103">Chapter 3 - Functional Components of Azure RTOS NetX Duo</span></span>

<span data-ttu-id="e11b4-104">Ten rozdział zawiera opis stosu TCP/IP o wysokiej wydajności usługi Azure RTO NetX Duo z perspektywy funkcjonalnej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-104">This chapter contains a description of the high- performance Azure RTOS NetX Duo TCP/IP stack from a functional perspective.</span></span> 

## <a name="execution-overview"></a><span data-ttu-id="e11b4-105">Przegląd wykonywania</span><span class="sxs-lookup"><span data-stu-id="e11b4-105">Execution Overview</span></span>

<span data-ttu-id="e11b4-106">W aplikacji NetX Duo istnieje pięć typów wykonywania programu: inicjalizacja, wywołania interfejsu aplikacji, wewnętrzny wątek IP, okresowe czasomierze IP i sterownik sieciowy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-106">There are five types of program execution within a NetX Duo application: initialization, application interface calls, internal IP thread, IP periodic timers, and the network driver.</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-107">*NetX Duo zakłada istnienie ThreadX i zależy od jej wykonywania, zawieszania, okresowych czasomierzy i wzajemnych wykluczeń.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-107">*NetX Duo assumes the existence of ThreadX and depends on its thread execution, suspension, periodic timers, and mutual exclusion facilities.*</span></span>

### <a name="initialization"></a><span data-ttu-id="e11b4-108">Inicjalizacja</span><span class="sxs-lookup"><span data-stu-id="e11b4-108">Initialization</span></span>

<span data-ttu-id="e11b4-109">Przed wywołaniem innej usługi NetX Duo należy wywołać usługę \***nx_system_initialize** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-109">The service \***nx_system_initialize** _ must be called before any other NetX Duo service is called.</span></span> <span data-ttu-id="e11b4-110">Inicjalizację systemu można wywołać z funkcji ThreadX _ *_tx_application_define_*\* lub z wątków aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-110">System initialization can be called either from the ThreadX _ *_tx_application_define_*\* function or from application threads.</span></span>

<span data-ttu-id="e11b4-111">Po znaku \***nx_system_initialize** _ system jest gotowy do tworzenia pul pakietów i wystąpień adresów IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-111">After \***nx_system_initialize** _ returns, the system is ready to create packet pools and IP instances.</span></span> <span data-ttu-id="e11b4-112">Ponieważ utworzenie wystąpienia adresu IP wymaga domyślnej puli pakietów, musi istnieć co najmniej jedna pula pakietów NetX Duo przed utworzeniem wystąpienia adresu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-112">Because creating an IP instance requires a default packet pool, at least one NetX Duo packet pool must exist prior to creating an IP instance.</span></span> <span data-ttu-id="e11b4-113">Tworzenie pul pakietów i wystąpień adresów IP jest dozwolone z funkcji inicjowania ThreadX _ *_tx_application_define_*\* i z wątków aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-113">Creating packet pools and IP instances are allowed from the ThreadX initialization function _ *_tx_application_define_*\* and from application threads.</span></span>

<span data-ttu-id="e11b4-114">Wewnętrznie Tworzenie wystąpienia IP jest realizowane w dwóch częściach: Pierwsza część jest wykonywana w kontekście obiektu wywołującego, z ***tx_application_define*** lub z kontekstu wątku aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-114">Internally, creating an IP instance is accomplished in two parts: The first part is done within the context of the caller, either from ***tx_application_define*** or from an application thread's context.</span></span> <span data-ttu-id="e11b4-115">Obejmuje to Konfigurowanie struktury danych IP i tworzenie różnych zasobów IP, w tym wewnętrznego wątku IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-115">This includes setting up the IP data structure and creating various IP resources, including the internal IP thread.</span></span> <span data-ttu-id="e11b4-116">Druga część jest wykonywana podczas początkowego wykonywania z wewnętrznego wątku IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-116">The second part is performed during the initial execution from the internal IP thread.</span></span> <span data-ttu-id="e11b4-117">Jest to miejsce, w którym sterownik sieciowy dostarczony podczas pierwszej części tworzenia IP jest najpierw wywoływany.</span><span class="sxs-lookup"><span data-stu-id="e11b4-117">This is where the network driver, supplied during the first part of IP creation, is first called.</span></span> <span data-ttu-id="e11b4-118">Wywołanie sterownika sieci z wewnętrznego wątku IP umożliwia sterownikowi wykonywanie operacji we/wy i wstrzymywanie podczas przetwarzania inicjalizacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-118">Calling the network driver from the internal IP thread enables the driver to perform I/O and suspend during its initialization processing.</span></span>

<span data-ttu-id="e11b4-119">Gdy sterownik sieciowy wraca z przetwarzania inicjowania, tworzenie adresu IP zostało zakończone.</span><span class="sxs-lookup"><span data-stu-id="e11b4-119">When the network driver returns from its initialization processing, the IP creation is complete.</span></span>

<span data-ttu-id="e11b4-120">Inicjalizacja protokołu IPv6 w NetX Duo wymaga kilku dodatkowych usług NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-120">Initialization of IPv6 in NetX Duo requires a few additional NetX Duo services.</span></span> <span data-ttu-id="e11b4-121">Są one opisane bardziej szczegółowo w sekcji [IPv6 w NetX Duo](#ipv6-in-netx-duo) w dalszej części tego rozdziału.</span><span class="sxs-lookup"><span data-stu-id="e11b4-121">These are described in greater detail in the section [IPv6 in NetX Duo](#ipv6-in-netx-duo) later in this chapter.</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-122">***Nx_ip_status_check** usługi NetX Duo jest dostępna, aby uzyskać informacje dotyczące wystąpienia adresu IP i jego stanu podstawowego interfejsu. Takie informacje o stanie obejmują, czy łącze jest inicjowane, włączone i rozwiązane. Te informacje służą do synchronizowania wątków aplikacji, które wymagają użycia nowo utworzonego wystąpienia adresu IP. W przypadku systemów z wieloma systemami prywatnymi Zobacz artykuł [Obsługa wieloznacznych](#multihome-support). **nx_ip_interface_status_check** jest dostępny do uzyskania 3information w określonym interfejsie.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-122">*The NetX Duo service **nx_ip_status_check** is available to obtain information on the IP instance and its primary interface status. Such status information includes whether or not the link is initialized, enabled and IP address is resolved. This information is used to synchronize application threads needing to use a newly created IP instance. For multihome systems, see [Multihome Support](#multihome-support). **nx_ip_interface_status_check** is available to obtain 3information on the specified interface.*</span></span>

### <a name="application-interface-calls"></a><span data-ttu-id="e11b4-123">Wywołania interfejsu aplikacji</span><span class="sxs-lookup"><span data-stu-id="e11b4-123">Application Interface Calls</span></span>

<span data-ttu-id="e11b4-124">Wywołania z aplikacji są wykonywane w dużej mierze od wątków aplikacji uruchomionych w ramach ThreadX RTO.</span><span class="sxs-lookup"><span data-stu-id="e11b4-124">Calls from the application are largely made from application threads running under the ThreadX RTOS.</span></span> <span data-ttu-id="e11b4-125">Jednak niektóre inicjalizacje, tworzenie i Włączanie usług mogą być wywoływane z ***tx_application_define***.</span><span class="sxs-lookup"><span data-stu-id="e11b4-125">However, some initialization, create, and enable services may be called from ***tx_application_define***.</span></span> <span data-ttu-id="e11b4-126">Sekcje "dozwolone z" w [rozdziale 4 — Opis usług Azure RTO NetX Duo](chapter4.md) wskazują, na podstawie których można wywołać każdą usługę NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-126">The "Allowed From" sections in [Chapter 4 - Description of Azure RTOS NetX Duo Services](chapter4.md) indicate from which each NetX Duo service can be called.</span></span>

<span data-ttu-id="e11b4-127">W większości przypadków przetwarzanie intensywnych działań, takich jak obliczanie sum kontrolnych, odbywa się w kontekście wątku wywołującego — bez blokowania dostępu do innych wątków do wystąpienia IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-127">For the most part, processing intensive activities such as computing checksums is done within the calling thread's context—without blocking access of other threads to the IP instance.</span></span> <span data-ttu-id="e11b4-128">Na przykład podczas transmisji obliczenia sumy kontrolnej UDP są wykonywane w ramach usługi \***nx_udp_socket_send** _ przed wywołaniem podstawowej funkcji wysyłania adresów IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-128">For example, on transmission, the UDP checksum calculation is performed inside the \***nx_udp_socket_send** _ service, prior to calling the underlying IP send function.</span></span> <span data-ttu-id="e11b4-129">W przypadku odebranego pakietu suma kontrolna UDP jest obliczana w usłudze _ \*_nx_udp_socket_receive_\*\*, wykonywanej w wątku aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-129">On a received packet, the UDP checksum is calculated in the _ *_nx_udp_socket_receive_*\* service, executed in the  of the application thread.</span></span> <span data-ttu-id="e11b4-130">Pomaga to zapobiegać zapewnieniu żądań sieci przez wątki o wyższym priorytecie z powodu przetwarzania obliczeń sum kontrolnych o niższym priorytecie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-130">This helps prevent stalling network requests of higher-priority threads because of processing intensive checksum computation in lower-priority threads.</span></span>

<span data-ttu-id="e11b4-131">Wartości, takie jak adresy IP i numery portów, są przesyłane do interfejsów API w kolejności bajtów hosta.</span><span class="sxs-lookup"><span data-stu-id="e11b4-131">Values, such as IP addresses and port numbers, are passed to APIs in host byte order.</span></span> <span data-ttu-id="e11b4-132">Wewnętrznie te wartości są przechowywane w kolejności bajtów hosta.</span><span class="sxs-lookup"><span data-stu-id="e11b4-132">Internally these values are stored in host byte order as well.</span></span> <span data-ttu-id="e11b4-133">Dzięki temu deweloperzy mogą łatwo wyświetlać wartości za pomocą debugera.</span><span class="sxs-lookup"><span data-stu-id="e11b4-133">This allows developers to easily view the values via a debugger.</span></span> <span data-ttu-id="e11b4-134">Gdy te wartości są programowane do ramki do transmisji, są konwertowane na kolejność bajtów sieci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-134">When these values are programmed into a frame for transmission, they are converted to network byte order.</span></span>

### <a name="internal-ip-thread"></a><span data-ttu-id="e11b4-135">Wewnętrzny wątek IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-135">Internal IP Thread</span></span>

<span data-ttu-id="e11b4-136">Jak wspomniano, każde wystąpienie protokołu IP w NetX Duo ma swój własny wątek.</span><span class="sxs-lookup"><span data-stu-id="e11b4-136">As mentioned, each IP instance in NetX Duo has its own thread.</span></span> <span data-ttu-id="e11b4-137">Priorytet i rozmiar stosu wewnętrznego wątku IP są zdefiniowane w usłudze ***nx_ip_create*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-137">The priority and stack size of the internal IP thread is defined in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="e11b4-138">Wewnętrzny wątek IP jest tworzony w trybie gotowym do wykonania.</span><span class="sxs-lookup"><span data-stu-id="e11b4-138">The internal IP thread is created in a ready-to-execute mode.</span></span> <span data-ttu-id="e11b4-139">Jeśli wątek IP ma wyższy priorytet niż wątek wywołujący, może wystąpić zastępujący w wywołaniu IP Create.</span><span class="sxs-lookup"><span data-stu-id="e11b4-139">If the IP thread has a higher priority than the calling thread, preemption may occur inside the IP create call.</span></span>

<span data-ttu-id="e11b4-140">Punkt wejścia wewnętrznego wątku IP znajduje się w funkcji wewnętrznej _ ***nx_ip_thread_entry***.</span><span class="sxs-lookup"><span data-stu-id="e11b4-140">The entry point of the internal IP thread is at the internal function _ ***nx_ip_thread_entry***.</span></span> <span data-ttu-id="e11b4-141">Po uruchomieniu wewnętrzny wątek IP najpierw kończy inicjalizację sterownika sieci, która składa się z trzech wywołań sterownika sieci specyficznego dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-141">When started, the internal IP thread first completes network driver initialization, which consists of making three calls to the application-specific network driver.</span></span> <span data-ttu-id="e11b4-142">Pierwsze wywołanie polega na dołączeniu sterownika sieci do wystąpienia IP, po którym następuje wywołanie inicjacji, które umożliwia sterownikowi sieciowe przechodzenie przez proces inicjalizacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-142">The first call is to attach the network driver to the IP instance, followed by an initialization call, which allows the network driver to go through the initialization process.</span></span> <span data-ttu-id="e11b4-143">Po powrocie sterownika sieci z inicjacji (może on zostać zawieszony podczas oczekiwania na prawidłowe skonfigurowanie sprzętu), wewnętrzny wątek IP wywołuje ponownie sterownik sieciowy, aby włączyć link.</span><span class="sxs-lookup"><span data-stu-id="e11b4-143">After the network driver returns from initialization (it may suspend while waiting for the hardware to be properly set up), the internal IP thread calls the network driver again to enable the link.</span></span> <span data-ttu-id="e11b4-144">Po powrocie sterownika sieci z wywołania Włącz łącze, wewnętrzny wątek IP wprowadza pętlę nieskończoną dla różnych zdarzeń, które wymagają przetworzenia dla tego wystąpienia IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-144">After the network driver returns from the link enable call, the internal IP thread enters a forever loop checking for various events that need processing for this IP instance.</span></span> <span data-ttu-id="e11b4-145">Zdarzenia przetwarzane w tej pętli obejmują odroczony przyjmowanie pakietów IP, zestaw fragmentów pakietów IP, przetwarzanie ping protokołu ICMP, przetwarzanie protokołu IGMP, przetwarzanie kolejki pakietów TCP, przetwarzanie przez TCP, przekroczenie limitu czasu zestawu fragmentów adresów IP oraz okresowe przetwarzanie IGMP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-145">Events processed in this loop include deferred IP packet reception, IP packet fragment assembly, ICMP ping processing, IGMP processing, TCP packet queue processing, TCP periodic processing, IP fragment assembly timeouts, and IGMP periodic processing.</span></span> <span data-ttu-id="e11b4-146">Zdarzenia obejmują również działania dotyczące rozpoznawania adresów; Przetwarzanie pakietów ARP i okresowe przetwarzanie ARP w protokole IPv4, wykrywanie duplikatów adresów, żądanie routera i odnajdowanie sąsiadów w protokole IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-146">Events also include address resolution activities; ARP packet processing and ARP periodic processing in IPv4, Duplicate Address Detection, Router Solicitation, and Neighbor Discovery in IPv6.</span></span>

> [!CAUTION]
> <span data-ttu-id="e11b4-147">*Funkcje wywołania zwrotnego NetX Duo, w tym nasłuchiwanie i rozłączane wywołania zwrotne, są wywoływane z wewnętrznego wątku IP — a nie oryginalnego wątku wywołującego. Aplikacja musi zadbać o to, aby nie zawiesić się wewnątrz żadnej funkcji wywołania zwrotnego NetX Duo.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-147">*The NetX Duo callback functions, including listen and disconnect callbacks, are called from the internal IP thread—not the original calling thread. The application must take care not to suspend inside any NetX Duo callback function.*</span></span>

### <a name="ip-periodic-timers"></a><span data-ttu-id="e11b4-148">Okresowe czasomierze IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-148">IP Periodic Timers</span></span>

<span data-ttu-id="e11b4-149">Dla każdego wystąpienia IP są używane dwa okresowe czasomierze ThreadX.</span><span class="sxs-lookup"><span data-stu-id="e11b4-149">There are two ThreadX periodic timers used for each IP instance.</span></span> <span data-ttu-id="e11b4-150">Pierwszy z nich to jednorazowy czasomierz dla protokołu ARP, protokołu IGMP, limitu czasu protokołu TCP, a także dyski reasemblera fragmentu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-150">The first one is a one-second timer for ARP, IGMP, TCP timeout, and it also drives IP fragment reassemble processing.</span></span> <span data-ttu-id="e11b4-151">Drugi czasomierz to 100 ms czasomierza, który umożliwia przekroczenie limitu czasu ponownej transmisji protokołu TCP i operacji związanych z protokołem IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-151">The second timer is a 100ms timer to drive the TCP retransmission timeout and IPv6-related operations.</span></span>

### <a name="network-driver"></a><span data-ttu-id="e11b4-152">Sterownik sieciowy</span><span class="sxs-lookup"><span data-stu-id="e11b4-152">Network Driver</span></span>

<span data-ttu-id="e11b4-153">Każde wystąpienie IP w NetX Duo ma interfejs podstawowy, który jest identyfikowany przez jego sterownik urządzenia określony w usłudze ***nx_ip_create*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-153">Each IP instance in NetX Duo has a primary interface, which is identified by its device driver specified in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="e11b4-154">Sterownik sieciowy jest odpowiedzialny za obsługę różnych żądań NetX Duo, w tym przesyłanie pakietów, odbieranie pakietów i żądania dotyczące stanu i kontroli.</span><span class="sxs-lookup"><span data-stu-id="e11b4-154">The network driver is responsible for handling various NetX Duo requests, including packet transmission, packet reception, and requests for status and control.</span></span> 

<span data-ttu-id="e11b4-155">W przypadku systemu wieloznacznego wystąpienie protokołu IP zawiera wiele interfejsów, z których każdy jest skojarzony ze sterownikiem sieciowym wykonującym te zadania dla odpowiedniego interfejsu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-155">For a multi-home system, the IP instance has multiple interfaces, each with an associated network driver that performs these tasks for the respective interface.</span></span>

<span data-ttu-id="e11b4-156">Sterownik sieciowy musi również obsługiwać zdarzenia asynchroniczne występujące na nośniku.</span><span class="sxs-lookup"><span data-stu-id="e11b4-156">The network driver must also handle asynchronous events occurring on the media.</span></span> <span data-ttu-id="e11b4-157">Zdarzenia asynchroniczne z nośnika obejmują odbieranie pakietów, uzupełnianie transmisji pakietów i zmiany stanu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-157">Asynchronous events from the media include packet reception, packet transmission completion, and status changes.</span></span> <span data-ttu-id="e11b4-158">NetX Duo udostępnia sterownik sieciowy z kilkoma funkcjami dostępu do obsługi różnych zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="e11b4-158">NetX Duo provides the network driver with several access functions to handle various events.</span></span> <span data-ttu-id="e11b4-159">Te funkcje są przeznaczone do wywoływania z części procedury usługi przerwania sterownika sieci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-159">These functions are designed to be called from the  interrupt service routine portion of the network driver.</span></span> <span data-ttu-id="e11b4-160">W przypadku sieci IPv4 sterownik sieciowy powinien przesłać dalej wszystkie pakiety ARP odebrane do funkcji wewnętrznej ***_nx_arp_packet_deferred_receive*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-160">For IPv4 networks, the network driver should forward all ARP packets received to the ***_nx_arp_packet_deferred_receive*** internal function.</span></span> <span data-ttu-id="e11b4-161">Wszystkie pakiety RARP powinny być przekazywane do funkcji wewnętrznej \***_nx_rarp_packet_deferred_receive** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-161">All RARP packets should be forwarded to \***_nx_rarp_packet_deferred_receive** _ internal function.</span></span> <span data-ttu-id="e11b4-162">Dostępne są dwie opcje pakietów IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-162">There are two options for IP packets.</span></span> <span data-ttu-id="e11b4-163">Jeśli jest wymagane szybkie wysyłanie pakietów IP, przychodzące pakiety IP powinny być przekazywane do _ _ *_nx_ip_packet_receive_* _ do natychmiastowego przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="e11b4-163">If fast dispatch of IP packets is required, incoming IP packets should be forwarded to _ *_ _nx_ip_packet_receive_* _ for immediate processing.</span></span> <span data-ttu-id="e11b4-164">Znacznie poprawia to wydajność NetX Duo w obsłudze pakietów IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-164">This greatly improves NetX Duo performance in handling IP packets.</span></span> <span data-ttu-id="e11b4-165">W przeciwnym razie należy wykonać przekazywanie pakietów IP do _ \*_ _nx_ip_packet_deferred_receive_\*\*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-165">Otherwise, forwarding IP packets to _ *_ _nx_ip_packet_deferred_receive_*\* should be done.</span></span> <span data-ttu-id="e11b4-166">Ta usługa umieszcza pakiet IP w odroczonej kolejce przetwarzania, w której jest następnie obsługiwany przez wewnętrzny wątek IP, co skutkuje mniejszą ilością czasu przetwarzania ISR.</span><span class="sxs-lookup"><span data-stu-id="e11b4-166">This service places the IP packet in the deferred processing queue where it is then handled by the internal IP thread, which results in the least amount of ISR processing time.</span></span>

<span data-ttu-id="e11b4-167">Sterownik sieciowy może również odroczyć przetwarzanie przerwania w celu uruchomienia z kontekstu wątku IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-167">The network driver can also defer interrupt processing to run out of the context of the IP thread.</span></span> <span data-ttu-id="e11b4-168">W tym trybie procedura ISR zapisze niezbędne informacje, wywołaj wewnętrzną funkcję ***_nx_ip_driver_deferred_processing*** i Potwierdź kontroler przerwań.</span><span class="sxs-lookup"><span data-stu-id="e11b4-168">In this mode, the ISR shall save the necessary information, call the internal function ***_nx_ip_driver_deferred_processing***, and acknowledge the interrupt controller.</span></span> <span data-ttu-id="e11b4-169">Ta usługa powiadamia wątek IP w celu zaplanowania wywołania zwrotnego sterownika urządzenia, aby zakończyć proces zdarzenia, które powoduje przerwanie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-169">This service notifies IP thread to schedule a callback to the device driver to complete the process of the event that causes the interrupt.</span></span>

<span data-ttu-id="e11b4-170">Niektóre kontrolery sieci mogą wykonywać obliczenia i weryfikację sum kontrolnych nagłówka TCP/IP na sprzęcie bez uwzględniania cennych zasobów procesora CPU.</span><span class="sxs-lookup"><span data-stu-id="e11b4-170">Some network controllers are capable of performing TCP/IP header checksum computation and validation in hardware, without taking up valuable CPU resources.</span></span> <span data-ttu-id="e11b4-171">Aby skorzystać z funkcji sprzętowej, NetX Duo oferuje opcje włączania lub wyłączania obliczeń sum kontrolnych oprogramowania w czasie kompilacji, a także włączania lub wyłączania obliczeń sum kontrolnych w czasie wykonywania, jeśli sterownik urządzenia może komunikować się z warstwą IP w systemie to możliwości sprzętowe.</span><span class="sxs-lookup"><span data-stu-id="e11b4-171">To take advantage of the hardware capability feature, NetX Duo provides options to enable or disable various software checksum computation at compilation time, as well as turning on or off checksum computation at run time, if the device driver is able to communicate with the IP layer about is hardware capabilities.</span></span> <span data-ttu-id="e11b4-172">Aby uzyskać bardziej szczegółowe informacje na temat pisania sterowników sieciowych NetX Duo, zobacz [rozdział 5 — sterowniki sieciowe usługi Azure RTO NetX Duo](chapter5.md) .</span><span class="sxs-lookup"><span data-stu-id="e11b4-172">See [Chapter 5 - Azure RTOS NetX Duo Network Drivers](chapter5.md) for more detailed information on writing NetX Duo network drivers.</span></span>

### <a name="multihome-support"></a><span data-ttu-id="e11b4-173">Obsługa wielostrona</span><span class="sxs-lookup"><span data-stu-id="e11b4-173">Multihome Support</span></span>

<span data-ttu-id="e11b4-174">NetX Duo obsługuje systemy połączone z wieloma urządzeniami fizycznymi przy użyciu jednego wystąpienia IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-174">NetX Duo supports systems connected to multiple physical devices using a single IP instance.</span></span> <span data-ttu-id="e11b4-175">Każdy interfejs fizyczny jest przypisany do bloku sterowania interfejsem w wystąpieniu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-175">Each physical interface is assigned to an interface control block in the IP instance.</span></span> <span data-ttu-id="e11b4-176">Aplikacje chcące korzystać z systemu wieloznacznego muszą definiować wartość parametru \***NX_MAX_PHSYCIAL_INTERFACES** _ do liczby urządzeń fizycznych podłączonych do systemu i ponownie kompilować bibliotekę NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-176">Applications wishing to use a multihome system must define the value for \***NX_MAX_PHSYCIAL_INTERFACES** _ to the number of physical devices attached to the system, and rebuild NetX Duo library.</span></span> <span data-ttu-id="e11b4-177">Domyślnie _ *_NX_MAX_PHYSICAL_INTERFACES_*\* jest ustawiona na jeden, tworząc jeden blok sterowania interfejsem w wystąpieniu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-177">By default _ *_NX_MAX_PHYSICAL_INTERFACES_*\* is set to one, creating one interface control block in the IP instance.</span></span>

<span data-ttu-id="e11b4-178">Aplikacja NetX Duo tworzy pojedyncze wystąpienie adresu IP dla urządzenia podstawowego przy użyciu usługi \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-178">The NetX Duo application creates a single IP instance for the primary device using the \***nx_ip_create** _ service.</span></span> <span data-ttu-id="e11b4-179">Dla każdego dodatkowego urządzenia sieciowego aplikacja dołącza urządzenie do wystąpienia IP przy użyciu usługi _ \*_nx_ip_interface_attach_\*\*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-179">For each additional network devices, the application attaches the device to the IP instance using the _ *_nx_ip_interface_attach_*\* service.</span></span>

<span data-ttu-id="e11b4-180">Każda struktura interfejsu sieciowego zawiera podzestaw informacji o sieci o interfejsie sieciowym, który znajduje się w bloku kontroli IP, w tym adres IPv4 interfejsu, maskę podsieci, rozmiar IP jednostki MTU i informacje o adresie warstwy MAC.</span><span class="sxs-lookup"><span data-stu-id="e11b4-180">Each network interface structure contains a subset of network information about the network interface that is contained in the IP control block, including interface IPv4 address, subnet mask, IP MTU size, and MAC-layer address information.</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-181">*NetX Duo z obsługą wielodomu jest zgodna z poprzednimi wersjami NetX Duo. Usługi, które nie pobierają domyślnych informacji o interfejsie, do podstawowego urządzenia sieciowego.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-181">*NetX Duo with multihome support is backward compatible with earlier versions of NetX Duo. Services that do not take explicit interface information default to the primary network device.*</span></span>

<span data-ttu-id="e11b4-182">Interfejs podstawowy ma indeks zero na liście wystąpień adresów IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-182">The primary interface has index zero in the IP instance list.</span></span> <span data-ttu-id="e11b4-183">Do każdego kolejnego urządzenia dołączonego do wystąpienia protokołu IP jest przypisywany następny indeks.</span><span class="sxs-lookup"><span data-stu-id="e11b4-183">Each subsequent device attached to the IP instance is assigned the next index.</span></span>

<span data-ttu-id="e11b4-184">Wszystkie usługi protokołów warstwy wyższej, dla których jest włączone wystąpienie protokołu IP, w tym protokoły TCP, UDP, ICMP i IGMP, są dostępne dla wszystkich dołączonych urządzeń.</span><span class="sxs-lookup"><span data-stu-id="e11b4-184">All upper layer protocol services for which the IP instance is enabled, including TCP, UDP, ICMP, and IGMP, are available to all the attached devices.</span></span>

<span data-ttu-id="e11b4-185">W większości przypadków NetX Duo może określić najlepszy adres źródłowy do użycia podczas przesyłania pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-185">In most cases, NetX Duo can determine the best source address to use when transmitting a packet.</span></span> <span data-ttu-id="e11b4-186">Wybór adresów źródłowych jest oparty na adresie docelowym.</span><span class="sxs-lookup"><span data-stu-id="e11b4-186">The source address selection is based on the destination address.</span></span> <span data-ttu-id="e11b4-187">Usługi NetX Duo są dodawane, aby umożliwić aplikacjom określenie określonego adresu źródłowego, w przypadkach, gdy najbardziej odpowiedni dla nich nie może być określony przez adres docelowy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-187">NetX Duo services are added to allow applications to specify a specific source address to use, in cases where the most suitable one cannot be determined by the destination address.</span></span> <span data-ttu-id="e11b4-188">Przykładem może być w systemie z wieloma lokalizacjami, aplikacja musi wysłać pakiet do adresu IPv4 lub multiemisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-188">An example would be in a multihome system, an application needs to send a packet to an IPv4 broadcast or multicast destination addresses.</span></span>

<span data-ttu-id="e11b4-189">Usługi przeznaczone do tworzenia aplikacji multihomed:</span><span class="sxs-lookup"><span data-stu-id="e11b4-189">Services specifically for developing multihome applications include the following:</span></span>

- <span data-ttu-id="e11b4-190">*nx_igmp_multicast_interface_join*</span><span class="sxs-lookup"><span data-stu-id="e11b4-190">*nx_igmp_multicast_interface_join*</span></span>
- <span data-ttu-id="e11b4-191">*nx_igmp_multicast_interface_leave*</span><span class="sxs-lookup"><span data-stu-id="e11b4-191">*nx_igmp_multicast_interface_leave*</span></span>
- <span data-ttu-id="e11b4-192">*nx_ip_driver_interface_direct_command*</span><span class="sxs-lookup"><span data-stu-id="e11b4-192">*nx_ip_driver_interface_direct_command*</span></span>
- <span data-ttu-id="e11b4-193">*nx_ip_interface_address_get*</span><span class="sxs-lookup"><span data-stu-id="e11b4-193">*nx_ip_interface_address_get*</span></span>
- <span data-ttu-id="e11b4-194">*nx_ip_interface_address_mapping_configure*</span><span class="sxs-lookup"><span data-stu-id="e11b4-194">*nx_ip_interface_address_mapping_configure*</span></span>
- <span data-ttu-id="e11b4-195">*nx_ip_interface_address_set*</span><span class="sxs-lookup"><span data-stu-id="e11b4-195">*nx_ip_interface_address_set*</span></span>  
- <span data-ttu-id="e11b4-196">*nx_ip_interface_attach*</span><span class="sxs-lookup"><span data-stu-id="e11b4-196">*nx_ip_interface_attach*</span></span>
- <span data-ttu-id="e11b4-197">*nx_ip_interface_capability_get*</span><span class="sxs-lookup"><span data-stu-id="e11b4-197">*nx_ip_interface_capability_get*</span></span> 
- <span data-ttu-id="e11b4-198">*nx_ip_interface_capability_set*</span><span class="sxs-lookup"><span data-stu-id="e11b4-198">*nx_ip_interface_capability_set*</span></span>
- <span data-ttu-id="e11b4-199">*nx_ip_interface_detach*</span><span class="sxs-lookup"><span data-stu-id="e11b4-199">*nx_ip_interface_detach*</span></span>
- <span data-ttu-id="e11b4-200">*nx_ip_interface_info_get*</span><span class="sxs-lookup"><span data-stu-id="e11b4-200">*nx_ip_interface_info_get*</span></span>
- <span data-ttu-id="e11b4-201">*nx_ip_interface_mtu_set*</span><span class="sxs-lookup"><span data-stu-id="e11b4-201">*nx_ip_interface_mtu_set*</span></span>
- <span data-ttu-id="e11b4-202">*nx_ip_interface_physical_address_get*</span><span class="sxs-lookup"><span data-stu-id="e11b4-202">*nx_ip_interface_physical_address_get*</span></span>
- <span data-ttu-id="e11b4-203">*nx_ip_interface_physical_address_set*</span><span class="sxs-lookup"><span data-stu-id="e11b4-203">*nx_ip_interface_physical_address_set*</span></span>
- <span data-ttu-id="e11b4-204">*nx_ip_interface_status_check*</span><span class="sxs-lookup"><span data-stu-id="e11b4-204">*nx_ip_interface_status_check*</span></span>
- <span data-ttu-id="e11b4-205">*nx_ip_raw_packet_source_send*</span><span class="sxs-lookup"><span data-stu-id="e11b4-205">*nx_ip_raw_packet_source_send*</span></span>
- <span data-ttu-id="e11b4-206">*nx_ipv4_multicast_interface_join*</span><span class="sxs-lookup"><span data-stu-id="e11b4-206">*nx_ipv4_multicast_interface_join*</span></span>
- <span data-ttu-id="e11b4-207">*nx_ipv4_multicast_interface_leave*</span><span class="sxs-lookup"><span data-stu-id="e11b4-207">*nx_ipv4_multicast_interface_leave*</span></span>
- <span data-ttu-id="e11b4-208">*nx_udp_socket_source_send*</span><span class="sxs-lookup"><span data-stu-id="e11b4-208">*nx_udp_socket_source_send*</span></span>
- <span data-ttu-id="e11b4-209">*nxd_ipv6_multicast_interface_join*</span><span class="sxs-lookup"><span data-stu-id="e11b4-209">*nxd_ipv6_multicast_interface_join*</span></span>
- <span data-ttu-id="e11b4-210">*nxd_ipv6_multicast_interface_leave*</span><span class="sxs-lookup"><span data-stu-id="e11b4-210">*nxd_ipv6_multicast_interface_leave*</span></span> 
- <span data-ttu-id="e11b4-211">*nxd_udp_socket_source_send*</span><span class="sxs-lookup"><span data-stu-id="e11b4-211">*nxd_udp_socket_source_send*</span></span>
- <span data-ttu-id="e11b4-212">*nxd_icmp_source_ping*</span><span class="sxs-lookup"><span data-stu-id="e11b4-212">*nxd_icmp_source_ping*</span></span>
- <span data-ttu-id="e11b4-213">*nxd_ip_raw_packet_source_send*</span><span class="sxs-lookup"><span data-stu-id="e11b4-213">*nxd_ip_raw_packet_source_send*</span></span>
- <span data-ttu-id="e11b4-214">*nxd_udp_socket_source_send*</span><span class="sxs-lookup"><span data-stu-id="e11b4-214">*nxd_udp_socket_source_send*</span></span>

<span data-ttu-id="e11b4-215">Te usługi zostały omówione bardziej szczegółowo w [opisie usług NetX Duo](chapter4.md).</span><span class="sxs-lookup"><span data-stu-id="e11b4-215">These services are explained in greater detail in [Description of NetX Duo Services](chapter4.md).</span></span>

### <a name="loopback-interface"></a><span data-ttu-id="e11b4-216">Interfejs sprzężenia zwrotnego</span><span class="sxs-lookup"><span data-stu-id="e11b4-216">Loopback Interface</span></span>

<span data-ttu-id="e11b4-217">Interfejs sprzężenia zwrotnego jest specjalnym interfejsem sieciowym bez linku fizycznego dołączonego do.</span><span class="sxs-lookup"><span data-stu-id="e11b4-217">The loopback interface is a special network interface without an physical link attached to.</span></span> <span data-ttu-id="e11b4-218">Interfejs sprzężenia zwrotnego umożliwia aplikacjom komunikowanie się przy użyciu adresu sprzężenia zwrotnego IPv4 127.0.0.1 do wykorzystania logicznego interfejsu sprzężenia zwrotnego, upewnij się, że konfigurowalne ***NX_DISABLE_LOOPBACK_INTERFACE*** nie jest ustawione.</span><span class="sxs-lookup"><span data-stu-id="e11b4-218">The loopback interface allows applications to communicate using the IPv4 loopback address 127.0.0.1 To utilize a logical loopback interface, ensure the configurable option ***NX_DISABLE_LOOPBACK_INTERFACE*** is not set.</span></span>

### <a name="interface-control-blocks"></a><span data-ttu-id="e11b4-219">Bloki sterujące interfejsu</span><span class="sxs-lookup"><span data-stu-id="e11b4-219">Interface Control Blocks</span></span>

<span data-ttu-id="e11b4-220">Liczba bloków sterujących interfejsem w wystąpieniu IP jest liczbą interfejsów fizycznych (zdefiniowanych przez \***NX_MAX_PHYSICAL_INTERFACES** _) i interfejsem sprzężenia zwrotnego, jeśli jest włączony.</span><span class="sxs-lookup"><span data-stu-id="e11b4-220">The number of interface control blocks in the IP instance is the number of physical interfaces (defined by \***NX_MAX_PHYSICAL_INTERFACES** _) plus the loopback interface if it is enabled.</span></span> <span data-ttu-id="e11b4-221">Łączna liczba interfejsów jest zdefiniowana w _ *_NX_MAX_IP_INTERFACES_* \*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-221">The total number of interfaces is defined in _\*_NX_MAX_IP_INTERFACES_\*\*.</span></span>

## <a name="protocol-layering"></a><span data-ttu-id="e11b4-222">Warstwy protokołu</span><span class="sxs-lookup"><span data-stu-id="e11b4-222">Protocol Layering</span></span>

<span data-ttu-id="e11b4-223">Protokół TCP/IP zaimplementowany przez NetX Duo jest protokołem warstwowym, co oznacza, że bardziej złożone protokoły są zbudowane w oparciu o prostsze protokoły bazowe.</span><span class="sxs-lookup"><span data-stu-id="e11b4-223">The TCP/IP implemented by NetX Duo is a layered protocol, which means more complex protocols are built on top of simpler underlying protocols.</span></span> <span data-ttu-id="e11b4-224">W przypadku protokołu TCP/IP najniższy protokół warstwy jest na *poziomie łącza* i jest obsługiwany przez sterownik sieciowy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-224">In TCP/IP, the lowest layer protocol is at the *link level* and is handled by the network driver.</span></span> <span data-ttu-id="e11b4-225">Ten poziom jest zwykle przeznaczony do sieci Ethernet, ale może być również Fiber, serial lub praktycznie dowolnym nośnikiem fizycznym.</span><span class="sxs-lookup"><span data-stu-id="e11b4-225">This level is typically targeted towards Ethernet, but it could also be fiber, serial, or virtually any physical media.</span></span>

<span data-ttu-id="e11b4-226">W górnej części warstwy linku znajduje się *warstwa sieciowa*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-226">On top of the link layer is the *network layer*.</span></span> <span data-ttu-id="e11b4-227">W przypadku protokołu TCP/IP jest to adres IP, który jest zasadniczo odpowiedzialny za wysyłanie i otrzymywanie prostych pakietów — w sposób optymalny — w sieci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-227">In TCP/IP, this is the IP, which is basically responsible for sending and receiving simple packets—in a best-effort manner—across the network.</span></span> <span data-ttu-id="e11b4-228">Protokoły typu zarządzania, takie jak ICMP i IGMP, są zazwyczaj klasyfikowane jako warstwy sieci, nawet jeśli są one oparte na adresie IP do wysyłania i otrzymywania.</span><span class="sxs-lookup"><span data-stu-id="e11b4-228">Management-type protocols like ICMP and IGMP are typically also categorized as network layers, even though they rely on IP for sending and receiving.</span></span>

<span data-ttu-id="e11b4-229">*Warstwa transportu* jest zareszcie warstwy sieciowej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-229">The *transport layer* rests on top of the network layer.</span></span> <span data-ttu-id="e11b4-230">Ta warstwa jest odpowiedzialna za zarządzanie przepływem danych między hostami w sieci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-230">This layer is responsible for managing the flow of data between hosts on the network.</span></span> <span data-ttu-id="e11b4-231">Istnieją dwa typy usług transportowych obsługiwane przez NetX Duo: UDP i TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-231">There are two types of transport services supported by NetX Duo: UDP and TCP.</span></span> <span data-ttu-id="e11b4-232">Usługi UDP zapewniają optymalny sposób wysyłania i otrzymywania danych między dwoma hostami bez połączenia, natomiast protokół TCP zapewnia niezawodne usługi zorientowane na połączenia między dwiema jednostkami hosta.</span><span class="sxs-lookup"><span data-stu-id="e11b4-232">UDP services provide best-effort sending and receiving of data between two hosts in a connectionless manner, while TCP provides reliable connection-oriented service between two host entities.</span></span>

<span data-ttu-id="e11b4-233">Ta warstwa jest odzwierciedlana w rzeczywistych pakietach danych sieciowych.</span><span class="sxs-lookup"><span data-stu-id="e11b4-233">This layering is reflected in the actual network data packets.</span></span> <span data-ttu-id="e11b4-234">Każda warstwa w protokole TCP/IP zawiera blok informacji o nazwie header.</span><span class="sxs-lookup"><span data-stu-id="e11b4-234">Each layer in TCP/IP contains a block of information called a header.</span></span> <span data-ttu-id="e11b4-235">Ta technika otaczających danych (i prawdopodobnie informacji o protokole) z nagłówkiem jest zazwyczaj nazywana hermetyzacją danych.</span><span class="sxs-lookup"><span data-stu-id="e11b4-235">This technique of surrounding data (and possibly protocol information) with a header is typically called data encapsulation.</span></span> <span data-ttu-id="e11b4-236">Na rysunku 1 przedstawiono przykład użycia warstw NetX Duo i rysunek 2 przedstawia powstający hermetyzację danych dla wysyłanych danych UDP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-236">Figure 1 shows an example of NetX Duo layering and Figure 2 shows the resulting data encapsulation for UDP data being sent.</span></span>

![Warstwy protokołu](./media/user-guide/image12.jpg)

<span data-ttu-id="e11b4-238">**RYSUNEK 1. Warstwy protokołu**</span><span class="sxs-lookup"><span data-stu-id="e11b4-238">**FIGURE 1. Protocol Layering**</span></span>

## <a name="packet-pools"></a><span data-ttu-id="e11b4-239">Pule pakietów</span><span class="sxs-lookup"><span data-stu-id="e11b4-239">Packet Pools</span></span>

<span data-ttu-id="e11b4-240">Przydzielanie pakietów w sposób szybki i deterministyczny jest zawsze wyzwaniem w aplikacjach sieci w czasie rzeczywistym.</span><span class="sxs-lookup"><span data-stu-id="e11b4-240">Allocating packets in a fast and deterministic manner is always a challenge in real-time networking applications.</span></span> <span data-ttu-id="e11b4-241">Z tego względu NetX Duo zapewnia możliwość tworzenia wielu pul pakietów o stałym rozmiarze i zarządzania nimi.</span><span class="sxs-lookup"><span data-stu-id="e11b4-241">With this in mind, NetX Duo provides the ability to create and manage multiple pools of fixed-size network packets.</span></span>

<span data-ttu-id="e11b4-242">Ponieważ pule pakietów NetX Duo składają się z bloków pamięci o stałym rozmiarze, nigdy nie występują żadne wewnętrzne problemy z defragmentacją.</span><span class="sxs-lookup"><span data-stu-id="e11b4-242">Because NetX Duo packet pools consist of fixed-size memory blocks, there are never any internal fragmentation problems.</span></span> <span data-ttu-id="e11b4-243">Oczywiście fragmentacja powoduje, że zachowanie, które jest niedeterministyczne.</span><span class="sxs-lookup"><span data-stu-id="e11b4-243">Of course, fragmentation causes behavior that is inherently nondeterministic.</span></span> <span data-ttu-id="e11b4-244">Ponadto czas wymagany do przydzielenia i zwolnienia pakietu NetX Duo do prostego manipulowania listą.</span><span class="sxs-lookup"><span data-stu-id="e11b4-244">In addition, the time required to allocate and free a NetX Duo packet amounts to simple linked-list manipulation.</span></span> <span data-ttu-id="e11b4-245">Ponadto alokacja i cofanie pakietów odbywa się na końcu listy dostępnych.</span><span class="sxs-lookup"><span data-stu-id="e11b4-245">Furthermore, packet allocation and deallocation is done at the head of the available list.</span></span> <span data-ttu-id="e11b4-246">Zapewnia to najszybszy możliwy do przetwarzania listy połączonej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-246">This provides the fastest possible linked list processing.</span></span>

![Hermetyzacja danych UDP](./media/user-guide/image13.png)

<span data-ttu-id="e11b4-248">**RYSUNEK 2. Hermetyzacja danych UDP**</span><span class="sxs-lookup"><span data-stu-id="e11b4-248">**FIGURE 2. UDP Data Encapsulation**</span></span>

<span data-ttu-id="e11b4-249">Brak elastyczności jest zazwyczaj główną wadą dla pul pakietów o stałym rozmiarze.</span><span class="sxs-lookup"><span data-stu-id="e11b4-249">Lack of flexibility is typically the main drawback of fixed-size packet pools.</span></span> <span data-ttu-id="e11b4-250">Określenie optymalnego rozmiaru ładunku pakietu, który również obsługuje pakiet przychodzący najgorszego przypadku, jest trudnym zadaniem.</span><span class="sxs-lookup"><span data-stu-id="e11b4-250">Determining the optimal packet payload size that also handles the worst-case incoming packet is a difficult task.</span></span> <span data-ttu-id="e11b4-251">Pakiety NetX Duo dotyczą tego problemu z opcjonalną funkcją o nazwie tworzenie łańcucha pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-251">NetX Duo packets address this problem with an optional feature called packet chaining.</span></span> <span data-ttu-id="e11b4-252">Rzeczywisty pakiet sieciowy może być utworzony z co najmniej jednym pakietem NetX Duo połączonych ze sobą.</span><span class="sxs-lookup"><span data-stu-id="e11b4-252">An actual network packet can be made of one or more NetX Duo packets linked together.</span></span> <span data-ttu-id="e11b4-253">Ponadto nagłówek pakietu zachowuje wskaźnik na górze pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-253">In addition, the packet header maintains a pointer to the top of the packet.</span></span> <span data-ttu-id="e11b4-254">Po dodaniu dodatkowych protokołów wskaźnik ten jest po prostu przenoszony do tyłu, a nowy nagłówek jest zapisywana bezpośrednio przed danymi.</span><span class="sxs-lookup"><span data-stu-id="e11b4-254">As additional protocols are added, this pointer is simply moved backwards and the new header is written directly in front of the data.</span></span> <span data-ttu-id="e11b4-255">Bez elastycznej technologii pakietów, stos będzie musiał przydzielić inny bufor i skopiować dane do nowego buforu z nowym nagłówkiem, który przetwarza intensywne przetwarzanie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-255">Without the flexible packet technology, the stack would have to allocate another buffer and copy the data into a new buffer with the new header, which is processing intensive.</span></span>

<span data-ttu-id="e11b4-256">Ponieważ każdy rozmiar ładunku pakietu został ustalony dla danej puli pakietów, dane aplikacji o rozmiarze większym niż rozmiar ładunku będą wymagały łączenia wielu pakietów jednocześnie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-256">Since each packet payload size is fixed for a given packet pool, application data larger than the payload size would require multiple packets chained together.</span></span> <span data-ttu-id="e11b4-257">Podczas wypełniania pakietu przy użyciu danych użytkownika aplikacja korzysta z ***nx_packet_data_append*** usługi.</span><span class="sxs-lookup"><span data-stu-id="e11b4-257">When filling a packet with user data, the application shall use the service ***nx_packet_data_append***.</span></span> <span data-ttu-id="e11b4-258">Ta usługa przenosi dane aplikacji do pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-258">This service moves application data into a packet.</span></span> <span data-ttu-id="e11b4-259">W sytuacjach, gdy pakiet nie wystarcza do przechowywania danych użytkownika, dodatkowe pakiety są przydzieleni do przechowywania danych użytkownika.</span><span class="sxs-lookup"><span data-stu-id="e11b4-259">In situations where a packet is not enough to hold user data, additional packets are allocated to store user data.</span></span> <span data-ttu-id="e11b4-260">Aby można było korzystać z łańcucha pakietów, Sterownik musi mieć możliwość odbierania lub przesyłania z połączonych pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-260">To use packet chaining, the driver must be able to receive into or transmit from chained packets.</span></span>

<span data-ttu-id="e11b4-261">W przypadku systemów osadzonych, które nie muszą korzystać z funkcji łańcucha pakietów, biblioteka NetX Duo może być skompilowana za pomocą \***NX_DISABLE_PACKET_CHAIN** _, aby usunąć logikę łańcucha pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-261">For embedded systems that do not need to use the packet chaining feature, the NetX Duo library can be built with \***NX_DISABLE_PACKET_CHAIN** _ to remove the packet chaining logic.</span></span> <span data-ttu-id="e11b4-262">Należy pamiętać, że funkcja fragmentacji i reasemblera IP może potrzebować użycia funkcji łańcucha w łańcuchu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-262">Note that the IP fragmentation and reassembly feature may need to utilize the chained packet feature.</span></span> <span data-ttu-id="e11b4-263">W związku z tym Definiowanie _*_NX_DISABLE_PACKET_CHAIN_*_ wymaga zdefiniowania _ \*_NX_DISABLE_FRAGMENTATION_\*\*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-263">Therefore defining _*_NX_DISABLE_PACKET_CHAIN_*_ requires _ *_NX_DISABLE_FRAGMENTATION_*\* also be defined.</span></span> 

<span data-ttu-id="e11b4-264">Każda pula pamięci pakietu NetX Duo jest zasobem publicznym.</span><span class="sxs-lookup"><span data-stu-id="e11b4-264">Each NetX Duo packet memory pool is a public resource.</span></span> <span data-ttu-id="e11b4-265">NetX Duo nie wprowadza żadnych ograniczeń dotyczących sposobu używania pul pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-265">NetX Duo places no constraints on how packet pools are used.</span></span> 

### <a name="packet-pool-memory-area"></a><span data-ttu-id="e11b4-266">Obszar pamięci puli pakietów</span><span class="sxs-lookup"><span data-stu-id="e11b4-266">Packet Pool Memory Area</span></span>

<span data-ttu-id="e11b4-267">Obszar pamięci dla puli pakietów jest określany podczas tworzenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-267">The memory area for the packet pool is specified during creation.</span></span> <span data-ttu-id="e11b4-268">Podobnie jak w przypadku innych obszarów pamięci dla obiektów ThreadX i NetX Duo, może ona znajdować się w dowolnym miejscu w przestrzeni adresowej miejsca docelowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-268">Like other memory areas for ThreadX and NetX Duo objects, it can be located anywhere in the target's address space.</span></span> 

<span data-ttu-id="e11b4-269">Jest to ważna funkcja ze względu na znaczną elastyczność zapewnianą przez aplikację.</span><span class="sxs-lookup"><span data-stu-id="e11b4-269">This is an important feature because of the considerable flexibility it gives the application.</span></span> <span data-ttu-id="e11b4-270">Załóżmy na przykład, że produkt komunikacyjny ma obszar pamięci o dużej szybkości dla buforów sieciowych.</span><span class="sxs-lookup"><span data-stu-id="e11b4-270">For example, suppose that a communication product has a high-speed memory area for network buffers.</span></span> <span data-ttu-id="e11b4-271">Ten obszar pamięci jest łatwo wykorzystywany przez umieszczenie go w puli pamięci pakietu NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-271">This memory area is easily utilized by making it into a NetX Duo packet memory pool.</span></span>

### <a name="creating-packet-pools"></a><span data-ttu-id="e11b4-272">Tworzenie pul pakietów</span><span class="sxs-lookup"><span data-stu-id="e11b4-272">Creating Packet Pools</span></span>

<span data-ttu-id="e11b4-273">Pule pakietów są tworzone podczas inicjalizacji lub podczas wykonywania przez wątki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-273">Packet pools are created either during initialization or during runtime by  application threads.</span></span> <span data-ttu-id="e11b4-274">W aplikacji NetX Duo nie ma ograniczeń dotyczących liczby pul pamięci pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-274">There are no limits on the number of packet memory pools in a NetX Duo application.</span></span>

### <a name="dual-packet-pool"></a><span data-ttu-id="e11b4-275">Podwójna Pula pakietów</span><span class="sxs-lookup"><span data-stu-id="e11b4-275">Dual Packet Pool</span></span>

<span data-ttu-id="e11b4-276">Zwykle rozmiar ładunku domyślnej puli pakietów IP jest wystarczająco duży, aby pomieścić rozmiar ramki do jednostki MTU interfejsu sieciowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-276">Typically the payload size of the default IP packet pool is large enough to accommodate frame size up to the network interface MTU.</span></span> <span data-ttu-id="e11b4-277">Podczas normalnej operacji wątek IP musi wysyłać komunikaty, takie jak ARP, komunikaty sterujące TCP, Komunikaty IGMP, komunikaty ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-277">During normal operation, the IP thread needs to send messages such as ARP, TCP control messages, IGMP messages, ICMPv6 messages.</span></span> <span data-ttu-id="e11b4-278">Te komunikaty używają pakietów przyznanych z domyślnej puli pakietów w wystąpieniu protokołu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-278">These messages use the packets allocated from the default packet pool in the IP instance.</span></span> <span data-ttu-id="e11b4-279">W systemie ograniczonym do pamięci, w którym ilość pamięci dostępnej dla puli pakietów jest ograniczona, użycie pojedynczej puli pakietów (z dużym rozmiarem ładunku do dopasowania rozmiaru MTU) może nie być rozwiązaniem optymalnym.</span><span class="sxs-lookup"><span data-stu-id="e11b4-279">On a memory-constrained system where the amount of memory available for packet pool is limited, using a single packet pool (with the large payload size to match MTU size) may not be an optimal solution.</span></span> <span data-ttu-id="e11b4-280">NetX Duo umożliwia aplikacji zainstalowanie pomocniczej puli pakietów, gdzie rozmiar ładunku jest mniejszy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-280">NetX Duo allows application to install an auxiliary packet pool, where the payload size is smaller.</span></span> <span data-ttu-id="e11b4-281">Po zainstalowaniu pomocniczej puli pakietów wątek pomocnika IP przydzieli pakiety z domyślnej puli pakietów lub pomocniczej puli, w zależności od rozmiaru wysyłanej wiadomości.</span><span class="sxs-lookup"><span data-stu-id="e11b4-281">Once the auxiliary packet pool is installed, the IP helper thread would allocate packets from either the default packet pool or the auxiliary pool, depending on the size of the message it transmits.</span></span> <span data-ttu-id="e11b4-282">W przypadku pomocniczej puli pakietów rozmiar ładunku 200 bajtów będzie działał z większością komunikatów przesyłanych przez wątek pomocnika IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-282">For an auxiliary packet pool, a payload size of 200 bytes would work with most of the messages the IP helper thread transmits.</span></span>

<span data-ttu-id="e11b4-283">Domyślnie Biblioteka NetX Duo została skompilowana bez włączania podwójnej puli pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-283">By default NetX Duo library is built without enabling dual packet pool.</span></span> <span data-ttu-id="e11b4-284">Aby włączyć tę funkcję, skompiluj bibliotekę z definicją \***NX_DUAL_PACKET_POOL_ENABLE** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-284">To enable the feature, build the library with \***NX_DUAL_PACKET_POOL_ENABLE** _ defined.</span></span> <span data-ttu-id="e11b4-285">Następnie pomocniczą pulę pakietów można ustawić przez wywołanie _ *_nx_ip_auxiliary_packet_pool_set_* \*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-285">Then the auxiliary packet pool can be set by calling _\*_nx_ip_auxiliary_packet_pool_set_\*\*.</span></span>

<span data-ttu-id="e11b4-286">Istnieje również możliwość utworzenia więcej niż jednej puli pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-286">There is also the option of creating more than one packet pool.</span></span> <span data-ttu-id="e11b4-287">Przykładowo zostanie utworzona Pula pakietów przesyłana z optymalnym rozmiarem ładunku dla oczekiwanych rozmiarów komunikatów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-287">For example a transmit packet pool is created with optimal payload size for expected message sizes.</span></span> <span data-ttu-id="e11b4-288">Pula pakietów odbioru jest tworzona w sterowniku z rozmiarem ładunku ustawionym na jednostkę MTU sterownika, ponieważ jeden z nich nie może przewidzieć rozmiaru odebranych pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-288">A receive packet pool is created in the driver with a payload size set to the driver MTU, since one cannot predict the size of received packets.</span></span>

### <a name="packet-header-nx_packet"></a><span data-ttu-id="e11b4-289">NX_PACKET nagłówka pakietu</span><span class="sxs-lookup"><span data-stu-id="e11b4-289">Packet Header NX_PACKET</span></span>   
<span data-ttu-id="e11b4-290">Domyślnie NetX Duo umieszcza nagłówek pakietu bezpośrednio przed obszarem ładunku pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-290">By default, NetX Duo places the packet header immediately before the packet payload area.</span></span> <span data-ttu-id="e11b4-291">Pula pamięci pakietu jest zasadniczo serią pakietów — nagłówkami, a następnie bezpośrednio przez ładunek pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-291">The packet memory pool is basically a series of packets— headers followed immediately by the packet payload.</span></span> <span data-ttu-id="e11b4-292">Nagłówek pakietu (***NX_PACKET***) i układ puli pakietów są przedstawiane na rysunku 3.</span><span class="sxs-lookup"><span data-stu-id="e11b4-292">The packet header (***NX_PACKET***) and the layout of the packet pool are pictured in Figure 3.</span></span>

<span data-ttu-id="e11b4-293">W przypadku sterownika urządzeń sieciowych, który jest w stanie wykonać zero operacji kopiowania, zazwyczaj adres początkowy obszaru ładunku pakietu jest zaprogramowany do logiki DMA.</span><span class="sxs-lookup"><span data-stu-id="e11b4-293">For network devices driver that are able to perform zero copy operations, typically the starting address of the packet payload area is programmed into the DMA logic.</span></span> <span data-ttu-id="e11b4-294">Niektóre aparaty DMA mają wymagania dotyczące wyrównania w obszarze ładunku.</span><span class="sxs-lookup"><span data-stu-id="e11b4-294">Certain DMA engines have alignment requirement on the payload area.</span></span> <span data-ttu-id="e11b4-295">Aby adres początkowy obszaru ładunku był wyrównany prawidłowo dla aparatu DMA lub operacji pamięci podręcznej, użytkownik może zdefiniować symbol ***NX_PACKET_ALIGNMENT***.</span><span class="sxs-lookup"><span data-stu-id="e11b4-295">To make the starting address of the payload area align properly for the DMA engine, or the cache operation, the user can define the symbol ***NX_PACKET_ALIGNMENT***.</span></span>

> [!WARNING]
> <span data-ttu-id="e11b4-296">*Ważne jest, aby sterownik sieciowy korzystał z funkcji **nx_packet_transmit_release** , gdy transmisja pakietu zostanie zakończona. Ta funkcja sprawdza, czy pakiet nie jest częścią kolejki wyjściowej TCP, zanim zostanie w rzeczywistości umieszczony w dostępnej puli.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-296">*It is important for the network driver to use the **nx_packet_transmit_release** function when transmission of a packet is complete. This function checks to make sure the packet is not part of a TCP output queue before it is actually placed back in the available pool.*</span></span>

![Układ nagłówka i puli pakietów](./media/user-guide/image14.jpg)

<span data-ttu-id="e11b4-298">**RYSUNEK 3. Układ nagłówka i puli pakietów**</span><span class="sxs-lookup"><span data-stu-id="e11b4-298">**FIGURE 3. Packet Header and Packet Pool Layout**</span></span>

<span data-ttu-id="e11b4-299">Pola nagłówka pakietu są zdefiniowane w następujący sposób.</span><span class="sxs-lookup"><span data-stu-id="e11b4-299">The fields of the packet header are defined as follows.</span></span> <span data-ttu-id="e11b4-300">Należy zauważyć, że ta tabela nie jest kompletną listą wszystkich elementów członkowskich w strukturze *NX_PACKET* .</span><span class="sxs-lookup"><span data-stu-id="e11b4-300">Note that this table is not a comprehensive list of all the members in the *NX_PACKET* structure.</span></span>

|<span data-ttu-id="e11b4-301">Nagłówek pakietu</span><span class="sxs-lookup"><span data-stu-id="e11b4-301">Packet header</span></span> | <span data-ttu-id="e11b4-302">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="e11b4-302">Purpose</span></span> |
|---|---|
|<span data-ttu-id="e11b4-303">***nx_packet_pool_owner***</span><span class="sxs-lookup"><span data-stu-id="e11b4-303">***nx_packet_pool_owner***</span></span>|<span data-ttu-id="e11b4-304">To pole wskazuje pulę pakietów, do której należy ten konkretny pakiet.</span><span class="sxs-lookup"><span data-stu-id="e11b4-304">This field points to the packet pool that owns this particular packet.</span></span> <span data-ttu-id="e11b4-305">Po wydaniu pakiet jest on wydawany do tej określonej puli.</span><span class="sxs-lookup"><span data-stu-id="e11b4-305">When the packet is released, it is released to this particular pool.</span></span> <span data-ttu-id="e11b4-306">Mając własność puli wewnątrz każdego pakietu, istnieje możliwość, że datagram obejmuje wiele pakietów z wielu pul pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-306">With the pool ownership inside each packet, it is possible for a datagram to span multiple packets from multiple packet pools.</span></span>|
|<span data-ttu-id="e11b4-307">\***nx_packet_next** _</span><span class="sxs-lookup"><span data-stu-id="e11b4-307">\***nx_packet_next** _</span></span>|<span data-ttu-id="e11b4-308">To pole wskazuje następny pakiet w obrębie tej samej ramki.</span><span class="sxs-lookup"><span data-stu-id="e11b4-308">This field points to the next packet within the same frame.</span></span> <span data-ttu-id="e11b4-309">Jeśli wartość jest równa NULL, nie ma dodatkowych pakietów, które są częścią ramki.</span><span class="sxs-lookup"><span data-stu-id="e11b4-309">If NULL, there are no additional packets that are part of the frame.</span></span> <span data-ttu-id="e11b4-310">To pole jest również używane do przechowywania pofragmentowanych pakietów do momentu, w którym cały pakiet będzie można ponownie połączyć.</span><span class="sxs-lookup"><span data-stu-id="e11b4-310">This field is also used to hold fragmented packets until the entire packet can be re-assembled.</span></span> <span data-ttu-id="e11b4-311">jest ona usuwana, jeśli określono _ *_NX_DISABLE_PACKET_CHAIN_* \*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-311">it is removed if _\*_NX_DISABLE_PACKET_CHAIN_\*\*is defined.</span></span>|
|<span data-ttu-id="e11b4-312">\***nx_packet_last** _</span><span class="sxs-lookup"><span data-stu-id="e11b4-312">\***nx_packet_last** _</span></span>|<span data-ttu-id="e11b4-313">To pole wskazuje ostatni pakiet w ramach tego samego pakietu sieciowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-313">This field points to the last packet within the same network packet.</span></span> <span data-ttu-id="e11b4-314">Jeśli wartość jest równa NULL, ten pakiet reprezentuje cały pakiet sieciowy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-314">If NULL, this packet represents the entire network packet.</span></span> <span data-ttu-id="e11b4-315">To pole jest usuwane, jeśli określono _ *_NX_DISABLE_PACKET_CHAIN_* \*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-315">This field is removed if _\*_NX_DISABLE_PACKET_CHAIN_\*\*is defined.</span></span>|
|<span data-ttu-id="e11b4-316">\***nx_packet_length** _</span><span class="sxs-lookup"><span data-stu-id="e11b4-316">\***nx_packet_length** _</span></span>| <span data-ttu-id="e11b4-317">To pole zawiera łączną liczbę bajtów w całym pakiecie sieciowym, w tym łączną liczbę wszystkich bajtów we wszystkich pakietach połączonych przez element członkowski _nx_packet_next \*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-317">This field contains the total number of bytes in the entire network packet, including the total of all bytes in all packets chained together by the _nx_packet_next\*member.</span></span>|
|<span data-ttu-id="e11b4-318">***nx_packet_ip_interface***</span><span class="sxs-lookup"><span data-stu-id="e11b4-318">***nx_packet_ip_interface***</span></span>| <span data-ttu-id="e11b4-319">To pole jest blokiem sterowania interfejsem przypisanym do pakietu, gdy jest odbierany przez sterownik interfejsu i przez NetX Duo dla pakietów wychodzących.</span><span class="sxs-lookup"><span data-stu-id="e11b4-319">This field is the interface control block which is assigned to the packet when it is received by the interface driver, and by NetX Duo for outgoing packets.</span></span> <span data-ttu-id="e11b4-320">Blok sterowania interfejsem opisuje interfejs, np. adres sieciowy, adres MAC, adres IP i stan interfejsu, takie jak link włączony i wymagane jest mapowanie fizyczne.</span><span class="sxs-lookup"><span data-stu-id="e11b4-320">An interface control block describes the interface e.g. network address, MAC address, IP address and interface status such as link enabled and physical mapping required.</span></span>|
|<span data-ttu-id="e11b4-321">\***nx_packet_data_start** _</span><span class="sxs-lookup"><span data-stu-id="e11b4-321">\***nx_packet_data_start** _</span></span>| <span data-ttu-id="e11b4-322">To pole wskazuje początek obszaru fizycznego ładunku tego pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-322">This field points to the start of the physical payload area of this packet.</span></span> <span data-ttu-id="e11b4-323">Nie musi ona występować bezpośrednio po nagłówku NX_PACKET, ale jest wartością domyślną dla usługi _ \*_nx_packet_pool_create_\*\*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-323">It does not have to be immediately following the NX_PACKET header, but that is the default for the _ *_nx_packet_pool_create_*\* service.</span></span>|
|<span data-ttu-id="e11b4-324">\***nx_packet_data_end** _</span><span class="sxs-lookup"><span data-stu-id="e11b4-324">\***nx_packet_data_end** _</span></span>|<span data-ttu-id="e11b4-325">To pole wskazuje koniec obszaru fizycznego ładunku tego pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-325">This field points to the end of the physical payload area of this packet.</span></span> <span data-ttu-id="e11b4-326">Różnica między tym polem a polem _nx_packet_data_start \* reprezentuje rozmiar ładunku.</span><span class="sxs-lookup"><span data-stu-id="e11b4-326">The difference between this field and the _nx_packet_data_start\* field represents the payload size.</span></span>|
|<span data-ttu-id="e11b4-327">\***nx_packet_prepend_ptr** _</span><span class="sxs-lookup"><span data-stu-id="e11b4-327">\***nx_packet_prepend_ptr** _</span></span>|<span data-ttu-id="e11b4-328">To pole wskazuje lokalizację, w której dane pakietów, nagłówek protokołu lub rzeczywiste dane, są dodawane przed istniejącymi danymi pakietu (jeśli istnieją) w obszarze ładunku pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-328">This field points to the location of where packet data, either protocol header or actual data, is added in front of the existing packet data (if any) in the packet payload area.</span></span> <span data-ttu-id="e11b4-329">Wartość musi być większa niż lub równa _nx_packet_data_start \* lokalizacji wskaźnika i mniejsza lub równa *nx_packet_append_ptr* wskaźnika.</span><span class="sxs-lookup"><span data-stu-id="e11b4-329">It must be greater than or equal to the _nx_packet_data_start\* pointer location and less than or equal to the *nx_packet_append_ptr* pointer.</span></span>|
> [!CAUTION]
> <span data-ttu-id="e11b4-330">*Ze względu na wydajność NetX Duo zakłada, że gdy pakiet jest przekazywany do usługi NetX Duo do transmisji, wskaźnik poprzedź wskazuje na długi adres wyrównany do wyrazu.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-330">*For performance reasons, NetX Duo assumes that when the packet is passed into NetX Duo services for transmission, the prepend pointer points to long word aligned address.*</span></span>

|   |   |
|---|---|
|<span data-ttu-id="e11b4-331">\***nx_packet_append_ptr** _</span><span class="sxs-lookup"><span data-stu-id="e11b4-331">\***nx_packet_append_ptr** _</span></span>|<span data-ttu-id="e11b4-332">To pole wskazuje koniec danych znajdujących się obecnie w obszarze ładunku pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-332">This field points to the end of the data currently in the packet payload area.</span></span> <span data-ttu-id="e11b4-333">Musi znajdować się między lokalizacją pamięci wskazywaną przez _nx_packet_prepend_ptr \* i *nx_packet_data_end.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-333">It must be in between the memory location pointed to by _nx_packet_prepend_ptr\* and *nx_packet_data_end.*</span></span> <span data-ttu-id="e11b4-334">Różnica między tym polem a polem *nx_packet_prepend_ptr* reprezentuje ilość danych w tym pakiecie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-334">The difference between this field and the *nx_packet_prepend_ptr* field represents the amount of data in this packet.</span></span>|
|<span data-ttu-id="e11b4-335">\***nx_packet_packet_pad** _</span><span class="sxs-lookup"><span data-stu-id="e11b4-335">\***nx_packet_packet_pad** _</span></span>|<span data-ttu-id="e11b4-336">Te pola definiują długość wypełnienia w przypadku wyrazów 4-bajtowych w celu osiągnięcia wymaganego wymagania dotyczącego wyrównania.</span><span class="sxs-lookup"><span data-stu-id="e11b4-336">This fields defines the length of padding in 4-byte words to achieve the desired alignment requirement.</span></span> <span data-ttu-id="e11b4-337">To pole jest usuwane, jeśli nie zdefiniowano _*_NX_PACKET_HEADER_PAD_*_ .</span><span class="sxs-lookup"><span data-stu-id="e11b4-337">This field is removed if _*_NX_PACKET_HEADER_PAD_*_ is not defined.</span></span> <span data-ttu-id="e11b4-338">Można również użyć _*_NX_PACKET_ALIGNMENT_*_ zamiast definiować _nx_packet_header_pad. \*</span><span class="sxs-lookup"><span data-stu-id="e11b4-338">Alternatively _*_NX_PACKET_ALIGNMENT_*_ can be used instead of defining _nx_packet_header_pad.\*</span></span>|

### <a name="packet-header-offsets"></a><span data-ttu-id="e11b4-339">Przesunięcia nagłówka pakietu</span><span class="sxs-lookup"><span data-stu-id="e11b4-339">Packet Header Offsets</span></span>

<span data-ttu-id="e11b4-340">Rozmiar nagłówka pakietu jest zdefiniowany w celu zapewnienia wystarczającej ilości miejsca, aby pomieścić rozmiar nagłówka.</span><span class="sxs-lookup"><span data-stu-id="e11b4-340">Packet header size is defined to allow enough room  to accommodate the size of the header.</span></span> <span data-ttu-id="e11b4-341">Usługa ***nx_packet_allocate*** jest używana do przydzielania pakietu i dostosowywania wskaźnika dołączania w pakiecie zgodnie z typem określonego pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-341">The ***nx_packet_allocate*** service is used to allocate a packet and adjusts the prepend pointer in the packet according to the type of packet specified.</span></span> <span data-ttu-id="e11b4-342">Typ pakietu informuje NetX Duo o przesunięciu wymaganym do wstawienia nagłówka protokołu (na przykład UDP, TCP lub ICMP) przed danymi protokołu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-342">The packet type tells NetX Duo the offset required for inserting the protocol header (such as UDP, TCP, or ICMP) in front of the protocol data.</span></span>

<span data-ttu-id="e11b4-343">Następujące typy są zdefiniowane w NetX Duo w celu uwzględnienia nagłówka IP i nagłówków warstwy fizycznej (Ethernet) w pakiecie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-343">The following types are defined in NetX Duo to take into account the IP header and physical layer (Ethernet) header in the packet.</span></span> <span data-ttu-id="e11b4-344">W drugim przypadku zakłada się, że jest to 16 bajtów z uwzględnieniem wymaganego 4-bajtowego wyrównania.</span><span class="sxs-lookup"><span data-stu-id="e11b4-344">In the latter case, it is assumed to be 16 bytes taking the required 4-byte alignment into consideration.</span></span> <span data-ttu-id="e11b4-345">Pakiety IPv4 są nadal zdefiniowane w NetX Duo dla aplikacji w celu przydzielenia pakietów dla sieci IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-345">IPv4 packets are still defined in NetX Duo for applications to allocate packets for IPv4 networks.</span></span> <span data-ttu-id="e11b4-346">Należy pamiętać, że jeśli biblioteka NetX Duo została skompilowana z włączonym protokołem IPv6, typy pakietów ogólnych (takie jak NX_IP_PACKET) są mapowane na wersję protokołu IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-346">Note that if the NetX Duo library is built with IPv6 enabled, the generic packet types (such as NX_IP_PACKET) are mapped to the IPv6 version.</span></span> <span data-ttu-id="e11b4-347">Jeśli biblioteka NetX Duo została skompilowana bez włączonego protokołu IPv6, te typy pakietów ogólnych są mapowane na wersję IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-347">If the NetX Duo Library is built without IPv6 enabled, these generic packet types are mapped to the IPv4 version.</span></span>

<span data-ttu-id="e11b4-348">W poniższej tabeli przedstawiono symbole zdefiniowane przy użyciu protokołu IPv6:</span><span class="sxs-lookup"><span data-stu-id="e11b4-348">The following table shows symbols defined with IPv6 enabled:</span></span>

|<span data-ttu-id="e11b4-349">**Typ pakietu**</span><span class="sxs-lookup"><span data-stu-id="e11b4-349">**Packet Type**</span></span> |<span data-ttu-id="e11b4-350">**Wartość**</span><span class="sxs-lookup"><span data-stu-id="e11b4-350">**Value**</span></span> |
|---|---|
|<span data-ttu-id="e11b4-351">NX_IPv6_PACKET (NX_IP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="e11b4-351">NX_IPv6_PACKET (NX_IP_PACKET)</span></span> | <span data-ttu-id="e11b4-352">0x38</span><span class="sxs-lookup"><span data-stu-id="e11b4-352">0x38</span></span> |
|<span data-ttu-id="e11b4-353">NX_UDPv6_PACKET (NX_UDP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="e11b4-353">NX_UDPv6_PACKET (NX_UDP_PACKET)</span></span> |<span data-ttu-id="e11b4-354">0x40</span><span class="sxs-lookup"><span data-stu-id="e11b4-354">0x40</span></span> |
|<span data-ttu-id="e11b4-355">NX_TCPv6_PACKET (NX_TCP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="e11b4-355">NX_TCPv6_PACKET (NX_TCP_PACKET)</span></span> |<span data-ttu-id="e11b4-356">0x4c</span><span class="sxs-lookup"><span data-stu-id="e11b4-356">0x4c</span></span> |
|<span data-ttu-id="e11b4-357">NX_IPv4_PACKET</span><span class="sxs-lookup"><span data-stu-id="e11b4-357">NX_IPv4_PACKET</span></span> |<span data-ttu-id="e11b4-358">0x24</span><span class="sxs-lookup"><span data-stu-id="e11b4-358">0x24</span></span> |
|<span data-ttu-id="e11b4-359">NX_IPv4_UDP_PACKET</span><span class="sxs-lookup"><span data-stu-id="e11b4-359">NX_IPv4_UDP_PACKET</span></span> |<span data-ttu-id="e11b4-360">0x2c</span><span class="sxs-lookup"><span data-stu-id="e11b4-360">0x2c</span></span> |
|<span data-ttu-id="e11b4-361">NX_IPv4_TCP_PACKET</span><span class="sxs-lookup"><span data-stu-id="e11b4-361">NX_IPv4_TCP_PACKET</span></span> |<span data-ttu-id="e11b4-362">0x38</span><span class="sxs-lookup"><span data-stu-id="e11b4-362">0x38</span></span> |

<span data-ttu-id="e11b4-363">W poniższej tabeli przedstawiono symbole zdefiniowane przy użyciu protokołu IPv6:</span><span class="sxs-lookup"><span data-stu-id="e11b4-363">The following table shows symbols defined with IPv6 disabled:</span></span>

|<span data-ttu-id="e11b4-364">**Typ pakietu**</span><span class="sxs-lookup"><span data-stu-id="e11b4-364">**Packet Type**</span></span> |<span data-ttu-id="e11b4-365">**Wartość**</span><span class="sxs-lookup"><span data-stu-id="e11b4-365">**Value**</span></span> |
|---|---|
|<span data-ttu-id="e11b4-366">NX_IPv4_PACKET (NX_IP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="e11b4-366">NX_IPv4_PACKET (NX_IP_PACKET)</span></span> |<span data-ttu-id="e11b4-367">0x24</span><span class="sxs-lookup"><span data-stu-id="e11b4-367">0x24</span></span> |
|<span data-ttu-id="e11b4-368">NX_IPv4_UDP_PACKET (NX_UDP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="e11b4-368">NX_IPv4_UDP_PACKET (NX_UDP_PACKET)</span></span> |<span data-ttu-id="e11b4-369">0x2c</span><span class="sxs-lookup"><span data-stu-id="e11b4-369">0x2c</span></span> |
|<span data-ttu-id="e11b4-370">NX_IPv4_TCP_PACKET (NX_TCP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="e11b4-370">NX_IPv4_TCP_PACKET (NX_TCP_PACKET)</span></span> |<span data-ttu-id="e11b4-371">0x38</span><span class="sxs-lookup"><span data-stu-id="e11b4-371">0x38</span></span> |

<span data-ttu-id="e11b4-372">Należy zauważyć, że te wartości zmienią się, jeśli *NX_IPSEC_ENABLE* jest zdefiniowany.</span><span class="sxs-lookup"><span data-stu-id="e11b4-372">Note that these values will change if *NX_IPSEC_ENABLE* is defined.</span></span> <span data-ttu-id="e11b4-373">W przypadku aplikacji korzystających z protokołu IPsec zapoznaj się z podręcznikiem użytkownika NetX Duo IPsec, aby uzyskać więcej informacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-373">For application using IPsec, refer to NetX Duo IPsec User Guide for more information.</span></span>

### <a name="pool-capacity"></a><span data-ttu-id="e11b4-374">Pojemność puli</span><span class="sxs-lookup"><span data-stu-id="e11b4-374">Pool Capacity</span></span>

<span data-ttu-id="e11b4-375">Liczba pakietów w puli pakietów jest funkcją rozmiaru ładunku i łączną liczbą bajtów w obszarze pamięci dostarczonym do usługi tworzenia puli pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-375">The number of packets in a packet pool is a function of the payload size and the total number of bytes in the memory area supplied to the packet pool create service.</span></span> <span data-ttu-id="e11b4-376">Pojemność puli jest obliczana przez podzielenie rozmiaru pakietu (w tym rozmiaru nagłówka NX_PACKET, rozmiaru ładunku i właściwego wyrównania) do całkowitej liczby bajtów w podanym obszarze pamięci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-376">The capacity of the pool is calculated by dividing the packet size (including the size of the NX_PACKET header, the payload size, and proper alignment) into the total number of bytes in the supplied memory area.</span></span>

### <a name="payload-area-alignment"></a><span data-ttu-id="e11b4-377">Wyrównanie obszaru ładunku</span><span class="sxs-lookup"><span data-stu-id="e11b4-377">Payload Area Alignment</span></span>

<span data-ttu-id="e11b4-378">Projektowanie puli pakietów w programie NetX Duo obsługuje kopiowanie zerowe.</span><span class="sxs-lookup"><span data-stu-id="e11b4-378">Packet pool design in NetX Duo supports zero-copy.</span></span> <span data-ttu-id="e11b4-379">Na poziomie sterownika urządzenia sterownik może przypisać obszar ładunku bezpośrednio do deskryptorów buforu na potrzeby odbierania danych.</span><span class="sxs-lookup"><span data-stu-id="e11b4-379">At the device driver level, the driver is able to assign the payload area directly into buffer descriptors for data reception.</span></span> <span data-ttu-id="e11b4-380">Czasami aparat DMA lub mechanizm synchronizacji pamięci podręcznej wymaga, aby adres początkowy obszaru ładunku miał pewne wymagania dotyczące wyrównania.</span><span class="sxs-lookup"><span data-stu-id="e11b4-380">Sometimes the DMA engine or the cache synchronization mechanism requires the starting address of the payload area to have a certain alignment requirement.</span></span> <span data-ttu-id="e11b4-381">Można to osiągnąć przez zdefiniowanie żądanego wymagania dotyczącego wyrównania (w bajtach) w ***NX_PACKET_ALIGNMENT***.</span><span class="sxs-lookup"><span data-stu-id="e11b4-381">This can be achieved by defining the desired alignment requirement (in bytes) in ***NX_PACKET_ALIGNMENT***.</span></span> <span data-ttu-id="e11b4-382">Podczas tworzenia puli pakietów początkowy adres obszaru ładunku będzie wyrównany do tej wartości.</span><span class="sxs-lookup"><span data-stu-id="e11b4-382">When creating a packet pool, the starting address of the payload area will aligned to this value.</span></span> <span data-ttu-id="e11b4-383">Domyślnie adres początkowy to 4-bajtowy wyrównany.</span><span class="sxs-lookup"><span data-stu-id="e11b4-383">By default, starting address is 4-byte aligned.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="e11b4-384">Zawieszenie wątku</span><span class="sxs-lookup"><span data-stu-id="e11b4-384">Thread Suspension</span></span>

<span data-ttu-id="e11b4-385">Wątki aplikacji mogą wstrzymywać się podczas oczekiwania na pakiet z pustej puli.</span><span class="sxs-lookup"><span data-stu-id="e11b4-385">Application threads can suspend while waiting for a packet from an empty pool.</span></span> <span data-ttu-id="e11b4-386">Gdy pakiet jest zwracany do puli, zawieszony wątek zostaje przyznany i wznowiony.</span><span class="sxs-lookup"><span data-stu-id="e11b4-386">When a packet is returned to the pool, the suspended thread is given this packet and resumed.</span></span>

<span data-ttu-id="e11b4-387">Jeśli wiele wątków jest zawieszonych w tej samej puli pakietów, wznowione w kolejności, w której zostały wstrzymane (FIFO).</span><span class="sxs-lookup"><span data-stu-id="e11b4-387">If multiple threads are suspended on the same packet pool, they  resumed in the order they were suspended (FIFO).</span></span>

### <a name="pool-statistics-and-errors"></a><span data-ttu-id="e11b4-388">Statystyki i błędy puli</span><span class="sxs-lookup"><span data-stu-id="e11b4-388">Pool Statistics and Errors</span></span>

<span data-ttu-id="e11b4-389">Jeśli ta opcja jest włączona, oprogramowanie do zarządzania pakietami NetX Duo śledzi kilka statystyk i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-389">If enabled, the NetX Duo packet management software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="e11b4-390">Dla pul pakietów są obsługiwane następujące raporty statystyczne i błędy:</span><span class="sxs-lookup"><span data-stu-id="e11b4-390">The following statistics and error reports are maintained for packet pools:</span></span>

- <span data-ttu-id="e11b4-391">Łączna liczba pakietów w puli</span><span class="sxs-lookup"><span data-stu-id="e11b4-391">Total Packets in Pool</span></span>
- <span data-ttu-id="e11b4-392">Bezpłatne pakiety w puli</span><span class="sxs-lookup"><span data-stu-id="e11b4-392">Free Packets in Pool</span></span>
- <span data-ttu-id="e11b4-393">Łączna liczba przydziałów pakietów</span><span class="sxs-lookup"><span data-stu-id="e11b4-393">Total Packet Allocations</span></span>
- <span data-ttu-id="e11b4-394">Puste żądania alokacji puli</span><span class="sxs-lookup"><span data-stu-id="e11b4-394">Pool Empty Allocation Requests</span></span>
- <span data-ttu-id="e11b4-395">Zawieszanie pustej alokacji puli</span><span class="sxs-lookup"><span data-stu-id="e11b4-395">Pool Empty Allocation Suspensions</span></span>
- <span data-ttu-id="e11b4-396">Nieprawidłowe wersje pakietów</span><span class="sxs-lookup"><span data-stu-id="e11b4-396">Invalid Packet Releases</span></span>

<span data-ttu-id="e11b4-397">Wszystkie te statystyki i raporty o błędach, z wyjątkiem całkowitej i bezpłatnej liczby pakietów w puli, są wbudowane w bibliotekę NetX Duo, chyba że określono \***NX_DISABLE_PACKET_INFO** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-397">All of these statistics and error reports, except for total and free packet count in pool, are built into NetX Duo library unless \***NX_DISABLE_PACKET_INFO** _ is defined.</span></span> <span data-ttu-id="e11b4-398">Te dane są dostępne dla aplikacji za pomocą usługi _ \*_nx_packet_pool_info_get_\*\*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-398">This data is available to the application with the _ *_nx_packet_pool_info_get_*\* service.</span></span>

### <a name="packet-pool-control-block-nx_packet_pool"></a><span data-ttu-id="e11b4-399">NX_PACKET_POOL bloku kontroli puli pakietów</span><span class="sxs-lookup"><span data-stu-id="e11b4-399">Packet Pool Control Block NX_PACKET_POOL</span></span>

<span data-ttu-id="e11b4-400">Charakterystyka każdej puli pamięci pakietów znajduje się w bloku sterowania.</span><span class="sxs-lookup"><span data-stu-id="e11b4-400">The characteristics of each packet memory pool are found in its control block.</span></span> <span data-ttu-id="e11b4-401">Zawiera on przydatne informacje, takie jak połączona lista bezpłatnych pakietów, Liczba bezpłatnych pakietów i rozmiar ładunku dla pakietów w tej puli.</span><span class="sxs-lookup"><span data-stu-id="e11b4-401">It contains useful information such as the linked list of free packets, the number of free packets, and the payload size for packets in this pool.</span></span> <span data-ttu-id="e11b4-402">Ta struktura jest zdefiniowana w pliku ***nx_api. h*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-402">This structure is defined in the ***nx_api.h*** file.</span></span>

<span data-ttu-id="e11b4-403">Bloki sterujące puli pakietów mogą znajdować się w dowolnym miejscu w pamięci, ale najczęściej jest to, że formant blokuje strukturę globalną przez definiowanie jej poza zakresem dowolnej funkcji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-403">Packet pool control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

## <a name="ipv4-protocol"></a><span data-ttu-id="e11b4-404">Protokół IPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-404">IPv4 Protocol</span></span>

<span data-ttu-id="e11b4-405">Składnik protokołu internetowego (IP) NetX Duo jest odpowiedzialny za wysyłanie i otrzymywanie pakietów IPv4 w Internecie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-405">The Internet Protocol (IP) component of NetX Duo is responsible for sending and receiving IPv4 packets on the Internet.</span></span> <span data-ttu-id="e11b4-406">W NetX Duo jest to składnik, który jest ostatecznie odpowiedzialny za wysyłanie i otrzymywanie komunikatów TCP, UDP, ICMP i IGMP przy użyciu podstawowego sterownika sieciowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-406">In NetX Duo, it is the component ultimately responsible for sending and receiving TCP, UDP, ICMP, and IGMP messages, utilizing the underlying network driver.</span></span>

<span data-ttu-id="e11b4-407">NetX Duo obsługuje zarówno protokół IPv4 (RFC 791), jak i protokół IPv6 (RFC 2460).</span><span class="sxs-lookup"><span data-stu-id="e11b4-407">NetX Duo supports both IPv4 protocol (RFC 791) and IPv6 protocol (RFC 2460).</span></span> <span data-ttu-id="e11b4-408">W tej sekcji omówiono protokół IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-408">This section discusses IPv4.</span></span> <span data-ttu-id="e11b4-409">Protokół IPv6 został omówiony w następnej sekcji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-409">IPv6 is discussed in the next section.</span></span>

### <a name="ipv4-addresses"></a><span data-ttu-id="e11b4-410">Adresy IPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-410">IPv4 Addresses</span></span>

<span data-ttu-id="e11b4-411">Każdy host w Internecie ma unikatowy identyfikator 32-bitowy o nazwie adres IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-411">Each host on the Internet has a unique 32-bit identifier called an IP address.</span></span> <span data-ttu-id="e11b4-412">Istnieje pięć klas adresów IPv4, zgodnie z opisem na rysunku 4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-412">There are five classes of IPv4 addresses as described in Figure 4.</span></span> <span data-ttu-id="e11b4-413">Zakresy pięciu klas adresów IPv4 są następujące:</span><span class="sxs-lookup"><span data-stu-id="e11b4-413">The ranges of the five IPv4 address classes are as follows:</span></span>

|<span data-ttu-id="e11b4-414">Klasa</span><span class="sxs-lookup"><span data-stu-id="e11b4-414">Class</span></span>|<span data-ttu-id="e11b4-415">Zakres</span><span class="sxs-lookup"><span data-stu-id="e11b4-415">Range</span></span>|
|---|---|
|<span data-ttu-id="e11b4-416">A</span><span class="sxs-lookup"><span data-stu-id="e11b4-416">A</span></span> |<span data-ttu-id="e11b4-417">od 0.0.0.0 do 127.255.255.255</span><span class="sxs-lookup"><span data-stu-id="e11b4-417">0.0.0.0 to 127.255.255.255</span></span>|
|<span data-ttu-id="e11b4-418">B</span><span class="sxs-lookup"><span data-stu-id="e11b4-418">B</span></span> |<span data-ttu-id="e11b4-419">128.0.0.0 do 191.255.255.255</span><span class="sxs-lookup"><span data-stu-id="e11b4-419">128.0.0.0 to 191.255.255.255</span></span>|
|<span data-ttu-id="e11b4-420">C</span><span class="sxs-lookup"><span data-stu-id="e11b4-420">C</span></span> |<span data-ttu-id="e11b4-421">192.0.0.0 do 223.255.255.255</span><span class="sxs-lookup"><span data-stu-id="e11b4-421">192.0.0.0 to 223.255.255.255</span></span>|
|<span data-ttu-id="e11b4-422">D</span><span class="sxs-lookup"><span data-stu-id="e11b4-422">D</span></span> |<span data-ttu-id="e11b4-423">od 224.0.0.0 do 239.255.255.255</span><span class="sxs-lookup"><span data-stu-id="e11b4-423">224.0.0.0 to 239.255.255.255</span></span>|
|<span data-ttu-id="e11b4-424">E</span><span class="sxs-lookup"><span data-stu-id="e11b4-424">E</span></span> |<span data-ttu-id="e11b4-425">240.0.0.0 do 247.255.255.255</span><span class="sxs-lookup"><span data-stu-id="e11b4-425">240.0.0.0 to 247.255.255.255</span></span>|

![Diagram struktury adresów IPv4.](./media/user-guide/ipv4-address-structure.png)

### <a name="figure-4-ipv4-address-structure"></a><span data-ttu-id="e11b4-427">RYSUNEK 4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-427">FIGURE 4.</span></span> <span data-ttu-id="e11b4-428">Struktura adresów IPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-428">IPv4 Address Structure</span></span>

<span data-ttu-id="e11b4-429">Istnieją również trzy typy specyfikacji adresów: *emisja pojedyncza*, *emisja* i *Multiemisja*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-429">There are also three types of address specifications: *unicast*, *broadcast*, and *multicast*.</span></span> <span data-ttu-id="e11b4-430">Adresy emisji pojedynczej są adresami IPv4, które identyfikują określonego hosta w Internecie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-430">Unicast addresses are those IPv4 addresses that identify a specific host on the Internet.</span></span> <span data-ttu-id="e11b4-431">Adresy emisji pojedynczej mogą być źródłem lub docelowym adresem IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-431">Unicast addresses can be either a source or a destination IPv4 address.</span></span> <span data-ttu-id="e11b4-432">Adres emisji identyfikuje wszystkie hosty w określonej sieci lub podsieci i może być używany tylko jako adresy docelowe.</span><span class="sxs-lookup"><span data-stu-id="e11b4-432">A broadcast address identifies all hosts on a specific network or sub-network and can only be used as destination addresses.</span></span> <span data-ttu-id="e11b4-433">Adresy emisji są określane przez posiadanie części adresu hosta ustawionej na wartość.</span><span class="sxs-lookup"><span data-stu-id="e11b4-433">Broadcast addresses are specified by having the host ID portion of the address set to ones.</span></span> <span data-ttu-id="e11b4-434">Adresy multiemisji (Klasa D) określają dynamiczną grupę hostów w Internecie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-434">Multicast addresses (Class D) specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="e11b4-435">Członkowie grupy multiemisji mogą dołączać się i zostawiać w dowolnym momencie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-435">Members of the multicast group may join and leave whenever they wish.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e11b4-436">*Tylko protokoły bezpołączeniowe, takie jak UDP przez IPv4, mogą korzystać z emisji i ograniczonej możliwości emisji grupy multiemisji.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-436">*Only connectionless protocols like UDP over IPv4 can utilize broadcast and the limited broadcast capability of the multicast group.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e11b4-437">\* Makro *IP_address* jest zdefiniowane w \***nx_api. h** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-437">\*The macro *IP_ADDRESS* is defined in \***nx_api.h** _.</span></span> <span data-ttu-id="e11b4-438">Umożliwia łatwą specyfikację adresów IPv4 przy użyciu przecinków zamiast kropek.</span><span class="sxs-lookup"><span data-stu-id="e11b4-438">It allows easy specification of IPv4 addresses using commas instead of a periods.</span></span> <span data-ttu-id="e11b4-439">Na przykład _IP_ADDRESS (128, 0, 0, 0) \* określa pierwszy adres klasy B przedstawiony na rysunku 4. \*</span><span class="sxs-lookup"><span data-stu-id="e11b4-439">For example, _IP_ADDRESS(128,0,0,0)\* specifies the first class B address shown in Figure 4.\*</span></span>

### <a name="ipv4-gateway-address"></a><span data-ttu-id="e11b4-440">Adres bramy IPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-440">IPv4 Gateway Address</span></span>

<span data-ttu-id="e11b4-441">Bramy sieci ułatwiają hostom w ich sieciach przekazywanie pakietów przeznaczonych do miejsc docelowych poza domeną lokalną.</span><span class="sxs-lookup"><span data-stu-id="e11b4-441">Network gateways assist hosts on their networks to relay packets destined to destinations outside the local domain.</span></span> <span data-ttu-id="e11b4-442">Każdy węzeł ma pewną wiedzę na temat tego, w którym następnym przeskoku ma być wysyłany, do lokalizacji docelowej jednego z jej sąsiadów lub za pomocą wstępnie zaprogramowanej tabeli routingu statycznego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-442">Each node has some knowledge of which next hop to send to, either the destination one of its neighbors, or through a pre-programmed static routing table.</span></span> <span data-ttu-id="e11b4-443">Jeśli jednak te podejścia zakończą się niepowodzeniem, węzeł powinien przekazać pakiet do bramy domyślnej, która ma lepszą wiedzę na temat sposobu kierowania pakietu do jego miejsca docelowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-443">However if these approaches fail, the node should forward the packet to its default gateway which has better knowledge on how to route the packet to its destination.</span></span> <span data-ttu-id="e11b4-444">Należy pamiętać, że brama domyślna musi być bezpośrednio dostępna za pomocą jednego z interfejsów fizycznych dołączonych do wystąpienia protokołu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-444">Note that the default gateway must be directly accessible through one of the physical interfaces attached to the IP instance.</span></span> <span data-ttu-id="e11b4-445">Aplikacja wywołuje \***nx_ip_gateway_address_set** _, aby skonfigurować adres bramy domyślnej IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-445">The application calls \***nx_ip_gateway_address_set** _ to configure IPv4 default gateway address.</span></span> <span data-ttu-id="e11b4-446">Użyj _*_nx_ip_gateway_address_get_*_ usługi, aby pobrać bieżące ustawienia bramy IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-446">Use the service _*_nx_ip_gateway_address_get_*_ to retrieve the current IPv4 gateway settings.</span></span> <span data-ttu-id="e11b4-447">Aplikacja używa usługi _ \*_nx_ip_gateway_address_clear_\*\*, aby wyczyścić ustawienie bramy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-447">Application shall use the service _ *_nx_ip_gateway_address_clear_*\* to clear the gateway setting.</span></span>

### <a name="ipv4-header"></a><span data-ttu-id="e11b4-448">Nagłówek IPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-448">IPv4 Header</span></span>

<span data-ttu-id="e11b4-449">Dla dowolnego pakietu IPv4, który ma być wysyłany przez Internet, musi mieć nagłówek IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-449">For any IPv4 packet to be sent on the Internet, it must have an IPv4 header.</span></span> <span data-ttu-id="e11b4-450">Gdy protokoły wyższego poziomu (UDP, TCP, ICMP lub IGMP) wywołują składnik IP w celu wysłania pakietu, moduł przesyłania protokołu IPv4 umieszcza nagłówek IPv4 przed danymi.</span><span class="sxs-lookup"><span data-stu-id="e11b4-450">When higher-level protocols (UDP, TCP, ICMP, or IGMP) call the IP component to send a packet, the IPv4 transmit module places an IPv4 header in front of the data.</span></span> <span data-ttu-id="e11b4-451">Z drugiej strony, gdy pakiety IP są odbierane z sieci, składnik IP usuwa nagłówek IPv4 z pakietu przed dostarczeniem do protokołów wyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-451">Conversely, when IP packets are received from the network, the IP component removes the IPv4 header from the packet before delivery to the higher-level protocols.</span></span> <span data-ttu-id="e11b4-452">Rysunek 5 przedstawia format nagłówka IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-452">Figure 5 shows the format of the IP header.</span></span>

![Format nagłówka IPv4](./media/user-guide/ipv4-header-format.png)

### <a name="figure-5-ipv4-header-format"></a><span data-ttu-id="e11b4-454">RYSUNEK 5.</span><span class="sxs-lookup"><span data-stu-id="e11b4-454">FIGURE 5.</span></span> <span data-ttu-id="e11b4-455">Format nagłówka IPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-455">IPv4 Header Format</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e11b4-456">*Oczekuje się, że wszystkie nagłówki w implementacji TCP/IP mają być w formacie **big endian** . W tym formacie najbardziej znaczący bajt słowa znajduje się na najniższym adresie bajtowym. Na przykład 4-bitowa wersja i 4-bitowe długości nagłówka IP muszą znajdować się na pierwszym bajcie nagłówka.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-456">*All headers in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address. For example, the 4-bit version and the 4-bit header length of the IP header must be located on the first byte of the header.*</span></span>

<span data-ttu-id="e11b4-457">Pola nagłówka IPv4 są zdefiniowane w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="e11b4-457">The fields of the IPv4 header are defined as follows:</span></span>

|<span data-ttu-id="e11b4-458">&nbsp;Pole nagłówka &nbsp; IPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-458">IPv4&nbsp;Header&nbsp;Field</span></span> |<span data-ttu-id="e11b4-459">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="e11b4-459">Purpose</span></span> |
|---|---|
|<span data-ttu-id="e11b4-460">***4-bitowa wersja***</span><span class="sxs-lookup"><span data-stu-id="e11b4-460">***4-bit version***</span></span> |<span data-ttu-id="e11b4-461">To pole zawiera wersję protokołu IP reprezentowanego przez ten nagłówek.</span><span class="sxs-lookup"><span data-stu-id="e11b4-461">This field contains the version of IP this header represents.</span></span> <span data-ttu-id="e11b4-462">W przypadku protokołu IP w wersji 4, który jest obsługiwany przez NetX Duo, wartość tego pola to 4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-462">For IP version 4, which is what NetX Duo supports, the value of this field is 4.</span></span> |
|<span data-ttu-id="e11b4-463">***4-bitowa Długość nagłówka***</span><span class="sxs-lookup"><span data-stu-id="e11b4-463">***4-bit header length***</span></span> |<span data-ttu-id="e11b4-464">To pole określa liczbę 32-bitowych wyrazów w nagłówku IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-464">This field specifies the number of 32-bit words in the IP header.</span></span> <span data-ttu-id="e11b4-465">Jeśli nie ma żadnych opcji, wartość dla tego pola to 5.</span><span class="sxs-lookup"><span data-stu-id="e11b4-465">If no option words are present, the value for this field is 5.</span></span> |
|<span data-ttu-id="e11b4-466">***8-bitowy typ usługi (TOS)***</span><span class="sxs-lookup"><span data-stu-id="e11b4-466">***8-bit type of service (TOS)***</span></span> |<span data-ttu-id="e11b4-467">To pole określa typ usługi żądany dla tego pakietu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-467">This field specifies the type of service requested for this IP packet.</span></span> <span data-ttu-id="e11b4-468">Prawidłowe żądania są następujące:</span><span class="sxs-lookup"><span data-stu-id="e11b4-468">Valid requests are as follows:</span></span><br /><span data-ttu-id="e11b4-469">-Normal: 0x00</span><span class="sxs-lookup"><span data-stu-id="e11b4-469">- Normal: 0x00</span></span> <br /><span data-ttu-id="e11b4-470">-Minimalne opóźnienie: 0x00</span><span class="sxs-lookup"><span data-stu-id="e11b4-470">- Minimum Delay: 0x00</span></span><br /><span data-ttu-id="e11b4-471">-Maksymalna ilość danych: 0x08</span><span class="sxs-lookup"><span data-stu-id="e11b4-471">- Maximum Data: 0x08</span></span><br /><span data-ttu-id="e11b4-472">-Maksymalna niezawodność: 0x04</span><span class="sxs-lookup"><span data-stu-id="e11b4-472">- Maximum Reliability: 0x04</span></span><br /><span data-ttu-id="e11b4-473">— Koszt minimalny: 0x02</span><span class="sxs-lookup"><span data-stu-id="e11b4-473">- Minimum Cost: 0x02</span></span> |
|<span data-ttu-id="e11b4-474">***16-bitowa łączna długość***</span><span class="sxs-lookup"><span data-stu-id="e11b4-474">***16-bit total length***</span></span> |<span data-ttu-id="e11b4-475">To pole zawiera łączną długość datagramu IP w bajtach, z uwzględnieniem nagłówka IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-475">This field contains the total length of the IP datagram in bytes, including the IP header.</span></span> <span data-ttu-id="e11b4-476">Datagram IP to podstawowa jednostka informacji dostępnych w Internecie TCP/IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-476">An IP datagram is the basic unit of information found on a TCP/IP Internet.</span></span> <span data-ttu-id="e11b4-477">Zawiera adres docelowy i źródłowy oprócz danych.</span><span class="sxs-lookup"><span data-stu-id="e11b4-477">It contains a destination and source address in addition to data.</span></span> <span data-ttu-id="e11b4-478">Ponieważ jest to pole 16-bitowe, maksymalny rozmiar datagramu IP to 65 535 bajtów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-478">Because it is a 16-bit field, the maximum size of an IP datagram is 65,535 bytes.</span></span>|
|<span data-ttu-id="e11b4-479">***Identyfikacja 16-bitowa***</span><span class="sxs-lookup"><span data-stu-id="e11b4-479">***16-bit identification***</span></span> |<span data-ttu-id="e11b4-480">Pole to numer używany do unikatowego identyfikowania każdego datagramu IP wysyłanego z hosta.</span><span class="sxs-lookup"><span data-stu-id="e11b4-480">The field is a number used to uniquely identify each IP datagram sent from a host.</span></span> <span data-ttu-id="e11b4-481">Ta liczba jest zwykle zwiększana po wysłaniu datagramu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-481">This number is typically incremented after an IP datagram is sent.</span></span> <span data-ttu-id="e11b4-482">Jest to szczególnie przydatne w przypadku asemblera odebranych fragmentów pakietów IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-482">It is especially useful in assembling received IP packet fragments.</span></span>|
|<span data-ttu-id="e11b4-483">***flagi 3-bitowe***</span><span class="sxs-lookup"><span data-stu-id="e11b4-483">***3-bit flags***</span></span> |<span data-ttu-id="e11b4-484">To pole zawiera informacje o fragmentacji adresów IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-484">This field contains IP fragmentation information.</span></span> <span data-ttu-id="e11b4-485">Bit 14 to bit "Nie fragmentuj".</span><span class="sxs-lookup"><span data-stu-id="e11b4-485">Bit 14 is the "don't fragment" bit.</span></span> <span data-ttu-id="e11b4-486">Jeśli ten bit jest ustawiony, wychodzący datagram IP nie zostanie pofragmentowany.</span><span class="sxs-lookup"><span data-stu-id="e11b4-486">If this bit is set, the outgoing IP datagram will not be fragmented.</span></span> <span data-ttu-id="e11b4-487">Bit 13 to bit "więcej fragmentów".</span><span class="sxs-lookup"><span data-stu-id="e11b4-487">Bit 13 is the "more fragments" bit.</span></span> <span data-ttu-id="e11b4-488">Jeśli ten bit jest ustawiony, zawiera więcej fragmentów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-488">If this bit is set, there are more fragments.</span></span> <span data-ttu-id="e11b4-489">Jeśli ten bit jest wyczyszczony, jest to ostatni fragment pakietu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-489">If this bit is clear, this is the last fragment of the IP packet.</span></span>|
|<span data-ttu-id="e11b4-490">***13-bitowe przesunięcie fragmentu***</span><span class="sxs-lookup"><span data-stu-id="e11b4-490">***13-bit fragment offset***</span></span> |<span data-ttu-id="e11b4-491">To pole zawiera górne 13 bitów przesunięcia fragmentu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-491">This field contains the upper 13-bits of the fragment offset.</span></span> <span data-ttu-id="e11b4-492">Z tego powodu przesunięcia fragmentów są dozwolone tylko dla granic 8-bajtowych.</span><span class="sxs-lookup"><span data-stu-id="e11b4-492">Because of this, fragment offsets are only allowed on 8-byte boundaries.</span></span> <span data-ttu-id="e11b4-493">Pierwszy fragment pofragmentowanego datagramu IP będzie miał ustawiony bit "więcej fragmentów" i ma przesunięcie 0.</span><span class="sxs-lookup"><span data-stu-id="e11b4-493">The first fragment of a fragmented IP datagram will have the "more fragments" bit set and have an offset of 0.</span></span>|
|<span data-ttu-id="e11b4-494">***8-bitowy czas wygaśnięcia (TTL)***</span><span class="sxs-lookup"><span data-stu-id="e11b4-494">***8-bit time to live (TTL)***</span></span> |<span data-ttu-id="e11b4-495">To pole zawiera liczbę routerów, które mogą być przekazywane przez ten datagram, co w istocie ogranicza okres istnienia datagramu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-495">This field contains the number of routers this datagram can pass, which basically limits the lifetime of the datagram.</span></span>|
|<span data-ttu-id="e11b4-496">***Protokół 8-bitowy***</span><span class="sxs-lookup"><span data-stu-id="e11b4-496">***8-bit protocol***</span></span>|<span data-ttu-id="e11b4-497">To pole określa, który protokół korzysta z datagramu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-497">This field specifies which protocol is using the IP datagram.</span></span> <span data-ttu-id="e11b4-498">Poniżej znajduje się lista prawidłowych protokołów i ich wartości:</span><span class="sxs-lookup"><span data-stu-id="e11b4-498">The following is a list of valid protocols and their values:</span></span><br /><span data-ttu-id="e11b4-499">-ICMP: 0x01</span><span class="sxs-lookup"><span data-stu-id="e11b4-499">- ICMP: 0x01</span></span> <br /><span data-ttu-id="e11b4-500">-IGMP: 0x02</span><span class="sxs-lookup"><span data-stu-id="e11b4-500">- IGMP: 0x02</span></span><br /><span data-ttu-id="e11b4-501">-TCP: 0X06</span><span class="sxs-lookup"><span data-stu-id="e11b4-501">- TCP: 0X06</span></span><br /><span data-ttu-id="e11b4-502">-UDP: 0X11</span><span class="sxs-lookup"><span data-stu-id="e11b4-502">- UDP: 0X11</span></span> |
|<span data-ttu-id="e11b4-503">***16-bitowa suma kontrolna***</span><span class="sxs-lookup"><span data-stu-id="e11b4-503">***16-bit checksum***</span></span> |<span data-ttu-id="e11b4-504">To pole zawiera 16-bitową sumę kontrolną obejmującą tylko nagłówek IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-504">This field contains the 16-bit checksum that covers the IP header only.</span></span> <span data-ttu-id="e11b4-505">Istnieją dodatkowe sumy kontrolne w protokołach wyższego poziomu, które obejmują ładunek IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-505">There are additional checksums in the higher level protocols that cover the IP payload.</span></span> |
|<span data-ttu-id="e11b4-506">***32-bitowy źródłowy adres IP***</span><span class="sxs-lookup"><span data-stu-id="e11b4-506">***32-bit source IP address***</span></span> |<span data-ttu-id="e11b4-507">To pole zawiera adres IP nadawcy i zawsze jest adresem hosta.</span><span class="sxs-lookup"><span data-stu-id="e11b4-507">This field contains the IP address of the sender and is always a host address.</span></span> |
|<span data-ttu-id="e11b4-508">***32-bitowy docelowy adres IP***</span><span class="sxs-lookup"><span data-stu-id="e11b4-508">***32-bit destination IP address***</span></span> |<span data-ttu-id="e11b4-509">To pole zawiera adres IP odbiorcy lub odbiorników, jeśli adres jest adresem emisji lub multiemisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-509">This field contains the IP address of the receiver or receivers if the address is a broadcast or multicast address.</span></span> |

### <a name="creating-ip-instances"></a><span data-ttu-id="e11b4-510">Tworzenie wystąpień adresów IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-510">Creating IP Instances</span></span>

<span data-ttu-id="e11b4-511">Wystąpienia adresów IP są tworzone podczas inicjowania lub podczas wykonywania przez wątki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-511">IP instances are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="e11b4-512">Początkowy adres IPv4, maskę sieci, domyślną pulę pakietów, sterownik nośnika oraz rozmiar pamięci i priorytet wewnętrznego wątku IP są definiowane przez usługę ***nx_ip_create***, nawet jeśli aplikacja nie będzie korzystać tylko z sieci IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-512">The initial IPv4 address, network mask, default packet pool, media driver, and memory and priority of the internal IP thread are defined by the ***nx_ip_create*** service even if the application intends to use IPv6 networks only.</span></span> <span data-ttu-id="e11b4-513">Jeśli aplikacja inicjuje wystąpienie IP z ustawionym adresem IPv4 jako nieprawidłowy adres (0.0.0.0), zakłada się, że adres interfejsu jest rozpoznawany przez ręczną konfigurację później, za pośrednictwem RARP lub za pośrednictwem protokołu DHCP lub podobnych protokołów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-513">If the application initializes the IP instance with its IPv4 address set to an invalid address(0.0.0.0), it is assumed that the interface address is going to resolved by manual configuration later, via RARP, or through DHCP or similar protocols.</span></span>

<span data-ttu-id="e11b4-514">W przypadku systemów z wieloma interfejsami sieciowymi interfejs podstawowy jest wyznaczany podczas wywoływania \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-514">For systems with multiple network interfaces, the primary interface is designated when calling \***nx_ip_create** _.</span></span> <span data-ttu-id="e11b4-515">Każdy dodatkowy interfejs może być dołączony do tego samego wystąpienia IP przez wywołanie _ *_nx_ip_interface_attach_* \*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-515">Each additional interface can be attached to the same IP instance by calling _\*_nx_ip_interface_attach_\*\*.</span></span> <span data-ttu-id="e11b4-516">Ta usługa przechowuje informacje o interfejsie sieciowym (takim jak adres IP, maska sieci) w bloku sterowania interfejsem i kojarzy wystąpienie sterownika z blokiem sterowania interfejsem w wystąpieniu protokołu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-516">This service stores information about the network interface (such as IP address, network mask) in the interface control block, and associates the driver instance with the interface control block in the IP instance.</span></span> <span data-ttu-id="e11b4-517">Ponieważ sterownik odbiera pakiet danych, musi przechowywać informacje o interfejsie w strukturze NX_PACKET przed przekazaniem ich do logiki odbioru adresów IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-517">As the driver receives a data packet, it needs to store the interface information in the NX_PACKET structure before forwarding it to the IP receive logic.</span></span> <span data-ttu-id="e11b4-518">Przed dołączeniem interfejsów należy pamiętać o utworzeniu wystąpienia adresu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-518">Note an IP instance must already be created before attaching any interfaces.</span></span>

<span data-ttu-id="e11b4-519">Usługi IPv6 nie są uruchamiane po wywołaniu \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-519">IPv6 services are not started after calling \***nx_ip_create** _.</span></span> <span data-ttu-id="e11b4-520">Aplikacje chcące korzystać z usług IPv6 muszą wywoływać usługę _ \*_nx_ipv6_enable_\*\*, aby uruchomić protokół IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-520">Applications wishing to use IPv6 services must call the service _ *_nx_ipv6_enable_*\* to start IPv6.</span></span>

<span data-ttu-id="e11b4-521">W sieci IPv6 każdy interfejs w wystąpieniu IP może mieć wiele adresów globalnych IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-521">On the IPv6 network, each interface in an IP instance may have multiple IPv6 global addresses.</span></span> <span data-ttu-id="e11b4-522">Oprócz używania protokołu DHCPv6 do przypisywania adresów IPv6 urządzenie może również korzystać z automatycznej konfiguracji adresu bezstanowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-522">In addition to using DHCPv6 for IPv6 address assignment, a device may also use Stateless Address Autoconfiguration.</span></span> <span data-ttu-id="e11b4-523">Więcej informacji można znaleźć w sekcjach "blok kontroli IP" i "rozpoznawanie adresów IPv6" w dalszej części tego rozdziału.</span><span class="sxs-lookup"><span data-stu-id="e11b4-523">More information is available in the "IP Control Block" and "IPv6 Address Resolution" sections later in this chapter.</span></span>

### <a name="ip-send"></a><span data-ttu-id="e11b4-524">Wysyłanie IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-524">IP Send</span></span>

<span data-ttu-id="e11b4-525">Przetwarzanie wysyłania IP w NetX Duo jest bardzo usprawnione.</span><span class="sxs-lookup"><span data-stu-id="e11b4-525">The IP send processing in NetX Duo is very streamlined.</span></span> <span data-ttu-id="e11b4-526">Wskaźnik dołączania w pakiecie jest przenoszony do tyłu w celu uwzględnienia nagłówka IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-526">The prepend pointer in the packet is moved backwards to accommodate the IP header.</span></span> <span data-ttu-id="e11b4-527">Nagłówek IP zostanie ukończony (ze wszystkimi opcjami określonymi przez warstwę protokołu wywołującego), suma kontrolna protokołu IP jest obliczana w wierszu (tylko dla pakietów IPv4), a pakiet jest wysyłany do skojarzonego sterownika sieciowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-527">The IP header is completed (with all the options specified by the calling protocol layer), the IP checksum is computed in-line (for IPv4 packets only), and the packet is dispatched to the associated network driver.</span></span> <span data-ttu-id="e11b4-528">Ponadto wychodząca fragmentacja jest również koordynowana z poziomu przetwarzania wysyłania adresów IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-528">In addition, outgoing fragmentation is also coordinated from within the IP send processing.</span></span>

<span data-ttu-id="e11b4-529">W przypadku protokołu IPv4 NetX Duo inicjuje żądania ARP, jeśli dla docelowego adresu IP jest wymagana mapowanie fizyczne.</span><span class="sxs-lookup"><span data-stu-id="e11b4-529">For IPv4, NetX Duo initiates ARP requests if physical mapping is needed for the destination IP address.</span></span> <span data-ttu-id="e11b4-530">Protokół IPv6 używa funkcji odnajdywania sąsiadów dla mapowania IPv6-Address-tophysical-Address.</span><span class="sxs-lookup"><span data-stu-id="e11b4-530">IPv6 uses Neighbor Discovery for IPv6-address-tophysical-address mapping.</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-531">*W przypadku połączenia IPv4 pakiety wymagające rozpoznawania adresów IP (tj. mapowanie fizyczne) są umieszczane w kolejce protokołu ARP do momentu, aż liczba pakietów w kolejce przekroczy głębokość kolejki ARP (zdefiniowana przez symbol **NX_ARP_MAX_QUEUE_DEPTH**). Jeśli osiągnięto głębokość kolejki, NetX Duo usunie najstarszy pakiet w kolejce i kontynuuje oczekiwanie na rozpoznanie adresu dla pozostałych pakietów w kolejce. Z drugiej strony, Jeśli wpis ARP nie zostanie rozwiązany, oczekujące pakiety we wpisie ARP zostaną wydane po upływie limitu czasu wpisu ARP.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-531">*For IPv4 connectivity, packets that require IP address resolution (i.e., physical mapping) are enqueued on the ARP queue until the number of packets queued exceeds the ARP queue depth (defined by the symbol **NX_ARP_MAX_QUEUE_DEPTH**). If the queue depth is reached, NetX Duo will remove the oldest packet on the queue and continue waiting for address resolution for the remaining packets enqueued. On the other hand, if an ARP entry is not resolved, the pending packets on the ARP entry are released upon ARP entry timeout.*</span></span>

<span data-ttu-id="e11b4-532">W przypadku systemów z wieloma interfejsami sieciowymi NetX Duo wybiera interfejs oparty na docelowym adresie IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-532">For systems with multiple network interfaces, NetX Duo chooses an interface based on the destination IP address.</span></span> <span data-ttu-id="e11b4-533">Poniższa procedura dotyczy procesu wyboru:</span><span class="sxs-lookup"><span data-stu-id="e11b4-533">The following procedure applies to the selection process:</span></span>

1. <span data-ttu-id="e11b4-534">Jeśli nadawca określa interfejs wychodzący, a interfejs jest prawidłowy, użyj tego interfejsu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-534">If the sender specifies an outgoing interface and the interface is valid, use that interface.</span></span>
2. <span data-ttu-id="e11b4-535">Jeśli adres docelowy to emisja IPv4 lub Multiemisja, zostanie użyty pierwszy włączony interfejs fizyczny.</span><span class="sxs-lookup"><span data-stu-id="e11b4-535">If a destination address is IPv4 broadcast or multicast, the first enabled physical interface is used.</span></span>
3. <span data-ttu-id="e11b4-536">Jeśli w statycznej tabeli routingu zostanie znaleziony adres docelowy, używany jest interfejs skojarzony z bramą.</span><span class="sxs-lookup"><span data-stu-id="e11b4-536">If the destination address is found in the static routing table, the interface associated with the gateway is used.</span></span>
4. <span data-ttu-id="e11b4-537">Jeśli miejsce docelowe jest połączone z linkiem, używany jest interfejs on-link.</span><span class="sxs-lookup"><span data-stu-id="e11b4-537">If the destination is on-link, the on-link interface is used.</span></span>
5. <span data-ttu-id="e11b4-538">Jeśli adres docelowy jest adresem lokalnym łącza (169.254.0.0/16), używany jest pierwszy prawidłowy interfejs.</span><span class="sxs-lookup"><span data-stu-id="e11b4-538">If the destination address is a link-local address (169.254.0.0/16), the first valid interface is used.</span></span>
6. <span data-ttu-id="e11b4-539">Jeśli Brama domyślna jest skonfigurowana, użyj interfejsu skojarzonego z bramą domyślną, aby przesłać pakiet.</span><span class="sxs-lookup"><span data-stu-id="e11b4-539">If the default gateway is configured, use the interface associated with the default gateway to transmit the packet.</span></span>
7. <span data-ttu-id="e11b4-540">Na koniec, jeśli jeden z prawidłowych adresów IP interfejsu jest adresem lokalnym linku (169.254.0.0/16), ten interfejs jest używany jako adres źródłowy transmisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-540">Finally, if one of the valid interface IP address is link-local address (169.254.0.0/16), this interface is used as source address for the transmission.</span></span>
8. <span data-ttu-id="e11b4-541">Pakiet wyjściowy zostanie porzucony w przypadku niepowodzenia wszystkich powyższych elementów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-541">The output packet is dropped if all above fails.</span></span>

### <a name="ip-receive"></a><span data-ttu-id="e11b4-542">Odbieranie adresów IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-542">IP Receive</span></span>

<span data-ttu-id="e11b4-543">Przetwarzanie odbierania adresów IP jest wywoływane ze sterownika sieci lub wewnętrznego wątku IP (na potrzeby przetwarzania pakietów w odroczonej kolejce odebranych pakietów).</span><span class="sxs-lookup"><span data-stu-id="e11b4-543">The IP receive processing is either called from the network driver or the internal IP thread (for processing packets on the deferred received packet queue).</span></span> <span data-ttu-id="e11b4-544">Przetwarzanie odbierania adresów IP bada pole Protokół i próbuje wysłać pakiet do odpowiedniego składnika protokołu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-544">The IP receive processing examines the protocol field and attempts to dispatch the packet to the proper protocol component.</span></span> <span data-ttu-id="e11b4-545">Zanim pakiet zostanie faktycznie wysłany, Nagłówek IP zostanie usunięty przez przeciąganie wskaźnika dołączania do nagłówka IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-545">Before the packet is actually dispatched, the IP header is removed by advancing the prepend pointer past the IP header.</span></span>

<span data-ttu-id="e11b4-546">Przetwarzanie odbierania adresów IP również wykrywa pofragmentowane pakiety IP i wykonuje niezbędne kroki, aby ponownie je połączyć w przypadku włączenia fragmentacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-546">IP receive processing also detects fragmented IP packets and performs the necessary steps to reassemble them if fragmentation is enabled.</span></span> <span data-ttu-id="e11b4-547">Jeśli fragmentacja jest potrzebna, ale nie jest włączona, pakiet zostanie porzucony.</span><span class="sxs-lookup"><span data-stu-id="e11b4-547">If fragmentation is needed but not enabled, the packet is dropped.</span></span>

<span data-ttu-id="e11b4-548">NetX Duo określa odpowiedni interfejs sieciowy w oparciu o interfejs określony w pakiecie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-548">NetX Duo determines the appropriate network interface based on the interface specified in the packet.</span></span> <span data-ttu-id="e11b4-549">Jeśli interfejs pakietu ma wartość NULL, NetX Duo domyślnie jest interfejsem podstawowym.</span><span class="sxs-lookup"><span data-stu-id="e11b4-549">If the packet interface is NULL, NetX Duo defaults to the primary interface.</span></span> <span data-ttu-id="e11b4-550">Jest to realizowane w celu zagwarantowania zgodności ze starszymi sterownikami Ethernet NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-550">This is done to guarantee compatibility with legacy NetX Duo Ethernet drivers.</span></span>

### <a name="raw-ip-send"></a><span data-ttu-id="e11b4-551">Wysyłanie nieprzetworzonego adresu IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-551">Raw IP Send</span></span>

<span data-ttu-id="e11b4-552">Pakiet Raw IP jest ramką IP, która zawiera ładunek protokołu warstwy wyższej, który nie jest bezpośrednio obsługiwany (i przetwarzany) przez NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-552">A raw IP packet is an IP frame that contains upper layer protocol payload not directly supported (and processed) by NetX Duo.</span></span> <span data-ttu-id="e11b4-553">Pakiet Raw umożliwia deweloperom Definiowanie własnych aplikacji opartych na protokole IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-553">A raw packet allows developers to define their own IP-based applications.</span></span> <span data-ttu-id="e11b4-554">Aplikacja może wysyłać pakiety pierwotnych adresów IP bezpośrednio przy użyciu usługi ***nxd_ip_raw_packet_send** _, jeśli w usłudze _*_nx_ip_raw_packet_enabled_\*_ włączono przetwarzanie pakietów pierwotnych adresów IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-554">An application may send raw IP packets directly using the ***nxd_ip_raw_packet_send** _ service if raw IP packet processing has been enabled with the _*_nx_ip_raw_packet_enabled_\*_ service.</span></span> <span data-ttu-id="e11b4-555">Podczas transmisji pakietu emisji pojedynczej w sieci IPv6 NetX Duo automatycznie określa najlepszy źródłowy adres IPv6 do użycia w celu wysyłania pakietów na podstawie adresu docelowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-555">When transmitting a unicast packet on an IPv6 network, NetX Duo automatically determines the best source IPv6 address to use to send the packets out on, based on the destination address.</span></span> <span data-ttu-id="e11b4-556">Jeśli adres docelowy jest adresem multiemisji (lub emisji dla protokołu IPv4), NetX Duo będzie domyślnie miał pierwszy (podstawowy) interfejs.</span><span class="sxs-lookup"><span data-stu-id="e11b4-556">If the destination address is a multicast (or broadcast for IPv4) address, however, NetX Duo will default to the first (primary) interface.</span></span> <span data-ttu-id="e11b4-557">W związku z tym, aby wysłać takie pakiety w interfejsach pomocniczych, aplikacja musi używać usługi _ \*_nx_ip_raw_packet_source_send_\*\*, aby określić adres źródłowy do użycia dla pakietu wychodzącego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-557">Therefore, to send such packets out on secondary interfaces, the application must use the _ *_nx_ip_raw_packet_source_send_*\* service to specify the source address to use for the outgoing packet.</span></span>

### <a name="raw-ip-receive"></a><span data-ttu-id="e11b4-558">Nieprzetworzony adres IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-558">Raw IP Receive</span></span>

<span data-ttu-id="e11b4-559">Jeśli przetwarzanie pakietów pierwotnych adresów IP jest włączone, aplikacja może odbierać pakiety pierwotnych adresów IP za pomocą usługi \***nx_ip_raw_packet_receive** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-559">If raw IP packet processing is enabled, the application may receive raw IP packets through the \***nx_ip_raw_packet_receive** _ service.</span></span> <span data-ttu-id="e11b4-560">Wszystkie pakiety przychodzące są przetwarzane zgodnie z protokołem określonym w nagłówku IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-560">All incoming packets are processed according to the protocol specified in the IP header.</span></span> <span data-ttu-id="e11b4-561">Jeśli protokół określa UDP, TCP, IGMP lub ICMP, NetX Duo przetworzy pakiet przy użyciu odpowiedniego programu obsługi dla typu protokołu pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-561">If the protocol specifies UDP, TCP, IGMP or ICMP, NetX Duo will process the packet using the appropriate handler for the packet protocol type.</span></span> <span data-ttu-id="e11b4-562">Jeśli protokół nie jest jednym z tych protokołów, a odbieranie pierwotnego adresu IP jest włączone, pakiet przychodzący zostanie umieszczony w kolejce pakietów nieprzetworzonych, oczekując na odbiór aplikacji za pośrednictwem _usługi \*_nx_ip_raw_packet_receive_\*\*. Ponadto wątki aplikacji mogą wstrzymywać z opcjonalnym limitem czasu podczas oczekiwania na pakiet Raw IP. Liczba pakietów, które można umieścić w kolejce w nieprzetworzonej kolejce pakietów, jest ograniczona. Wartość maksymalna jest zdefiniowana w \***NX_IP_RAW_MAX_QUEUE_DEPTH**_, której wartością domyślną jest 20.</span><span class="sxs-lookup"><span data-stu-id="e11b4-562">If the protocol is not one of these protocols, and raw IP receive is enabled, the incoming packet will be put into the raw packet queue waiting for the application to receive it via the _*_nx_ip_raw_packet_receive_*\* service. In addition, application threads may suspend with an optional timeout while waiting for a raw IP packet. The number of packets that can be queued on the raw packet queue is limited. The maximum value is defined in \***NX_IP_RAW_MAX_QUEUE_DEPTH**_, whose default value is 20.</span></span> <span data-ttu-id="e11b4-563">Aplikacja może zmienić wartość maksymalną przez wywołanie _ *_nx_ip_raw_receive_queue_max_set_*\* usługi.</span><span class="sxs-lookup"><span data-stu-id="e11b4-563">An application may change the maximum value by calling the _ *_nx_ip_raw_receive_queue_max_set_*\* service.</span></span>

<span data-ttu-id="e11b4-564">Alternatywnie Biblioteka NetX Duo może być skompilowana przy użyciu \*\**NX_ENABLE_IP_RAW_PACKET_FILTER *.**</span><span class="sxs-lookup"><span data-stu-id="e11b4-564">Alternatively, the NetX Duo library may be built with \***NX_ENABLE_IP_RAW_PACKET_FILTER\*.**</span></span> <span data-ttu-id="e11b4-565">W tym trybie działania aplikacja udostępnia funkcję wywołania zwrotnego, która jest wywoływana za każdym razem, gdy jest odbierany pakiet z nieobsługiwanym typem protokołu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-565">In this mode of operation, the application provides a callback function that is invoked every time a packet with an unhandled protocol type is received.</span></span> <span data-ttu-id="e11b4-566">Logika odbierania adresów IP przekazuje pakiet do procedury filtru uzyskiwania pakietów nieprzetworzonych przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="e11b4-566">The IP receive logic forwards the packet to the user-defined raw packet receive filter routine.</span></span> <span data-ttu-id="e11b4-567">Procedura filtrowania decyduje o tym, czy zachować nieprzetworzony pakiet dla przyszłego procesu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-567">The filter routine decides whether or not to keep the raw packet for future process.</span></span> <span data-ttu-id="e11b4-568">Wartość zwracana z procedury wywołania zwrotnego wskazuje, czy pakiet został przetworzony przez filtr odbierania pakietów nieprzetworzonych.</span><span class="sxs-lookup"><span data-stu-id="e11b4-568">The return value from the callback routine indicates whether the packet has been processed by the raw packet receive filter.</span></span> <span data-ttu-id="e11b4-569">Jeśli pakiet jest przetwarzany przez funkcję wywołania zwrotnego, pakiet powinien zostać wydzierżawiony po zakończeniu aplikacji z pakietem.</span><span class="sxs-lookup"><span data-stu-id="e11b4-569">If the packet is processed by the callback function, the packet should be released after the application is done with the packet.</span></span> <span data-ttu-id="e11b4-570">W przeciwnym razie NetX Duo jest odpowiedzialny za wydanie pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-570">Otherwise, NetX Duo is responsible for releasing the packet.</span></span> <span data-ttu-id="e11b4-571">Zapoznaj się z **_nx_ip_raw_packet_filter_set_** , aby uzyskać więcej informacji na temat używania nieprzetworzonej funkcji filtru pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-571">Refer to the **_nx_ip_raw_packet_filter_set_** for more information on how to use the raw packet filter function.</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-572">\* Funkcja otoki BSD dla NetX Duo korzysta z funkcji nieprzetworzonego filtru pakietów do obsługi niesformatowanych gniazd BSD.</span><span class="sxs-lookup"><span data-stu-id="e11b4-572">\*The BSD wrapper function for NetX Duo relies on the raw packet filter function to handle BSD raw sockets.</span></span> <span data-ttu-id="e11b4-573">W związku z tym, aby obsługiwać surowy gniazd w otoki BSD, biblioteka NetX Duo musi być skompilowana przy użyciu funkcji ***NX_ENABLE_IP_RAW_PACKET_FILTER** _ zdefiniowanej, a aplikacja nie powinna używać _*_nx_ip_raw_packet_filter_set_\*_ do instalowania własnych nieprzetworzonych filtrów pakietów Functions._</span><span class="sxs-lookup"><span data-stu-id="e11b4-573">Therefore, to support raw socket in the BSD wrapper, the NetX Duo library must be built with ***NX_ENABLE_IP_RAW_PACKET_FILTER** _ defined, and the application should not use the _*_nx_ip_raw_packet_filter_set_\*_ to install its own raw packet filter functions._</span></span>

### <a name="default-packet-pool"></a><span data-ttu-id="e11b4-574">Domyślna pula pakietów</span><span class="sxs-lookup"><span data-stu-id="e11b4-574">Default Packet Pool</span></span>

<span data-ttu-id="e11b4-575">Każde wystąpienie IP otrzymuje domyślną pulę pakietów podczas tworzenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-575">Each IP instance is given a default packet pool during creation.</span></span> <span data-ttu-id="e11b4-576">Ta Pula pakietów służy do przydzielania pakietów dla protokołów ARP, RARP, ICMP, IGMP, różnych pakietów kontroli TCP (SYN, ACK itd.), odnajdywania sąsiadów, odnajdywania routera i wykrywania zduplikowanych adresów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-576">This packet pool is used to allocate packets for ARP, RARP, ICMP, IGMP, various TCP control packets (SYN, ACK, and so on), Neighbor Discovery, Router Discovery, and Duplicate Address Detection.</span></span> <span data-ttu-id="e11b4-577">Jeśli domyślna pula pakietów jest pusta, gdy NetX Duo wymaga przydzielenia pakietu, NetX Duo może być konieczne przerwanie określonej operacji i zwrócenie komunikatu o błędzie, jeśli jest to możliwe.</span><span class="sxs-lookup"><span data-stu-id="e11b4-577">If the default packet pool is empty when NetX Duo needs to allocate a packet, NetX Duo may have to abort the particular operation, and will return an error message if possible.</span></span>

### <a name="ip-helper-thread"></a><span data-ttu-id="e11b4-578">Wątek pomocnika IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-578">IP Helper Thread</span></span>

<span data-ttu-id="e11b4-579">Każde wystąpienie protokołu IP ma wątek pomocnika.</span><span class="sxs-lookup"><span data-stu-id="e11b4-579">Each IP instance has a helper thread.</span></span> <span data-ttu-id="e11b4-580">Ten wątek jest odpowiedzialny za obsługę całego odroczonego przetwarzania pakietów i całego przetwarzania okresowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-580">This thread is responsible for handling all deferred packet processing and all periodic processing.</span></span> <span data-ttu-id="e11b4-581">Wątek pomocnika IP jest tworzony w ***nx_ip_create.*** Jest to miejsce, w którym wątek otrzymuje swój stos i priorytet.</span><span class="sxs-lookup"><span data-stu-id="e11b4-581">The IP helper thread is created in ***nx_ip_create.*** This is where the thread is given its stack and priority.</span></span> <span data-ttu-id="e11b4-582">Należy zauważyć, że pierwsze przetwarzanie w wątku pomocnika IP to zakończenie inicjowania sterownika sieci skojarzonego z usługą IP Create.</span><span class="sxs-lookup"><span data-stu-id="e11b4-582">Note that the first processing in the IP helper thread is to finish the network driver initialization associated with the IP create service.</span></span> <span data-ttu-id="e11b4-583">Po zakończeniu inicjalizacji sterownika sieci wątek pomocniczy uruchamia nieskończoną pętlę, aby przetwarzać pakiety i okresowo żądania.</span><span class="sxs-lookup"><span data-stu-id="e11b4-583">After the network driver initialization is complete, the helper thread starts an endless loop to process packet and periodic requests.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e11b4-584">*Jeśli w wątku pomocnika adresów IP jest widoczne niewyjaśnione zachowanie, zwiększenie rozmiaru stosu w trakcie tworzenia usługi IP to pierwszy krok debugowania. Jeśli stos jest za mały, wątek pomocnika IP może spowodować zastępowanie pamięci, co może prowadzić do nietypowych problemów.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-584">*If unexplained behavior is seen within the IP helper thread, increasing its stack size during the IP create service is the first debugging step. If the stack is too small, the IP helper thread could possibly be overwriting memory, which may cause unusual problems.*</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="e11b4-585">Zawieszenie wątku</span><span class="sxs-lookup"><span data-stu-id="e11b4-585">Thread Suspension</span></span>

<span data-ttu-id="e11b4-586">Wątki aplikacji mogą wstrzymywać podczas próby odbierania pakietów pierwotnych adresów IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-586">Application threads can suspend while attempting to receive raw IP packets.</span></span> <span data-ttu-id="e11b4-587">Po odebraniu pakietu RAW nowy pakiet jest przyznany do pierwszego wątku zawieszanego i ten wątek zostaje wznowiony.</span><span class="sxs-lookup"><span data-stu-id="e11b4-587">After a raw packet is received, the new packet is given to the first thread suspended and that thread is resumed.</span></span> <span data-ttu-id="e11b4-588">Usługi NetX Duo dla odbieranych pakietów mają opcjonalny limit czasu zawieszenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-588">NetX Duo services for receiving packets all have an optional suspension timeout.</span></span> <span data-ttu-id="e11b4-589">Po odebraniu pakietu lub upływie limitu czasu wątek aplikacji zostaje wznowiony z odpowiednim stanem ukończenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-589">When a packet is received or the timeout expires, the application thread is resumed with the appropriate completion status.</span></span>

### <a name="ip-statistics-and-errors"></a><span data-ttu-id="e11b4-590">Statystyka i błędy adresów IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-590">IP Statistics and Errors</span></span>

<span data-ttu-id="e11b4-591">Jeśli ta opcja jest włączona, NetX Duo śledzi kilka statystyk i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-591">If enabled, the NetX Duo keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="e11b4-592">Dla każdego wystąpienia IP są obsługiwane następujące raporty statystyczne i błędy:</span><span class="sxs-lookup"><span data-stu-id="e11b4-592">The following statistics and error reports are maintained for each IP instance:</span></span>

- <span data-ttu-id="e11b4-593">Całkowita liczba wysłanych pakietów IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-593">Total IP Packets Sent</span></span>
- <span data-ttu-id="e11b4-594">Całkowita liczba wysłanych bajtów IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-594">Total IP Bytes Sent</span></span>
- <span data-ttu-id="e11b4-595">Całkowita liczba odebranych pakietów IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-595">Total IP Packets Received</span></span>
- <span data-ttu-id="e11b4-596">Całkowita liczba odebranych bajtów IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-596">Total IP Bytes Received</span></span>
- <span data-ttu-id="e11b4-597">Łączna liczba nieprawidłowych pakietów adresu IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-597">Total IP Invalid Packets</span></span>
- <span data-ttu-id="e11b4-598">Całkowita liczba porzuconych pakietów odebranych adresów IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-598">Total IP Receive Packets Dropped</span></span>
- <span data-ttu-id="e11b4-599">Łączne błędy sum kontrolnych odbierania adresów IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-599">Total IP Receive Checksum Errors</span></span>
- <span data-ttu-id="e11b4-600">Całkowita liczba porzuconych pakietów wysłanych przez protokół IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-600">Total IP Send Packets Dropped</span></span>
- <span data-ttu-id="e11b4-601">Całkowita liczba wysłanych fragmentów adresów IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-601">Total IP Fragments Sent</span></span>
- <span data-ttu-id="e11b4-602">Całkowita liczba odebranych fragmentów adresów IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-602">Total IP Fragments Received</span></span>

<span data-ttu-id="e11b4-603">Wszystkie te statystyki i raporty o błędach są dostępne dla aplikacji z usługą ***nx_ip_info_get***.</span><span class="sxs-lookup"><span data-stu-id="e11b4-603">All of these statistics and error reports are available to the application with the ***nx_ip_info_get*** service.</span></span>

### <a name="ip-control-block-nx_ip"></a><span data-ttu-id="e11b4-604">NX_IP bloku kontroli adresów IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-604">IP Control Block NX_IP</span></span>

<span data-ttu-id="e11b4-605">Charakterystyka każdego wystąpienia IP znajduje się w jego bloku sterowania.</span><span class="sxs-lookup"><span data-stu-id="e11b4-605">The characteristics of each IP instance are found in its control block.</span></span> <span data-ttu-id="e11b4-606">Zawiera ona przydatne informacje, takie jak adresy IP i maski sieci poszczególnych urządzeń sieciowych, a także tabela z oddzielnym adresem IP sąsiada i fizycznymi adresami sprzętowymi.</span><span class="sxs-lookup"><span data-stu-id="e11b4-606">It contains useful information such as the IP addresses and network masks of each network device, and a table of neighbor IP and physical hardware address mapping.</span></span> <span data-ttu-id="e11b4-607">Ta struktura jest zdefiniowana w _file \***nx_api. h**.</span><span class="sxs-lookup"><span data-stu-id="e11b4-607">This structure is defined in the \***nx_api.h** _file.</span></span> <span data-ttu-id="e11b4-608">Jeśli protokół IPv6 jest włączony, zawiera również tablicę adresów IPv6, która jest określana przez użytkownika, który można skonfigurować za pomocą opcji% *_NX_MAX_IPV6_ADDRESSES_* \*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-608">If IPv6 is enabled, it also contains an array of IPv6 address, the number of which is specified by the user configurable option _\*_NX_MAX_IPV6_ADDRESSES_\*\*.</span></span> <span data-ttu-id="e11b4-609">Wartość domyślna pozwala każdemu fizycznemu interfejsowi sieci na posiadanie trzech adresów IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-609">The default value allows each physical network interface to have three IPv6 addresses.</span></span>

<span data-ttu-id="e11b4-610">Bloki kontroli wystąpień IP mogą znajdować się w dowolnym miejscu w pamięci, ale najczęściej jest to, że formant blokuje strukturę globalną poprzez definiowanie jej poza zakresem dowolnej funkcji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-610">IP instance control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

### <a name="static-ipv4-routing"></a><span data-ttu-id="e11b4-611">Statyczny routing IPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-611">Static IPv4 Routing</span></span>

<span data-ttu-id="e11b4-612">Funkcja statycznego routingu umożliwia aplikacji określenie sieci IPv4 i adresu następnego przeskoku dla określonych brakujących docelowych adresów IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-612">The static routing feature allows an application to specify an IPv4 network and next hop address for specific out of network destination IP addresses.</span></span> <span data-ttu-id="e11b4-613">Jeśli routing statyczny jest włączony, NetX Duo przeszukuje tabelę routingu statycznego dla wpisu zgodnego z adresem docelowym pakietu do wysłania.</span><span class="sxs-lookup"><span data-stu-id="e11b4-613">If static routing is enabled, NetX Duo searches through the static routing table for an entry matching the destination address of the packet to send.</span></span> <span data-ttu-id="e11b4-614">Jeśli nie zostanie znalezione dopasowanie, NetX Duo przeszukuje listę interfejsów fizycznych i wybiera źródłowy adres IP i adres następnego przeskoku na podstawie docelowego adresu IP i maski sieci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-614">If no match is found, NetX Duo searches through the list of physical interfaces and chooses a source IP address and next hop address based on the destination IP address and the network mask.</span></span> <span data-ttu-id="e11b4-615">Jeśli miejsce docelowe nie jest zgodne z żadnym z adresów IP sterowników sieciowych dołączonych do wystąpienia IP, NetX Duo wybiera interfejs, który jest bezpośrednio połączony z bramą domyślną, i używa adresu IP interfejsu jako adresu źródłowego i bramy domyślnej jako następnego przeskoku.</span><span class="sxs-lookup"><span data-stu-id="e11b4-615">If the destination does not match any of the IP addresses of the network drivers attached to the IP instance, NetX Duo chooses an interface that is directly connected to the default gateway, and uses the IP address of the interface as source address, and the default gateway as the next hop.</span></span>

<span data-ttu-id="e11b4-616">Wpisy można dodawać i usuwać ze statycznej tabeli routingu odpowiednio przy użyciu ***nx_ip_static_route_add** _ i _ *_nx_ip_static_route_delete_** usług.</span><span class="sxs-lookup"><span data-stu-id="e11b4-616">Entries can be added and removed from the static routing table using the ***nx_ip_static_route_add** _ and _ *_nx_ip_static_route_delete_** services, respectively.</span></span> <span data-ttu-id="e11b4-617">Aby można było używać routingu statycznego, aplikacja hosta musi włączyć tę funkcję, definiując ***NX_ENABLE_IP_STATIC_ROUTING.***</span><span class="sxs-lookup"><span data-stu-id="e11b4-617">To use static routing, the host application must enable this feature by defining ***NX_ENABLE_IP_STATIC_ROUTING.***</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-618">*Podczas dodawania wpisu do statycznej tabeli routingu NetX Duo sprawdza pasujący wpis dla określonego adresu docelowego, który znajduje się już w tabeli. Jeśli taki istnieje, zapewnia preferencję dla wpisu z mniejszą siecią (dłuższym prefiksem) w masce sieci.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-618">*When adding an entry to the static routing table, NetX Duo checks for a matching entry for the specified destination address already in the table. If one exists, it gives preference to the entry with the smaller network (longer prefix) in the network mask.*</span></span>

### <a name="ipv4-forwarding"></a><span data-ttu-id="e11b4-619">Przekazywanie IPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-619">IPv4 Forwarding</span></span>

<span data-ttu-id="e11b4-620">Jeśli przychodzący pakiet IPv4 nie jest przeznaczony dla tego węzła i włączono funkcję przekazywania protokołu IPv4, NetX Duo podejmie próbę przesłania pakietu za pośrednictwem innych interfejsów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-620">If the incoming IPv4 packet is not destined for this node and IPv4 forwarding feature is enabled, NetX Duo attempts to forward the packet out via the other interfaces.</span></span>  

### <a name="ip-fragmentation"></a><span data-ttu-id="e11b4-621">Fragmentacja IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-621">IP Fragmentation</span></span>

<span data-ttu-id="e11b4-622">Urządzenie sieciowe może mieć limity rozmiaru pakietów wychodzących.</span><span class="sxs-lookup"><span data-stu-id="e11b4-622">The network device may have limits on the size of outgoing packets.</span></span> <span data-ttu-id="e11b4-623">Ten limit jest określany jako maksymalna jednostka transmisji (MTU).</span><span class="sxs-lookup"><span data-stu-id="e11b4-623">This limit is called the maximum transmission unit (MTU).</span></span> <span data-ttu-id="e11b4-624">Jednostka MTU protokołu IP to największy rozmiar ramki IP, który sterownik warstwy linku jest w stanie przesłać bez fragmentacji pakietu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-624">IP MTU is the largest IP frame size a link layer driver is able to transmit without fragmenting the IP packet.</span></span> <span data-ttu-id="e11b4-625">Podczas fazy inicjowania sterownika urządzenia moduł sterownika musi skonfigurować jego rozmiar jednostki adresów IP przy użyciu ***nx_ip_interface_mtu_set usługi.***</span><span class="sxs-lookup"><span data-stu-id="e11b4-625">During a device driver initialization phase, the driver module must configure its IP MTU size via the service ***nx_ip_interface_mtu_set.***</span></span>

<span data-ttu-id="e11b4-626">Chociaż nie jest to zalecane, aplikacja może generować datagramy większe niż bazowa Jednostka MTU IP obsługiwana przez urządzenie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-626">Although not recommended, the application may generate datagrams larger than the underlying IP MTU supported by the device.</span></span> <span data-ttu-id="e11b4-627">Przed przesłaniem takiego datagramu IP warstwa IP musi być pofragmentowana tych pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-627">Before transmitting such IP datagram, the IP layer must fragment these packets.</span></span> <span data-ttu-id="e11b4-628">W przypadku odebrania pofragmentowanych ramek IP na końcu musi być przechowywane wszystkie pofragmentowane ramki IP o tym samym IDENTYFIKATORze fragmentacji, a następnie ponownie nastąpić ich umieszczenie w określonej kolejności.</span><span class="sxs-lookup"><span data-stu-id="e11b4-628">On receiving fragmented IP frames, the receiving end must store all fragmented IP frames with the same fragmentation ID, and reassemble them in order.</span></span> <span data-ttu-id="e11b4-629">Jeśli logika odbierania IP nie może zebrać wszystkich fragmentów, aby przywrócić pierwotną ramkę IP w czasie, wszystkie fragmenty zostaną wydane.</span><span class="sxs-lookup"><span data-stu-id="e11b4-629">If the IP receive logic is unable to collect all the fragments to restore the original IP frame in time, all the fragments are released.</span></span> <span data-ttu-id="e11b4-630">Jest on do protokołu warstwy wyższej, aby wykryć tę utratę pakietów i odzyskać ją z niej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-630">It is up to the upper layer protocol to detect such packet loss and recover from it.</span></span>

<span data-ttu-id="e11b4-631">Fragmentacja IP dotyczy zarówno pakietów IPv4, jak i IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-631">The IP fragmentation applies to both IPv4 and IPv6 packets.</span></span>

<span data-ttu-id="e11b4-632">Aby można było obsługiwać fragmentację i operacje ponownego montażu IP, projektant systemu musi włączyć funkcję fragmentacji IP w NetX Duo przy użyciu usługi ***nx_ip_fragment_enable*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-632">In order to support IP fragmentation and reassembly operation, the system designer must enable the IP fragmentation feature in NetX Duo using the ***nx_ip_fragment_enable*** service.</span></span> <span data-ttu-id="e11b4-633">Jeśli ta funkcja nie jest włączona, przychodzące pofragmentowane pakiety IP są odrzucane, a także pakiety, które przekraczają jednostkę MTU sterownika sieci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-633">If this feature is not enabled, incoming fragmented IP packets are discarded, as well as packets that exceed the network driver's MTU.</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-634">\* Logika fragmentacji IP można całkowicie usunąć, definiując \***NX_DISABLE_FRAGMENTATION** _ podczas kompilowania biblioteki NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-634">\*The IP Fragmentation logic can be removed completely by defining \***NX_DISABLE_FRAGMENTATION** _ when building the NetX Duo library.</span></span> <span data-ttu-id="e11b4-635">Pozwoli to zmniejszyć rozmiar kodu NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-635">Doing so helps reduce the code size of NetX Duo.</span></span> <span data-ttu-id="e11b4-636">Należy zauważyć, że w takiej sytuacji zarówno funkcja fragmentacji protokołu IPv4, jak i IPv6 są disabled._</span><span class="sxs-lookup"><span data-stu-id="e11b4-636">Note that in this situation, both the IPv4 and IPv6 fragmentation/reassembly functions are disabled._</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-637">*Jeśli zdefiniowano **NX_DISABLE_CHAINED_PACKET** , fragmentacja IP musi być wyłączona.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-637">*If **NX_DISABLE_CHAINED_PACKET** is defined, IP fragmentation must be disabled.*</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-638">*W sieci IPv6 routery nie pofragmentowanie datagramu, jeśli rozmiar datagramu przekroczy minimalny rozmiar jednostki MTU. W związku z tym do urządzenia wysyłającego należy określić minimalną wartość MTU między źródłem a miejscem docelowym, a w celu upewnienia się, że rozmiar datagramu IP nie przekracza ścieżki MTU. W NetX Duo można włączyć odnajdowanie MTU ścieżki IPv6, tworząc bibliotekę NetX Duo z zdefiniowanym symbolem **NX_ENABLE_IPV6_PATH_MTU_DISCOVERY** .*</span><span class="sxs-lookup"><span data-stu-id="e11b4-638">*In an IPv6 network, routers do not fragment a datagram if the size of the datagram exceeds its minimum MTU size. Therefore, it is up to the sending device to determine the minimum MTU between the source and the destination, and to ensure the IP datagram size does not exceed the path MTU. In NetX Duo, IPv6 PATH MTU discovery can be enabled by building NetX Duo library with the symbol **NX_ENABLE_IPV6_PATH_MTU_DISCOVERY** defined.*</span></span>

## <a name="address-resolution-protocol-arp-in-ipv4"></a><span data-ttu-id="e11b4-639">Protokół ARP (Address Resolution Protocol) w protokole IPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-639">Address Resolution Protocol (ARP) in IPv4</span></span>

<span data-ttu-id="e11b4-640">Protokół ARP (Address Resolution Protocol) jest odpowiedzialny za dynamiczne mapowanie 32-bitowych adresów IPv4 na te, które są bazowego nośnika fizycznego (RFC 826).</span><span class="sxs-lookup"><span data-stu-id="e11b4-640">The Address Resolution Protocol (ARP) is responsible for dynamically mapping 32-bit IPv4 addresses to those of the underlying physical media (RFC 826).</span></span> <span data-ttu-id="e11b4-641">Ethernet jest najbardziej typowym nośnikiem fizycznym i obsługuje adresy 48-bitowe.</span><span class="sxs-lookup"><span data-stu-id="e11b4-641">Ethernet is the most typical physical media, and it supports 48-bit addresses.</span></span> <span data-ttu-id="e11b4-642">Potrzeba protokołu ARP jest określana przez sterownik sieciowy dostarczony do usługi \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-642">The need for ARP is determined by the network driver supplied to the \***nx_ip_create** _ service.</span></span> <span data-ttu-id="e11b4-643">Jeśli wymagane jest mapowanie fizyczne, Sterownik sieciowy musi używać usługi _ *_nx_interface_address_mapping_needed_*\* do prawidłowego konfigurowania interfejsu sterownika.</span><span class="sxs-lookup"><span data-stu-id="e11b4-643">If physical mapping is required, the network driver must use the _ *_nx_interface_address_mapping_needed_*\* service to configure the driver interface properly.</span></span>

### <a name="arp-enable"></a><span data-ttu-id="e11b4-644">Włączanie protokołu ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-644">ARP Enable</span></span>

<span data-ttu-id="e11b4-645">Aby protokół ARP działał prawidłowo, musi on być najpierw włączony przez aplikację z usługą ***nx_arp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-645">For ARP to function properly, it must first be enabled by the application with the ***nx_arp_enable*** service.</span></span> <span data-ttu-id="e11b4-646">Ta usługa konfiguruje różne struktury danych na potrzeby przetwarzania ARP, w tym tworzenie obszaru pamięci podręcznej ARP z pamięci dostarczonej do usługi ARP Enable.</span><span class="sxs-lookup"><span data-stu-id="e11b4-646">This service sets up various data structures for ARP processing, including the creation of an ARP cache area from the memory supplied to the ARP enable service.</span></span>

### <a name="arp-cache"></a><span data-ttu-id="e11b4-647">Pamięć podręczna ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-647">ARP Cache</span></span>

<span data-ttu-id="e11b4-648">Pamięć podręczna ARP może być wyświetlana jako tablica wewnętrznych struktur danych mapowania ARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-648">The ARP cache can be viewed as an array of internal ARP mapping data structures.</span></span> <span data-ttu-id="e11b4-649">Każda struktura wewnętrzna może utrzymywać relacje między adresem IP a fizycznym adresem sprzętowym.</span><span class="sxs-lookup"><span data-stu-id="e11b4-649">Each internal structure is capable of maintaining the relationship between an IP address and a physical hardware address.</span></span> <span data-ttu-id="e11b4-650">Ponadto każda struktura danych ma wskaźniki łączy, więc może być częścią wielu połączonych list.</span><span class="sxs-lookup"><span data-stu-id="e11b4-650">In addition, each data structure has link pointers so it can be part of multiple linked lists.</span></span>

<span data-ttu-id="e11b4-651">Aplikacja może wyszukiwać adres IP z pamięci podręcznej ARP przez dostarczenie sprzętowego adresu MAC przy użyciu usługi \***nx_arp_ip_address_find** _, jeśli mapowanie istnieje w tabeli ARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-651">Application can look up an IP address from the ARP cache by supplying hardware MAC address using the service \***nx_arp_ip_address_find** _ if the mapping exists in the ARP table.</span></span> <span data-ttu-id="e11b4-652">Podobnie usługa _ *_nx_arp_hardware_address_find_*\* zwraca adres MAC dla danego adresu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-652">Similarly, the service _ *_nx_arp_hardware_address_find_*\* returns the MAC address for a given IP address.</span></span>

### <a name="arp-dynamic-entries"></a><span data-ttu-id="e11b4-653">Dynamiczne wpisy ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-653">ARP Dynamic Entries</span></span>

<span data-ttu-id="e11b4-654">Domyślnie usługa ARP Enable umieszcza wszystkie wpisy w pamięci podręcznej ARP na liście dostępnych dynamicznych wpisów ARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-654">By default, the ARP enable service places all entries in the ARP cache on the list of available dynamic ARP entries.</span></span> <span data-ttu-id="e11b4-655">Dynamiczny wpis ARP jest przypisywany z tej listy przez NetX Duo w przypadku wykrycia żądania wysłania do niemapowanego adresu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-655">A dynamic ARP entry is allocated from this list by NetX Duo when a send request to an unmapped IP address is detected.</span></span> <span data-ttu-id="e11b4-656">Po przydzieleniu wpis ARP zostaje skonfigurowany, a żądanie ARP jest wysyłane do nośnika fizycznego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-656">After allocation, the ARP entry is set up and an ARP request is sent to the physical media.</span></span>

<span data-ttu-id="e11b4-657">Wpis dynamiczny może być również utworzony przez ***nx_arp_dynamic_entry_set*** usługi.</span><span class="sxs-lookup"><span data-stu-id="e11b4-657">A dynamic entry can also be created by the service ***nx_arp_dynamic_entry_set***.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e11b4-658">*Jeśli wszystkie dynamiczne wpisy ARP są używane, co najmniej ostatnio używany wpis ARP zostanie zastąpiony nowym mapowaniem.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-658">*If all dynamic ARP entries are in use, the least recently used ARP entry is replaced with a new mapping.*</span></span>

### <a name="arp-static-entries"></a><span data-ttu-id="e11b4-659">Statyczne wpisy ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-659">ARP Static Entries</span></span>

<span data-ttu-id="e11b4-660">Aplikacja może również skonfigurować statyczne mapowanie ARP przy użyciu _service \***nx_arp_static_entry_create**.</span><span class="sxs-lookup"><span data-stu-id="e11b4-660">The application can also set up static ARP mapping by using the \***nx_arp_static_entry_create** _service.</span></span> <span data-ttu-id="e11b4-661">Ta usługa przydziela wpis ARP z listy dynamicznego wpisu ARP i umieszcza ją na liście statycznej z informacjami o mapowaniu dostarczanymi przez aplikację.</span><span class="sxs-lookup"><span data-stu-id="e11b4-661">This service allocates an ARP entry from the dynamic ARP entry list and places it on the static list with the mapping information supplied by the application.</span></span> <span data-ttu-id="e11b4-662">Statyczne wpisy ARP nie mogą być ponownie używane ani przedawnianie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-662">Static ARP entries are not subject to reuse or aging.</span></span> <span data-ttu-id="e11b4-663">Aplikacja może usunąć wpis statyczny przy użyciu _*_nx_arp_static_entry_delete_*_ usługi.</span><span class="sxs-lookup"><span data-stu-id="e11b4-663">The application can delete a static entry by using the service _*_nx_arp_static_entry_delete_*_.</span></span> <span data-ttu-id="e11b4-664">Aby usunąć wszystkie wpisy statyczne w tabeli ARP, aplikacja może używać usługi _ *_nx_arp_static_entries_delete_* \*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-664">To remove all static entries in the ARP table, the application may use the service _\*_nx_arp_static_entries_delete_\*\*.</span></span>

### <a name="automatic-arp-entry"></a><span data-ttu-id="e11b4-665">Wpis automatyczny ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-665">Automatic ARP Entry</span></span>

<span data-ttu-id="e11b4-666">NetX Duo rejestruje mapowanie IP/MAC elementu równorzędnego po odpowiedzi równorzędnych na żądanie ARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-666">NetX Duo records the peer's IP/MAC mapping after the peer responses to the ARP request.</span></span> <span data-ttu-id="e11b4-667">NetX Duo implementuje również funkcję automatycznego wpisu ARP, gdzie rejestruje adresy IP równorzędnego mapowania adresów MAC na podstawie niezamówionych żądań ARP z sieci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-667">NetX Duo also implements the automatic ARP entry feature where it records peer IP/MAC address mapping based on unsolicited ARP requests from the network.</span></span> <span data-ttu-id="e11b4-668">Ta funkcja umożliwia wypełnienie tabeli ARP informacjami o komunikacji równorzędnej, co zmniejsza opóźnienie potrzebne do przechodzenia przez cykl żądania/odpowiedzi ARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-668">This feature allows the ARP table to be populated with peer information, reducing the delay needed to go through the ARP request/response cycle.</span></span> <span data-ttu-id="e11b4-669">Jednak minusem z włączaniem automatycznego protokołu ARP polega na tym, że tabela ARP jest w stanie szybko zapełniać się siecią z wieloma węzłami w łączu lokalnym, co ostatecznie doprowadziłoby do zamiany pozycji ARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-669">However the downside with enabling automatic ARP is that the ARP table tend to fill up quickly on a busy network with many nodes on the local link, which would eventually lead to ARP entry replacement.</span></span>

<span data-ttu-id="e11b4-670">Ta funkcja jest domyślnie włączona.</span><span class="sxs-lookup"><span data-stu-id="e11b4-670">This feature is enabled by default.</span></span> <span data-ttu-id="e11b4-671">Aby go wyłączyć, należy skompilować bibliotekę NetX Duo z zdefiniowanym symbolem ***NX_DISABLE_ARP_AUTO_ENTRY***.</span><span class="sxs-lookup"><span data-stu-id="e11b4-671">To disable it, the NetX Duo library must be compiled with the symbol ***NX_DISABLE_ARP_AUTO_ENTRY*** defined.</span></span></p>

### <a name="arp-messages"></a><span data-ttu-id="e11b4-672">Komunikaty ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-672">ARP Messages</span></span>

<span data-ttu-id="e11b4-673">Jak wspomniano wcześniej, komunikat żądania ARP jest wysyłany, gdy zadanie IP wykryje, że mapowanie jest niezbędne dla adresu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-673">As mentioned previously, an ARP request message is sent when the IP task detects that mapping is needed for an IP address.</span></span> <span data-ttu-id="e11b4-674">Żądania ARP są wysyłane okresowo (co \***NX_ARP_UPDATE_RATE** _ sekund) do momentu otrzymania odpowiedniej odpowiedzi ARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-674">ARP requests are sent periodically (every \***NX_ARP_UPDATE_RATE** _ seconds) until a corresponding ARP response is received.</span></span> <span data-ttu-id="e11b4-675">Całkowita liczba żądań ARP wynosząca _ *_NX_ARP_MAXIMUM_RETRIES_*\* przed porzucić próbą ARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-675">A total of _ *_NX_ARP_MAXIMUM_RETRIES_*\* ARP requests are made before the ARP attempt is abandoned.</span></span> <span data-ttu-id="e11b4-676">Po odebraniu odpowiedzi ARP skojarzone informacje o adresie fizycznym są przechowywane we wpisie ARP, który znajduje się w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-676">When an ARP response is received, the associated physical address information is stored in the ARP entry that is in the cache.</span></span>

<span data-ttu-id="e11b4-677">W przypadku systemów wielodomowych NetX Duo określa interfejs do wysyłania żądań i odpowiedzi ARP na podstawie określonego adresu docelowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-677">For multihome systems, NetX Duo determines which interface to send the ARP requests and responses based on destination address specified.</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-678">*Wychodzące pakiety IP są umieszczane w kolejce, podczas gdy NetX Duo czeka na odpowiedź ARP. Liczba wychodzących pakietów IP umieszczonych w kolejce jest definiowana przez stałą **NX_ARP_MAX_QUEUE_DEPTH**.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-678">*Outgoing IP packets are queued while NetX Duo waits for the ARP response. The number of outgoing IP packets queued is defined by the constant **NX_ARP_MAX_QUEUE_DEPTH**.*</span></span>

<span data-ttu-id="e11b4-679">NetX Duo reaguje także na żądania ARP z innych węzłów w lokalnej sieci IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-679">NetX Duo also responds to ARP requests from other nodes on the local IPv4 network.</span></span> <span data-ttu-id="e11b4-680">Po utworzeniu zewnętrznego żądania ARP zgodnego z bieżącym adresem IP interfejsu, który odbiera żądanie ARP, NetX Duo kompiluje komunikat odpowiedzi ARP zawierający bieżący adres fizyczny.</span><span class="sxs-lookup"><span data-stu-id="e11b4-680">When an external ARP request is made that matches the current IP address of the interface that receives the ARP request, NetX Duo builds an ARP response message that contains the current physical address.</span></span>

<span data-ttu-id="e11b4-681">Formaty żądań i odpowiedzi Ethernet ARP przedstawiono na rysunku 6 i opisano poniżej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-681">The formats of Ethernet ARP requests and responses are shown in Figure 6 and are described below.</span></span>

| <span data-ttu-id="e11b4-682">**Pole żądania/odpowiedzi &nbsp;**</span><span class="sxs-lookup"><span data-stu-id="e11b4-682">**Request/Response&nbsp;Field**</span></span>         | <span data-ttu-id="e11b4-683">**Cel**</span><span class="sxs-lookup"><span data-stu-id="e11b4-683">**Purpose**</span></span>            |
| ---------------------------------- | ---------------------- |
| <span data-ttu-id="e11b4-684">***Adres docelowy sieci Ethernet***</span><span class="sxs-lookup"><span data-stu-id="e11b4-684">***Ethernet Destination Address***</span></span> | <span data-ttu-id="e11b4-685">To 6-bajtowe pole zawiera adres docelowy odpowiedzi ARP i jest emisją (wszystkie) dla żądań ARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-685">This 6-byte field contains the destination address for the ARP response and is a broadcast (all ones) for ARP requests.</span></span> <span data-ttu-id="e11b4-686">To pole jest konfiguracją przez sterownik sieciowy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-686">This field is setup by the network driver.</span></span> 
| <span data-ttu-id="e11b4-687">***Adres źródłowy sieci Ethernet***</span><span class="sxs-lookup"><span data-stu-id="e11b4-687">***Ethernet Source Address***</span></span>      | <span data-ttu-id="e11b4-688">To 6-bajtowe pole zawiera adres nadawcy żądania lub odpowiedzi ARP i jest skonfigurowany przez sterownik sieciowy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-688">This 6-byte field contains the address of the sender of the ARP request or response and is set up by the network driver.</span></span> |
| <span data-ttu-id="e11b4-689">***Typ ramki***</span><span class="sxs-lookup"><span data-stu-id="e11b4-689">***Frame Type***</span></span> | <span data-ttu-id="e11b4-690">To pole 2-bajtowe zawiera typ ramki Ethernet, a w przypadku żądań i odpowiedzi ARP jest to równe 0x0806.</span><span class="sxs-lookup"><span data-stu-id="e11b4-690">This 2-byte field contains the type of Ethernet frame present and, for ARP requests and responses, this is equal to 0x0806.</span></span> <span data-ttu-id="e11b4-691">Jest to ostatnie pole, za pomocą którego sterownik sieciowy jest odpowiedzialny za konfigurowanie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-691">This is the last field the network driver is responsible for setting up.</span></span> |
| <span data-ttu-id="e11b4-692">***Typ sprzętu***</span><span class="sxs-lookup"><span data-stu-id="e11b4-692">***Hardware Type***</span></span> | <span data-ttu-id="e11b4-693">To pole 2-bajtowe zawiera typ sprzętu, który jest 0x0001 dla sieci Ethernet.</span><span class="sxs-lookup"><span data-stu-id="e11b4-693">This 2-byte field contains the hardware type, which is 0x0001 for Ethernet.</span></span> |
| <span data-ttu-id="e11b4-694">***Typ protokołu***</span><span class="sxs-lookup"><span data-stu-id="e11b4-694">***Protocol Type***</span></span> | <span data-ttu-id="e11b4-695">To pole 2-bajtowe zawiera typ protokołu, który jest 0x0800 dla adresów IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-695">This 2-byte field contains the protocol type, which is 0x0800 for IP addresses.</span></span> |
| <span data-ttu-id="e11b4-696">***Rozmiar sprzętu***</span><span class="sxs-lookup"><span data-stu-id="e11b4-696">***Hardware Size***</span></span> | <span data-ttu-id="e11b4-697">To pole 1-bajtowe zawiera rozmiar sprzętowy, który jest 6 dla adresów Ethernet.</span><span class="sxs-lookup"><span data-stu-id="e11b4-697">This 1-byte field contains the hardware address size, which is 6 for Ethernet addresses.</span></span> |

![Diagram formatu pakietu ARP.](./media/user-guide/arp-packet-format.png)

<span data-ttu-id="e11b4-699">**RYSUNEK 6. Format pakietu ARP**</span><span class="sxs-lookup"><span data-stu-id="e11b4-699">**FIGURE 6. ARP Packet Format**</span></span>

| <span data-ttu-id="e11b4-700">Pole żądania/odpowiedzi &nbsp;</span><span class="sxs-lookup"><span data-stu-id="e11b4-700">Request/Response&nbsp;Field</span></span> | <span data-ttu-id="e11b4-701">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="e11b4-701">Purpose</span></span> |
|---|---|
| <span data-ttu-id="e11b4-702">***Rozmiar protokołu***</span><span class="sxs-lookup"><span data-stu-id="e11b4-702">***Protocol Size***</span></span> | <span data-ttu-id="e11b4-703">To pole 1-bajtowe zawiera rozmiar adresu IP, czyli 4 dla adresów IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-703">This 1-byte field contains the IP address size, which is 4 for IP addresses.</span></span> |
| <span data-ttu-id="e11b4-704">***Kod operacji***</span><span class="sxs-lookup"><span data-stu-id="e11b4-704">***Operation Code***</span></span> | <span data-ttu-id="e11b4-705">To pole 2-bajtowe zawiera operację dla tego pakietu ARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-705">This 2-byte field contains the operation for this ARP packet.</span></span> <span data-ttu-id="e11b4-706">W żądaniu ARP jest określana wartość 0x0001, podczas gdy odpowiedź ARP jest reprezentowana przez wartość 0x0002.</span><span class="sxs-lookup"><span data-stu-id="e11b4-706">An ARP request is specified with the value of 0x0001, while an ARP response is represented by a value of 0x0002.</span></span> |
| <span data-ttu-id="e11b4-707">***Adres Ethernet nadawcy***</span><span class="sxs-lookup"><span data-stu-id="e11b4-707">***Sender Ethernet Address***</span></span> | <span data-ttu-id="e11b4-708">To 6-bajtowe pole zawiera adres Ethernet nadawcy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-708">This 6-byte field contains the sender's Ethernet address.</span></span> |
| <span data-ttu-id="e11b4-709">***Adres IP nadawcy***</span><span class="sxs-lookup"><span data-stu-id="e11b4-709">***Sender IP Address***</span></span> | <span data-ttu-id="e11b4-710">To pole 4-bajtowe zawiera adres IP nadawcy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-710">This 4-byte field contains the sender's IP address.</span></span> |
| <span data-ttu-id="e11b4-711">***Docelowy adres ethernetowy***</span><span class="sxs-lookup"><span data-stu-id="e11b4-711">***Target Ethernet Address***</span></span> | <span data-ttu-id="e11b4-712">To pole 6-bajtowe zawiera adres Ethernet docelowy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-712">This 6-byte field contains the target's Ethernet address.</span></span> |
| <span data-ttu-id="e11b4-713">***Docelowy adres IP***</span><span class="sxs-lookup"><span data-stu-id="e11b4-713">***Target IP Address***</span></span> | <span data-ttu-id="e11b4-714">To pole 4-bajtowe zawiera adres IP miejsca docelowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-714">This 4-byte field contains the target's IP address.</span></span> |

> [!NOTE]
> <span data-ttu-id="e11b4-715">*Żądania i odpowiedzi ARP są pakietami na poziomie sieci Ethernet. Wszystkie inne pakiety TCP/IP są hermetyzowane przez nagłówek pakietu IP.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-715">*ARP requests and responses are Ethernet-level packets. All other TCP/IP packets are encapsulated by an IP packet header.*</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-716">*Oczekuje się, że wszystkie komunikaty ARP w implementacji protokołu TCP/IP mają być w formacie **big endian** . W tym formacie najbardziej znaczący bajt słowa znajduje się na najniższym adresie bajtowym.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-716">*All ARP messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="arp-aging"></a><span data-ttu-id="e11b4-717">Przedawnianie protokołu ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-717">ARP Aging</span></span>

<span data-ttu-id="e11b4-718">NetX obsługuje automatyczne unieważnianie wpisów dynamicznego ARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-718">NetX supports automatic dynamic ARP entry invalidation.</span></span><span data-ttu-id="e11b4-719">\ ***NX_ARP_EXPIRATION_RATE** _ określa liczbę sekund, przez jaką ustanowiony adres IP dla mapowania fizycznego pozostaje prawidłowy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-719">\ ***NX_ARP_EXPIRATION_RATE** _ specifies the number of seconds an established IP address to physical mapping stays valid.</span></span> <span data-ttu-id="e11b4-720">Po wygaśnięciu wpis ARP zostanie usunięty z pamięci podręcznej ARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-720">After expiration, the ARP entry is removed from the ARP cache.</span></span> <span data-ttu-id="e11b4-721">Kolejna próba wysłania do odpowiedniego adresu IP spowoduje powstanie nowego żądania protokołu ARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-721">The next attempt to send to the corresponding IP address will result in a new ARP request.</span></span> <span data-ttu-id="e11b4-722">Ustawienie _ *_NX_ARP_EXPIRATION_RATE_*\* na zero powoduje wyłączenie przedawnienia ARP, co jest konfiguracją domyślną.</span><span class="sxs-lookup"><span data-stu-id="e11b4-722">Setting _ *_NX_ARP_EXPIRATION_RATE_*\* to zero disables ARP aging, which is the default configuration.</span></span>

### <a name="arp-defend"></a><span data-ttu-id="e11b4-723">Obrona protokołu ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-723">ARP Defend</span></span>

<span data-ttu-id="e11b4-724">Po odebraniu żądania ARP lub pakietu odpowiedzi ARP, gdy nadawca ma ten sam adres IP, który powoduje konflikt z adresem IP tego węzła, NetX Duo wysyła żądanie ARP dla tego adresu jako obronność.</span><span class="sxs-lookup"><span data-stu-id="e11b4-724">When an ARP request or ARP response packet is received and the sender has the same IP address, which conflicts with the IP address of this node, NetX Duo sends an ARP request for that address as a defense.</span></span> <span data-ttu-id="e11b4-725">Jeśli pakiet rozwiązywania konfliktów ARP jest odbierany więcej niż raz w ciągu 10 sekund, NetX Duo nie wyśle więcej pakietów obrony.</span><span class="sxs-lookup"><span data-stu-id="e11b4-725">If the conflict ARP packet is received more than once in 10 seconds, NetX Duo does not send more defend packets.</span></span> <span data-ttu-id="e11b4-726">Domyślny interwał 10 sekund można zdefiniować ponownie przez \***NX_ARP_DEFEND_INTERVAL** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-726">The default interval 10 seconds can be redefined by \***NX_ARP_DEFEND_INTERVAL** _.</span></span> <span data-ttu-id="e11b4-727">To zachowanie jest zgodne z zasadami określonymi w 2.4 (c) RFC5227.</span><span class="sxs-lookup"><span data-stu-id="e11b4-727">This behavior follows the policy specified in 2.4(c) of RFC5227.</span></span> <span data-ttu-id="e11b4-728">Ponieważ system Windows XP ignoruje anons protokołu ARP jako odpowiedź na sondę ARP, użytkownik może zdefiniować _ \*_NX_ARP_DEFEND_BY_REPLY_\*\*, aby wysłać odpowiedź ARP jako dodatkową obronę.</span><span class="sxs-lookup"><span data-stu-id="e11b4-728">Since Windows XP ignores ARP announcement as a response for its ARP probe, user can define _ *_NX_ARP_DEFEND_BY_REPLY_*\* to send ARP response as additional defence.</span></span>

### <a name="arp-statistics-and-errors"></a><span data-ttu-id="e11b4-729">Statystyki i błędy dotyczące protokołu ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-729">ARP Statistics and Errors</span></span>

<span data-ttu-id="e11b4-730">Jeśli ta opcja jest włączona, oprogramowanie NetX Duo ARP śledzi kilka statystyk i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-730">If enabled, the NetX Duo ARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="e11b4-731">Następujące raporty statystyczne i błędy są obsługiwane dla każdego przetwarzania ARP IP:</span><span class="sxs-lookup"><span data-stu-id="e11b4-731">The following statistics and error reports are maintained for each IP's ARP processing:</span></span>

- <span data-ttu-id="e11b4-732">Całkowita liczba wysłanych żądań ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-732">Total ARP Requests Sent</span></span>
- <span data-ttu-id="e11b4-733">Całkowita liczba odebranych żądań ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-733">Total ARP Requests Received</span></span>
- <span data-ttu-id="e11b4-734">Całkowita liczba wysłanych odpowiedzi ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-734">Total ARP Responses Sent</span></span> 
- <span data-ttu-id="e11b4-735">Całkowita liczba odebranych odpowiedzi ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-735">Total ARP Responses Received</span></span> 
- <span data-ttu-id="e11b4-736">Łączna liczba wpisów dynamicznych ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-736">Total ARP Dynamic Entries</span></span> 
- <span data-ttu-id="e11b4-737">Łączna liczba wpisów statycznych ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-737">Total ARP Static Entries</span></span> 
- <span data-ttu-id="e11b4-738">Łączna liczba przestarzałych wpisów ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-738">Total ARP Aged Entries</span></span> 
- <span data-ttu-id="e11b4-739">Całkowita liczba nieprawidłowych komunikatów ARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-739">Total ARP Invalid Messages</span></span> 

<span data-ttu-id="e11b4-740">Wszystkie te statystyki i raporty o błędach są dostępne dla aplikacji z usługą ***nx_arp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-740">All these statistics and error reports are available to the application with the ***nx_arp_info_get*** service.</span></span>

## <a name="reverse-address-resolution-protocol-rarp-in-ipv4"></a><span data-ttu-id="e11b4-741">Protokół odwrotnego rozpoznawania adresów (RARP) w protokole IPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-741">Reverse Address Resolution Protocol (RARP) in IPv4</span></span>

<span data-ttu-id="e11b4-742">Protokół odwrotnego rozpoznawania adresów (RARP) to protokół służący do żądania przypisania sieci na 32-bitowe adresy IP hosta (RFC 903).</span><span class="sxs-lookup"><span data-stu-id="e11b4-742">The Reverse Address Resolution Protocol (RARP) is the protocol for requesting network assignment of the host's 32-bit IP addresses (RFC 903).</span></span> <span data-ttu-id="e11b4-743">Odbywa się to za pomocą żądania RARP i kontynuuje okresowo, dopóki członek sieci przypisze adres IP do interfejsu sieciowego hosta w odpowiedzi RARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-743">This is done through an RARP request and continues periodically until a network member assigns an IP address to the host network interface in an RARP response.</span></span> <span data-ttu-id="e11b4-744">Aplikacja tworzy wystąpienie IP przez usługę ***nx_ip_create*** z zerowym adresem IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-744">The application creates an IP instance by the service ***nx_ip_create*** with a zero IP address.</span></span> <span data-ttu-id="e11b4-745">Jeśli RARP jest włączona przez aplikację, może użyć protokołu RARP, aby zażądać adresu IP z serwera sieciowego dostępnego za pośrednictwem interfejsu, który ma zerowy adres IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-745">If RARP is enabled by the application, it can use the RARP protocol to request an IP address from the network server accessible through the interface that has a zero IP address.</span></span>

### <a name="rarp-enable"></a><span data-ttu-id="e11b4-746">Włącz RARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-746">RARP Enable</span></span>

<span data-ttu-id="e11b4-747">Aby użyć RARP, aplikacja musi utworzyć wystąpienie IP z adresem IP zerowym, a następnie włączyć RARP przy użyciu ***nx_rarp_enable*** usługi.</span><span class="sxs-lookup"><span data-stu-id="e11b4-747">To use RARP, the application must create the IP instance with an IP address of zero, then enable RARP using the service ***nx_rarp_enable***.</span></span> <span data-ttu-id="e11b4-748">W przypadku systemów wielodomowych co najmniej jedno urządzenie sieciowe skojarzone z wystąpieniem IP musi mieć adres IP równy zero.</span><span class="sxs-lookup"><span data-stu-id="e11b4-748">For multihome systems, at least one network device associated with the IP instance must have an IP address of zero.</span></span> <span data-ttu-id="e11b4-749">Przetwarzanie RARP okresowo wysyła komunikaty żądania RARP dla systemu NetX Duo wymagające adresu IP do momentu otrzymania prawidłowej odpowiedzi RARP z wydzielonym adresem IP sieci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-749">The RARP processing periodically sends RARP request messages for the NetX Duo system requiring an IP address until a valid RARP reply with the network designated IP address is received.</span></span> <span data-ttu-id="e11b4-750">W tym momencie przetwarzanie RARP zostało zakończone.</span><span class="sxs-lookup"><span data-stu-id="e11b4-750">At this point, RARP processing is complete.</span></span>

<span data-ttu-id="e11b4-751">Po włączeniu RARP jest on automatycznie wyłączany po rozwiązaniu wszystkich adresów interfejsu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-751">After RARP has been enabled, it is disabled automatically after all interface addresses are resolved.</span></span> <span data-ttu-id="e11b4-752">Aplikacja może wymusić zakończenie RARP przy użyciu usługi ***nx_rarp_disable***.</span><span class="sxs-lookup"><span data-stu-id="e11b4-752">The application may force RARP to terminate by using the service ***nx_rarp_disable***.</span></span>

### <a name="rarp-request"></a><span data-ttu-id="e11b4-753">Żądanie RARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-753">RARP Request</span></span>

<span data-ttu-id="e11b4-754">Format pakietu żądania RARP jest niemal identyczny z pakietem ARP pokazanym na [rysunku 6](#arp-messages). Jedyną różnicą jest pole Typ ramki to 0x8035, a pole *kod operacji* to 3, które wyznacza żądanie RARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-754">The format of an RARP request packet is almost identical to the ARP packet shown in [Figure 6](#arp-messages).The only difference is the frame type field is 0x8035 and the *Operation Code* field is 3, designating an RARP request.</span></span> <span data-ttu-id="e11b4-755">Jak wspomniano wcześniej, żądania RARP będą wysyłane okresowo (co ***NX_RARP_UPDATE_RATE*** sekund) do momentu otrzymania odpowiedzi RARP z przypisanym adresem IP sieci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-755">As mentioned previously, RARP requests will be sent periodically (every ***NX_RARP_UPDATE_RATE*** seconds) until a RARP reply with the network assigned IP address is received.</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-756">*Oczekuje się, że wszystkie komunikaty RARP w implementacji protokołu TCP/IP będą w formacie **big endian** . W tym formacie najbardziej znaczący bajt słowa znajduje się na najniższym adresie bajtowym.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-756">*All RARP messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="rarp-reply"></a><span data-ttu-id="e11b4-757">Odpowiedź RARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-757">RARP Reply</span></span>

<span data-ttu-id="e11b4-758">Komunikaty odpowiedzi RARP są odbierane z sieci i zawierają adres IP przypisany do sieci dla tego hosta.</span><span class="sxs-lookup"><span data-stu-id="e11b4-758">RARP reply messages are received from the network and contain the network assigned IP address for this host.</span></span> <span data-ttu-id="e11b4-759">Format pakietu odpowiedzi RARP jest niemal identyczny z pakietem ARP pokazanym na rysunku 6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-759">The format of an RARP reply packet is almost identical to the ARP packet shown in Figure 6.</span></span> <span data-ttu-id="e11b4-760">Jedyną różnicą jest pole Typ ramki to 0x8035, a pole *kod operacji* to 4, które wyznacza odpowiedź RARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-760">The only difference is the frame type field is 0x8035 and the *Operation Code* field is 4, which designates an RARP reply.</span></span> <span data-ttu-id="e11b4-761">Po odebraniu adres IP jest skonfigurowany w wystąpieniu IP, okresowe żądanie RARP jest wyłączone, a wystąpienie protokołu IP jest teraz gotowe do normalnego działania sieci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-761">After received, the IP address is setup in the IP instance, the periodic RARP request is disabled, and the IP instance is now ready for normal network operation.</span></span>

<span data-ttu-id="e11b4-762">W przypadku hostów wielomacierzystych adres IP jest stosowany do żądającego interfejsu sieciowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-762">For multihome hosts, the IP address is applied to the requesting network interface.</span></span> <span data-ttu-id="e11b4-763">Jeśli inne interfejsy sieciowe nadal żądają przypisania adresu IP, okresowa usługa RARP będzie kontynuowana do momentu rozwiązania wszystkich żądań adresów IP interfejsu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-763">If there are other network interfaces still requesting an IP address assignment, the periodic RARP service continues until all interface IP address requests are resolved.</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-764">*Aplikacja nie powinna używać wystąpienia protokołu IP do momentu ukończenia przetwarzania RARP. **Nx_ip_status_check** mogą być używane przez aplikacje w celu oczekiwania na ukończenie RARP. W przypadku systemów wielodomowych aplikacja nie powinna używać interfejsu żądającego do momentu ukończenia przetwarzania RARP w tym interfejsie. Stan adresu IP na urządzeniu pomocniczym można sprawdzić za pomocą usługi **nx_ip_interface_status_check** .*</span><span class="sxs-lookup"><span data-stu-id="e11b4-764">*The application should not use the IP instance until the RARP processing is complete. The **nx_ip_status_check** may be used by applications to wait for the RARP completion. For multihome systems, the application should not use the requesting interface until the RARP processing is complete on that interface. Status of the IP address on the secondary device can be checked with the **nx_ip_interface_status_check** service.*</span></span>

### <a name="rarp-statistics-and-errors"></a><span data-ttu-id="e11b4-765">RARP statystyk i błędów</span><span class="sxs-lookup"><span data-stu-id="e11b4-765">RARP Statistics and Errors</span></span>

<span data-ttu-id="e11b4-766">Jeśli to ustawienie jest włączone, oprogramowanie NetX Duo RARP śledzi kilka statystyk i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-766">If enabled, the NetX Duo RARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="e11b4-767">Następujące raporty statystyczne i błędy są obsługiwane dla każdego RARP IP:</span><span class="sxs-lookup"><span data-stu-id="e11b4-767">The following statistics and error reports are maintained for each IP's RARP processing:</span></span>

- <span data-ttu-id="e11b4-768">Całkowita liczba wysłanych żądań RARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-768">Total RARP Requests Sent</span></span>
- <span data-ttu-id="e11b4-769">Całkowita liczba odebranych odpowiedzi RARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-769">Total RARP Responses Received</span></span>
- <span data-ttu-id="e11b4-770">Całkowita liczba nieprawidłowych komunikatów RARP</span><span class="sxs-lookup"><span data-stu-id="e11b4-770">Total RARP Invalid Messages</span></span>

<span data-ttu-id="e11b4-771">Wszystkie te statystyki i raporty o błędach są dostępne dla aplikacji z usługą ***nx_rarp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-771">All these statistics and error reports are available to the application with the ***nx_rarp_info_get*** service.</span></span>

## <a name="internet-control-message-protocol-icmp"></a><span data-ttu-id="e11b4-772">Protokół ICMP (Internet Control Message Protocol)</span><span class="sxs-lookup"><span data-stu-id="e11b4-772">Internet Control Message Protocol (ICMP)</span></span>

<span data-ttu-id="e11b4-773">Protokół ICMP (Internet Control Message Protocol) dla protokołu IPv4 jest ograniczony do przekazywania informacji o błędach i kontroli między członkami sieci IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-773">Internet Control Message Protocol for IPv4 (ICMP) is limited to passing error and control information between IP network members.</span></span> <span data-ttu-id="e11b4-774">Protokół komunikatów kontroli Internetu dla protokołu IPv6 (ICMPv6) obsługuje również informacje o błędach i kontrolach i jest wymagany w przypadku protokołów rozpoznawania adresów, takich jak wykrywanie zduplikowanych adresów (DAD) i bezstanowe Autokonfiguracja adresu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-774">Internet Control Message Protocol for IPv6 (ICMPv6) also handles error and control information and is required for address resolution protocols such as Duplicate Address Detection (DAD) and stateless address autoconfiguration.</span></span>

<span data-ttu-id="e11b4-775">Podobnie jak większość innych komunikatów warstwy aplikacji (np. TCP/IP), komunikaty ICMP i ICMPv6 są hermetyzowane przy użyciu nagłówka IP z oznaczeniem protokołu ICMP (lub ICMPv6).</span><span class="sxs-lookup"><span data-stu-id="e11b4-775">Like most other application layer (e.g., TCP/IP) messages, ICMP and ICMPv6 messages are encapsulated by an IP header with the ICMP (or ICMPv6) protocol designation.</span></span>

### <a name="icmp-statistics-and-errors"></a><span data-ttu-id="e11b4-776">Statystyki i błędy protokołu ICMP</span><span class="sxs-lookup"><span data-stu-id="e11b4-776">ICMP Statistics and Errors</span></span>

<span data-ttu-id="e11b4-777">Jeśli ta opcja jest włączona, NetX Duo śledzi kilka statystyk ICMP i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-777">If enabled, NetX Duo keeps track of several ICMP statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="e11b4-778">Następujące raporty statystyczne i komunikaty o błędach są obsługiwane dla każdego przetworzenia protokołu ICMP IP:</span><span class="sxs-lookup"><span data-stu-id="e11b4-778">The following statistics and error reports are maintained for each IP's ICMP processing:</span></span> 

- <span data-ttu-id="e11b4-779">Całkowita liczba wysłanych poleceń ping protokołu ICMP</span><span class="sxs-lookup"><span data-stu-id="e11b4-779">Total ICMP Pings Sent</span></span>  
- <span data-ttu-id="e11b4-780">Łączny limit czasu polecenia ping protokołu ICMP</span><span class="sxs-lookup"><span data-stu-id="e11b4-780">Total ICMP Ping Timeouts</span></span> 
- <span data-ttu-id="e11b4-781">Całkowita liczba wstrzymanych wątków ping protokołu ICMP</span><span class="sxs-lookup"><span data-stu-id="e11b4-781">Total ICMP Ping Threads Suspended</span></span> 
- <span data-ttu-id="e11b4-782">Całkowita liczba odebranych odpowiedzi ping protokołu ICMP</span><span class="sxs-lookup"><span data-stu-id="e11b4-782">Total ICMP Ping Responses Received</span></span> 
- <span data-ttu-id="e11b4-783">Całkowita liczba błędów sumy kontrolnej protokołu ICMP</span><span class="sxs-lookup"><span data-stu-id="e11b4-783">Total ICMP Checksum Errors</span></span> 
- <span data-ttu-id="e11b4-784">Całkowita liczba nieobsłużonych komunikatów protokołu ICMP</span><span class="sxs-lookup"><span data-stu-id="e11b4-784">Total ICMP Unhandled Messages</span></span> 

<span data-ttu-id="e11b4-785">Wszystkie te statystyki i raporty o błędach są dostępne dla aplikacji z usługą ***nx_icmp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-785">All these statistics and error reports are available to the application with the ***nx_icmp_info_get*** service.</span></span>

## <a name="icmpv4-services-in-netx-duo"></a><span data-ttu-id="e11b4-786">Usługi ICMPv4 w NetX Duo</span><span class="sxs-lookup"><span data-stu-id="e11b4-786">ICMPv4 Services in NetX Duo</span></span>

### <a name="icmpv4-enable"></a><span data-ttu-id="e11b4-787">Włączanie ICMPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-787">ICMPv4 Enable</span></span>

<span data-ttu-id="e11b4-788">Przed przetworzeniem komunikatów ICMPv4 przez NetX Duo aplikacja musi wywoływać usługę ***nx_icmp_enable*** , aby umożliwić przetwarzanie ICMPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-788">Before ICMPv4 messages can be processed by NetX Duo, the application must call the ***nx_icmp_enable*** service to enable ICMPv4 processing.</span></span> <span data-ttu-id="e11b4-789">Po wykonaniu tej czynności aplikacja może wysyłać żądania ping i przychodzące pakiety ping.</span><span class="sxs-lookup"><span data-stu-id="e11b4-789">After this is done, the application can issue ping requests and field incoming ping packets.</span></span>  

### <a name="icmpv4-echo-request"></a><span data-ttu-id="e11b4-790">Żądanie echa ICMPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-790">ICMPv4 Echo Request</span></span>

<span data-ttu-id="e11b4-791">Żądanie echa to jeden typ komunikatu ICMPv4, który jest zazwyczaj używany do sprawdzania istnienia określonego węzła w sieci, zgodnie z jego adresem IP hosta.</span><span class="sxs-lookup"><span data-stu-id="e11b4-791">An echo request is one type of ICMPv4 message that is typically used to check for the existence of a specific node on the network, as identified by its host IP address.</span></span> <span data-ttu-id="e11b4-792">Popularne polecenie ping jest zaimplementowane przy użyciu komunikatów żądania echa ICMP/echo odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="e11b4-792">The popular ping command is implemented using ICMP echo request/echo reply messages.</span></span> <span data-ttu-id="e11b4-793">Jeśli określony host jest obecny, jego stos sieciowy przetwarza żądanie ping i odpowiedzi z odpowiedzią ping.</span><span class="sxs-lookup"><span data-stu-id="e11b4-793">If the specific host is present, its network stack processes the ping request and responses with a ping response.</span></span> <span data-ttu-id="e11b4-794">Rysunek 7. Szczegóły formatu wiadomości ping protokołu ICMPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-794">Figure 7 details the ICMPv4 ping message format.</span></span>

![Komunikat ICMPv4 ping](./media/user-guide/icmpv4-ping-message.png)  

<span data-ttu-id="e11b4-796">**RYSUNEK 7. Komunikat ICMPv4 ping**</span><span class="sxs-lookup"><span data-stu-id="e11b4-796">**FIGURE 7. ICMPv4 Ping Message**</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-797">*Oczekuje się, że wszystkie komunikaty ICMPv4 w implementacji protokołu TCP/IP będą w formacie **big endian** . W tym formacie najbardziej znaczący bajt słowa znajduje się na najniższym adresie bajtowym.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-797">*All ICMPv4 messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="e11b4-798">Poniżej opisano format nagłówka ICMPv4:</span><span class="sxs-lookup"><span data-stu-id="e11b4-798">The following describes the ICMPv4 header format:</span></span>

|<span data-ttu-id="e11b4-799">Pole nagłówka</span><span class="sxs-lookup"><span data-stu-id="e11b4-799">Header Field</span></span> |<span data-ttu-id="e11b4-800">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="e11b4-800">Purpose</span></span> |
|---|---|
|<span data-ttu-id="e11b4-801">**Typ**</span><span class="sxs-lookup"><span data-stu-id="e11b4-801">**Type**</span></span> |<span data-ttu-id="e11b4-802">To pole określa komunikat ICMPv4 (bity 31-24).</span><span class="sxs-lookup"><span data-stu-id="e11b4-802">This field specifies the ICMPv4 message (bits 31-24).</span></span> <span data-ttu-id="e11b4-803">Najczęstsze są następujące:</span><span class="sxs-lookup"><span data-stu-id="e11b4-803">The most common are:</span></span><br /><span data-ttu-id="e11b4-804">-0: echo odpowiedzi</span><span class="sxs-lookup"><span data-stu-id="e11b4-804">-  0: Echo Reply</span></span><br /><span data-ttu-id="e11b4-805">-3: miejsce docelowe jest nieosiągalne</span><span class="sxs-lookup"><span data-stu-id="e11b4-805">- 3: Destination Unreachable</span></span><br /><span data-ttu-id="e11b4-806">-8: żądanie echa</span><span class="sxs-lookup"><span data-stu-id="e11b4-806">- 8: Echo Request</span></span><br /><span data-ttu-id="e11b4-807">-11: przekroczono czas</span><span class="sxs-lookup"><span data-stu-id="e11b4-807">- 11: Time Exceeded</span></span><br /><span data-ttu-id="e11b4-808">-12: problem z parametrem</span><span class="sxs-lookup"><span data-stu-id="e11b4-808">- 12: Parameter Problem</span></span> |
|<span data-ttu-id="e11b4-809">**Kod**</span><span class="sxs-lookup"><span data-stu-id="e11b4-809">**Code**</span></span> |<span data-ttu-id="e11b4-810">To pole jest specyficzne dla kontekstu w polu Typ (bity 23-16).</span><span class="sxs-lookup"><span data-stu-id="e11b4-810">This field is context specific on the type field (bits 23-16).</span></span> <span data-ttu-id="e11b4-811">Dla żądania echa lub Odpowiedz kod jest ustawiony na zero.</span><span class="sxs-lookup"><span data-stu-id="e11b4-811">For an echo request or reply the code is set to zero.</span></span>|
|<span data-ttu-id="e11b4-812">**Suma**</span><span class="sxs-lookup"><span data-stu-id="e11b4-812">**Checksum**</span></span> |<span data-ttu-id="e11b4-813">To pole zawiera 16-bitową sumę kontrolną łącznej wartości w wiadomości ICMPv4, łącznie z całym nagłówkiem ICMPv4 rozpoczynającym się od pola Type.</span><span class="sxs-lookup"><span data-stu-id="e11b4-813">This field contains the 16-bit checksum of the one's complement sum of the ICMPv4 message including the entire the ICMPv4 header starting with the Type field.</span></span> <span data-ttu-id="e11b4-814">Przed wygenerowaniem sumy kontrolnej, pole sumy kontrolnej jest wyczyszczone.</span><span class="sxs-lookup"><span data-stu-id="e11b4-814">Before generating the checksum, the checksum field is cleared.</span></span>|
|<span data-ttu-id="e11b4-815">**Identyfikacja**</span><span class="sxs-lookup"><span data-stu-id="e11b4-815">**Identification**</span></span> | <span data-ttu-id="e11b4-816">To pole zawiera wartość identyfikatora identyfikującą hosta; Host powinien używać identyfikatora wyodrębnionego z żądania echa w odpowiedzi echa (bity 31-16).</span><span class="sxs-lookup"><span data-stu-id="e11b4-816">This field contains an ID value identifying the host; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span>|
|<span data-ttu-id="e11b4-817">**Numer sekwencyjny**</span><span class="sxs-lookup"><span data-stu-id="e11b4-817">**Sequence number**</span></span> |<span data-ttu-id="e11b4-818">To pole zawiera wartość identyfikatora; Host powinien używać identyfikatora wyodrębnionego z żądania echa w odpowiedzi echa (bity 31-16).</span><span class="sxs-lookup"><span data-stu-id="e11b4-818">This field contains an ID value; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span> <span data-ttu-id="e11b4-819">W przeciwieństwie do pola identyfikatora ta wartość zmieni się w kolejnych żądaniach ECHA z tego samego hosta (bity 15-0).</span><span class="sxs-lookup"><span data-stu-id="e11b4-819">Unlike the identifier field, this value will change in a subsequent Echo request from the same host (bits 15-0).</span></span>|

### <a name="icmpv4-echo-response"></a><span data-ttu-id="e11b4-820">Odpowiedź na ruch ICMPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-820">ICMPv4 Echo Response</span></span>    
<span data-ttu-id="e11b4-821">Odpowiedź ping to inny typ komunikatu ICMP, który jest generowany wewnętrznie przez składnik ICMP w odpowiedzi na zewnętrzne żądanie ping.</span><span class="sxs-lookup"><span data-stu-id="e11b4-821">A ping response is another type of ICMP message that is generated internally by the ICMP component in response to an external ping request.</span></span> <span data-ttu-id="e11b4-822">Oprócz potwierdzenia, odpowiedź na polecenie ping zawiera również kopię danych użytkownika dostarczonych w żądaniu ping.</span><span class="sxs-lookup"><span data-stu-id="e11b4-822">In addition to acknowledgement, the ping response also contains a copy of the user data supplied in the ping request.</span></span>

### <a name="icmpv4-error-messages"></a><span data-ttu-id="e11b4-823">Komunikaty o błędach ICMPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-823">ICMPv4 Error Messages</span></span>   
<span data-ttu-id="e11b4-824">W NetX Duo są obsługiwane następujące komunikaty o błędach ICMPv4:</span><span class="sxs-lookup"><span data-stu-id="e11b4-824">The following ICMPv4 error messages are supported in NetX Duo:</span></span> 
- <span data-ttu-id="e11b4-825">Miejsce docelowe jest nieosiągalne</span><span class="sxs-lookup"><span data-stu-id="e11b4-825">Destination Unreachable</span></span> 
- <span data-ttu-id="e11b4-826">Czas przekroczenia</span><span class="sxs-lookup"><span data-stu-id="e11b4-826">Time Exceed</span></span> 
- <span data-ttu-id="e11b4-827">Problem z parametrem</span><span class="sxs-lookup"><span data-stu-id="e11b4-827">Parameter Problem</span></span>

## <a name="internet-group-management-protocol-igmp"></a><span data-ttu-id="e11b4-828">Protokół IGMP (Internet Group Management Protocol)</span><span class="sxs-lookup"><span data-stu-id="e11b4-828">Internet Group Management Protocol (IGMP)</span></span>

<span data-ttu-id="e11b4-829">Protokół IGMP (Internet Group Management Protocol) udostępnia urządzenie do komunikowania się z jego sąsiadami i routerami, które zamierza otrzymać lub dołączyć do grupy multiemisji IPv4 (RFC 1112 i RFC 2236).</span><span class="sxs-lookup"><span data-stu-id="e11b4-829">The Internet Group Management Protocol (IGMP) provides a device to communicate with its neighbors and its routers that it intends to receive, or join, an IPv4 multicast group (RFC 1112 and RFC 2236).</span></span> <span data-ttu-id="e11b4-830">Grupa multiemisji jest zasadniczo dynamicznym zbiorem elementów członkowskich sieci i jest reprezentowana przez adres IP klasy D.</span><span class="sxs-lookup"><span data-stu-id="e11b4-830">A multicast group is basically a dynamic collection of network members and is represented by a Class D IP address.</span></span> <span data-ttu-id="e11b4-831">Członkowie grupy multiemisji mogą opuścić w dowolnym momencie, a nowi członkowie mogą dołączyć w dowolnym momencie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-831">Members of the multicast group may leave at any time, and new members may join at any time.</span></span> <span data-ttu-id="e11b4-832">Koordynacja związana z przyłączaniem i opuszczeniem grupy jest odpowiedzialna za IGMP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-832">The coordination involved in joining and leaving the group is the responsibility of IGMP.</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-833">*Protokół IGMP jest przeznaczony tylko dla grup multiemisji IPv4. Nie można jej używać w sieci IPv6.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-833">*IGMP is designed only for IPv4 multicast groups. It cannot be used on the IPv6 network.*</span></span>

### <a name="igmp-enable"></a><span data-ttu-id="e11b4-834">Włączanie IGMP</span><span class="sxs-lookup"><span data-stu-id="e11b4-834">IGMP Enable</span></span>     
<span data-ttu-id="e11b4-835">Przed rozpoczęciem dowolnego działania multiemisji w NetX Duo aplikacja musi wywołać usługę ***nx_igmp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-835">Before any multicasting activity can take place in NetX Duo, the application must call the ***nx_igmp_enable*** service.</span></span> <span data-ttu-id="e11b4-836">Ta usługa wykonuje podstawowe inicjowanie protokołu IGMP w przygotowaniu do obsługi żądań multiemisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-836">This service performs basic IGMP initialization in preparation for multicast requests.</span></span>

### <a name="multicast-ipv4-addressing"></a><span data-ttu-id="e11b4-837">Adres IPv4 multiemisji</span><span class="sxs-lookup"><span data-stu-id="e11b4-837">Multicast IPv4 Addressing</span></span>  
<span data-ttu-id="e11b4-838">Jak wspomniano wcześniej, adresy multiemisji w rzeczywistości są adresami IP klasy D, jak pokazano na [rysunku 4](#ipv4-addresses).</span><span class="sxs-lookup"><span data-stu-id="e11b4-838">As mentioned previously, multicast addresses are actually Class D IP addresses as shown in [Figure 4](#ipv4-addresses).</span></span> <span data-ttu-id="e11b4-839">Mniejsze 28 bitów adresu klasy D odpowiada IDENTYFIKATORowi grupy multiemisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-839">The lower 28-bits of the Class D address correspond to the multicast group ID.</span></span> <span data-ttu-id="e11b4-840">Istnieje szereg wstępnie zdefiniowanych adresów multiemisji; jednak *adres wszystkich hostów* (244.0.0.1) jest szczególnie istotny dla przetwarzania IGMP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-840">There are a series of pre-defined multicast addresses; however, the *all hosts address* (244.0.0.1) is particularly important to IGMP processing.</span></span> <span data-ttu-id="e11b4-841">*Adres wszystkie hosty* jest używany przez routery do wysyłania zapytań do wszystkich elementów członkowskich multiemisji w celu raportowania, do których grup multiemisji należą.</span><span class="sxs-lookup"><span data-stu-id="e11b4-841">The *all hosts address* is used by routers to query all multicast members to report on which multicast groups they belong to.</span></span>  

### <a name="physical-address-mapping-in-ipv4"></a><span data-ttu-id="e11b4-842">Mapowanie adresów fizycznych w protokole IPv4</span><span class="sxs-lookup"><span data-stu-id="e11b4-842">Physical Address Mapping in IPv4</span></span>
<span data-ttu-id="e11b4-843">Adresy multiemisji klasy D mapują bezpośrednio do fizycznych adresów Ethernet od 01.00.5 e. 00.00.00 do 01.00.5 e. 7F. FF. FF.</span><span class="sxs-lookup"><span data-stu-id="e11b4-843">Class D multicast addresses map directly to physical Ethernet addresses ranging from 01.00.5e.00.00.00 through 01.00.5e.7f.ff.ff.</span></span> <span data-ttu-id="e11b4-844">Mniejsze 23 bity adresu multiemisji IP są mapowane bezpośrednio do mniejszej liczby 23 bitów adresu Ethernet.</span><span class="sxs-lookup"><span data-stu-id="e11b4-844">The lower 23 bits of the IP multicast address map directly to the lower 23 bits of the Ethernet address.</span></span>

### <a name="multicast-group-join"></a><span data-ttu-id="e11b4-845">Przyłączanie do grupy multiemisji</span><span class="sxs-lookup"><span data-stu-id="e11b4-845">Multicast Group Join</span></span>
<span data-ttu-id="e11b4-846">Aplikacje, które muszą przyłączyć się do konkretnej grupy multiemisji, mogą to zrobić, wywołując usługę ***nx_igmp_multicast_join*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-846">Applications that need to join a particular multicast group may do so by calling the ***nx_igmp_multicast_join*** service.</span></span> <span data-ttu-id="e11b4-847">Ta usługa śledzi liczbę żądań dołączenia do tej grupy multiemisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-847">This service keeps track of the number of requests to join this multicast group.</span></span> <span data-ttu-id="e11b4-848">Jeśli jest to pierwsza aplikacja requestto dołączenia do grupy multiemisji, raport IGMP jest wysyłany w sieci podstawowej wskazującej zamiar tego hosta do przyłączenia do grupy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-848">If this is the first application requestto join the multicast group, an IGMP report is sent out on the primary network indicating this host's intention to join the group.</span></span> <span data-ttu-id="e11b4-849">Następnie sterownik sieciowy jest wywoływany w celu skonfigurowania nasłuchiwania pakietów z adresem Ethernet dla tej grupy multiemisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-849">Next, the network driver is called to set up for listening for packets with the Ethernet address for this multicast group.</span></span>

<span data-ttu-id="e11b4-850">W systemie wielodostępnym, jeśli grupa multiemisji jest dostępna za pośrednictwem określonego interfejsu, aplikacja będzie używać usługi \***nx_igmp_multicast_interface_join** _ zamiast _ *_nx_igmp_multicast_join_* \*, która jest ograniczona do grup multiemisji w sieci podstawowej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-850">In a multihome system, if the multicast group is accessible via a specific interface, application shall use the service ***nx_igmp_multicast_interface_join** _ instead of _*_nx_igmp_multicast_join_\*\*, which is limited to multicast groups on the primary network.</span></span>

### <a name="multicast-group-leave"></a><span data-ttu-id="e11b4-851">Opuszczenie grupy multiemisji</span><span class="sxs-lookup"><span data-stu-id="e11b4-851">Multicast Group Leave</span></span>   
<span data-ttu-id="e11b4-852">Aplikacje, które muszą opuścić wcześniej dołączoną grupę multiemisji, mogą to zrobić, wywołując usługę ***nx_igmp_multicast_leave*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-852">Applications that need to leave a previously joined multicast group may do so by calling the ***nx_igmp_multicast_leave*** service.</span></span> <span data-ttu-id="e11b4-853">Ta usługa zmniejsza liczbę wewnętrzną skojarzoną z tym, ile razy Grupa została przyłączona.</span><span class="sxs-lookup"><span data-stu-id="e11b4-853">This service reduces the internal count associated with how many times the group was joined.</span></span> <span data-ttu-id="e11b4-854">Jeśli nie ma żadnych oczekujących żądań dołączenia do grupy, Sterownik sieciowy jest wywoływany, aby wyłączyć nasłuchiwanie pakietów z adresem Ethernet tego grupy multiemisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-854">If there are no outstanding join requests for a group, the network driver is called to disable listening for packets with this multicast group's Ethernet address.</span></span>

### <a name="multicast-loopback"></a><span data-ttu-id="e11b4-855">Sprzężenie zwrotne multiemisji</span><span class="sxs-lookup"><span data-stu-id="e11b4-855">Multicast Loopback</span></span>    
<span data-ttu-id="e11b4-856">Aplikacja może chcieć odebrać ruch multiemisji pochodzący z jednego ze źródeł w tym samym węźle.</span><span class="sxs-lookup"><span data-stu-id="e11b4-856">An application may wish to receive multicast traffic originated from one of the sources on the same node.</span></span> <span data-ttu-id="e11b4-857">Wymaga to, aby składnik multiemisji protokołu IP miał włączoną funkcję sprzężenia zwrotnego przy użyciu ***nx_igmp_loopback_enable*** usługi.</span><span class="sxs-lookup"><span data-stu-id="e11b4-857">This requires the IP multicast component to have loopback enabled by using the service ***nx_igmp_loopback_enable***.</span></span>

### <a name="igmp-report-message"></a><span data-ttu-id="e11b4-858">Komunikat raportu IGMP</span><span class="sxs-lookup"><span data-stu-id="e11b4-858">IGMP Report Message</span></span>      
<span data-ttu-id="e11b4-859">Gdy aplikacja jest dołączana do grupy multiemisji, komunikat raportu IGMP jest wysyłany za pośrednictwem sieci, aby wskazać zamiar hosta do przyłączenia do określonej grupy multiemisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-859">When the application joins a multicast group, an IGMP report message is sent via the network to indicate the host's intention to join a particular multicast group.</span></span> <span data-ttu-id="e11b4-860">Format komunikatu IGMP jest przedstawiony na rysunku 8.</span><span class="sxs-lookup"><span data-stu-id="e11b4-860">The format of the IGMP report message is shown in Figure 8.</span></span> <span data-ttu-id="e11b4-861">Adres grupy multiemisji jest używany zarówno w komunikacie grupy w komunikacie z raportem IGMP, jak i docelowym adresie IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-861">The multicast group address is used for both the group message in the IGMP report message and the destination IP address.</span></span>

<span data-ttu-id="e11b4-862">Na powyższym rysunku (rysunek 8) nagłówek IGMP zawiera pole wersji/typu, maksymalną odpowiedź</span><span class="sxs-lookup"><span data-stu-id="e11b4-862">In the figure above (Figure 8), the IGMP header contains a version/type field, maximum response</span></span>

![Diagram komunikatów raportu IGMP.](./media/user-guide/image17.jpg)

<span data-ttu-id="e11b4-864">**RYSUNEK 8. Komunikat raportu IGMP**</span><span class="sxs-lookup"><span data-stu-id="e11b4-864">**FIGURE 8. IGMP Report Message**</span></span>

<span data-ttu-id="e11b4-865">godzina, pole sumy kontrolnej i pole adres grupy multiemisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-865">time, a checksum field, and a multicast group address field.</span></span> <span data-ttu-id="e11b4-866">W przypadku komunikatów IGMPv1 wartość pola Maksymalny czas odpowiedzi jest zawsze równa zero, ponieważ nie jest to część protokołu IGMPv1.</span><span class="sxs-lookup"><span data-stu-id="e11b4-866">For IGMPv1 messages, the Maximum Response Time field is always set to zero, as this is not part of the IGMPv1 protocol.</span></span> <span data-ttu-id="e11b4-867">Pole Maksymalny czas odpowiedzi jest ustawiane, gdy host odbierze komunikat IGMP i wyczyszczony, gdy host odbierze komunikat typu raport innego hosta określony przez protokół IGMPv2.</span><span class="sxs-lookup"><span data-stu-id="e11b4-867">The Maximum Response Time field is set when the host receives a Query type IGMP message and cleared when a host receives another host's Report type message as defined by the IGMPv2 protocol.</span></span>

<span data-ttu-id="e11b4-868">Poniżej opisano format nagłówka IGMP:</span><span class="sxs-lookup"><span data-stu-id="e11b4-868">The following describes the IGMP header format:</span></span>

|<span data-ttu-id="e11b4-869">Pole nagłówka</span><span class="sxs-lookup"><span data-stu-id="e11b4-869">Header Field</span></span>|<span data-ttu-id="e11b4-870">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="e11b4-870">Purpose</span></span>|
|---|---|
|<span data-ttu-id="e11b4-871">**Wersja**</span><span class="sxs-lookup"><span data-stu-id="e11b4-871">**Version**</span></span> |<span data-ttu-id="e11b4-872">To pole określa wersję protokołu IGMP (BITS 31-28).</span><span class="sxs-lookup"><span data-stu-id="e11b4-872">This field specifies the IGMP version (bits 31- 28).</span></span>|
|<span data-ttu-id="e11b4-873">**Typ**</span><span class="sxs-lookup"><span data-stu-id="e11b4-873">**Type**</span></span> |<span data-ttu-id="e11b4-874">To pole określa typ komunikatu IGMP (bity 27 -24).</span><span class="sxs-lookup"><span data-stu-id="e11b4-874">This field specifies the type of IGMP message (bits 27 -24).</span></span>|
|<span data-ttu-id="e11b4-875">**Maksymalny czas odpowiedzi**</span><span class="sxs-lookup"><span data-stu-id="e11b4-875">**Maximum Response Time**</span></span> |<span data-ttu-id="e11b4-876">Nieużywane w protokole IGMP v1.</span><span class="sxs-lookup"><span data-stu-id="e11b4-876">Not used in IGMP v1.</span></span> <span data-ttu-id="e11b4-877">W protokole IGMP V2 to pole służy jako maksymalny czas odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="e11b4-877">In IGMP v2 this field serves as the maximum response time.</span></span>|
|<span data-ttu-id="e11b4-878">**Suma**</span><span class="sxs-lookup"><span data-stu-id="e11b4-878">**Checksum**</span></span> |<span data-ttu-id="e11b4-879">To pole zawiera 16-bitową sumę kontrolną podsumowania dla komunikatu IGMP rozpoczynającego się od wersji IGMP (bity 0-15).</span><span class="sxs-lookup"><span data-stu-id="e11b4-879">This field contains the 16-bit checksum of the one's complement sum of the IGMP message starting with the IGMP version (bits 0-15)</span></span>|
|<span data-ttu-id="e11b4-880">**Adres grupy**</span><span class="sxs-lookup"><span data-stu-id="e11b4-880">**Group Address**</span></span> |<span data-ttu-id="e11b4-881">32-bitowy adres IP grupy klasy D</span><span class="sxs-lookup"><span data-stu-id="e11b4-881">32-bit class D group IP address</span></span>|

<span data-ttu-id="e11b4-882">Komunikaty raportów IGMP są również wysyłane w odpowiedzi na komunikaty zapytania IGMP wysyłane przez router multiemisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-882">IGMP report messages are also sent in response to IGMP query messages sent by a multicast router.</span></span> <span data-ttu-id="e11b4-883">Routery multiemisji okresowo wysyłają komunikaty zapytania, aby zobaczyć, które hosty nadal wymagają członkostwa w grupie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-883">Multicast routers periodically send query messages out to see which hosts still require group membership.</span></span> <span data-ttu-id="e11b4-884">Komunikaty zapytania mają taki sam format, jak komunikat raportu IGMP przedstawiony na rysunku 8.</span><span class="sxs-lookup"><span data-stu-id="e11b4-884">Query messages have the same format as the IGMP Report message shown in Figure 8.</span></span> <span data-ttu-id="e11b4-885">Jedyną różnicą jest to, że typ IGMP jest równy 1, a pole adres grupy jest ustawione na 0.</span><span class="sxs-lookup"><span data-stu-id="e11b4-885">The only differences are the IGMP type is equal to 1 and the group address field is set to 0.</span></span> <span data-ttu-id="e11b4-886">Komunikaty protokołu IGMP są wysyłane do adresu IP *wszystkie hosty* przez router multiemisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-886">IGMP Query messages are sent to the *all hosts* IP address by the multicast router.</span></span> <span data-ttu-id="e11b4-887">Host, który nadal chce zachować członkostwo w grupie odpowiada, wysyłając inny komunikat raportu IGMP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-887">A host that still wishes to maintain group membership responds by sending another IGMP Report message.</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-888">*Oczekuje się, że wszystkie komunikaty w implementacji protokołu TCP/IP będą w formacie **big endian** . W tym formacie najbardziej znaczący bajt słowa znajduje się na najniższym adresie bajtowym.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-888">*All messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="igmp-statistics-and-errors"></a><span data-ttu-id="e11b4-889">Statystyka i błędy IGMP</span><span class="sxs-lookup"><span data-stu-id="e11b4-889">IGMP Statistics and Errors</span></span>    
<th><p><span data-ttu-id="e11b4-890">Jeśli to ustawienie jest włączone, oprogramowanie IGMP NetX Duo śledzi kilka statystyk i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-890">If enabled, the NetX Duo IGMP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="e11b4-891">Następujące raporty statystyczne i błędy są obsługiwane dla każdego przetwarzania IGMP IP:</span><span class="sxs-lookup"><span data-stu-id="e11b4-891">The following statistics and error reports are maintained for each IP's IGMP processing:</span></span> 

- <span data-ttu-id="e11b4-892">Całkowita liczba wysłanych raportów IGMP</span><span class="sxs-lookup"><span data-stu-id="e11b4-892">Total IGMP Reports Sent</span></span> 
- <span data-ttu-id="e11b4-893">Całkowita liczba odebranych zapytań IGMP</span><span class="sxs-lookup"><span data-stu-id="e11b4-893">Total IGMP Queries Received</span></span> 
- <span data-ttu-id="e11b4-894">Łączna liczba błędów sum kontrolnych IGMP</span><span class="sxs-lookup"><span data-stu-id="e11b4-894">Total IGMP Checksum Errors</span></span> 
- <span data-ttu-id="e11b4-895">Łączna liczba przyłączonych bieżących grup protokołu IGMP</span><span class="sxs-lookup"><span data-stu-id="e11b4-895">Total IGMP Current Groups Joined</span></span> 

<span data-ttu-id="e11b4-896">Wszystkie te statystyki i raporty o błędach są dostępne dla aplikacji z usługą ***nx_igmp_info_get***.</span><span class="sxs-lookup"><span data-stu-id="e11b4-896">All these statistics and error reports are available to the application with the ***nx_igmp_info_get*** service.</span></span> 

### <a name="multicast-without-igmp"></a><span data-ttu-id="e11b4-897">Multiemisja bez protokołu IGMP</span><span class="sxs-lookup"><span data-stu-id="e11b4-897">Multicast without IGMP</span></span>  
<span data-ttu-id="e11b4-898">Aplikacja wymagająca ruchu multiemisji IPv4 może przyłączyć się do adresu grupy multiemisji bez wywoływania komunikatów IGMP przy użyciu usługi ***nx_ipv4_multicast_interface_join***.</span><span class="sxs-lookup"><span data-stu-id="e11b4-898">Application expecting IPv4 multicast traffic can join a multicast group address without invoking IGMP messages by using the service ***nx_ipv4_multicast_interface_join***.</span></span> <span data-ttu-id="e11b4-899">Ta usługa instruuje warstwę IPv4 i źródłowy sterownik interfejsu, aby akceptować pakiety ze wskazanego adresu IPv4 multiemisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-899">This service instructs the IPv4 layer and the underlying interface driver to accept packets from the designated IPv4 multicast address.</span></span> <span data-ttu-id="e11b4-900">Nie ma jednak żadnych komunikatów zarządzania grupami IGMP, które są wysyłane lub przetwarzane dla tej grupy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-900">However there is no IGMP group management messages being sent or processed for this group.</span></span>

<span data-ttu-id="e11b4-901">Aplikacja nie chce już odbierać ruchu z grupy, może używać ***nx_ipv4_multicast_interface_leave usługi.***</span><span class="sxs-lookup"><span data-stu-id="e11b4-901">Application no longer wish to receive traffic from the group can use the service ***nx_ipv4_multicast_interface_leave.***</span></span>

## <a name="ipv6-in-netx-duo"></a><span data-ttu-id="e11b4-902">IPv6 w NetX Duo</span><span class="sxs-lookup"><span data-stu-id="e11b4-902">IPv6 in NetX Duo</span></span>

### <a name="ipv6-addresses"></a><span data-ttu-id="e11b4-903">Adresy IPv6</span><span class="sxs-lookup"><span data-stu-id="e11b4-903">IPv6 Addresses</span></span>   
<span data-ttu-id="e11b4-904">Adresy IPv6 to 128 bitów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-904">IPv6 addresses are 128 bits.</span></span> <span data-ttu-id="e11b4-905">Architektura adresu IPv6 jest opisana w dokumencie RFC 4291.</span><span class="sxs-lookup"><span data-stu-id="e11b4-905">The architecture of IPv6 address is described in RFC 4291.</span></span> <span data-ttu-id="e11b4-906">Adres jest podzielony na prefiks zawierający najbardziej znaczące bity i adres hosta zawierający mniejsze bity.</span><span class="sxs-lookup"><span data-stu-id="e11b4-906">The address is divided into a prefix containing the most significant bits and a host address containing the lower bits.</span></span> <span data-ttu-id="e11b4-907">Prefiks wskazuje typ adresu i jest w przybliżeniu odpowiednikiem adresu sieciowego w sieci IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-907">The prefix indicates the type of address and is roughly the equivalent of the network address in IPv4 network.</span></span>

<span data-ttu-id="e11b4-908">Protokół IPv6 ma trzy typy specyfikacji adresów: emisja pojedyncza (nieobsługiwana w NetX Duo) i multiemisja.</span><span class="sxs-lookup"><span data-stu-id="e11b4-908">IPv6 has three types of address specifications: unicast, anycast (not supported in NetX Duo), and multicast.</span></span> <span data-ttu-id="e11b4-909">Adresy emisji pojedynczej to adresy IP, które identyfikują określonego hosta w Internecie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-909">Unicast addresses are those IP addresses that identify a specific host on the Internet.</span></span> <span data-ttu-id="e11b4-910">Adresy emisji pojedynczej mogą być źródłem lub docelowym adresem IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-910">Unicast addresses can be either a source or a destination IP address.</span></span> <span data-ttu-id="e11b4-911">Adresy multiemisji określają dynamiczną grupę hostów w Internecie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-911">Multicast addresses specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="e11b4-912">Członkowie grupy multiemisji mogą dołączać się i zostawiać w dowolnym momencie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-912">Members of the multicast group may join and leave whenever they wish.</span></span>

<span data-ttu-id="e11b4-913">Protokół IPv6 nie jest odpowiednikiem mechanizmu emisji IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-913">IPv6 does not have the equivalent of the IPv4 broadcast mechanism.</span></span> <span data-ttu-id="e11b4-914">Możliwość wysyłania pakietu do wszystkich hostów można osiągnąć, wysyłając pakiet do grupy multiemisji wszystkie hosty na wszystkich hostach.</span><span class="sxs-lookup"><span data-stu-id="e11b4-914">The ability to send a packet to all hosts can be achieved by sending a packet to the link-local all hosts multicast group.</span></span>

<span data-ttu-id="e11b4-915">Protokół IPv6 korzysta z adresów multiemisji w celu przeprowadzenia procedury odnajdywania sąsiadów, odnajdywania routera i bezstanowego usuwania adresów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-915">IPv6 utilizes multicast addresses to perform Neighbor Discovery, Router Discovery, and Stateless Address Auto Configuration procedures.</span></span>

<span data-ttu-id="e11b4-916">Istnieją dwa typy adresów emisji pojedynczej IPv6: Połącz adresy lokalne, zazwyczaj skonstruowane przez połączenie dobrze znanego prefiksu lokalnego linku z adresem MAC interfejsu i globalnych adresów IP, które również zawiera część prefiksu i część identyfikatora hosta.</span><span class="sxs-lookup"><span data-stu-id="e11b4-916">There are two types of IPv6 unicast addresses: link local addresses, typically constructed by combining the well-known link local prefix with the interface MAC address, and global IP addresses, which also has the prefix portion and the host ID portion.</span></span> <span data-ttu-id="e11b4-917">Adres globalny można skonfigurować ręcznie lub za pomocą autokonfiguracji adresu bezstanowego lub protokołu DHCPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-917">A global address may be configured manually, or through the Stateless Address Autoconfiguration or DHCPv6.</span></span> <span data-ttu-id="e11b4-918">NetX Duo obsługuje zarówno adres lokalny łącza, jak i adres globalny.</span><span class="sxs-lookup"><span data-stu-id="e11b4-918">NetX Duo supports both link local address and global address.</span></span>

<span data-ttu-id="e11b4-919">W celu uwzględnienia formatów protokołów IPv4 i IPv6 NetX Duo udostępnia nowy typ danych, NXD_ADDRESS do przechowywania adresów IPv4 i IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-919">To accommodate both IPv4 and IPv6 formats, NetX Duo provides a new data type, NXD_ADDRESS, for holding IPv4 and IPv6 addresses.</span></span> <span data-ttu-id="e11b4-920">Definicja tej struktury jest pokazana poniżej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-920">The definition of this structure is shown below.</span></span> <span data-ttu-id="e11b4-921">Pole adres jest związkiem adresów IPv4 i IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-921">The address field is a union of IPv4 and IPv6 addresses.</span></span>

```c
typedef struct NXD_ADDRESS_STRUCT
{
    ULONG nxd_ip_version;
    union
    {
        ULONG v4;
        ULONG v6[4];
    } nxd_ip_address;
} NXD_ADDRESS;
```

<span data-ttu-id="e11b4-922">W strukturze NXD_ADDRESS pierwszy element, *nxd_ip_version*, wskazuje wersję IPv4 lub IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-922">In the NXD_ADDRESS structure, the first element, *nxd_ip_version*, indicates IPv4 or IPv6 version.</span></span> <span data-ttu-id="e11b4-923">Obsługiwane wartości to NX_IP_VERSION_V4 lub NX_IP_VERSION_V6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-923">Supported values are either NX_IP_VERSION_V4 or NX_IP_VERSION_V6.</span></span> <span data-ttu-id="e11b4-924">*nxd_ip_version* wskazuje, które pole w Unii *nxd_ip_address* ma być używane jako adres IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-924">*nxd_ip_version* indicates which field in the *nxd_ip_address* union to use as the IP address.</span></span> <span data-ttu-id="e11b4-925">Usługi interfejsu API NetX Duo zazwyczaj przyjmują wskaźnik do NXD_ADDRESS struktury jako argument wejściowy zamiast adresu IP ULONG (32-bitowy).</span><span class="sxs-lookup"><span data-stu-id="e11b4-925">NetX Duo API services typically take a pointer to NXD_ADDRESS structure as input argument in lieu of the ULONG (32 bit) IP address.</span></span>

### <a name="link-local-addresses"></a><span data-ttu-id="e11b4-926">Połącz adresy lokalne</span><span class="sxs-lookup"><span data-stu-id="e11b4-926">Link Local Addresses</span></span>     
<span data-ttu-id="e11b4-927">Adres lokalny link jest prawidłowy tylko w sieci lokalnej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-927">A link-local address is only valid on the local network.</span></span> <span data-ttu-id="e11b4-928">Urządzenie może wysyłać i odbierać pakiety do innego urządzenia w tej samej sieci po przypisaniu prawidłowego adresu lokalnego łącza.</span><span class="sxs-lookup"><span data-stu-id="e11b4-928">A device can send and receive packets to another device on the same network after a valid link local address is assigned to it.</span></span> <span data-ttu-id="e11b4-929">Aplikacja przypisuje adres lokalny łącza, wywołując usługę NetX Duo ***nxd_ipv6_address_set***, z parametrem Length prefiksem ustawionym na 10.</span><span class="sxs-lookup"><span data-stu-id="e11b4-929">An application assigns a link-local address by calling the NetX Duo service ***nxd_ipv6_address_set***, with the prefix length parameter set to 10.</span></span> <span data-ttu-id="e11b4-930">Aplikacja może dostarczyć adres lokalny dla linku do usługi lub może po prostu użyć NX_NULL jako adresu lokalnego linku i zezwolić NetX Duo na konstruowanie adresu lokalnego łącza na podstawie adresu MAC urządzenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-930">The application may supply a link-local address to the service, or it may simply use NX_NULL as the link-local address and allow NetX Duo to construct a link-local address based on the device's MAC address.</span></span>

<span data-ttu-id="e11b4-931">Poniższy przykład instruuje NetX Duo, aby skonfigurować adres lokalny łącza z prefiksem 10 na urządzeniu podstawowym (indeks 0) przy użyciu adresu MAC:</span><span class="sxs-lookup"><span data-stu-id="e11b4-931">The following example instructs NetX Duo to configure the link-local address with a prefix length of 10 on the primary device (index 0) using its MAC address:</span></span>

```c
nxd_ipv6_address_set(ip_ptr, 0, NX_NULL, 10, NX_NULL);
```
<span data-ttu-id="e11b4-932">W powyższym przykładzie, jeśli adres MAC interfejsu to 54:32:10:1A: BC: 67, odpowiedni adres lokalny łącza:</span><span class="sxs-lookup"><span data-stu-id="e11b4-932">In the example above, if the MAC address of the interface is 54:32:10:1A:BC:67, the corresponding link-local address would be:</span></span>

```c
FE80::5632:10FF:FE1A:BC67
```
<span data-ttu-id="e11b4-933">Zwróć uwagę, że część identyfikatora hosta adresu IPv6 (**5632:10FF: FE1A: BC67**) składa się z 6-bajtowego adresu Mac z następującymi modyfikacjami:</span><span class="sxs-lookup"><span data-stu-id="e11b4-933">Note that the host ID portion of the IPv6 address (**5632:10FF:FE1A:BC67**) is made up of the 6-byte MAC address, with the following modifications:</span></span>

- <span data-ttu-id="e11b4-934">**0xFFFE** wstawiona między bajtami 3 i 4 adresu Mac</span><span class="sxs-lookup"><span data-stu-id="e11b4-934">**0xFFFE** inserted between byte 3 and byte 4 of the MAC address</span></span>
- <span data-ttu-id="e11b4-935">Drugi najniższy bit pierwszego bajtu adresu MAC (bit U/L) jest ustawiony na 1</span><span class="sxs-lookup"><span data-stu-id="e11b4-935">Second lowest bit of the first byte of the MAC address (U/L bit) is set to 1</span></span>

<span data-ttu-id="e11b4-936">Aby uzyskać więcej informacji na temat konstruowania części hosta adresu IPv6 przy użyciu adresu MAC interfejsu, zobacz RFC 2464 (przesyłanie pakietów IPv6 przez sieć Ethernet).</span><span class="sxs-lookup"><span data-stu-id="e11b4-936">Refer to RFC 2464 (Transmission of IPv6 Packets over Ethernet Network) for more information on how to construct the host portion of an IPv6 address from its interface MAC address.</span></span>

<span data-ttu-id="e11b4-937">Istnieje kilka specjalnych adresów multiemisji do wysyłania komunikatów multiemisji do co najmniej jednego hosta w protokole IPv6:</span><span class="sxs-lookup"><span data-stu-id="e11b4-937">There are a few special multicast addresses for sending multicast messages to one or more hosts in IPv6:</span></span>

| <span data-ttu-id="e11b4-938">Group (Grupa)</span><span class="sxs-lookup"><span data-stu-id="e11b4-938">Group</span></span>  | <span data-ttu-id="e11b4-939">Adres</span><span class="sxs-lookup"><span data-stu-id="e11b4-939">Address</span></span>   | <span data-ttu-id="e11b4-940">Opis</span><span class="sxs-lookup"><span data-stu-id="e11b4-940">Description</span></span>  |
|---|---|---|
|<span data-ttu-id="e11b4-941">Grupa wszystkich węzłów</span><span class="sxs-lookup"><span data-stu-id="e11b4-941">All nodes group</span></span> |<span data-ttu-id="e11b4-942">**FF02:: 1**</span><span class="sxs-lookup"><span data-stu-id="e11b4-942">**FF02::1**</span></span> |<span data-ttu-id="e11b4-943">Wszystkie hosty w sieci lokalnej</span><span class="sxs-lookup"><span data-stu-id="e11b4-943">All hosts on the local network</span></span>|
|<span data-ttu-id="e11b4-944">Grupa wszystkich routerów</span><span class="sxs-lookup"><span data-stu-id="e11b4-944">All routers group</span></span> |<span data-ttu-id="e11b4-945">**FF02:: 2**</span><span class="sxs-lookup"><span data-stu-id="e11b4-945">**FF02::2**</span></span> |<span data-ttu-id="e11b4-946">Wszystkie routery w sieci lokalnej</span><span class="sxs-lookup"><span data-stu-id="e11b4-946">All routers on the local network</span></span>|
|<span data-ttu-id="e11b4-947">Żądanie-węzeł</span><span class="sxs-lookup"><span data-stu-id="e11b4-947">Solicited-node</span></span> |<span data-ttu-id="e11b4-948">**FF02:: 1: FF00:0/104**</span><span class="sxs-lookup"><span data-stu-id="e11b4-948">**FF02::1:FF00:0/104**</span></span> |<span data-ttu-id="e11b4-949">Wyjaśniono poniżej</span><span class="sxs-lookup"><span data-stu-id="e11b4-949">Explained below</span></span>|

<span data-ttu-id="e11b4-950">Adres multiemisji węzła na żądanie jest przeznaczony dla konkretnych hostów w łączu lokalnym, a nie na wszystkich hostach IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-950">A solicited-node multicast address targets specific hosts on the local link rather than all the IPv6 hosts.</span></span> <span data-ttu-id="e11b4-951">Składa się z prefiksu **FF02:: 1: FF00:0/104**, czyli 104 bitów i ostatnich 24 bitów docelowego adresu IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-951">It consists of the prefix **FF02::1:FF00:0/104**, which is 104 bits and the last 24-bits of the target IPv6 address.</span></span> <span data-ttu-id="e11b4-952">Na przykład adres IPv6 **205B: 209D: D028:: F058: D1C8:1024** ma adres multiemisji solicitednode o adresie **FF02:: 1: FFC8:1024**.</span><span class="sxs-lookup"><span data-stu-id="e11b4-952">For example, an IPv6 address **205B:209D:D028::F058:D1C8:1024** has a solicitednode multicast address of address **FF02::1:FFC8:1024**.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e11b4-953">*Notacja podwójnego dwukropka wskazuje, że wystąpiły bity są równe zero. **FF02:: 1: FF00:0/104** w pełni rozwinięte wygląda jak* **FF02:0000:** 0000:0000:0000:0,001: FF00:0000</span><span class="sxs-lookup"><span data-stu-id="e11b4-953">*The double colon notation indicates the intervening bits are all zeroes. **FF02::1:FF00:0/104** fully expanded looks like* **FF02:0000:0000:0000:0000:0001:FF00:0000**</span></span>

### <a name="global-addresses"></a><span data-ttu-id="e11b4-954">Adresy globalne</span><span class="sxs-lookup"><span data-stu-id="e11b4-954">Global Addresses</span></span>    
<span data-ttu-id="e11b4-955">Przykładem globalnego adresu IPv6 jest **2001:0123:4567:89AB: CDEF:: 1** NetX Duo przechowuje adresy IPv6 w strukturze NXD_ADDRESS.</span><span class="sxs-lookup"><span data-stu-id="e11b4-955">An example of an IPv6 global address is **2001:0123:4567:89AB:CDEF::1** NetX Duo stores IPv6 addresses in the NXD_ADDRESS structure.</span></span> <span data-ttu-id="e11b4-956">W poniższym przykładzie zmienna NXD_ADDRESS **global_ipv6_address** zawiera adres IPv6 emisji pojedynczej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-956">In the example below, the NXD_ADDRESS variable **global_ipv6_address** contains a unicast IPv6 address.</span></span> <span data-ttu-id="e11b4-957">Poniższy przykład przedstawia urządzenie NetX Duo, które tworzy określony adres globalny IPv6 dla swojego urządzenia podstawowego:</span><span class="sxs-lookup"><span data-stu-id="e11b4-957">The following example demonstrates a NetX Duo device creating a specific IPv6 global address for its primary device:</span></span>

```c
NXD_ADDRESS global_ipv6_address;
UINT        primary_interface_index = 0;

global_ipv6_address.nxd_ip_version = NX_IP_VERSION_V6;
global_ipv6_address.nxd_ip_address.v6[0] = 0x20010123;
global_ipv6_address.nxd_ip_address.v6[1] = 0x456789AB;
global_ipv6_address.nxd_ip_address.v6[2] = 0xCDEF0000;
global_ipv6_address.nxd_ip_address.v6[3] = 0x00000001;

status = nxd_ipv6_address_set(
            &ip_0,
            primary_interface_index,
            &global_ipv6_address,
            64,
            NX_NULL);
```
<span data-ttu-id="e11b4-958">Należy pamiętać, że prefiks tego adresu IPv6 to **2001:0123:4567:89AB**, który jest 64 bitów Long i jest wspólną długością prefiksu dla globalnych adresów IPv6 emisji pojedynczej w sieci Ethernet.</span><span class="sxs-lookup"><span data-stu-id="e11b4-958">Note that the prefix of this IPv6 address is **2001:0123:4567:89AB**, which is 64 bits long and is a common prefix length for global unicast IPv6 addresses on Ethernet.</span></span>

<span data-ttu-id="e11b4-959">Struktura NXD_ADDRESS również zawiera adresy IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-959">The NXD_ADDRESS structure also holds IPv4 addresses.</span></span> <span data-ttu-id="e11b4-960">Adres IP **192.1.168.10** (**0xC001A80A**) przechowywany w global_ipv4_address będzie miał następujący układ pamięci:</span><span class="sxs-lookup"><span data-stu-id="e11b4-960">An IP address of **192.1.168.10** (**0xC001A80A**) stored in global_ipv4_address would have the following memory layout:</span></span>

|<span data-ttu-id="e11b4-961">Pole</span><span class="sxs-lookup"><span data-stu-id="e11b4-961">Field</span></span> |<span data-ttu-id="e11b4-962">Wartość</span><span class="sxs-lookup"><span data-stu-id="e11b4-962">Value</span></span> |
|---|---|
|<span data-ttu-id="e11b4-963">global_ipv4_address global_ipv4_address.nxd_ip_version</span><span class="sxs-lookup"><span data-stu-id="e11b4-963">global_ipv4_address.nxd_ip_version</span></span> |<span data-ttu-id="e11b4-964">NX_IP_VERSION_V4</span><span class="sxs-lookup"><span data-stu-id="e11b4-964">NX_IP_VERSION_V4</span></span>|
|<span data-ttu-id="e11b4-965">global_ipv4_address global_ipv4_address.nxd_ip_address. v4</span><span class="sxs-lookup"><span data-stu-id="e11b4-965">global_ipv4_address.nxd_ip_address.v4</span></span> |<span data-ttu-id="e11b4-966">0xC001A80A</span><span class="sxs-lookup"><span data-stu-id="e11b4-966">0xC001A80A</span></span>|

<span data-ttu-id="e11b4-967">Gdy aplikacja przekazuje adres do usług NetX Duo, w polu *nxd_ip_version* należy określić prawidłową wersję protokołu IP, aby zapewnić obsługę odpowiednich pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-967">When an application passes an address to NetX Duo services, the *nxd_ip_version* field must specify the correct IP version for proper packet handling.</span></span>

<span data-ttu-id="e11b4-968">Aby była zgodna z poprzednimi wersjami istniejących aplikacji NetX, NetX Duo obsługuje wszystkie usługi NetX.</span><span class="sxs-lookup"><span data-stu-id="e11b4-968">To be backward compatible with existing NetX applications, NetX Duo supports all NetX services.</span></span> <span data-ttu-id="e11b4-969">Wewnętrznie NetX Duo konwertuje typ adresu IPv4 ULONG na typ danych NXD_ADDRESS przed przekazaniem go do rzeczywistej usługi NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-969">Internally, NetX Duo converts the IPv4 address type ULONG to an NXD_ADDRESS data type before forwarding it to the actual NetX Duo service.</span></span>

<span data-ttu-id="e11b4-970">Poniższy przykład ilustruje podobieństwo i różnice między usługami w NetX i NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-970">The following example illustrates the similarity and the differences between services in NetX and NetX Duo.</span></span>

```c
/* Make a connection to the destination IPv4 address
   192.1.168.12 through an already created TCP socket bound
   to the well known HTTP port number 80. */

global_ipv4_address.nxd_ip_version = NX_IP_VERSION_V4;
global_ipv4_address.nxd_ip_address.v4 = 0xC001A80C;

nxd_tcp_client_socket_connect(&tcp_socket,
                              &global_ipv4_address,
                              port_number,
                              NX_WAIT_FOREVER);
```

<span data-ttu-id="e11b4-971">Poniżej przedstawiono odpowiedni interfejs API NetX:</span><span class="sxs-lookup"><span data-stu-id="e11b4-971">The following is the equivalent NetX API:</span></span>

```c
ULONG         server_ip = 0xC001A80C;
NX_TCP_SOCKET tcp_socket;
UINT          port_number = 80;

nx_tcp_client_socket_connect(&tcp_socket,
                             server_ip,
                             port_number,
                             NX_WAIT_FOREVER); 
```

> [!IMPORTANT]
> <span data-ttu-id="e11b4-972">*Deweloperzy aplikacji zachęcają do korzystania z wersji NXD tych interfejsów API*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-972">*Application developers are encouraged to use the nxd version of these APIs*.</span></span>

### <a name="ipv6-default-routers"></a><span data-ttu-id="e11b4-973">Routery domyślne IPv6</span><span class="sxs-lookup"><span data-stu-id="e11b4-973">IPv6 Default Routers</span></span>    
<span data-ttu-id="e11b4-974">Protokół IPv6 używa domyślnego routera do przekazywania pakietów do miejsc docelowych offlink.</span><span class="sxs-lookup"><span data-stu-id="e11b4-974">IPv6 uses a default router to forward packets to offlink destinations.</span></span> <span data-ttu-id="e11b4-975">***Nxd_ipv6_default_router_add*** usługa NetX Duo umożliwia aplikacji dodanie routera IPv6 do tabeli routera domyślnego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-975">The NetX Duo service ***nxd_ipv6_default_router_add*** enables an application to add an IPv6 router to the default router table.</span></span> <span data-ttu-id="e11b4-976">Zobacz rozdział 4 "Opis usług", aby uzyskać więcej domyślnych usług routera oferowanych przez NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-976">See Chapter 4 "Description of Services" for more default router services offered by NetX Duo.</span></span>  

<span data-ttu-id="e11b4-977">W przypadku przekazywania pakietów IPv6 NetX Duo najpierw sprawdza, czy w miejscu docelowym pakietu znajduje się link.</span><span class="sxs-lookup"><span data-stu-id="e11b4-977">When forwarding IPv6 packets, NetX Duo first checks if the packet destination is on-link.</span></span> <span data-ttu-id="e11b4-978">Jeśli nie, NetX Duo sprawdza domyślną tabelę routingu dla prawidłowego routera do przesyłania dalej do usługi.</span><span class="sxs-lookup"><span data-stu-id="e11b4-978">If not, NetX Duo checks the default routing table for a valid router to forward the off-link packet to.</span></span>  

<span data-ttu-id="e11b4-979">Aby usunąć router z tabeli routera domyślnego IPv6, aplikacja używa usługi \***nxd_ipv6_default_router_delete** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-979">To remove a router from the IPv6 default router table, application shall use the service \***nxd_ipv6_default_router_delete** _.</span></span> <span data-ttu-id="e11b4-980">Aby uzyskać wpisy domyślnej tabeli routera IPv6, należy użyć usługi _ *_nxd_ipv6_default_router_entry_get_* \*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-980">To obtain entries of the IPv6 default router table, use the service _\*_nxd_ipv6_default_router_entry_get_\*\*.</span></span>

### <a name="ipv6-header"></a><span data-ttu-id="e11b4-981">Nagłówek IPv6</span><span class="sxs-lookup"><span data-stu-id="e11b4-981">IPv6 Header</span></span>    
<span data-ttu-id="e11b4-982">Nagłówek IPv6 został zmodyfikowany z nagłówka IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-982">The IPv6 header has been modified from the IPv4 header.</span></span> <span data-ttu-id="e11b4-983">Podczas alokowania pakietu obiekt wywołujący określa protokół aplikacji (np. UDP, TCP), rozmiar buforu w bajtach i limit przeskoków.</span><span class="sxs-lookup"><span data-stu-id="e11b4-983">When allocating a packet, the caller specifies the application protocol (e.g., UDP, TCP), buffer size in bytes, and hop limit.</span></span>   

<span data-ttu-id="e11b4-984">Rysunek 9 przedstawia format nagłówka IPv6 i tabelę wyświetla listę składników nagłówka.</span><span class="sxs-lookup"><span data-stu-id="e11b4-984">Figure 9 shows the format of the IPv6 header and the table lists the header components.</span></span>

![Diagram formatu nagłówka IPv6.](./media/user-guide/image18.png)

<span data-ttu-id="e11b4-986">**RYSUNEK 9. Format nagłówka IPv6**</span><span class="sxs-lookup"><span data-stu-id="e11b4-986">**FIGURE 9. IPv6 Header Format**</span></span>

|<span data-ttu-id="e11b4-987">Nagłówek IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-987">IP header</span></span> | <span data-ttu-id="e11b4-988">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="e11b4-988">Purpose</span></span> |
|---|---|
|<span data-ttu-id="e11b4-989">Wersja</span><span class="sxs-lookup"><span data-stu-id="e11b4-989">Version</span></span> |<span data-ttu-id="e11b4-990">pole 4-bitowe dla wersji IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-990">4-bit field for IP version.</span></span> <span data-ttu-id="e11b4-991">W przypadku sieci IPv6 wartość w tym polu musi wynosić 6; W przypadku sieci IPv4 musi być 4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-991">For IPv6 networks, the value in this field must be 6; For IPv4 networks it must be 4.</span></span>|
|<span data-ttu-id="e11b4-992">Klasa ruchu</span><span class="sxs-lookup"><span data-stu-id="e11b4-992">Traffic Class</span></span> |<span data-ttu-id="e11b4-993">pole 8-bitowe przechowujące informacje o klasie ruchu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-993">8-bit field that stores the traffic class information.</span></span> <span data-ttu-id="e11b4-994">To pole nie jest używane przez NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-994">This field is not used by NetX Duo.</span></span>|
|<span data-ttu-id="e11b4-995">Etykieta przepływu</span><span class="sxs-lookup"><span data-stu-id="e11b4-995">Flow Label</span></span> |<span data-ttu-id="e11b4-996">pole 20-bitowe do unikatowego identyfikowania przepływu, z którym jest skojarzony pakiet.</span><span class="sxs-lookup"><span data-stu-id="e11b4-996">20-bit field to uniquely identify the flow, if any, that a packet is associated with.</span></span> <span data-ttu-id="e11b4-997">Wartość zerowa wskazuje, że pakiet nie należy do określonego przepływu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-997">A value of zero indicates the packet does not belong to a particular flow.</span></span> <span data-ttu-id="e11b4-998">To pole zastępuje pole *OT* w protokole IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-998">This field replaces the *TOS* field in IPv4.</span></span>|
|<span data-ttu-id="e11b4-999">Długość ładunku</span><span class="sxs-lookup"><span data-stu-id="e11b4-999">Payload Length</span></span> |<span data-ttu-id="e11b4-1000">pole 16-bitowe wskazujące ilość danych w bajtach pakietu IPv6 po nagłówku podstawowym IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1000">16-bit field indicating the amount of data in bytes of the IPv6 packet following the IPv6 base header.</span></span> <span data-ttu-id="e11b4-1001">Obejmuje to wszystkie hermetyzowane nagłówki protokołu i dane.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1001">This includes all encapsulated protocol header and data.</span></span>|
|<span data-ttu-id="e11b4-1002">Następny nagłówek</span><span class="sxs-lookup"><span data-stu-id="e11b4-1002">Next Header</span></span> | <span data-ttu-id="e11b4-1003">pole 8-bitowe wskazujące typ nagłówka rozszerzenia, który następuje po nagłówku bazowym IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1003">8-bit field indicating the type of the extension header that follows the IPv6 base header.</span></span> <span data-ttu-id="e11b4-1004">To pole zastępuje pole *Protokół* w protokole IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1004">This field replaces the *Protocol* field in IPv4.</span></span>|
|<span data-ttu-id="e11b4-1005">Limit przeskoków</span><span class="sxs-lookup"><span data-stu-id="e11b4-1005">Hop Limit</span></span> |<span data-ttu-id="e11b4-1006">pole 8-bitowe ograniczające liczbę routerów, przez które może przejść pakiet.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1006">8-bit field that limits the number of routers the packet is allowed to go through.</span></span> <span data-ttu-id="e11b4-1007">To pole zastępuje pole *czasu wygaśnięcia* w protokole IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1007">This field replaces the *TTL* field in IPv4.</span></span>|
|<span data-ttu-id="e11b4-1008">Adres źródłowy</span><span class="sxs-lookup"><span data-stu-id="e11b4-1008">Source Address</span></span> |<span data-ttu-id="e11b4-1009">128 — pole bitowe, które przechowuje adres IPv6 nadawcy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1009">128-bit field that stores the IPv6 address of the sender.</span></span>|
|<span data-ttu-id="e11b4-1010">Adres docelowy</span><span class="sxs-lookup"><span data-stu-id="e11b4-1010">Destination Address</span></span> |<span data-ttu-id="e11b4-1011">128-bitowe pole, które Sores adres IPv6 miejsca docelowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1011">128-bit field that sores the IPv6 address of the destination.</span></span>|

### <a name="enabling-ipv6-in-netx-duo"></a><span data-ttu-id="e11b4-1012">Włączanie protokołu IPv6 w NetX Duo</span><span class="sxs-lookup"><span data-stu-id="e11b4-1012">Enabling IPv6 in NetX Duo</span></span>    
<span data-ttu-id="e11b4-1013">Domyślnie protokół IPv6 jest włączony w NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1013">By default IPv6 is enabled in NetX Duo.</span></span> <span data-ttu-id="e11b4-1014">Usługi IPv6 są włączone w NetX Duo, jeśli konfigurowalna opcja \***NX_DISABLE_IPV6** _ w _nx_user. h \* nie została zdefiniowana.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1014">IPv6 services are enabled in NetX Duo if the configurable option ***NX_DISABLE_IPV6** _ in _nx_user.h* is not defined.</span></span> <span data-ttu-id="e11b4-1015">Jeśli ***NX_DISABLE_IPV6*** jest zdefiniowany, NetX Duo będzie oferować tylko usługi IPv4, a wszystkie moduły i usługi związane z protokołem IPv6 nie są wbudowane w bibliotekę NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1015">If ***NX_DISABLE_IPV6*** is defined, NetX Duo will only offer IPv4 services, and all the IPv6-related modules and services are not built into NetX Duo library.</span></span>

<span data-ttu-id="e11b4-1016">Następująca usługa jest świadczona dla aplikacji w celu skonfigurowania adresu IPv6 urządzenia: ***nxd_ipv6_address_set***</span><span class="sxs-lookup"><span data-stu-id="e11b4-1016">The following service is provided for applications to configure the device IPv6 address: ***nxd_ipv6_address_set***</span></span>

<span data-ttu-id="e11b4-1017">Oprócz ręcznego ustawiania adresów IPv6 urządzenia, system może również korzystać z automatycznej konfiguracji adresów bezstanowych.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1017">In addition to manually setting the device's IPv6 addresses, the system may also use Stateless Address Autoconfiguration.</span></span> <span data-ttu-id="e11b4-1018">Aby można było użyć tej opcji, aplikacja musi wywoływać \***nxd_ipv6_enable** _, aby uruchomić usługi IPv6 na urządzeniu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1018">To use this option, the application must call \***nxd_ipv6_enable** _ to start IPv6 services on the device.</span></span> <span data-ttu-id="e11b4-1019">Ponadto usługi ICMPv6 muszą zostać uruchomione przez wywołanie _*_nxd_icmp_enable_*_, co umożliwia NetX Duo wykonywanie usług takich jak żądanie routera, odnajdowanie sąsiadów i wykrywanie duplikatów adresów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1019">In addition, ICMPv6 services must be started by calling _*_nxd_icmp_enable_*_, which enables NetX Duo to perform services such as Router Solicitation, Neighbor Discovery, and Duplicate Address Detection.</span></span> <span data-ttu-id="e11b4-1020">Należy pamiętać, że _*_nx_icmp_enable_*_ uruchamia tylko protokół ICMP dla usług IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1020">Note that _*_nx_icmp_enable_*_ only starts ICMP for IPv4 services.</span></span> <span data-ttu-id="e11b4-1021">_*_nxd_icmp_enable_*_ uruchamia usługi ICMP dla protokołów IPv4 i IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1021">_*_nxd_icmp_enable_*_ starts ICMP services for both IPv4 and IPv6.</span></span> <span data-ttu-id="e11b4-1022">Jeśli system nie potrzebuje usług ICMPv6, można użyć _ \*_nx_icmp_enable_\*\*, aby moduł ICMPv6 nie był połączony z systemem.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1022">If the system does not need ICMPv6 services, then _ *_nx_icmp_enable_*\* can be used so the ICMPv6 module is not linked into the system.</span></span>

<span data-ttu-id="e11b4-1023">W poniższym przykładzie przedstawiono typową procedurę inicjowania protokołu IPv6 NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1023">The following example shows a typical NetX Duo IPv6 initialization procedure.</span></span>

```c
/* Assume ip_0 has been created and IPv4 services (such as ARP,
   ICMP, have been enabled. */
#define SECONDARY_INTERFACE 1

/* Enable IPv6 */
status = nxd_ipv6_enable(&ip_0);

if(status != NX_SUCCESS)
{
    /* nxd_ipv6_enable failed. */
}

/* Enable ICMPv6 */
status = nxd_icmp_enable(&ip_0);
if(status != NX_SUCCESS)
{
    /* nxd_icmp_enable failed. */
}

/* Configure the link local address on the primary interface. */
status = nxd_ipv6_address_set(&ip_0, 0, NX_NULL, 10, NX_NULL);

/* Configure ip_0 primary interface global address. */
ip_address.nxd_ip_version = NX_IP_VERSION_V6
ip_address.nxd_ip_address.v6[0] = 0x20010db8;
ip_address.nxd_ip_address.v6[1] = 0x0000f101;
ip_address.nxd_ip_address.v6[2] = 0;
ip_address.nxd_ip_address.v6[3] = 0x202;

/* Configure global address of the primary interface. */
status = nxd_ipv6_address_set(&ip_0, SECONDARY_INTERFACE,
                              &ip_address, 64, NX_NULL);
```                              

<span data-ttu-id="e11b4-1024">Protokoły warstwy wyższej (takie jak TCP i UDP) można włączyć przed uruchomieniem protokołu IPv6 lub po nim.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1024">Upper layer protocols (such as TCP and UDP) can be enabled either before or after IPv6 starts.</span></span>

> [!IMPORTANT]  
> <span data-ttu-id="e11b4-1025">*Usługi IPv6 są dostępne tylko po zainicjowaniu wątku IP i włączeniu urządzenia.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-1025">*IPv6 services are available only after IP thread is initialized and the device is enabled.*</span></span>

<span data-ttu-id="e11b4-1026">Po włączeniu interfejsu (tj. sterownik urządzenia interfejsu jest gotowy do wysyłania i odbierania danych, a uzyskano prawidłowy adres lokalny linku), urządzenie może uzyskać globalne adresy IPv6 przy użyciu jednej z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="e11b4-1026">After the interface is enabled (i.e.,the interface device driver is ready to send and receive data, and a valid link local address has been obtained), the device may obtain global IPv6 addresses by one of the these methods:</span></span>

- <span data-ttu-id="e11b4-1027">Bezstanowa Konfiguracja automatycznej konfiguracji;</span><span class="sxs-lookup"><span data-stu-id="e11b4-1027">Stateless Address Auto Configuration;</span></span>  
- <span data-ttu-id="e11b4-1028">Ręczna konfiguracja adresów IPv6;</span><span class="sxs-lookup"><span data-stu-id="e11b4-1028">Manual IPv6 address configuration;</span></span>  
- <span data-ttu-id="e11b4-1029">Konfiguracja adresu za pośrednictwem protokołu DHCPv6 (z opcjonalnym pakietem DHCPv6)</span><span class="sxs-lookup"><span data-stu-id="e11b4-1029">Address configuration via DHCPv6 (with optional DHCPv6 package)</span></span>

<span data-ttu-id="e11b4-1030">Dwie pierwsze metody są opisane poniżej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1030">The first two methods are described below.</span></span> <span data-ttu-id="e11b4-1031">Metoda trzecia (DHCPv6) jest opisana w pakiecie DHCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1031">The 3rd method (DHCPv6) is described in the DHCP package.</span></span>

### <a name="stateless-address-autoconfiguration-using-router-solicitation"></a><span data-ttu-id="e11b4-1032">Autokonfiguracja adresu bezstanowego przy użyciu żądania routera</span><span class="sxs-lookup"><span data-stu-id="e11b4-1032">Stateless Address Autoconfiguration Using Router Solicitation</span></span>      
<span data-ttu-id="e11b4-1033">Urządzenia NetX Duo mogą automatycznie konfigurować ich interfejsy w przypadku połączenia z siecią IPv6 przy użyciu routera dostarczającego informacje o prefiksie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1033">NetX Duo devices can configure their interfaces automatically when connected to an IPv6 network with a router that supplies prefix information.</span></span> <span data-ttu-id="e11b4-1034">Urządzenia, które wymagają bezstanowej automatycznej konfiguracji wysyłania komunikatów żądań routera (RS).</span><span class="sxs-lookup"><span data-stu-id="e11b4-1034">Devices that require Stateless Address Autoconfiguration send out router solicitation (RS) messages.</span></span> <span data-ttu-id="e11b4-1035">Routery w sieci odpowiadają za pomocą komunikatów na żądanie anonsowania routera (RA).</span><span class="sxs-lookup"><span data-stu-id="e11b4-1035">Routers on the network respond with solicited router advertisement (RA) messages.</span></span> <span data-ttu-id="e11b4-1036">Komunikaty RA anonsują prefiksy, które identyfikują adresy sieciowe skojarzone z linkiem.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1036">RA messages advertise prefixes that identify the network addresses associated with a link.</span></span> <span data-ttu-id="e11b4-1037">Następnie urządzenia generują unikatowy identyfikator sieci, do której jest dołączone urządzenie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1037">Devices then generate a unique identifier for the network the device is attached to.</span></span> <span data-ttu-id="e11b4-1038">Adres jest tworzony przez połączenie prefiksu i jego unikatowego identyfikatora.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1038">The address is formed by combining the prefix and its unique identifier.</span></span> <span data-ttu-id="e11b4-1039">W ten sposób w przypadku otrzymywania wiadomości urzędu rejestrowania hosty generują adresy IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1039">In this manner on receiving the RA messages, hosts generate their IP address.</span></span> <span data-ttu-id="e11b4-1040">Routery mogą również wysyłać okresowe niechciane komunikaty urzędu rejestrowania.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1040">Routers may also send periodic unsolicited RA messages.</span></span> 

> [!WARNING]
> <span data-ttu-id="e11b4-1041">*NetX Duo umożliwia aplikacji włączenie lub wyłączenie automatycznej konfiguracji adresu bezstanowego w czasie wykonywania. Aby włączyć tę funkcję, biblioteka NetX Duo musi być skompilowana ze zdefiniowanym **NX_IPV6_STATELESS_AUTOCONFIG_CONTROL** . Po włączeniu tej funkcji aplikacje mogą używać **nxd_ipv6_stateless_address_autoconfigure_enable** i **nxd_ipv6_stateless_address_autocofigure_disable** do włączania lub wyłączania automatycznej konfiguracji adresów IPv6*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1041">*NetX Duo allows an application to enable or disable Stateless Address Autoconfiguration at run time. To enable this feature, NetX Duo library must be compiled with **NX_IPV6_STATELESS_AUTOCONFIG_CONTROL** defined. Once this feature is enabled, applications may use **nxd_ipv6_stateless_address_autoconfigure_enable** and **nxd_ipv6_stateless_address_autocofigure_disable** to enable or disable IPv6 stateless address autoconfiguration*.</span></span>

### <a name="manual-ipv6-address-configuration"></a><span data-ttu-id="e11b4-1042">Ręczna konfiguracja adresu IPv6</span><span class="sxs-lookup"><span data-stu-id="e11b4-1042">Manual IPv6 Address Configuration</span></span>     
<span data-ttu-id="e11b4-1043">Jeśli wymagany jest konkretny adres IPv6, aplikacja może używać ***nxd_ipv6_address_set*** do ręcznego konfigurowania adresu IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1043">If a specific IPv6 address is needed, the application may use ***nxd_ipv6_address_set*** to manually configure an IPv6 address.</span></span> <span data-ttu-id="e11b4-1044">Interfejs sieciowy może mieć wiele adresów IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1044">A network interface may have multiple IPv6 addresses.</span></span> <span data-ttu-id="e11b4-1045">Należy jednak pamiętać, że łączna liczba adresów IPv6 w systemie uzyskanych za pomocą automatycznej konfiguracji adresów bezstanowych lub przez konfigurację ręczną nie może przekroczyć ***NX_MAX_IPV6_ADDRESSES***.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1045">However keep in mind that the total number of IPv6 addresses in a system, either obtained through Stateless Address Autoconfiguration, or through the Manual Configuration, cannot exceed ***NX_MAX_IPV6_ADDRESSES***.</span></span>

<span data-ttu-id="e11b4-1046">Poniższy przykład ilustruje sposób ręcznego konfigurowania adresu globalnego w podstawowym interfejsie (urządzenie 0) w ip_0:</span><span class="sxs-lookup"><span data-stu-id="e11b4-1046">The following example illustrates how to manually configure a global address on the primary interface (device 0) in ip_0:</span></span>

```c
NXD_ADDRESS global_address;
global_address.nxd_ip_version = NX_IP_VERSION_V6;
global_address.nxd_ip_address.v6[0] = 0x20010000;
global_address.nxd_ip_address.v6[1] = 0x00000000;
global_address.nxd_ip_address.v6[2] = 0x00000000;
global_address.nxd_ip_address.v6[3] = 0x0000ABCD;
```

<span data-ttu-id="e11b4-1047">Następnie Host wywoła następującą usługę NetX Duo, aby przypisać ten adres jako globalny adres IP:</span><span class="sxs-lookup"><span data-stu-id="e11b4-1047">The host then calls the following NetX Duo service to assign this address as its global IP address:</span></span>

```c
status = nxd_ipv6_address_set(&ip_0, 0,  
                              &global_address, 64
                              NX_NULL);
```

### <a name="duplicate-address-detection-dad"></a><span data-ttu-id="e11b4-1048">Wykrywanie zduplikowanych adresów (tata)</span><span class="sxs-lookup"><span data-stu-id="e11b4-1048">Duplicate Address Detection (DAD)</span></span>    
<span data-ttu-id="e11b4-1049">Gdy system skonfiguruje swój adres IPv6, adres zostanie oznaczony jako *niepewny*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1049">After a system configures its IPv6 address, the address is marked as *TENTATIVE*.</span></span> <span data-ttu-id="e11b4-1050">W przypadku wykrycia zduplikowanego adresu (DAD), opisanego w dokumencie RFC 4862, NetX Duo automatycznie wysyła komunikaty żądania sąsiada (NS) przy użyciu tego nieakceptowanego adresu jako miejsca docelowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1050">If Duplicate Address Detection (DAD), described in RFC 4862, is enabled, NetX Duo automatically sends neighbor solicitation (NS) messages with this tentative address as the destination.</span></span> <span data-ttu-id="e11b4-1051">Jeśli żadne hosty w sieci nie odpowiadają na te komunikaty NS w danym okresie, zakłada się, że adres jest unikatowy w łączu lokalnym, a jego stan jest prawidłowy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1051">If no hosts on the network respond to these NS messages within a given period of time, the address is assumed to be unique on the local link, and its state transits to the VALID state.</span></span> <span data-ttu-id="e11b4-1052">W tym momencie aplikacja może zacząć używać tego adresu IP do komunikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1052">At this point the application may start using this IP address for communication.</span></span>  

<span data-ttu-id="e11b4-1053">Funkcje DAD są częścią modułu ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1053">The DAD functionality is part of the ICMPv6 module.</span></span> <span data-ttu-id="e11b4-1054">W związku z tym aplikacja musi włączyć usługi ICMPv6, zanim nowo skonfigurowany adres będzie mógł przejść przez proces DAD.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1054">Therefore, the application must enable ICMPv6 services before a newly configured address can go through the DAD process.</span></span> <span data-ttu-id="e11b4-1055">Alternatywnie, proces DAD może być wyłączony przez zdefiniowanie opcji ***NX_DISABLE_IPV6_DAD** _ w środowisku kompilacji biblioteki NetX Duo (zdefiniowanej jako _*_nx_user. h_\*_).</span><span class="sxs-lookup"><span data-stu-id="e11b4-1055">Alternatively, the DAD process may be turned off by defining ***NX_DISABLE_IPV6_DAD** _ option in the NetX Duo library build environment (defined as _*_nx_user.h_\*_).</span></span> <span data-ttu-id="e11b4-1056">Podczas procesu DAD parametr _*_NX_IPV6_DAD_TRANSMITS_*_ określa liczbę komunikatów NS wysłanych przez NetX Duo bez otrzymywania odpowiedzi w celu ustalenia, czy adres jest unikatowy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1056">During the DAD process, the _*_NX_IPV6_DAD_TRANSMITS_*_ parameter determines the number of NS messages sent by NetX Duo without receiving a response to determine that the address is unique.</span></span> <span data-ttu-id="e11b4-1057">Domyślnie i zalecane przez RFC 4862, _ *_NX_IPV6_DAD_TRANSMITS_*\* jest ustawiony na 3.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1057">By default and recommended by RFC 4862, _ *_NX_IPV6_DAD_TRANSMITS_*\* is set at 3.</span></span> <span data-ttu-id="e11b4-1058">Ustawienie tego symbolu na zero powoduje wyłączenie DAD.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1058">Setting this symbol to zero effectively disables DAD.</span></span>

<span data-ttu-id="e11b4-1059">Jeśli protokół ICMPv6 lub tata nie jest włączony w momencie, gdy aplikacja przypisze adres IPv6, tato nie zostanie wykonana i NetX Duo ustawi natychmiastowy stan adresu IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1059">If ICMPv6 or DAD is not enabled at the time the application assigns an IPv6 address, DAD is not performed and NetX Duo sets the state of the IPv6 address to VALID immediately.</span></span>

<span data-ttu-id="e11b4-1060">NetX Duo nie może komunikować się w sieci IPv6, dopóki adres lokalny i/lub globalny linku nie są prawidłowe.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1060">NetX Duo cannot communicate on the IPv6 network until its link local and/or global address is valid.</span></span> <span data-ttu-id="e11b4-1061">Po uzyskaniu prawidłowego adresu NetX Duo próbuje dopasować adres docelowy pakietu przychodzącego do jednego ze skonfigurowanych adresów IPv6 lub z włączonym adresem multiemisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1061">After a valid address is obtained, NetX Duo attempts to match the destination address of an incoming packet against one of its configured IPv6 address or an enabled multicast address.</span></span> <span data-ttu-id="e11b4-1062">Jeśli nie zostaną znalezione żadne dopasowania, pakiet zostanie porzucony.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1062">If no matches are found, the packet is dropped.</span></span> 

> [!WARNING]  
> <span data-ttu-id="e11b4-1063">\* W trakcie procesu DAD liczba pakietów DAD NS do przesłania jest definiowana przez \***NX_IPV6_DAD_TRANSMITS**_, która domyślnie jest równa 3, a w przypadku gdy wysyłana jest jedna sekunda opóźnienia między każdą zawartą w niej wiadomości NS. W związku z tym w systemie z włączonym tata, po przypisaniu adresu IPv6 (przy założeniu, że nie jest to zduplikowany adres), istnieje około 3 sekund opóźnienia, zanim adres IP będzie w PRAWIDŁOWYm stanie i jest gotowy do komunikacji._</span><span class="sxs-lookup"><span data-stu-id="e11b4-1063">\*During the DAD process, the number of DAD NS packets to be transmitted is defined by \***NX_IPV6_DAD_TRANSMITS**_, which defaults to 3, and by default there is a one second delay between each DAD NS message is sent. Therefore, in a system with DAD enabled, after an IPv6 address is assigned (and assuming this is not a duplicated address), there is approximately 3 seconds delay before the IP address is in a VALID state and is ready for communication._</span></span>

<span data-ttu-id="e11b4-1064">Aplikacje mogą chcieć otrzymywać powiadomienia o zmianie adresów IPv6 w systemie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1064">Applications may want to receive notifications when IPv6 addresses in the system are changed.</span></span> <span data-ttu-id="e11b4-1065">Aby włączyć funkcję powiadamiania o zmianie adresu IPv6, biblioteka NetX Duo musi być skompilowana przy użyciu zdefiniowanego symbolu **NX_ENABLE_IPV6_ADDRESS_CHANGE_NOTIFY** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-1065">To enable the IPv6 address change notification feature, the NetX Duo library must be built with the symbol **NX_ENABLE_IPV6_ADDRESS_CHANGE_NOTIFY** defined.</span></span> <span data-ttu-id="e11b4-1066">Po włączeniu tej funkcji aplikacje mogą instalować funkcję wywołania zwrotnego za pomocą usługi **_nxd_ipv6_address_change_notify_** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-1066">Once the feature is enabled, applications may install the callback function by using the **_nxd_ipv6_address_change_notify_** service.</span></span>

<span data-ttu-id="e11b4-1067">Gdy adres IPv6 zostanie zmieniony lub przestanie być nieprawidłowy, funkcja wywołania zwrotnego wprowadzona przez użytkownika zostanie wywołana z następującymi informacjami:</span><span class="sxs-lookup"><span data-stu-id="e11b4-1067">Once an IPv6 address is changed, or becomes invalid, the user-supplied callback function is invoked with the following information:</span></span>

| <span data-ttu-id="e11b4-1068">Funkcja</span><span class="sxs-lookup"><span data-stu-id="e11b4-1068">Function</span></span>  | <span data-ttu-id="e11b4-1069">Opis</span><span class="sxs-lookup"><span data-stu-id="e11b4-1069">Description</span></span>  |
|---|---|
|<span data-ttu-id="e11b4-1070">ip_ptr</span><span class="sxs-lookup"><span data-stu-id="e11b4-1070">ip_ptr</span></span> |<span data-ttu-id="e11b4-1071">Wskaźnik do wystąpienia adresu IP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1071">Pointer to the IP instance</span></span>|
|<span data-ttu-id="e11b4-1072">interface_index</span><span class="sxs-lookup"><span data-stu-id="e11b4-1072">interface_index</span></span> |<span data-ttu-id="e11b4-1073">Indeksuj do interfejsu sieciowego, z którym jest skojarzony ten adres IPv6</span><span class="sxs-lookup"><span data-stu-id="e11b4-1073">Index to the network interface that this IPv6 address is associated with</span></span>
|<span data-ttu-id="e11b4-1074">ipv6_addr_index</span><span class="sxs-lookup"><span data-stu-id="e11b4-1074">ipv6_addr_index</span></span> |<span data-ttu-id="e11b4-1075">Indeksowanie tabeli adresów IPv6</span><span class="sxs-lookup"><span data-stu-id="e11b4-1075">Index to the IPv6 address table</span></span>|
|<span data-ttu-id="e11b4-1076">ipv6_address</span><span class="sxs-lookup"><span data-stu-id="e11b4-1076">ipv6_address</span></span> |<span data-ttu-id="e11b4-1077">Wskaźnik na adres IPv6 w postaci tablicy czterech ULONG liczb całkowitych.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1077">Pointer to the IPv6 address, in the form of an array of four ULONG integers.</span></span> <span data-ttu-id="e11b4-1078">Adresy Pv6 są prezentowane w kolejności bajtów hosta.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1078">Pv6 addresses are presented in host byte order.</span></span>|

### <a name="ipv6-multicast-support-in-netx-duo"></a><span data-ttu-id="e11b4-1079">Obsługa multiemisji IPv6 w programie NetX Duo</span><span class="sxs-lookup"><span data-stu-id="e11b4-1079">IPv6 Multicast Support In NetX Duo</span></span>      
<span data-ttu-id="e11b4-1080">Adresy multiemisji określają dynamiczną grupę hostów w Internecie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1080">Multicast addresses specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="e11b4-1081">Członkowie grupy multiemisji mogą dołączać się i zostawiać w dowolnym momencie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1081">Members of the multicast group may join and leave whenever they wish.</span></span> <span data-ttu-id="e11b4-1082">NetX Duo implementuje kilka protokołów ICMPv6, w tym wykrywanie zduplikowanych adresów, odnajdywanie sąsiadów i odnajdywanie routerów, które wymagają możliwości multiemisji IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1082">NetX Duo implements several ICMPv6 protocols, including Duplicate Address Detection, Neighbor Discovery, and Router Discovery, which require IP multicast capability.</span></span> <span data-ttu-id="e11b4-1083">W związku z tym NetX Duo oczekuje, że podstawowy sterownik urządzenia obsługuje operacje multiemisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1083">Therefore, NetX Duo expects the underlying device driver to support multicast operations.</span></span>

<span data-ttu-id="e11b4-1084">Gdy NetX Duo musi przyłączyć się do grupy multiemisji lub opuścić ją (na przykład adres multiemisji z całego węzła i adres multiemisji na *żądanie* ), wysyła polecenie sterownika do sterownika urządzenia, aby dołączyć lub pozostawić adres MAC multiemisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1084">When NetX Duo needs to join or leave a multicast group (such as the all-node multicast address, and the *solicited-node* multicast address), it issues a driver command to the device driver to join or leave a multicast MAC address.</span></span> <span data-ttu-id="e11b4-1085">Polecenie sterownika służące do przyłączania adresu multiemisji to \***NX_LINK_MULTICAST_JOIN** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1085">The driver command for joining the multicast address is \***NX_LINK_MULTICAST_JOIN** _.</span></span> <span data-ttu-id="e11b4-1086">Aby opuścić adres multiemisji, NetX Duo wystawia polecenie sterownika _ *_NX_LINK_MULTICAST_LEAVE_* \*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1086">To leave a multicast address, NetX Duo issues the driver command _\*_NX_LINK_MULTICAST_LEAVE_\*\*.</span></span> <span data-ttu-id="e11b4-1087">Aby protokoły ICMPv6 działały prawidłowo, sterownik urządzenia musi zaimplementować te dwa polecenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1087">The device driver must implement these two commands for ICMPv6 protocols to work properly.</span></span>

<span data-ttu-id="e11b4-1088">Aplikacje mogą dołączać do grupy multiemisji IPv6 za pomocą usługi \*\**nxd_ipv6_multicast_interface_join *.**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1088">Applications may join an IPv6 multicast group by using the service \***nxd_ipv6_multicast_interface_join\*.**</span></span> <span data-ttu-id="e11b4-1089">Ta usługa rejestruje adres multiemisji przy użyciu stosu IP, a następnie powiadamia określony sterownik urządzenia w adresie multiemisji IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1089">This service registers the multicast address with the IP stack, and then notifies the specified device driver of the IPv6 multicast address.</span></span> <span data-ttu-id="e11b4-1090">Aby opuścić grupę multiemisji, aplikacje używają ***nxd_ipv6_multicast_interface_leave usługi.***</span><span class="sxs-lookup"><span data-stu-id="e11b4-1090">To leave a multicast group, applications use the service ***nxd_ipv6_multicast_interface_leave.***</span></span>

### <a name="neighbor-discovery-nd"></a><span data-ttu-id="e11b4-1091">Odnajdywanie sąsiadów (ND)</span><span class="sxs-lookup"><span data-stu-id="e11b4-1091">Neighbor Discovery (ND)</span></span>    
<span data-ttu-id="e11b4-1092">Funkcja odnajdywania sąsiadów to protokół w sieciach IPv6 służący do mapowania adresów fizycznych na adresy IPv6 (adres globalny lub adres lokalny łącza).</span><span class="sxs-lookup"><span data-stu-id="e11b4-1092">Neighbor Discovery is a protocol in IPv6 networks for mapping physical addresses to the IPv6 addresses (global address or link-local address).</span></span> <span data-ttu-id="e11b4-1093">To mapowanie jest zachowywane w pamięci podręcznej odnajdowania sąsiadów (w pamięci podręcznej ND).</span><span class="sxs-lookup"><span data-stu-id="e11b4-1093">This mapping is maintained in the Neighbor Discovery Cache (ND Cache).</span></span> <span data-ttu-id="e11b4-1094">Proces ND jest odpowiednikiem procesu ARP w protokole IPv4, a pamięć podręczna ND jest podobna do tabeli ARP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1094">The ND process is the equivalent of the ARP process in IPv4, and the ND Cache is similar to the ARP table.</span></span> <span data-ttu-id="e11b4-1095">Węzeł IPv6 może uzyskać adres MAC swojego sąsiada przy użyciu protokołu Neighbor Discovery (ND).</span><span class="sxs-lookup"><span data-stu-id="e11b4-1095">An IPv6 node can obtain its neighbor's MAC address using the Neighbor Discovery (ND) protocol.</span></span> <span data-ttu-id="e11b4-1096">Wysyła komunikat żądania sąsiada (NS) do adresu multiemisji węzła żądanego przez węzeł i czeka na odpowiedni komunikat anonsu sąsiada (NA).</span><span class="sxs-lookup"><span data-stu-id="e11b4-1096">It sends out a neighbor solicitation (NS) message to the all-node solicited node multicast address, and waits for a corresponding neighbor advertisement (NA) message.</span></span> <span data-ttu-id="e11b4-1097">Adres MAC uzyskany za pomocą tego procesu jest przechowywany w pamięci podręcznej ND.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1097">The MAC address obtained through this process is stored in the ND Cache.</span></span>

<span data-ttu-id="e11b4-1098">Każde wystąpienie IP ma jedną pamięć podręczną ND.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1098">Each IP instance has one ND cache.</span></span> <span data-ttu-id="e11b4-1099">Pamięć podręczna ND jest utrzymywana jako tablica wpisów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1099">The ND Cache is maintained as an array of entries.</span></span> <span data-ttu-id="e11b4-1100">Rozmiar tablicy jest definiowany w czasie kompilacji przez ustawienie opcji \***NX_IPV6_NEIGHBOR_CACHE_SIZE** _, w _ *_nx_user. h_* \*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1100">The size of the array is defined at compilation time by setting the option ***NX_IPV6_NEIGHBOR_CACHE_SIZE** _ which in _*_nx_user.h_\*\*.</span></span> <span data-ttu-id="e11b4-1101">Należy zauważyć, że wszystkie interfejsy dołączone do wystąpienia IP korzystają z tej samej pamięci podręcznej ND.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1101">Note that all interfaces attached to an IP instance share the same ND cache.</span></span>

<span data-ttu-id="e11b4-1102">Cała pamięć podręczna ND jest pusta, gdy zostanie uruchomione NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1102">The entire ND Cache is empty when NetX Duo starts up.</span></span> <span data-ttu-id="e11b4-1103">Gdy system zostanie uruchomiony, NetX Duo automatycznie aktualizuje pamięć podręczną ND, dodając i usuwając wpisy zgodnie z protokołem ND.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1103">As the system runs, NetX Duo automatically updates the ND Cache, adding and deleting entries as per ND protocol.</span></span> <span data-ttu-id="e11b4-1104">Jednak aplikacja może również zaktualizować pamięć podręczną ND, ręcznie dodając i usuwając wpisy pamięci podręcznej przy użyciu następujących usług NetX Duo:</span><span class="sxs-lookup"><span data-stu-id="e11b4-1104">However, an application may also update the ND Cache by manually adding and deleting cache entries using the following NetX Duo services:</span></span>

- <span data-ttu-id="e11b4-1105">***nxd_nd_cache_entry_delete***</span><span class="sxs-lookup"><span data-stu-id="e11b4-1105">***nxd_nd_cache_entry_delete***</span></span>  
- <span data-ttu-id="e11b4-1106">***nxd_nd_cache_entry_set***</span><span class="sxs-lookup"><span data-stu-id="e11b4-1106">***nxd_nd_cache_entry_set***</span></span>   
- <span data-ttu-id="e11b4-1107">***nxd_nd_cache_invalidate***</span><span class="sxs-lookup"><span data-stu-id="e11b4-1107">***nxd_nd_cache_invalidate***</span></span>

<span data-ttu-id="e11b4-1108">W przypadku wysyłania i otrzymywania pakietów IPv6 NetX Duo automatycznie aktualizuje tabelę pamięci podręcznej ND.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1108">When sending and receiving IPv6 packets, NetX Duo automatically updates the ND Cache table.</span></span>

## <a name="internet-control-message-protocol-in-ipv6-icmpv6"></a><span data-ttu-id="e11b4-1109">Protokół komunikatów kontroli Internetu w protokole IPv6 (ICMPv6)</span><span class="sxs-lookup"><span data-stu-id="e11b4-1109">Internet Control Message Protocol in IPv6 (ICMPv6)</span></span>  

<span data-ttu-id="e11b4-1110">Rola ICMPv6 w protokole IPv6 została znacznie rozszerzona w celu obsługi mapowania adresów IPv6 i odnajdywania routera.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1110">The role of ICMPv6 in IPv6 has been greatly expanded to support IPv6 address mapping and router discovery.</span></span> <span data-ttu-id="e11b4-1111">Dodatkowo NetX Duo ICMPv6 obsługuje żądanie echa i odpowiedzi, raporty błędów ICMPv6 i komunikaty ICMPv6 redirect.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1111">In addition, NetX Duo ICMPv6 supports echo request and response, ICMPv6 error reports, and ICMPv6 redirect messages.</span></span>

### <a name="icmpv6-enable"></a><span data-ttu-id="e11b4-1112">Włączenie ICMPv6</span><span class="sxs-lookup"><span data-stu-id="e11b4-1112">ICMPv6 Enable</span></span>    
<span data-ttu-id="e11b4-1113">Aby komunikaty ICMPv6 mogły być przetwarzane przez NetX Duo, aplikacja musi wywoływać usługę ***nxd_icmp_enable*** , aby umożliwić przetwarzanie ICMPv6 w sposób opisany wcześniej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1113">Before ICMPv6 messages can be processed by NetX Duo, the application must call the ***nxd_icmp_enable*** service to enable ICMPv6 processing as explained previously.</span></span> 

### <a name="icmpv6-messages"></a><span data-ttu-id="e11b4-1114">Komunikaty ICMPv6</span><span class="sxs-lookup"><span data-stu-id="e11b4-1114">ICMPv6 Messages</span></span>     
<span data-ttu-id="e11b4-1115">Struktura nagłówka ICMPv6 jest podobna do struktury nagłówka ICMPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1115">The ICMPv6 header structure is similar to the ICMPv4 header structure.</span></span> <span data-ttu-id="e11b4-1116">Jak pokazano poniżej, podstawowy nagłówek ICMPv6 zawiera trzy pola, typ, kod i sumę kontrolną, a także zmienną długość danych opcji ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1116">As shown below, the basic ICMPv6 header contains the three fields, type, code, and checksum, plus variable length of ICMPv6 option data.</span></span> 

![Diagram podstawowego nagłówka ICMPv6.](./media/user-guide/image19.png)

<span data-ttu-id="e11b4-1118">**RYSUNEK 10. Podstawowy nagłówek ICMPv6**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1118">**FIGURE 10. Basic ICMPv6 Header**</span></span>

|<span data-ttu-id="e11b4-1119">Pole</span><span class="sxs-lookup"><span data-stu-id="e11b4-1119">Field</span></span> |<span data-ttu-id="e11b4-1120">Rozmiar (w bajtach)</span><span class="sxs-lookup"><span data-stu-id="e11b4-1120">Size(bytes)</span></span> |<span data-ttu-id="e11b4-1121">Opis</span><span class="sxs-lookup"><span data-stu-id="e11b4-1121">Description</span></span> |
|-----|-----|-----|
|     | <span data-ttu-id="e11b4-1122">1</span><span class="sxs-lookup"><span data-stu-id="e11b4-1122">1</span></span>   |<span data-ttu-id="e11b4-1123">Identyfikuje typ komunikatu ICMPv6;</span><span class="sxs-lookup"><span data-stu-id="e11b4-1123">Identifies the ICMPv6 message type;</span></span> |
|     |     |<span data-ttu-id="e11b4-1124">1 miejsce docelowe jest nieosiągalne</span><span class="sxs-lookup"><span data-stu-id="e11b4-1124">1 Destination Unreachable</span></span> |
|     |     |<span data-ttu-id="e11b4-1125">Zbyt duży pakiet 2</span><span class="sxs-lookup"><span data-stu-id="e11b4-1125">2 Packet Too Big</span></span> |
|     |     |<span data-ttu-id="e11b4-1126">3 przekroczenia czasu</span><span class="sxs-lookup"><span data-stu-id="e11b4-1126">3 Time Exceeded</span></span> |
|     |     |<span data-ttu-id="e11b4-1127">4 problem z parametrem</span><span class="sxs-lookup"><span data-stu-id="e11b4-1127">4 Parameter Problem</span></span> |
|     |     |<span data-ttu-id="e11b4-1128">128 żądanie echa</span><span class="sxs-lookup"><span data-stu-id="e11b4-1128">128 Echo Request</span></span> |
|     |     |<span data-ttu-id="e11b4-1129">129 odpowiedzi echa</span><span class="sxs-lookup"><span data-stu-id="e11b4-1129">129 Echo Reply</span></span> |
|     |     |<span data-ttu-id="e11b4-1130">Żądanie routera 133</span><span class="sxs-lookup"><span data-stu-id="e11b4-1130">133 Router Solicitation</span></span> |
|     |     |<span data-ttu-id="e11b4-1131">Anons routera 134</span><span class="sxs-lookup"><span data-stu-id="e11b4-1131">134 Router Advertisement</span></span> |
|     |     |<span data-ttu-id="e11b4-1132">135 żądanie sąsiada</span><span class="sxs-lookup"><span data-stu-id="e11b4-1132">135 Neighbor Solicitation</span></span> |
|     |     |<span data-ttu-id="e11b4-1133">136 anons sąsiada</span><span class="sxs-lookup"><span data-stu-id="e11b4-1133">136 Neighbor Advertisement</span></span> |
|     |     |<span data-ttu-id="e11b4-1134">137 komunikat przekierowania</span><span class="sxs-lookup"><span data-stu-id="e11b4-1134">137 Redirect Message</span></span> |
|<span data-ttu-id="e11b4-1135">Kod</span><span class="sxs-lookup"><span data-stu-id="e11b4-1135">Code</span></span> | <span data-ttu-id="e11b4-1136">1</span><span class="sxs-lookup"><span data-stu-id="e11b4-1136">1</span></span>   |<span data-ttu-id="e11b4-1137">Umożliwia dalsze zakwalifikowanie typu komunikatu ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1137">Further qualifies the ICMPv6 message type.</span></span> <span data-ttu-id="e11b4-1138">Zwykle używany z komunikatami o błędach.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1138">Generally used with error messages.</span></span> <span data-ttu-id="e11b4-1139">Jeśli nie zostanie użyta, jest ustawiona na zero.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1139">If not used, it is set to zero.</span></span> <span data-ttu-id="e11b4-1140">Komunikaty żądania echa/odpowiedzi i NS nie są używane.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1140">Echo request/reply and NS messages do not use it.</span></span>|
|<span data-ttu-id="e11b4-1141">Suma kontrolna</span><span class="sxs-lookup"><span data-stu-id="e11b4-1141">Checksum</span></span> | <span data-ttu-id="e11b4-1142">2</span><span class="sxs-lookup"><span data-stu-id="e11b4-1142">2</span></span> |<span data-ttu-id="e11b4-1143">16-bitowe pole sumy kontrolnej dla nagłówka ICMP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1143">16-bit checksum field for the ICMP Header.</span></span> <span data-ttu-id="e11b4-1144">Jest to 16-bitowy uzupełniający cały komunikat ICMPv6, w tym nagłówek ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1144">This is a 16-bit complement of the entire ICMPv6 message, including the ICMPv6 header.</span></span> <span data-ttu-id="e11b4-1145">Zawiera również pseudo nagłówka adresu źródłowego IPv6, adresu docelowego i długości ładunku pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1145">It also includes a pseudo-header of the IPv6 source address, destination address, and packet payload length.</span></span> |

<span data-ttu-id="e11b4-1146">Poniżej przedstawiono przykładowy nagłówek żądania sąsiada.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1146">An example Neighbor Solicitation header is shown below.</span></span>

![Diagram przykładowego nagłówka żądania sąsiada.](./media/user-guide/image20.jpg)

<span data-ttu-id="e11b4-1148">**RYSUNEK 11. Nagłówek ICMPv6 dla komunikatu żądania sąsiada**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1148">**FIGURE 11. ICMPv6 Header for a Neighbor Solicitation Message**</span></span>

|<span data-ttu-id="e11b4-1149">Pole</span><span class="sxs-lookup"><span data-stu-id="e11b4-1149">Field</span></span> |<span data-ttu-id="e11b4-1150">Rozmiar (w bajtach)</span><span class="sxs-lookup"><span data-stu-id="e11b4-1150">Size(bytes)</span></span> |<span data-ttu-id="e11b4-1151">Opis</span><span class="sxs-lookup"><span data-stu-id="e11b4-1151">Description</span></span> |
|-----|-----|-----|
|<span data-ttu-id="e11b4-1152">Typ</span><span class="sxs-lookup"><span data-stu-id="e11b4-1152">Type</span></span> | <span data-ttu-id="e11b4-1153">1</span><span class="sxs-lookup"><span data-stu-id="e11b4-1153">1</span></span>   |<span data-ttu-id="e11b4-1154">Identyfikuje typ komunikatu ICMPv6 dla komunikatów żądania sąsiada.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1154">Identifies the ICMPv6 message type for neighbor solicitation messages.</span></span> <span data-ttu-id="e11b4-1155">Wartość to 135.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1155">Value is 135.</span></span> |
|<span data-ttu-id="e11b4-1156">Kod</span><span class="sxs-lookup"><span data-stu-id="e11b4-1156">Code</span></span> | <span data-ttu-id="e11b4-1157">1</span><span class="sxs-lookup"><span data-stu-id="e11b4-1157">1</span></span>   |<span data-ttu-id="e11b4-1158">Nie używany.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1158">Not used.</span></span> <span data-ttu-id="e11b4-1159">Ustaw wartość 0.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1159">Set to 0.</span></span> |
|<span data-ttu-id="e11b4-1160">Suma kontrolna</span><span class="sxs-lookup"><span data-stu-id="e11b4-1160">Checksum</span></span> | <span data-ttu-id="e11b4-1161">2</span><span class="sxs-lookup"><span data-stu-id="e11b4-1161">2</span></span>  |<span data-ttu-id="e11b4-1162">16-bitowe pole sumy kontrolnej dla nagłówka ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1162">16-bit checksum field for the ICMPv6 header.</span></span> |
|<span data-ttu-id="e11b4-1163">Zarezerwowany</span><span class="sxs-lookup"><span data-stu-id="e11b4-1163">Reserved</span></span> | <span data-ttu-id="e11b4-1164">4</span><span class="sxs-lookup"><span data-stu-id="e11b4-1164">4</span></span>  |<span data-ttu-id="e11b4-1165">4 zarezerwowane bajty ustawione na 0.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1165">4 reserved bytes set to 0.</span></span> |
|<span data-ttu-id="e11b4-1166">Adres docelowy</span><span class="sxs-lookup"><span data-stu-id="e11b4-1166">Target Address</span></span> | <span data-ttu-id="e11b4-1167">16</span><span class="sxs-lookup"><span data-stu-id="e11b4-1167">16</span></span>  |<span data-ttu-id="e11b4-1168">Adres IPv6 obiektu docelowego żądania.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1168">IPv6 address of target of the solicitation.</span></span> <span data-ttu-id="e11b4-1169">W przypadku rozpoznawania adresów IPv6 jest to rzeczywisty adres IP emisji pojedynczej urządzenia, którego adres warstwy łącza musi zostać rozpoznany.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1169">For IPv6 address resolution, this is the actual unicast IP address of the device whose link layer address needs to be resolved.</span></span> |
|<span data-ttu-id="e11b4-1170">Opcje</span><span class="sxs-lookup"><span data-stu-id="e11b4-1170">Options</span></span> | <span data-ttu-id="e11b4-1171">Zmienna</span><span class="sxs-lookup"><span data-stu-id="e11b4-1171">Variable</span></span> |<span data-ttu-id="e11b4-1172">Opcjonalne informacje określone przez protokół Neighbor Discovery Protocol.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1172">Optional information specified by the Neighbor Discovery Protocol.</span></span> |

### <a name="icmpv6-ping-request"></a><span data-ttu-id="e11b4-1173">Żądanie ping ICMPv6</span><span class="sxs-lookup"><span data-stu-id="e11b4-1173">ICMPv6 Ping Request</span></span>
<span data-ttu-id="e11b4-1174">W aplikacjach NetX Duo Użyj ***nxd_icmp_ping*** , aby wystawić żądania ping IPv6 lub IPv4 na podstawie docelowego adresu IP określonego w parametrach.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1174">In NetX Duo applications use ***nxd_icmp_ping*** to issue either IPv6 or IPv4 ping requests, based on the destination IP address specified in the parameters.</span></span>  

### <a name="icmpv6-ping-response"></a><span data-ttu-id="e11b4-1175">Odpowiedź ping protokołu ICMPv6</span><span class="sxs-lookup"><span data-stu-id="e11b4-1175">ICMPv6 Ping Response</span></span>
<span data-ttu-id="e11b4-1176">Odpowiedź na polecenie ping protokołu ICMPv6 jest innym typem komunikatu ICMPv6, który jest generowany wewnętrznie przez składnik ICMPv6 w odpowiedzi na zewnętrzne żądanie ping ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1176">An ICMPv6 ping response is another type of ICMPv6 message that is generated internally by the ICMPv6 component in response to an external ICMPv6 ping request.</span></span> <span data-ttu-id="e11b4-1177">Aby uzyskać dodatkowe potwierdzenie, odpowiedź na polecenie ping protokołu ICMPv6 również zawiera kopię danych użytkownika dostarczonych w żądaniu ping ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1177">In additional to acknowledgement, the ICMPv6 ping response also contains a copy of the user data supplied in the ICMPv6 ping request.</span></span>  

### <a name="thread-suspension"></a><span data-ttu-id="e11b4-1178">Zawieszenie wątku</span><span class="sxs-lookup"><span data-stu-id="e11b4-1178">Thread Suspension</span></span>
<span data-ttu-id="e11b4-1179">Wątki aplikacji mogą wstrzymywać podczas próby wysłania polecenia ping do innego elementu członkowskiego sieci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1179">Application threads can suspend while attempting to ping another network member.</span></span> <span data-ttu-id="e11b4-1180">Po odebraniu odpowiedzi ping komunikat odpowiedzi ping jest przyznany do pierwszego wątku zawieszonego i ten wątek zostaje wznowiony.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1180">After a ping response is received, the ping response message is given to the first thread suspended and that thread is resumed.</span></span> <span data-ttu-id="e11b4-1181">Podobnie jak w przypadku wszystkich usług NetX Duo, zawieszenie żądania ping ma opcjonalny limit czasu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1181">Like all NetX Duo services, suspending on a ping request has an optional timeout.</span></span>  

### <a name="other-icmpv6-messages"></a><span data-ttu-id="e11b4-1182">Inne komunikaty ICMPv6</span><span class="sxs-lookup"><span data-stu-id="e11b4-1182">Other ICMPv6 Messages</span></span>
<span data-ttu-id="e11b4-1183">Komunikaty ICMPv6 są wymagane dla następujących funkcji:</span><span class="sxs-lookup"><span data-stu-id="e11b4-1183">ICMPv6 messages are required for the following features:</span></span>  

- <span data-ttu-id="e11b4-1184">Odnajdywanie sąsiadów</span><span class="sxs-lookup"><span data-stu-id="e11b4-1184">Neighbor Discovery</span></span>  
- <span data-ttu-id="e11b4-1185">Autokonfiguracja adresu bezstanowego</span><span class="sxs-lookup"><span data-stu-id="e11b4-1185">Stateless Address Autoconfiguration</span></span> 
- <span data-ttu-id="e11b4-1186">Odnajdywanie routera</span><span class="sxs-lookup"><span data-stu-id="e11b4-1186">Router Discovery</span></span> 
- <span data-ttu-id="e11b4-1187">Wykrywanie nieosiągalności sąsiadów</span><span class="sxs-lookup"><span data-stu-id="e11b4-1187">Neighbor Unreachability Detection</span></span>  

### <a name="neighbor-unreachability-router-and-prefix-discovery"></a><span data-ttu-id="e11b4-1188">Nieosiągalność sąsiada, Wykrywanie routera i prefiksów</span><span class="sxs-lookup"><span data-stu-id="e11b4-1188">Neighbor Unreachability, Router and Prefix Discovery</span></span>    
<span data-ttu-id="e11b4-1189">Wykrywanie nieosiągalności sąsiadów, odnajdywanie routera i odnajdowanie prefiksów opiera się na protokole Neighbor Discovery i opisano poniżej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1189">Neighbor Unreachability Detection, Router Discovery, and Prefix Discovery are based on the Neighbor Discovery protocol and are described below.</span></span> 

<span data-ttu-id="e11b4-1190">***Wykrywanie nieosiągalności sąsiada:*** Urządzenie IPv6 przeszukuje pamięć podręczną odnajdowania sąsiadów (ND) dla adresu warstwy łącza docelowego, gdy chce wysłać pakiet.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1190">***Neighbor Unreachability Detection:*** An IPv6 device searches its Neighbor Discovery (ND) Cache for the destination link layer address when it wishes to send a packet.</span></span> <span data-ttu-id="e11b4-1191">Bezpośrednie miejsce docelowe, nazywane czasem "następnym przeskokiem", może być rzeczywistym miejscem docelowym tego samego linku lub może być routerem, jeśli miejsce docelowe jest wyłączone.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1191">The immediate destination, sometimes referred to as the 'next hop,' may be the actual destination on the same link or it may be a router if the destination is off link.</span></span> <span data-ttu-id="e11b4-1192">Wpis pamięci podręcznej ND zawiera stan dla możliwości uzyskania dostępu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1192">An ND cache entry contains the status on a neighbor's reachability.</span></span>

<span data-ttu-id="e11b4-1193">Stan OSIĄGALNy oznacza, że sąsiad jest uznawany za osiągalny.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1193">A REACHABLE status indicates the neighbor is considered reachable.</span></span> <span data-ttu-id="e11b4-1194">Sąsiad jest osiągalny, jeśli niedawno otrzymał potwierdzenie, że pakiety wysłane do sąsiada zostały odebrane.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1194">A neighbor is reachable if it has recently received confirmation that packets sent to the neighbor have been received.</span></span> <span data-ttu-id="e11b4-1195">Potwierdzenie w NetX Duo przyjmuje formę odebrania komunikatu NA brak z sąsiada w odpowiedzi na komunikat NS Wysłany przez urządzenie NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1195">Confirmation in NetX Duo take the form of receiving an NA message from the neighbor in response to an NS message sent by the NetX Duo device.</span></span> <span data-ttu-id="e11b4-1196">NetX Duo zmieni stan sąsiada na dostępny, jeśli aplikacja wywoła usługę NetX Duo ***nxd_nd_cache_entry_set*** ręcznie wprowadzić rekord pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1196">NetX Duo will also change the state of the neighbor status to REACHABLE if the application calls the NetX Duo service ***nxd_nd_cache_entry_set*** to manually enter a cache record.</span></span>

<span data-ttu-id="e11b4-1197">***Odnajdywanie routera:*** Urządzenie IPv6 używa routera do przesyłania dalej wszystkich pakietów przeznaczonych do łączenia miejsc docelowych.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1197">***Router Discovery:*** An IPv6 device uses a router to forward all packets intended for off link destinations.</span></span> <span data-ttu-id="e11b4-1198">Mogą również używać informacji wysyłanych przez router, takich jak komunikaty Anons routera (RA), w celu skonfigurowania globalnych adresów IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1198">It may also use information sent by the router, such as router advertisement (RA) messages, to configure its global IPv6 addresses.</span></span>

<span data-ttu-id="e11b4-1199">Urządzenie w sieci może inicjować proces odnajdywania routera, wysyłając komunikat żądania routera (RS) do adresu multiemisji wszystkich routerów (FF01:: 2).</span><span class="sxs-lookup"><span data-stu-id="e11b4-1199">A device on the network may initiate the Router Discovery process by sending a router solicitation (RS) message to the all-router multicast address (FF01::2).</span></span> <span data-ttu-id="e11b4-1200">Może też oczekiwać na adres multiemisji wszystkich węzłów (FF:: 1) dla okresowego urzędu rejestrowania z routerów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1200">Or it can wait on the all-node multicast address (FF::1) for a periodic RA from the routers.</span></span>

<span data-ttu-id="e11b4-1201">Komunikat urzędu rejestrowania zawiera informacje o prefiksie służące do konfigurowania adresu IPv6 dla tej sieci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1201">An RA message contains the prefix information for configuring an IPv6 address for that network.</span></span> <span data-ttu-id="e11b4-1202">W NetX Duo żądanie routera jest domyślnie włączone i można je wyłączyć przez ustawienie opcji konfiguracji \***NX_DISABLE_ICMPV6_ROUTER_SOLICITATION** _ w _ *_nx_user. h_* \*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1202">In NetX Duo, router solicitation is by default enabled and can be disabled by setting the configuration option ***NX_DISABLE_ICMPV6_ROUTER_SOLICITATION** _ in _*_nx_user.h_\*\*.</span></span> <span data-ttu-id="e11b4-1203">Aby uzyskać więcej informacji na temat ustawiania parametrów żądania routera, zobacz Opcje konfiguracji w rozdziale "Instalacja i użycie programu NetX Duo".</span><span class="sxs-lookup"><span data-stu-id="e11b4-1203">See Configuration Options in the "Installation and Use of NetX Duo" chapter for more details on setting Router Solicitation parameters.</span></span> 

<span data-ttu-id="e11b4-1204">***Odnajdywanie prefiksu***: urządzenie IPv6 używa odnajdywania prefiksów, aby dowiedzieć się, które hosty docelowe są dostępne bezpośrednio bez przechodzenia przez router.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1204">***Prefix Discovery***: An IPv6 device uses prefix discovery to learn which target hosts are accessible directly without going through a router.</span></span> <span data-ttu-id="e11b4-1205">Te informacje są udostępniane urządzeniu IPv6 z komunikatów urzędu rejestrowania z routera.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1205">This information is made available to the IPv6 device from RA messages from the router.</span></span> <span data-ttu-id="e11b4-1206">Urządzenie IPv6 zapisuje informacje o prefiksach w tabeli prefiksów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1206">The IPv6 device stores the prefix information in a prefix table.</span></span> <span data-ttu-id="e11b4-1207">Funkcja odnajdywania prefiksów dopasowuje prefiks z tabeli prefiksów urządzeń IPv6 do adresu docelowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1207">Prefix discovery is matching a prefix from the IPv6 device prefix table to a target address.</span></span> <span data-ttu-id="e11b4-1208">Prefiks jest zgodny z adresem docelowym, jeśli wszystkie bity w prefiksie pasują do najbardziej znaczących bitów adresu docelowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1208">A prefix matches a target address if all the bits in the prefix match the most significant bits of the target address.</span></span> <span data-ttu-id="e11b4-1209">Jeśli więcej niż jeden prefiks obejmuje adres, wybierany jest najdłuższy prefiks.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1209">If more than one prefix covers an address, the longest prefix is selected.</span></span>

### <a name="icmpv6-error-messages"></a><span data-ttu-id="e11b4-1210">Komunikaty o błędach ICMPv6</span><span class="sxs-lookup"><span data-stu-id="e11b4-1210">ICMPv6 Error Messages</span></span>    
<span data-ttu-id="e11b4-1211">W NetX Duo są obsługiwane następujące komunikaty o błędach ICMPv6:</span><span class="sxs-lookup"><span data-stu-id="e11b4-1211">The following ICMPv6 error messages are supported in NetX Duo:</span></span>  

- <span data-ttu-id="e11b4-1212">Miejsce docelowe jest nieosiągalne</span><span class="sxs-lookup"><span data-stu-id="e11b4-1212">Destination Unreachable</span></span>  
- <span data-ttu-id="e11b4-1213">Zbyt duży pakiet</span><span class="sxs-lookup"><span data-stu-id="e11b4-1213">Packet Too Big</span></span>  
- <span data-ttu-id="e11b4-1214">Czas przekroczenia</span><span class="sxs-lookup"><span data-stu-id="e11b4-1214">Time Exceed</span></span>  
- <span data-ttu-id="e11b4-1215">Problem z parametrem</span><span class="sxs-lookup"><span data-stu-id="e11b4-1215">Parameter Problem</span></span>  

## <a name="user-datagram-protocol-udp"></a><span data-ttu-id="e11b4-1216">User Datagram Protocol (UDP)</span><span class="sxs-lookup"><span data-stu-id="e11b4-1216">User Datagram Protocol (UDP)</span></span>

<span data-ttu-id="e11b4-1217">Protokół UDP (User Datagram Protocol) zapewnia najprostszą formę transferu danych między elementami członkowskimi sieci (RFC 768).</span><span class="sxs-lookup"><span data-stu-id="e11b4-1217">The User Datagram Protocol (UDP) provides the simplest form of data transfer between network members (RFC 768).</span></span> <span data-ttu-id="e11b4-1218">Pakiety danych UDP są wysyłane z jednego członka sieci do innego w najlepszym wysiłku. oznacza to, że nie ma wbudowanego mechanizmu potwierdzania przez odbiorcę pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1218">UDP data packets are sent from one network member to another in a best effort fashion; i.e., there is no built-in mechanism for acknowledgement by the packet recipient.</span></span> <span data-ttu-id="e11b4-1219">Ponadto wysyłanie pakietu UDP nie wymaga wcześniejszego nawiązania połączenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1219">In addition, sending a UDP packet does not require any connection to be established in advance.</span></span> <span data-ttu-id="e11b4-1220">Z tego powodu transmisja pakietów UDP jest bardzo wydajna.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1220">Because of this, UDP packet transmission is very efficient.</span></span>

<span data-ttu-id="e11b4-1221">Deweloperzy migrujeli aplikacje NetX do NetX Duo istnieją tylko pewne podstawowe zmiany w funkcji UDP między NetX i NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1221">For developers migrating their NetX applications to NetX Duo there are only a few basic changes in UDP functionality between NetX and NetX Duo.</span></span> <span data-ttu-id="e11b4-1222">Wynika to z tego, że protokół IPv6 jest przede wszystkim objęty podstawową warstwą IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1222">This is because IPv6 is primarily concerned with the underlying IP layer.</span></span> <span data-ttu-id="e11b4-1223">Wszystkie usługi UDP NetX Duo mogą być używane na potrzeby łączności IPv4 lub IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1223">All NetX Duo UDP services can be used for either IPv4 or IPv6 connectivity.</span></span>

### <a name="udp-header"></a><span data-ttu-id="e11b4-1224">Nagłówek UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1224">UDP Header</span></span>       
<span data-ttu-id="e11b4-1225">Protokół UDP umieszcza prosty nagłówek pakietu przed danymi aplikacji podczas transmisji i usuwa podobny nagłówek UDP z pakietu przy odbiorze przed dostarczeniem odebranego pakietu UDP do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1225">UDP places a simple packet header in front of the application's data on transmission, and removes a similar UDP header from the packet on reception before delivering a received UDP packet to the application.</span></span> <span data-ttu-id="e11b4-1226">Protokół UDP korzysta z protokołu IP do wysyłania i otrzymywania pakietów, co oznacza, że na początku nagłówka UDP znajduje się nagłówek IP, gdy pakiet znajduje się w sieci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1226">UDP utilizes the IP protocol for sending and receiving packets, which means there is an IP header in front of the UDP header when the packet is on the network.</span></span> <span data-ttu-id="e11b4-1227">Rysunek 12 przedstawia format nagłówka UDP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1227">Figure 12 shows the format of the UDP header.</span></span>

![Diagram formatu nagłówka UDP.](./media/user-guide/image21.png)

### <a name="figure-12-udp-header"></a><span data-ttu-id="e11b4-1229">RYSUNEK 12.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1229">FIGURE 12.</span></span> <span data-ttu-id="e11b4-1230">Nagłówek UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1230">UDP Header</span></span>

> [!NOTE]
> <span data-ttu-id="e11b4-1231">*Oczekuje się, że wszystkie nagłówki w implementacji protokołu UDP/IP mają być w formacie **big endian** . W tym formacie najbardziej znaczący bajt słowa znajduje się na najniższym adresie bajtowym.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-1231">*All headers in the UDP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="e11b4-1232">Poniżej opisano format nagłówka UDP:</span><span class="sxs-lookup"><span data-stu-id="e11b4-1232">The following describes the UDP header format:</span></span>

|<span data-ttu-id="e11b4-1233">Pole nagłówka</span><span class="sxs-lookup"><span data-stu-id="e11b4-1233">Header Field</span></span> |<span data-ttu-id="e11b4-1234">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="e11b4-1234">Purpose</span></span> |
|---|---|
|<span data-ttu-id="e11b4-1235">**16-bitowy numer portu źródłowego**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1235">**16-bit source port number**</span></span> |<span data-ttu-id="e11b4-1236">To pole zawiera port, z którego jest wysyłany pakiet UDP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1236">This field contains the port on which the UDP packet is being sent from.</span></span> <span data-ttu-id="e11b4-1237">Prawidłowe porty UDP mieszczą się w zakresie od 1 do 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1237">Valid UDP ports range from 1 through 0xFFFF.</span></span> |
|<span data-ttu-id="e11b4-1238">**16-bitowy numer portu docelowego**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1238">**16-bit destination port number**</span></span> |<span data-ttu-id="e11b4-1239">To pole zawiera port UDP, do którego jest wysyłany pakiet.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1239">This field contains the UDP port to which the packet is being sent to.</span></span> <span data-ttu-id="e11b4-1240">Prawidłowe porty UDP mieszczą się w zakresie od 1 do 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1240">Valid UDP ports range from 1 through 0xFFFF.</span></span> |
|<span data-ttu-id="e11b4-1241">**16-bitowa długość protokołu UDP**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1241">**16-bit UDP length**</span></span> |<span data-ttu-id="e11b4-1242">To pole zawiera liczbę bajtów w pakiecie UDP, w tym rozmiar nagłówka UDP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1242">This field contains the number of bytes in the UDP packet, including the size of the UDP header.</span></span> |
|<span data-ttu-id="e11b4-1243">**16-bitowa suma kontrolna UDP**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1243">**16-bit UDP checksum**</span></span> |<span data-ttu-id="e11b4-1244">To pole zawiera 16-bitową sumę kontrolną pakietu, w tym nagłówek UDP, obszar danych pakietu i nagłówek pseudo IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1244">This field contains the 16-bit checksum for the packet, including the UDP header, the packet data area, and the pseudo IP header.</span></span> |

### <a name="udp-enable"></a><span data-ttu-id="e11b4-1245">Włączanie protokołu UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1245">UDP Enable</span></span>   
<span data-ttu-id="e11b4-1246">Przed przekazaniem pakietów UDP aplikacja musi najpierw włączyć protokół UDP, wywołując usługę ***nx_udp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-1246">Before UDP packet transmission is possible, the application must first enable UDP by calling the ***nx_udp_enable*** service.</span></span> <span data-ttu-id="e11b4-1247">Po włączeniu aplikacja jest bezpłatna do wysyłania i odbierania pakietów UDP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1247">After enabled, the application is free to send and receive UDP packets.</span></span>  

### <a name="udp-socket-create"></a><span data-ttu-id="e11b4-1248">Tworzenie gniazda UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1248">UDP Socket Create</span></span>    
<span data-ttu-id="e11b4-1249">Gniazda UDP są tworzone podczas inicjowania lub podczas wykonywania przez wątki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1249">UDP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="e11b4-1250">Początkowy typ usługi, czas wygaśnięcia i głębokość kolejki odbierania są zdefiniowane przez usługę ***nx_udp_socket_create*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-1250">The initial type of service, time to live, and receive queue depth are defined by the ***nx_udp_socket_create*** service.</span></span> <span data-ttu-id="e11b4-1251">Liczba gniazd UDP w aplikacji nie jest ograniczona.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1251">There are no limits on the number of UDP sockets in an application.</span></span>

### <a name="udp-checksum"></a><span data-ttu-id="e11b4-1252">Suma kontrolna UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1252">UDP Checksum</span></span>   
<span data-ttu-id="e11b4-1253">Protokół IPv6 wymaga obliczeń sum kontrolnych nagłówka UDP w danych pakietu, natomiast w protokole IPv4, który jest opcjonalny.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1253">IPv6 protocol requires a UDP header checksum computation on packet data, whereas in the IPv4 protocol it is optional.</span></span>  

<span data-ttu-id="e11b4-1254">Protokół UDP określa 16-bitową sumę kontrolną, która pokrywa się z pseudo nagłówka adresu IP (składa się ze źródłowego adresu IP, docelowego adresu IP oraz słowa protokołu IP o długości), nagłówka UDP i danych pakietów UDP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1254">UDP specifies a one's complement 16-bit checksum that covers the IP pseudo header (consisting of the source IP address, destination IP address, and the protocol/length IP word), the UDP header, and the UDP packet data.</span></span> <span data-ttu-id="e11b4-1255">Jedyne różnice sum kontrolnych nagłówka pakietów UDP IPv4 i IPv6 polega na tym, że źródłowe i docelowe adresy IP są 32 bitowe w protokole IPv4, a w protokole IPv6 mają 128 bit.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1255">The only differences between IPv4 and IPv6 UDP packet header checksums is that the source and destination IP addresses are 32 bit in IPv4 while in IPv6 they are 128 bit.</span></span> <span data-ttu-id="e11b4-1256">Jeśli obliczona suma kontrolna UDP to 0, jest ona przechowywana jako wszystkie (0xFFFF).</span><span class="sxs-lookup"><span data-stu-id="e11b4-1256">If the calculated UDP checksum is 0, it is stored as all ones (0xFFFF).</span></span> <span data-ttu-id="e11b4-1257">Jeśli gniazdo wysyłania ma wyłączoną logikę sumy kontrolnej UDP, wartość zero jest umieszczana w polu sumy kontrolnej UDP, aby wskazać, że suma kontrolna nie została obliczona.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1257">If the sending socket has the UDP checksum logic disabled, a zero is placed in the UDP checksum field to indicate the checksum was not calculated.</span></span>

<span data-ttu-id="e11b4-1258">Jeśli suma kontrolna UDP nie jest zgodna z obliczoną sumą kontrolną przez odbiorcę, pakiet UDP jest po prostu odrzucony.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1258">If the UDP checksum does not match the computed checksum by the receiver, the UDP packet is simply discarded.</span></span>

<span data-ttu-id="e11b4-1259">W sieci IPv4 suma kontrolna UDP jest opcjonalna.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1259">On the IPv4 network, UDP checksum is optional.</span></span> <span data-ttu-id="e11b4-1260">NetX Duo umożliwia aplikacji Włączanie lub wyłączanie obliczeń sum kontrolnych UDP na podstawie gniazda.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1260">NetX Duo allows an application to enable or disable UDP checksum calculation on a per-socket basis.</span></span> <span data-ttu-id="e11b4-1261">Domyślnie logika sumy kontrolnej gniazda UDP jest włączona.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1261">By default, the UDP socket checksum logic is enabled.</span></span> <span data-ttu-id="e11b4-1262">Aplikacja może wyłączyć logikę sumy kontrolnej dla określonego gniazda UDP, wywołując usługę \***nx_udp_socket_checksum_disable** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1262">The application can disable checksum logic for a particular UDP socket by calling the \***nx_udp_socket_checksum_disable** _ service.</span></span> <span data-ttu-id="e11b4-1263">W sieci IPv6 jednak suma kontrolna UDP jest obowiązkowa.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1263">On the IPv6 network, however, UDP checksum is mandatory.</span></span> <span data-ttu-id="e11b4-1264">W związku z tym usługa _ *_nx_udp_socket_checksum_disable_*\* nie wyłączy logiki sum kontrolnych UDP podczas wysyłania pakietu za pomocą sieci IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1264">Therefore, the service _ *_nx_udp_socket_checksum_disable_*\* would not disable UDP checksum logic when sending a packet through the IPv6 network.</span></span>

<span data-ttu-id="e11b4-1265">Niektóre kontrolery Ethernet mogą generować sumę kontrolną UDP na bieżąco.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1265">Certain Ethernet controllers are able to generate the UDP checksum on the fly.</span></span> <span data-ttu-id="e11b4-1266">Jeśli system może korzystać z funkcji obliczeń sum kontrolnych sprzętowych, biblioteka NetX Duo może być skompilowana bez logiki sumy kontrolnej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1266">If the system is able to use hardware checksum computation feature, the NetX Duo library can be built without the checksum logic.</span></span> <span data-ttu-id="e11b4-1267">Aby wyłączyć sumę kontrolną oprogramowania UDP, biblioteka NetX Duo musi być skompilowana z następującymi zdefiniowanymi symbolami: ***NX_DISABLE_UDP_TX_CHECKSUM** _ i _*_NX_DISABLE_UDP_RX_CHECKSUM_\*_ (opisane w rozdziale dwa).</span><span class="sxs-lookup"><span data-stu-id="e11b4-1267">To disable UDP software checksum, the NetX Duo library must be built with the following symbols defined: ***NX_DISABLE_UDP_TX_CHECKSUM** _ and _*_NX_DISABLE_UDP_RX_CHECKSUM_\*_ (described in Chapter two).</span></span> <span data-ttu-id="e11b4-1268">Opcje konfiguracji usuwają logikę sum kontrolnych UDP z NetX Duo całkowicie, podczas gdy wywołanie _ *_nx_udp_socket_checksum_disable_*\* pozwala aplikacji wyłączyć przetwarzanie sum kontrolnych UDP protokołu IPv4 dla każdego gniazda.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1268">The configuration options remove UDP checksum logic from NetX Duo entirely, while calling the _ *_nx_udp_socket_checksum_disable_*\* service allows the application to disable IPv4 UDP checksum processing on a per socket basis.</span></span>

### <a name="udp-ports-and-binding"></a><span data-ttu-id="e11b4-1269">Porty i powiązania UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1269">UDP Ports and Binding</span></span>      
<span data-ttu-id="e11b4-1270">Port UDP jest logicznym punktem końcowym protokołu UDP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1270">A UDP port is a logical end point in the UDP protocol.</span></span> <span data-ttu-id="e11b4-1271">W składniku UDP programu NetX Duo istnieją 65 535 prawidłowe porty z zakresu od 1 do 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1271">There are 65,535 valid ports in the UDP component of NetX Duo, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="e11b4-1272">Aby wysłać lub odebrać dane UDP, aplikacja musi najpierw utworzyć gniazdo UDP, a następnie powiązać ją z żądanym portem.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1272">To send or receive UDP data, the application must first create a UDP socket, then bind it to a desired port.</span></span> <span data-ttu-id="e11b4-1273">Po powiązaniu gniazda UDP z portem aplikacja może wysyłać i odbierać dane w tym gnieździe.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1273">After binding a UDP socket to a port, the application may send and receive data on that socket.</span></span>

### <a name="udp-fast-pathtrade"></a><span data-ttu-id="e11b4-1274">Szybka ścieżka UDP&trade;</span><span class="sxs-lookup"><span data-stu-id="e11b4-1274">UDP Fast Path&trade;</span></span>   
<span data-ttu-id="e11b4-1275">Szybka ścieżka UDP &trade; to nazwa małej ścieżki narzutu na pakiety przez implementację protokołu UDP NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1275">The UDP Fast Path&trade; is the name for a low packet overhead path through the NetX Duo UDP implementation.</span></span> <span data-ttu-id="e11b4-1276">Wysyłanie pakietu UDP wymaga tylko kilku wywołań funkcji: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_ i ostatecznego wywołania sterownika sieci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1276">Sending a UDP packet requires just a few function calls: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_, and the eventual call to the network driver.</span></span> <span data-ttu-id="e11b4-1277">_*_nx_udp_socket_send_*_ jest dostępny w NetX Duo dla istniejących aplikacji NetX i ma zastosowanie tylko w przypadku pakietów IPv4.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1277">_*_nx_udp_socket_send_*_ is available in NetX Duo for existing NetX applications and is only applicable for IPv4 packets.</span></span> <span data-ttu-id="e11b4-1278">Preferowaną metodą jest jednak użycie _ *_nxd_udp_socket_send_*\* usługi omówionej poniżej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1278">The preferred method, however, is to use _ *_nxd_udp_socket_send_*\* service discussed below.</span></span> <span data-ttu-id="e11b4-1279">W przypadku odbierania pakietów UDP pakiet UDP jest umieszczany w odpowiedniej kolejce odbioru gniazda UDP lub dostarczany do zawieszonego wątku aplikacji w ramach pojedynczego wywołania funkcji z przetwarzania przerwań odbieranych przez sterownik sieciowy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1279">On UDP packet reception, the UDP packet is either placed on the appropriate UDP socket receive queue or delivered to a suspended application thread in a single function call from the network driver's receive interrupt processing.</span></span> <span data-ttu-id="e11b4-1280">Ta wysoce zoptymalizowana logika do wysyłania i otrzymywania pakietów UDP jest istotą technologii szybkiego ścieżki UDP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1280">This highly optimized logic for sending and receiving UDP packets is the essence of UDP Fast Path technology.</span></span>  

### <a name="udp-packet-send"></a><span data-ttu-id="e11b4-1281">Wysyłanie pakietów UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1281">UDP Packet Send</span></span>    
<span data-ttu-id="e11b4-1282">Wysyłanie danych UDP za pośrednictwem protokołu IPv6 lub sieci IPv4 jest łatwo realizowane przez wywołanie funkcji \***nxd_udp_socket_send** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1282">Sending UDP data over IPv6 or IPv4 networks is easily accomplished by calling the \***nxd_udp_socket_send** _ function.</span></span> <span data-ttu-id="e11b4-1283">Obiekt wywołujący musi ustawić wersję protokołu IP w polu _nx_ip_version \* parametru wskaźnika NXD_ADDRESS.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1283">The caller must set the IP version in the _nx_ip_version\* field of the NXD_ADDRESS pointer parameter.</span></span> <span data-ttu-id="e11b4-1284">NetX Duo określi najlepszy adres źródłowy przesyłanych pakietów UDP na podstawie docelowego adresu IPv4/IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1284">NetX Duo will determine the best source address for transmitted UDP packets based on the destination IPv4/IPv6 address.</span></span> <span data-ttu-id="e11b4-1285">Ta usługa umieszcza nagłówek UDP przed danymi pakietu i wysyła je do sieci przy użyciu procedury wysyłania wewnętrznego adresu IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1285">This service places a UDP header in front of the packet data and sends it out onto the network using an internal IP send routine.</span></span> <span data-ttu-id="e11b4-1286">Nie ma zawieszania wątku podczas wysyłania pakietów UDP, ponieważ wszystkie transporty pakietów UDP są przetwarzane natychmiast.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1286">There is no thread suspension on sending UDP packets because all UDP packet transmissions are processed immediately.</span></span> 

<span data-ttu-id="e11b4-1287">W przypadku docelowych multiemisji lub emisji aplikacja powinna określić źródłowy adres IP, który ma być używany, jeśli urządzenie NetX Duo ma wiele adresów IP do wyboru.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1287">For multicast or broadcast destinations, the application should specify the source IP address to use if the NetX Duo device has multiple IP addresses to choose from.</span></span> <span data-ttu-id="e11b4-1288">Można to zrobić za pomocą usług ***nxd_udp_socket_source_send.***</span><span class="sxs-lookup"><span data-stu-id="e11b4-1288">This can be done with the services ***nxd_udp_socket_source_send.***</span></span>

> [!IMPORTANT]    
> <span data-ttu-id="e11b4-1289">*Jeśli **nx_udp_socket_send** jest używany do przesyłania pakietów multiemisji lub emisji, adres IP pierwszego włączonego interfejsu jest używany jako adres źródłowy*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1289">*If **nx_udp_socket_send** is used for transmitting multicast or broadcast packets, the IP address of the first enabled interface is used as source address*.</span></span>

> [!NOTE] 
> <span data-ttu-id="e11b4-1290">*Jeśli dla tego gniazda jest włączona logika sumy kontrolnej UDP, operacja sumy kontrolnej jest wykonywana w kontekście wątku wywołującego bez blokowania dostępu do struktur danych protokołu UDP lub IP*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1290">*If UDP checksum logic is enabled for this socket, the checksum operation is performed in the context of the calling thread, without blocking access to the UDP or IP data structures*.</span></span> 

> [!WARNING]    
> <span data-ttu-id="e11b4-1291">*Dane ładunku UDP znajdujące się w strukturze NX_PACKET powinny znajdować się na granicy długiego wyrazu. Aplikacja musi pozostawić wystarczającą ilość miejsca między wskaźnikiem dołączania i wskaźnikiem rozpoczęcia danych dla NetX Duo, aby umieścić nagłówki UDP, IP i nośnika fizycznego*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1291">*The UDP payload data residing in the NX_PACKET structure should reside on a long-word boundary. The application needs to leave sufficient space between the prepend pointer and the data start pointer for NetX Duo to place the UDP, IP, and physical media headers*.</span></span>

### <a name="udp-packet-receive"></a><span data-ttu-id="e11b4-1292">Odbieranie pakietów UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1292">UDP Packet Receive</span></span>    
<span data-ttu-id="e11b4-1293">Wątki aplikacji mogą odbierać pakiety UDP z określonego gniazda przez wywołanie ***nx_udp_socket_receive***.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1293">Application threads may receive UDP packets from a particular socket by calling ***nx_udp_socket_receive***.</span></span> <span data-ttu-id="e11b4-1294">Funkcja odbioru gniazda udostępnia najstarszy pakiet w kolejce odbioru gniazda.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1294">The socket receive function delivers the oldest packet on the socket's receive queue.</span></span> <span data-ttu-id="e11b4-1295">Jeśli w kolejce odbierania nie ma pakietów, wątek wywołujący może zawiesić (z opcjonalnym limitem czasu) do momentu otrzymania pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1295">If there are no packets on the receive queue, the calling thread can suspend (with an optional timeout) until a packet arrives.</span></span>

<span data-ttu-id="e11b4-1296">Przetwarzanie pakietów protokołu UDP odbierane (zwykle wywoływane z procedury obsługi przerwania odbierania przez sterownik sieciowy) jest odpowiedzialne za umieszczenie pakietu w kolejce odbioru gniazda UDP lub dostarczenie go do pierwszego wstrzymanego wątku oczekującego na pakiet.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1296">The UDP receive packet processing (usually called from the network driver's receive interrupt handler) is responsible for either placing the packet on the UDP socket's receive queue or delivering it to the first suspended thread waiting for a packet.</span></span> <span data-ttu-id="e11b4-1297">Jeśli pakiet jest umieszczany w kolejce, przetwarzanie odbiera również sprawdza maksymalną głębokość kolejki odbierania skojarzoną z gniazdem.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1297">If the packet is queued, the receive processing also checks the maximum receive queue depth associated with the socket.</span></span> <span data-ttu-id="e11b4-1298">Jeśli ten nowo umieszczony w kolejce pakiet przekracza głębokość kolejki, najstarszy pakiet w kolejce zostanie odrzucony.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1298">If this newly queued packet exceeds the queue depth, the oldest packet in the queue is discarded.</span></span>

### <a name="udp-receive-notify"></a><span data-ttu-id="e11b4-1299">Powiadomienie o odebraniu protokołu UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1299">UDP Receive Notify</span></span>   
<span data-ttu-id="e11b4-1300">Jeśli wątek aplikacji musi przetwarzać odebrane dane z więcej niż jednego gniazda, należy użyć funkcji ***nx_udp_socket_receive_notify*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-1300">If the application thread needs to process received data from more than one socket, the ***nx_udp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="e11b4-1301">Ta funkcja rejestruje funkcję odbierania pakietów wywołania zwrotnego dla gniazda.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1301">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="e11b4-1302">Za każdym razem, gdy pakiet jest odbierany w gnieździe, funkcja wywołania zwrotnego jest wykonywana.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1302">Whenever a packet is received on the socket, the callback function is executed.</span></span>

<span data-ttu-id="e11b4-1303">Zawartość funkcji wywołania zwrotnego to applicationspecific; jednak najprawdopodobniej zawiera logikę do informowania wątku przetwarzania, że pakiet jest teraz dostępny w odpowiednim gnieździe.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1303">The contents of the callback function is applicationspecific; however, it would most likely contain logic to inform the processing thread that a packet is now available on the corresponding socket.</span></span>

### <a name="peer-address-and-port"></a><span data-ttu-id="e11b4-1304">Adres i port elementu równorzędnego</span><span class="sxs-lookup"><span data-stu-id="e11b4-1304">Peer Address and Port</span></span>   
<span data-ttu-id="e11b4-1305">W przypadku odebrania pakietu UDP aplikacja może znaleźć adres IP i numer portu nadawcy przy użyciu ***nx_udp_packet_info_extract*** usługi.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1305">On receiving a UDP packet, application may find the sender's IP address and port number by using the service ***nx_udp_packet_info_extract***.</span></span> <span data-ttu-id="e11b4-1306">Po pomyślnym powrocie usługa ta udostępnia informacje o adresie IP nadawcy, numerze portu nadawcy i interfejsie lokalnym, za pomocą którego został odebrany pakiet.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1306">On successful return, this service provides information on the sender's IP address, sender's port number, and the local interface through which the packet was received.</span></span>  

### <a name="thread-suspension"></a><span data-ttu-id="e11b4-1307">Zawieszenie wątku</span><span class="sxs-lookup"><span data-stu-id="e11b4-1307">Thread Suspension</span></span>   
<span data-ttu-id="e11b4-1308">Jak wspomniano wcześniej, wątki aplikacji mogą wstrzymywać się podczas próby odebrania pakietu UDP na określonym porcie UDP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1308">As mentioned previously, application threads can suspend while attempting to receive a UDP packet on a particular UDP port.</span></span> <span data-ttu-id="e11b4-1309">Po odebraniu pakietu na tym porcie jest on przyznany do pierwszego wątku, a następnie wznowiony.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1309">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="e11b4-1310">Opcjonalny limit czasu jest dostępny w przypadku zawieszania pakietu odbioru protokołu UDP, który jest funkcją dostępną dla większości usług NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1310">An optional timeout is available when suspending on a UDP receive packet, a feature available for most NetX Duo services.</span></span>  

### <a name="udp-socket-statistics-and-errors"></a><span data-ttu-id="e11b4-1311">Statystyka i błędy gniazda UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1311">UDP Socket Statistics and Errors</span></span>     
<span data-ttu-id="e11b4-1312">Jeśli ta opcja jest włączona, oprogramowanie Socket NetX Duo UDP śledzi kilka statystyk i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1312">If enabled, the NetX Duo UDP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="e11b4-1313">Dla każdego wystąpienia protokołu IP/UDP są obsługiwane następujące raporty statystyczne i błędy:</span><span class="sxs-lookup"><span data-stu-id="e11b4-1313">The following statistics and error reports are maintained for each IP/UDP instance:</span></span>

- <span data-ttu-id="e11b4-1314">Całkowita liczba wysłanych pakietów UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1314">Total UDP Packets Sent</span></span>  
- <span data-ttu-id="e11b4-1315">Całkowita liczba wysłanych bajtów UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1315">Total UDP Bytes Sent</span></span>  
- <span data-ttu-id="e11b4-1316">Całkowita liczba odebranych pakietów UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1316">Total UDP Packets Received</span></span>   
- <span data-ttu-id="e11b4-1317">Całkowita liczba odebranych bajtów UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1317">Total UDP Bytes Received</span></span>  
- <span data-ttu-id="e11b4-1318">Całkowita liczba nieprawidłowych pakietów UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1318">Total UDP Invalid Packets</span></span>  
- <span data-ttu-id="e11b4-1319">Całkowita liczba porzuconych pakietów odbioru protokołu UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1319">Total UDP Receive Packets Dropped</span></span>  
- <span data-ttu-id="e11b4-1320">Łączne błędy sum kontrolnych odbierania UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1320">Total UDP Receive Checksum Errors</span></span>  
- <span data-ttu-id="e11b4-1321">Wysłane pakiety gniazd UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1321">UDP Socket Packets Sent</span></span>  
- <span data-ttu-id="e11b4-1322">Wysłane bajty gniazda UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1322">UDP Socket Bytes Sent</span></span>  
- <span data-ttu-id="e11b4-1323">Odebrane pakiety UDP Socket</span><span class="sxs-lookup"><span data-stu-id="e11b4-1323">UDP Socket Packets Received</span></span>   
- <span data-ttu-id="e11b4-1324">Odebrane bajty gniazda UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1324">UDP Socket Bytes Received</span></span>  
- <span data-ttu-id="e11b4-1325">Pakiety gniazd UDP w kolejce</span><span class="sxs-lookup"><span data-stu-id="e11b4-1325">UDP Socket Packets Queued</span></span>  
- <span data-ttu-id="e11b4-1326">Odebrane pakiety UDP w gnieździe</span><span class="sxs-lookup"><span data-stu-id="e11b4-1326">UDP Socket Receive Packets Dropped</span></span>  
- <span data-ttu-id="e11b4-1327">Błędy sum kontrolnych gniazda UDP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1327">UDP Socket Checksum Errors</span></span>  

<span data-ttu-id="e11b4-1328">Wszystkie te statystyki i raporty o błędach są dostępne dla aplikacji z usługą ***nx_udp_info_get** _ dla statystyk UDP amassed za pośrednictwem wszystkich gniazd UDP i _ *_nx_udp_socket_info_get_** usługi dla statystyk UDP w określonym gnieździe UDP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1328">All these statistics and error reports are available to the application with the ***nx_udp_info_get** _ service for UDP statistics amassed over all UDP sockets, and the _ *_nx_udp_socket_info_get_** service for UDP statistics on the specified UDP socket.</span></span>

### <a name="udp-socket-control-block-nx_udp_socket"></a><span data-ttu-id="e11b4-1329">Blok sterowania gniazdem UDP NX_UDP_SOCKET</span><span class="sxs-lookup"><span data-stu-id="e11b4-1329">UDP Socket Control Block NX_UDP_SOCKET</span></span>
<span data-ttu-id="e11b4-1330">Cechy poszczególnych gniazd UDP są dostępne w skojarzonym bloku sterowania NX_UDP_SOCKET.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1330">The characteristics of each UDP socket are found in the associated NX_UDP_SOCKET control block.</span></span> <span data-ttu-id="e11b4-1331">Zawiera użyteczne informacje, takie jak link do struktury danych IP, interfejs sieciowy dla ścieżki wysyłania i odbierania, port powiązany i kolejka odbierania pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1331">It contains useful information such as the link to the IP data structure, the network interface for the sending and receiving paths, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="e11b4-1332">Ta struktura jest zdefiniowana w pliku ***nx_api. h*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-1332">This structure is defined in the ***nx_api.h*** file.</span></span>

## <a name="transmission-control-protocol-tcp"></a><span data-ttu-id="e11b4-1333">Transmission Control Protocol (TCP)</span><span class="sxs-lookup"><span data-stu-id="e11b4-1333">Transmission Control Protocol (TCP)</span></span>

<span data-ttu-id="e11b4-1334">Transmission Control Protocol (TCP) zapewnia niezawodny transfer danych przesyłanych strumieniowo między dwoma członkami sieci (RFC 793).</span><span class="sxs-lookup"><span data-stu-id="e11b4-1334">The Transmission Control Protocol (TCP) provides reliable stream data transfer between two network members (RFC 793).</span></span> <span data-ttu-id="e11b4-1335">Wszystkie dane wysyłane z jednego członka sieci są weryfikowane i potwierdzane przez element członkowski odbiorcy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1335">All data sent from one network member are verified and acknowledged by the receiving member.</span></span> <span data-ttu-id="e11b4-1336">Ponadto dwóch członków musi nawiązać połączenie przed jakimkolwiek transferem danych.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1336">In addition, the two members must have established a connection prior to any data transfer.</span></span> <span data-ttu-id="e11b4-1337">Wszystkie te wyniki są niezawodnym transferem danych; jednak wymaga to znacznie więcej obciążenia niż poprzednio opisany w tym transfer danych UDP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1337">All this results in reliable data transfer; however, it does require substantially more overhead than the previously described UDP data transfer.</span></span>

<span data-ttu-id="e11b4-1338">Z wyjątkiem sytuacji, w których nie wprowadzono żadnych zmian w usługach interfejsu API protokołu TCP między NetX i NetX Duo, ponieważ protokół IPv6 jest głównie objęty podstawową warstwą IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1338">Except where noted, there are no changes in TCP protocol API services between NetX and NetX Duo because IPv6 is primarily concerned with the underlying IP layer.</span></span> <span data-ttu-id="e11b4-1339">Wszystkie usługi TCP NetX Duo mogą być używane dla połączeń IPv4 lub IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1339">All NetX Duo TCP services can be used for either IPv4 or IPv6 connections.</span></span>

### <a name="tcp-header"></a><span data-ttu-id="e11b4-1340">Nagłówek TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1340">TCP Header</span></span>   
<span data-ttu-id="e11b4-1341">W przypadku przesyłania nagłówek TCP jest umieszczany przed danymi od użytkownika.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1341">On transmission, TCP header is placed in front of the data from the user.</span></span> <span data-ttu-id="e11b4-1342">Przy odbiorze nagłówek TCP zostaje usunięty z przychodzącego pakietu, pozostawiając tylko te dane użytkownika, które są dostępne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1342">On reception, TCP header is removed from the incoming packet, leaving only the user data available to the application.</span></span> <span data-ttu-id="e11b4-1343">Protokół TCP korzysta z protokołu IP do wysyłania i odbierania pakietów, co oznacza, że na początku nagłówka TCP znajduje się nagłówek IP, gdy pakiet znajduje się w sieci.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1343">TCP utilizes the IP protocol to send and receive packets, which means there is an IP header in front of the TCP header when the packet is on the network.</span></span> <span data-ttu-id="e11b4-1344">Rysunek 13 przedstawia format nagłówka TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1344">Figure 13 shows the format of the TCP header.</span></span>

![Diagram formatu nagłówka TCP.](./media/user-guide/image22.png)

### <a name="figure-13-tcp-header"></a><span data-ttu-id="e11b4-1346">RYSUNEK 13.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1346">FIGURE 13.</span></span> <span data-ttu-id="e11b4-1347">Nagłówek TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1347">TCP Header</span></span>

<span data-ttu-id="e11b4-1348">Poniżej opisano format nagłówka TCP:</span><span class="sxs-lookup"><span data-stu-id="e11b4-1348">The following describes the TCP header format:</span></span>

|<span data-ttu-id="e11b4-1349">&nbsp;Pole nagłówka</span><span class="sxs-lookup"><span data-stu-id="e11b4-1349">Header&nbsp;Field</span></span> |<span data-ttu-id="e11b4-1350">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="e11b4-1350">Purpose</span></span> |
|------|------|
| <span data-ttu-id="e11b4-1351">**16-bitowy numer portu źródłowego**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1351">**16-bit source port number**</span></span> | <span data-ttu-id="e11b4-1352">To pole zawiera port, na którym jest wysyłany pakiet TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1352">This field contains the port the TCP packet is being sent out on.</span></span> <span data-ttu-id="e11b4-1353">Prawidłowe porty TCP mieszczą się w zakresie od 1 do 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1353">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="e11b4-1354">**16-bitowy port docelowy**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1354">**16-bit destination port**</span></span> | <span data-ttu-id="e11b4-1355">To pole zawiera port TCP, na który jest wysyłany pakiet.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1355">This field contains the TCP port the packet is being sent to.</span></span> <span data-ttu-id="e11b4-1356">Prawidłowe porty TCP mieszczą się w zakresie od 1 do 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1356">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="e11b4-1357">**32-bitowy numer sekwencji**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1357">**32-bit sequence number**</span></span> | <span data-ttu-id="e11b4-1358">To pole zawiera numer sekwencyjny dla danych wysyłanych z tego końca połączenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1358">This field contains the sequence number for data sent from this end of the connection.</span></span> <span data-ttu-id="e11b4-1359">Oryginalna sekwencja jest określana podczas początkowej sekwencji połączeń między dwoma węzłami TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1359">The original sequence is established during the initial connection sequence between two TCP nodes.</span></span> <span data-ttu-id="e11b4-1360">Każdy transfer danych od tego momentu powoduje zwiększenie liczby sekwencji o ilość wysłanych bajtów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1360">Every data transfer from that point results in an increment of the sequence number by the amount bytes sent.</span></span> |
| <span data-ttu-id="e11b4-1361">**32-bitowy numer potwierdzenia**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1361">**32-bit acknowledgement number**</span></span> | <span data-ttu-id="e11b4-1362">To pole zawiera numer sekwencyjny odpowiadający ostatniemu bajtowi odebranemu po tej stronie połączenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1362">This field contains the sequence number corresponding to the last byte received by this side of the connection.</span></span> <span data-ttu-id="e11b4-1363">Służy do określenia, czy dane wysłane wcześniej zostały pomyślnie odebrane przez inne zakończenie połączenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1363">This is used to determine whether or not data previously sent has successfully been received by the other end of the connection.</span></span> |
| <span data-ttu-id="e11b4-1364">**4-bitowa Długość nagłówka**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1364">**4-bit header length**</span></span> | <span data-ttu-id="e11b4-1365">To pole zawiera liczbę 32-bitowych wyrazów w nagłówku TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1365">This field contains the number of 32-bit words in the TCP header.</span></span> <span data-ttu-id="e11b4-1366">Jeśli w nagłówku TCP nie ma żadnych opcji, to pole ma wartość 5.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1366">If no options are present in the TCP header, this field is 5.</span></span> |
| <span data-ttu-id="e11b4-1367">**6-bitowe bity kodu**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1367">**6-bit code bits**</span></span> |<span data-ttu-id="e11b4-1368">To pole zawiera sześć różnych bitów kodu używanych do wskazywania różnych informacji o kontroli skojarzonych z połączeniem.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1368">This field contains the six different code bits used to indicate various control information associated with the connection.</span></span> <span data-ttu-id="e11b4-1369">Bity sterujące są zdefiniowane w następujący sposób: <br \> -URG (21): pilne presen danych<br \> -ACK (20): numer potwierdzenia jest prawidłowy<br \> -PSH — (19): należy bezpośrednio obsłużyć te dane<br \> -RST (18): Resetowanie połączenia<br \> -syn (17): synchronizacja numerów sekwencyjnych (użytych do ustanowienia połączenia) <br \> -FIN (16): nadawca zakończył przesyłanie</span><span class="sxs-lookup"><span data-stu-id="e11b4-1369">The control bits are defined as follows:<br \> - URG (21): Urgent data presen<br \> - ACK (20): Acknowledgement number is valid<br \> - PSH (19): Handle this data immediately<br \> - RST (18): Reset the connection<br \> - SYN (17): Synchronize sequence numbers (used to establish connection)<br \> - FIN (16): Sender is finished with transmit (used to close connection)</span></span> |
|<span data-ttu-id="e11b4-1370">**okno 16-bitowe**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1370">**16-bit window**</span></span> |<span data-ttu-id="e11b4-1371">To pole jest używane do sterowania przepływem.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1371">This field is used for flow control.</span></span> <span data-ttu-id="e11b4-1372">Zawiera ilość bajtów, które gniazdo może obecnie odbierać.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1372">It contains the amount of bytes the socket can currently receive.</span></span> <span data-ttu-id="e11b4-1373">Ta w istocie jest używana do sterowania przepływem.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1373">This basically is used for flow control.</span></span> <span data-ttu-id="e11b4-1374">Nadawca jest odpowiedzialny za upewnienie się, że dane do wysłania mieszczą się w oknie anonsowanym odbiorcy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1374">The sender is responsible for making sure the data to send will fit into the receiver's advertised window.</span></span> |
|<span data-ttu-id="e11b4-1375">**16-bitowa suma kontrolna TCP**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1375">**16-bit TCP checksum**</span></span> |<span data-ttu-id="e11b4-1376">To pole zawiera 16-bitową sumę kontrolną pakietu, w tym nagłówek TCP, obszar danych pakietu i nagłówek pseudo IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1376">This field contains the 16-bit checksum for the packet including the TCP header, the packet data area, and the pseudo IP header.</span></span> |
|<span data-ttu-id="e11b4-1377">**16-bitowy wskaźnik pilny**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1377">**16-bit urgent pointer**</span></span> |<span data-ttu-id="e11b4-1378">To pole zawiera dodatnie przesunięcie ostatniego bajtu pilnych danych.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1378">This field contains the positive offset of the last byte of the urgent data.</span></span> <span data-ttu-id="e11b4-1379">To pole jest prawidłowe tylko wtedy, gdy w nagłówku jest ustawiony bit kodu URG.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1379">This field is only valid if the URG code bit is set in the header.</span></span> |

> [!NOTE]  
> <span data-ttu-id="e11b4-1380">*Oczekuje się, że wszystkie nagłówki w implementacji TCP/IP mają być w formacie **big endian** . W tym formacie najbardziej znaczący bajt słowa znajduje się na najniższym adresie bajtowym*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1380">*All headers in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address*.</span></span>

### <a name="tcp-enable"></a><span data-ttu-id="e11b4-1381">Włączanie protokołu TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1381">TCP Enable</span></span>       
<span data-ttu-id="e11b4-1382">Przed przystąpieniem do połączeń TCP i przesyłania pakietów aplikacja musi najpierw włączyć protokół TCP, wywołując usługę ***nx_tcp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-1382">Before TCP connections and packet transmissions are possible, the application must first enable TCP by calling the ***nx_tcp_enable*** service.</span></span> <span data-ttu-id="e11b4-1383">Po włączeniu aplikacja jest bezpłatna, aby uzyskać dostęp do wszystkich usług TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1383">After enabled, the application is free to access all TCP services.</span></span>  

### <a name="tcp-socket-create"></a><span data-ttu-id="e11b4-1384">Tworzenie gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1384">TCP Socket Create</span></span>    
<span data-ttu-id="e11b4-1385">Gniazda TCP są tworzone podczas inicjowania lub podczas wykonywania przez wątki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1385">TCP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="e11b4-1386">Początkowy typ usługi, czas wygaśnięcia i rozmiar okna są zdefiniowane przez usługę ***nx_tcp_socket_create*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-1386">The initial type of service, time to live, and window size are defined by the ***nx_tcp_socket_create*** service.</span></span> <span data-ttu-id="e11b4-1387">W aplikacji nie ma ograniczeń dotyczących liczby gniazd TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1387">There are no limits on the number of TCP sockets in an application.</span></span>  

### <a name="tcp-checksum"></a><span data-ttu-id="e11b4-1388">Suma kontrolna TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1388">TCP Checksum</span></span>     
<span data-ttu-id="e11b4-1389">Protokół TCP określa 16-bitową sumę kontrolną, która pokrywa się z pseudo nagłówka IP (składa się ze źródłowego adresu IP, docelowego adresu IP oraz słowa IP protokołu/długości), nagłówka TCP i danych pakietu TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1389">TCP specifies a one's complement 16-bit checksum that covers the IP pseudo header, (consisting of the source IP address, destination IP address, and the protocol/length IP word), the TCP header, and the TCP packet data.</span></span> <span data-ttu-id="e11b4-1390">Jedyną różnicą sum kontrolnych nagłówka pakietów TCP i IPv6 jest to, że źródłowy i docelowy adres IP to 32 bit w IPv4 i 128 bit w protokole IPv6.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1390">The only difference between IPv4 and IPv6 TCP packet header checksums is that the source and destination IP addresses are 32 bit in IPv4 and 128 bit in IPv6.</span></span> 

<span data-ttu-id="e11b4-1391">Niektóre kontrolery sieci mogą wykonywać obliczenia sum kontrolnych TCP i walidację sprzętu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1391">Certain network controllers are able to perform TCP checksum computation and validation in hardware.</span></span> <span data-ttu-id="e11b4-1392">W przypadku takich systemów aplikacje mogą chcieć używać logiki sum kontrolnych sprzętowych, jak to możliwe, aby zmniejszyć obciążenie środowiska uruchomieniowego.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1392">For such systems, applications may want to use hardware checksum logic as much as possible to reduce runtime overhead.</span></span> <span data-ttu-id="e11b4-1393">Aplikacje mogą wyłączyć logikę obliczeń sum kontrolnych protokołu TCP z biblioteki NetX Duo w czasie kompilacji, definiując \***NX_DISABLE_TCP_TX_CHECKSUM** _ i _ *_NX_DISABLE_TCP_RX_CHECKSUM_* \*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1393">Applications may disable TCP checksum computation logic from the NetX Duo library altogether at build time by defining ***NX_DISABLE_TCP_TX_CHECKSUM** _ and _*_NX_DISABLE_TCP_RX_CHECKSUM_\*\*.</span></span> <span data-ttu-id="e11b4-1394">W ten sposób kod sumy kontrolnej protokołu TCP nie jest kompilowany w.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1394">This way, the TCP checksum code is not compiled in.</span></span> <span data-ttu-id="e11b4-1395">Jednak należy zachować ostrożność, jeśli zainstalowano opcjonalny pakiet IPsec NetX Duo, a połączenie TCP może wymagać przechodzenia przez bezpieczny kanał.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1395">However one should exercise caution if the optional NetX Duo IPsec package is installed, and the TCP connection may need to traverse through a secure channel.</span></span> <span data-ttu-id="e11b4-1396">W takim przypadku dane w pakietach należących do połączenia TCP są już zaszyfrowane i większość sprzętowych modułów sumy kontrolnej TCP znajdujących się w sterowniku sieciowym nie jest w stanie wygenerować prawidłowej wartości sumy kontrolnej z zaszyfrowanego ładunku TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1396">In this case, data in packets belonging to the TCP connection is already encrypted, and most hardware TCP checksum modules present in the network driver are unable to generate correct checksum value from the encrypted TCP payload.</span></span>

<span data-ttu-id="e11b4-1397">Aby rozwiązać ten problem, aplikacja utrzymuje logikę sum kontrolnych TCP dostępną w bibliotece i używa funkcji interfejsu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1397">To address this issue, application shall keep the TCP checksum logic available in the library and use the interface capability feature.</span></span> <span data-ttu-id="e11b4-1398">W przypadku włączenia funkcji interfejsu w module TCP jest znane, jak prawidłowo obsługiwać sumę kontrolną TCP, jeśli sterownik może również obliczyć sumę kontrolną:</span><span class="sxs-lookup"><span data-stu-id="e11b4-1398">With interface capability feature enabled, the TCP module knows how to properly handle the TCP checksum if the driver is also able to compute the checksum value:</span></span>

1) <span data-ttu-id="e11b4-1399">Jeśli pakiet TCP nie podlega procesowi IPsec, sprzęt interfejsu sieciowego może obliczyć sumę kontrolną.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1399">If the TCP packet is not subject to IPsec process, the network interface hardware is able to compute the checksum.</span></span> <span data-ttu-id="e11b4-1400">W związku z tym moduł TCP nie próbuje obliczyć sumy kontrolnej;</span><span class="sxs-lookup"><span data-stu-id="e11b4-1400">Therefore the TCP module does not attempt to compute the checksum;</span></span>

2) <span data-ttu-id="e11b4-1401">Jeśli pakiet protokołu IPsec jest zainstalowany, a pakiet TCP podlega procesowi IPsec, moduł TCP oblicza sumę kontrolną w oprogramowaniu przed wysłaniem pakietu do warstwy protokołu IPsec.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1401">If IPsec package is installed, and the TCP packet is subject to IPsec process, the TCP module computes checksum in software before sending the packet to IPsec layer.</span></span>

### <a name="tcp-port"></a><span data-ttu-id="e11b4-1402">Port TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1402">TCP Port</span></span>     
<span data-ttu-id="e11b4-1403">Port TCP jest logicznym punktem połączenia w protokole TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1403">A TCP port is a logical connection point in the TCP protocol.</span></span> <span data-ttu-id="e11b4-1404">W składniku TCP programu NetX Duo istnieją 65 535 prawidłowe porty z zakresu od 1 do 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1404">There are 65,535 valid ports in the TCP component of NetX Duo, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="e11b4-1405">W przeciwieństwie do protokołu UDP, w którym dane z jednego portu mogą być wysyłane do dowolnego innego portu docelowego, port TCP jest połączony z innym określonym portem TCP i tylko wtedy, gdy połączenie jest nawiązywane, może mieć miejsce transfer danych — i tylko między dwoma portami.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1405">Unlike UDP in which data from one port can be sent to any other destination port, a TCP port is connected to another specific TCP port, and only when this connection is established can any data transfer take place—and only between the two ports making up the connection.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e11b4-1406">*Porty TCP są całkowicie oddzielone od portów UDP, np. numer portu UDP 1 nie ma powiązania z portem TCP o numerze 1*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1406">*TCP ports are completely separate from UDP ports; e.g., UDP port number 1 has no relation to TCP port number 1*.</span></span>

### <a name="client-server-model"></a><span data-ttu-id="e11b4-1407">Model Client-Server</span><span class="sxs-lookup"><span data-stu-id="e11b4-1407">Client-Server Model</span></span>     
<span data-ttu-id="e11b4-1408">Aby można było korzystać z protokołu TCP na potrzeby transferu danych, należy najpierw nawiązać połączenie między dwoma gniazdami TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1408">To use TCP for data transfer, a connection must first be established between the two TCP sockets.</span></span> <span data-ttu-id="e11b4-1409">Ustanowienie połączenia odbywa się na serwerze klienta.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1409">The establishment of the connection is done in a client-server fashion.</span></span> <span data-ttu-id="e11b4-1410">Po stronie klienta połączenia znajduje się Strona, która inicjuje połączenie, a po stronie serwera po prostu czeka na żądania połączenia klienta przed ukończeniem przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1410">The client side of the connection is the side that initiates the connection, while the server side simply waits for client connection requests before any processing is done.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e11b4-1411">*W przypadku urządzeń z wieloma lokalizacjami funkcja NetX Duo automatycznie określa adres źródłowy do użycia w połączeniu, a adres następnego przeskoku na podstawie docelowego adresu IP połączenia. Ponieważ protokół TCP jest ograniczony do wysyłania pakietów do emisji pojedynczej (np. "nieemisyjne") adresów docelowych, NetX Duo nie wymaga "podpowiedzi" do wybierania źródłowego adresu IPv6*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1411">*For multihome devices, NetX Duo automatically determines the source address to use for the connection, and the next hop address based on the destination IP address of the connection. Because TCP is limited to sending packets to unicast (e.g.nonbroadcast) destination addresses, NetX Duo does not require a "hint" for choosing the source IPv6 address*.</span></span>

### <a name="tcp-socket-state-machine"></a><span data-ttu-id="e11b4-1412">Komputer stanu gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1412">TCP Socket State Machine</span></span>      
<span data-ttu-id="e11b4-1413">Połączenie między dwoma gniazdami TCP (jeden klient i jeden serwer) jest złożone i jest zarządzane w sposób komputerowy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1413">The connection between two TCP sockets (one client and one server) is complex and is managed in a state machine manner.</span></span> <span data-ttu-id="e11b4-1414">Każde gniazdo TCP zostanie uruchomione w stanie ZAMKNIĘTYm.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1414">Each TCP socket starts in a CLOSED state.</span></span> <span data-ttu-id="e11b4-1415">Za pośrednictwem zdarzeń połączeń każda maszyna stanu gniazda jest migrowana w stan USTANOWIONy, który jest miejscem, w którym odbywa się zbiorczo transfer danych w protokole TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1415">Through connection events each socket's state machine migrates into the ESTABLISHED state, which is where the bulk of the data transfer in TCP takes place.</span></span> <span data-ttu-id="e11b4-1416">Gdy jedna strona połączenia nie chce już wysyłać danych, zostanie odłączona.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1416">When one side of the connection no longer wishes to send data, it disconnects.</span></span> <span data-ttu-id="e11b4-1417">Po rozłączeniu z drugą stroną, gdy gniazdo TCP powróci do stanu ZAMKNIĘTEgo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1417">After the other side disconnects, eventually the TCP socket returns to the CLOSED state.</span></span> <span data-ttu-id="e11b4-1418">Ten proces jest powtarzany za każdym razem, gdy klient i serwer TCP nawiązują połączenie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1418">This process repeats each time a TCP client and server establish and close a connection.</span></span> <span data-ttu-id="e11b4-1419">Rysunek 14 przedstawia różne stany komputera stanu TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1419">Figure 14 shows the various states of the TCP state machine.</span></span>

### <a name="tcp-client-connection"></a><span data-ttu-id="e11b4-1420">Połączenie klienta TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1420">TCP Client Connection</span></span>       
<span data-ttu-id="e11b4-1421">Jak wspomniano wcześniej, po stronie klienta połączenia TCP zostaje zainicjowany żądanie połączenia z serwerem TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1421">As mentioned previously, the client side of the TCP connection initiates a connection request to a TCP server.</span></span> <span data-ttu-id="e11b4-1422">Aby można było wykonać żądanie połączenia, należy włączyć protokół TCP w wystąpieniu adresu IP klienta.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1422">Before a connection request can be made, TCP must be enabled on the client IP instance.</span></span> <span data-ttu-id="e11b4-1423">Ponadto gniazdo TCP klienta musi być utworzone za pomocą usługi ***nx_tcp_socket_create** _ i powiązana z portem za pośrednictwem _ *_nx_tcp_client_socket_bind_** usługi.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1423">In addition, the client TCP socket must next be created with the ***nx_tcp_socket_create** _ service and bound to a port via the _ *_nx_tcp_client_socket_bind_** service.</span></span>

<span data-ttu-id="e11b4-1424">Po powiązaniu gniazda klienta usługa ***nxd_tcp_client_socket_connect*** zostanie użyta do nawiązania połączenia z serwerem TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1424">After the client socket is bound, the ***nxd_tcp_client_socket_connect*** service is used to establish a connection with a TCP server.</span></span> <span data-ttu-id="e11b4-1425">Należy pamiętać, że gniazdo musi być w stanie ZAMKNIĘTYm, aby można było zainicjować próbę połączenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1425">Note the socket must be in a CLOSED state to initiate a connection attempt.</span></span> <span data-ttu-id="e11b4-1426">Ustanowienie połączenia rozpoczyna się od NetX Duo wystawiającego pakiet SYN, a następnie czeka na powrót z powrotem do pakietu ACK z serwera, który oznacza akceptację żądania połączenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1426">Establishing the connection starts with NetX Duo issuing a SYN packet and then waiting for a SYN ACK packet back from the server, which signifies acceptance of the connection request.</span></span> <span data-ttu-id="e11b4-1427">Po otrzymaniu potwierdzenia SYN NetX Duo reaguje na pakiet ACK i promuje gniazdo klienta do określonego stanu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1427">After the SYN ACK is received, NetX Duo responds with an ACK packet and promotes the client socket to the ESTABLISHED state.</span></span>

![Diagram stanów komputera stanu TCP.](./media/user-guide/image24.png)   

<span data-ttu-id="e11b4-1429">**RYSUNEK 14. Stany komputera stanu TCP**</span><span class="sxs-lookup"><span data-stu-id="e11b4-1429">**FIGURE 14. States of the TCP State Machine**</span></span>


> [!WARNING]
> <span data-ttu-id="e11b4-1430">*Aplikacje powinny używać **nxd_tcp_client_socket_connect** dla połączeń TCP i IPv6 z protokołem IPv4. Aplikacje mogą nadal używać **nx_tcp_client_socket_connect** dla połączeń TCP IPv4, ale zachęca się deweloperów do korzystania z **nxd_tcp_client_socket_connect** , ponieważ **nx_tcp_client_socket_connect** będzie ostatecznie przestarzałe*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1430">*Applications should use **nxd_tcp_client_socket_connect** for either IPv4 and IPv6 TCP connections. Applications can still use **nx_tcp_client_socket_connect** for IPv4 TCP connections, but developers are encouraged to use **nxd_tcp_client_socket_connect** since **nx_tcp_client_socket_connect** will eventually be deprecated*.</span></span>

<span data-ttu-id="e11b4-1431">*Podobnie **nxd_tcp_socket_peer_info_get** współpracuje z połączeniami TCP IPv4 lub IPv6. Jednak **nx_tcp_socket_peer_info_get** nadal są dostępne dla starszych aplikacji. Deweloperzy są zachęcani do korzystania z **nxd_tcp_socket_peer_info_get** przechodzenia do przodu*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1431">*Similarly, **nxd_tcp_socket_peer_info_get** works with either IPv4 or IPv6 TCP connections. However, **nx_tcp_socket_peer_info_get** is still available for legacy applications. Developers are encouraged to use **nxd_tcp_socket_peer_info_get** going forward*.</span></span>

### <a name="tcp-client-disconnection"></a><span data-ttu-id="e11b4-1432">Odłączanie klienta TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1432">TCP Client Disconnection</span></span>    
<span data-ttu-id="e11b4-1433">Zamykanie połączenia odbywa się przez wywołanie ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1433">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="e11b4-1434">Jeśli nie określono zawieszenia, gniazdo klienta wysyła do gniazda serwerowego pakiet RST i umieszcza gniazdo w stanie ZAMKNIĘTYm.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1434">If no suspension is specified, the client socket sends a RST packet to the server socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="e11b4-1435">W przeciwnym razie, jeśli zażądano zawieszenia, zostaje wykonany pełny protokół Disconnect protokołu TCP w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="e11b4-1435">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows:</span></span> 

- <span data-ttu-id="e11b4-1436">Jeśli serwer zainicjował wcześniej żądanie rozłączenia (gniazdo klienta już otrzymał pakiet FIN, odpowiedział na ACK i jest w stanie oczekiwania na zamknięcie), NetX Duo podnosi stan gniazda TCP klienta do ostatniego potwierdzenia i wysyła pakiet FIN.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1436">If the server previously initiated a disconnect request (the client socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX Duo promotes the client TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="e11b4-1437">Następnie czeka na potwierdzenie z serwera przed ukończeniem rozłączenia i przeprowadzeniem stanu ZAMKNIĘTEgo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1437">It then waits for an ACK from the server before completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="e11b4-1438">Jeśli z drugiej strony, klient jest pierwszym zainicjowaniem żądania rozłączenia (serwer nie został odłączony, a gniazdo nadal jest w stanie), NetX Duo wysyła pakiet FIN w celu zainicjowania rozłączenia i czeka na otrzymanie elementu FIN i ACK z serwera przed ukończeniem rozłączenia i umieszczenie gniazda w stanie ZAMKNIĘTYm.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1438">If on the other hand, the client is the first to initiate a disconnect request (the server has not disconnected and the socket is still in the ESTABLISHED state), NetX Duo sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the server before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="e11b4-1439">Jeśli w kolejce transmisji gniazda nadal istnieją pakiety, NetX Duo zawiesza się dla określonego limitu czasu, aby umożliwić potwierdzenie pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1439">If there are still packets on the socket transmit queue, NetX Duo suspends for the specified timeout to allow the packets to be acknowledged.</span></span> <span data-ttu-id="e11b4-1440">Jeśli limit czasu wygaśnie, NetX Duo opróżnia kolejkę transmisji gniazda klienta.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1440">If the timeout expires, NetX Duo empties the transmit queue of the client socket.</span></span> 

<span data-ttu-id="e11b4-1441">Aby usunąć powiązanie portu z gniazda klienta, aplikacja wywołuje ***nx_tcp_client_socket_unbind***.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1441">To unbind the port from the client socket, the application calls ***nx_tcp_client_socket_unbind***.</span></span> <span data-ttu-id="e11b4-1442">Gniazdo musi znajdować się w stanie ZAMKNIĘTYm lub w trakcie rozłączania (tj. czas oczekiwania na stan) przed zwolnieniem portu; w przeciwnym razie zwracany jest błąd.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1442">The socket must be in a CLOSED state or in the process of disconnecting (i.e., TIMED WAIT state) before the port is released; otherwise, an error is returned.</span></span>

<span data-ttu-id="e11b4-1443">Na koniec, jeśli aplikacja nie potrzebuje już gniazda klienta, wywołuje ***nx_tcp_socket_delete*** , aby usunąć gniazdo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1443">Finally, if the application no longer needs the client socket, it calls ***nx_tcp_socket_delete*** to delete the socket.</span></span>

### <a name="tcp-server-connection"></a><span data-ttu-id="e11b4-1444">Połączenie z serwerem TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1444">TCP Server Connection</span></span>      
<span data-ttu-id="e11b4-1445">Po stronie serwera połączenia TCP jest pasywny; oznacza to, że serwer czeka na zainicjowanie żądania połączenia przez klienta.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1445">The server side of a TCP connection is passive; i.e., the server waits for a client to initiate connection request.</span></span> <span data-ttu-id="e11b4-1446">Aby zaakceptować połączenie z klientem, należy najpierw włączyć protokół TCP w wystąpieniu adresu IP, wywołując usługę \***nx_tcp_enable** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1446">To accept a client connection, TCP must first be enabled on the IP instance by calling the service \***nx_tcp_enable** _.</span></span> <span data-ttu-id="e11b4-1447">Następnie aplikacja musi utworzyć gniazdo TCP przy użyciu usługi _ \*_nx_tcp_socket_create_\*\*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1447">Next, the application must create a TCP socket using the _ *_nx_tcp_socket_create_*\* service.</span></span>  

<span data-ttu-id="e11b4-1448">Należy również skonfigurować gniazdo serwera do nasłuchiwania żądań połączeń.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1448">The server socket must also be set up for listening for connection requests.</span></span> <span data-ttu-id="e11b4-1449">Jest to realizowane za pomocą usługi ***nx_tcp_server_socket_listen*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-1449">This is achieved by using the ***nx_tcp_server_socket_listen*** service.</span></span> <span data-ttu-id="e11b4-1450">Ta usługa umieszcza gniazdo serwera w stanie nasłuchiwania i wiąże określony port serwera z gniazdem.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1450">This service places the server socket in the LISTEN state and binds the specified server port to the socket.</span></span>

> [!NOTE] 
> <span data-ttu-id="e11b4-1451">*Aby ustawić procedurę wywołania zwrotnego gniazda Socket, aplikacja określa odpowiednią funkcję wywołania zwrotnego dla tcp_listen_callback argumentu usługi **nx_tcp_server_socket_listen** . Ta funkcja wywołania zwrotnego aplikacji jest następnie wykonywana przez NetX Duo, gdy na tym porcie serwera zażądano nowego połączenia. Przetwarzanie w wywołaniu zwrotnym jest pod kontrolą aplikacji.*</span><span class="sxs-lookup"><span data-stu-id="e11b4-1451">*To set a socket listen callback routine the application specifies the appropriate callback function for the tcp_listen_callback argument of the **nx_tcp_server_socket_listen** service. This application callback function is then executed by NetX Duo whenever a new connection is requested on this server port. The processing in the callback is under application control.*</span></span>

<span data-ttu-id="e11b4-1452">Aby akceptować żądania połączenia klienta, aplikacja wywołuje usługę \***nx_tcp_server_socket_accept** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1452">To accept client connection requests, the application calls the \***nx_tcp_server_socket_accept** _ service.</span></span> <span data-ttu-id="e11b4-1453">Gniazdo serwera musi znajdować się w stanie nasłuchiwania lub zostać ODEBRANe (tj. serwer jest w stanie nasłuchiwania i odebrał pakiet SYN z klienta wysyłającego żądanie połączenia) w celu wywołania usługi Accept.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1453">The server socket must either be in a LISTEN state or a SYN RECEIVED state (i.e., the server is in the LISTEN state and has received a SYN packet from a client requesting a connection) to call the accept service.</span></span> <span data-ttu-id="e11b4-1454">Pomyślne zwrócenie stanu z _ *_nx_tcp_server_socket_accept_*\* wskazuje, że połączenie zostało skonfigurowane i że gniazdo serwera jest w stanie nawiązane.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1454">A successful return status from _ *_nx_tcp_server_socket_accept_*\* indicates the connection has been set up and the server socket is in the ESTABLISHED state.</span></span>

<span data-ttu-id="e11b4-1455">Gdy gniazdo serwera ma prawidłowe połączenie, dodatkowe żądania połączenia klienta są umieszczane w kolejce do głębokości określonej przez *listen_queue_size,* do  \* usługi **nx_tcp_server_socket_listen** _.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1455">After the server socket has a valid connection, additional client connection requests are queued up to the depth specified by the *listen_queue_size, passed into the* \***nx_tcp_server_socket_listen** _ service.</span></span> <span data-ttu-id="e11b4-1456">W celu przetworzenia kolejnych połączeń na porcie serwera aplikacja musi wywołać _ *_nx_tcp_server_socket_relisten_*\* z dostępnym gniazdem (tj. gniazdem w stanie zamkniętym).</span><span class="sxs-lookup"><span data-stu-id="e11b4-1456">In order to process subsequent connections on a server port, the application must call _ *_nx_tcp_server_socket_relisten_*\* with an available socket (i.e., a socket in a CLOSED state).</span></span> <span data-ttu-id="e11b4-1457">Należy pamiętać, że tego samego gniazda serwerowego można użyć, jeśli poprzednie połączenie skojarzone z gniazdem zostanie zakończone, a gniazdo jest w stanie ZAMKNIĘTYm.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1457">Note that the same server socket could be used if the previous connection associated with the socket is now finished and the socket is in the CLOSED state.</span></span>

### <a name="tcp-server-disconnection"></a><span data-ttu-id="e11b4-1458">Odłączanie serwera TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1458">TCP Server Disconnection</span></span>     
<span data-ttu-id="e11b4-1459">Zamykanie połączenia odbywa się przez wywołanie ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1459">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="e11b4-1460">Jeśli nie określono zawieszenia, gniazdo serwera wysyła do gniazda klienta parametr RST i umieszcza gniazdo w stanie ZAMKNIĘTYm.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1460">If no suspension is specified, the server socket sends a RST packet to the client socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="e11b4-1461">W przeciwnym razie, jeśli zażądano zawieszenia, zostaje wykonany pełny protokół Disconnect protokołu TCP w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="e11b4-1461">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows:</span></span>

- <span data-ttu-id="e11b4-1462">Jeśli klient zainicjował wcześniej żądanie rozłączenia (gniazdo serwera już otrzymał pakiet FIN, odpowiedział na ACK i jest w stanie oczekiwania na zamknięcie), NetX Duo podnosi stan gniazda TCP do ostatniego potwierdzenia i wysyła pakiet FIN.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1462">If the client previously initiated a disconnect request (the server socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX Duo promotes the TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="e11b4-1463">Następnie czeka na potwierdzenie z klienta przed ukończeniem rozłączenia i przeprowadzeniem stanu ZAMKNIĘTEgo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1463">It then waits for an ACK from the client before  completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="e11b4-1464">Jeśli z drugiej strony, serwer jest pierwszym zainicjowaniem żądania rozłączenia (klient nie został odłączony, a gniazdo nadal jest w stanie), NetX Duo wyśle pakiet FIN w celu zainicjowania rozłączenia i czeka na otrzymanie elementu FIN i ACK z klienta przed ukończeniem odłączenia i umieszczenie gniazda w stanie ZAMKNIĘTYm.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1464">If on the other hand, the server is the first to initiate a disconnect request (the client has not disconnected and the socket is still in the ESTABLISHED state), NetX Duo sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the client before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="e11b4-1465">Jeśli w kolejce transmisji gniazda nadal istnieją pakiety, NetX Duo zawiesza się dla określonego limitu czasu, aby umożliwić potwierdzenie tych pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1465">If there are still packets on the socket transmit queue, NetX Duo suspends for the specified timeout to allow those packets to be acknowledged.</span></span> <span data-ttu-id="e11b4-1466">Jeśli limit czasu wygaśnie, NetX Duo opróżnia kolejkę przesyłania w gnieździe serwera.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1466">If the timeout expires, NetX Duo flushes the transmit queue of the server socket.</span></span>

<span data-ttu-id="e11b4-1467">Po zakończeniu przetwarzania rozłączenia, gdy gniazdo serwera jest w stanie ZAMKNIĘTYm, aplikacja musi wywołać usługę \***nx_tcp_server_socket_unaccept** _, aby zakończyć skojarzenie tego gniazda z portem serwera.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1467">After the disconnect processing is complete and the server socket is in the CLOSED state, the application must call the \***nx_tcp_server_socket_unaccept** _ service to end the association of this socket with the server port.</span></span> <span data-ttu-id="e11b4-1468">Należy pamiętać, że ta usługa musi być wywoływana przez aplikację, nawet jeśli _*_nx_tcp_socket_disconnect_*_ lub _*_nx_tcp_server_socket_accept_*_ zwracają stan błędu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1468">Note this service must be called by the application even if _*_nx_tcp_socket_disconnect_*_ or _*_nx_tcp_server_socket_accept_*_ return an error status.</span></span> <span data-ttu-id="e11b4-1469">Po powrocie _*_nx_tcp_server_socket_unaccept_*_ gniazdo może być używane jako gniazdo klienta lub serwera, a nawet usunięte, jeśli nie jest już potrzebne.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1469">After the _*_nx_tcp_server_socket_unaccept_*_ returns, the socket can be used as a client or server socket, or even deleted if it is no longer needed.</span></span> <span data-ttu-id="e11b4-1470">Jeśli pożądane jest zaakceptowanie innego połączenia klienta na tym samym porcie serwera, usługa _ *_nx_tcp_server_socket_relisten_*\* powinna być wywoływana w tym gnieździe.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1470">If accepting another client connection on the same server port is desired, the _ *_nx_tcp_server_socket_relisten_*\* service should be called on this socket.</span></span>

<span data-ttu-id="e11b4-1471">Poniższy segment kodu ilustruje sekwencję wywołań typowego serwera TCP używa:</span><span class="sxs-lookup"><span data-stu-id="e11b4-1471">The following code segment illustrates the sequence of calls a typical TCP server uses:</span></span>

```c
/* Set up a previously created TCP socket to
   listen on port 12 */
nx_tcp_server_socket_listen()

/* Loop to make a (another) connection. */
while(1)
{
    /* Wait for a client socket connection request
       for 100 ticks. */
    nx_tcp_server_socket_accept();

    /* (Send and receive TCP messages with the TCP
       client) */

    /* Disconnect the server socket. */
    nx_tcp_socket_disconnect();

    /* Remove this server socket from listening on
       the port. */
    nx_tcp_server_socket_unaccept(&server_socket);
    /* Set up server socket to relisten on the
       same port for the next client. */
    nx_tcp_server_socket_relisten();
}
```

### <a name="mss-validation"></a><span data-ttu-id="e11b4-1472">Sprawdzanie poprawności</span><span class="sxs-lookup"><span data-stu-id="e11b4-1472">MSS Validation</span></span>      
<span data-ttu-id="e11b4-1473">Maksymalny rozmiar segmentu (Maximum) to maksymalna ilość bajtów odbieranych przez hosta TCP bez fragmentacji przez podstawową warstwę adresów IP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1473">The Maximum Segment Size (MSS) is the maximum amount of bytes a TCP host can receive without being fragmented by the underlying IP layer.</span></span> <span data-ttu-id="e11b4-1474">Podczas fazy ustanowienia połączenia TCP oba punkty końcowe wymieniają własną wartość TCP, tak że nadawca nie wyśle segmentu danych TCP, który jest większy niż rozmiar tego odbiorcy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1474">During TCP connection establishment phase, both ends exchanges its own TCP MSS value, so that the sender does not send a TCP data segment that is larger than the receiver's MSS.</span></span> <span data-ttu-id="e11b4-1475">Moduł TCP NetX Duo będzie opcjonalnie sprawdzać anonsowaną wartość tego obiektu równorzędnego przed nawiązaniem połączenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1475">NetX Duo TCP module will optionally validate its peer's advertised MSS value before establishing a connection.</span></span> <span data-ttu-id="e11b4-1476">Domyślnie NetX Duo nie zezwala na takie sprawdzenie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1476">By default NetX Duo does not enable such a check.</span></span> <span data-ttu-id="e11b4-1477">W przypadku aplikacji, które chcą wykonać weryfikację o kluczu, należy zdefiniować ***NX_ENABLE_TCP_MSS_CHECK** _ podczas kompilowania biblioteki NetX Duo, a wartość minimalna powinna być zdefiniowana w _*_NX_TCP_MSS_MINIMUM_\*_.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1477">Applications wishing to perform MSS validation shall define ***NX_ENABLE_TCP_MSS_CHECK** _ when building the NetX Duo library, and the minimum value shall be defined in _*_NX_TCP_MSS_MINIMUM_\*_.</span></span> <span data-ttu-id="e11b4-1478">Przychodzące połączenia TCP o wartościach o wielkości/mniej więcej niż _ *_NX_TCP_MSS_MINIMUM_*\* są porzucane.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1478">Incoming TCP connections with MSS values below _ *_NX_TCP_MSS_MINIMUM_*\* are dropped.</span></span>

### <a name="stop-listening-on-a-server-port"></a><span data-ttu-id="e11b4-1479">Zatrzymaj nasłuchiwanie na porcie serwera</span><span class="sxs-lookup"><span data-stu-id="e11b4-1479">Stop Listening on a Server Port</span></span>    
<span data-ttu-id="e11b4-1480">Jeśli aplikacja nie chce już nasłuchiwać żądań połączenia klienta na porcie serwera, który został wcześniej określony przez wywołanie usługi \***nx_tcp_server_socket_listen** _, aplikacja po prostu wywołuje usługę _ \*_nx_tcp_server_socket_unlisten_\*\*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1480">If the application no longer wishes to listen for client connection requests on a server port that was previously specified by a call to the ***nx_tcp_server_socket_listen** _ service, the application simply calls the _ *_nx_tcp_server_socket_unlisten_** service.</span></span> <span data-ttu-id="e11b4-1481">Ta usługa umieszcza wszystkie gniazda oczekujące na połączenie z powrotem w stanie ZAMKNIĘTYm i zwalnia wszystkie pakiety żądań połączeń klienta umieszczonych w kolejce.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1481">This service places any socket waiting for a connection back in the CLOSED state and releases any queued client connection request packets.</span></span> 

### <a name="tcp-window-size"></a><span data-ttu-id="e11b4-1482">Rozmiar okna TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1482">TCP Window Size</span></span>   
<span data-ttu-id="e11b4-1483">Podczas fazy instalacji i transferu danych połączenia każdy port raportuje ilość danych, które może obsłużyć, czyli rozmiar okna.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1483">During both the setup and data transfer phases of the connection, each port reports the amount of data it can handle, which is called its window size.</span></span> <span data-ttu-id="e11b4-1484">Gdy dane są odbierane i przetwarzane, rozmiar tego okna jest dostosowywany dynamicznie.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1484">As data are received and processed, this window size is adjusted dynamically.</span></span> <span data-ttu-id="e11b4-1485">W przypadku protokołu TCP nadawca może wysłać tylko ilość danych, które pasują do okna odbiorcy.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1485">In TCP, a sender can only send an amount of data that fits into the receiver's window.</span></span> <span data-ttu-id="e11b4-1486">W zasadzie rozmiar okna zapewnia kontrolę przepływu na potrzeby transferu danych w każdym kierunku połączenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1486">In essence, the window size provides flow control for data transfer in each direction of the connection.</span></span>   

### <a name="tcp-packet-send"></a><span data-ttu-id="e11b4-1487">Wysyłanie pakietów TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1487">TCP Packet Send</span></span>     
<span data-ttu-id="e11b4-1488">Wysyłanie danych TCP jest łatwo realizowane przez wywołanie funkcji ***nx_tcp_socket_send*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-1488">Sending TCP data is easily accomplished by calling the ***nx_tcp_socket_send*** function.</span></span> <span data-ttu-id="e11b4-1489">Jeśli rozmiar przesyłanych danych jest większy niż wartość rozmiaru w gnieździe lub bieżący rozmiar okna odbioru elementu równorzędnego, w zależności od tego, który z nich jest mniejszy, wewnętrzna logika TCP carves dane, które pasują do minimalnej (rozmiaru pasma, okna odbierania równorzędnego) do transmisji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1489">If the size of the data being transmitted is larger than the MSS value of the socket or the current peer receive window size, whichever is smaller, TCP internal logic carves off the data that fits into min (MSS, peer receive Window) for transmission.</span></span> <span data-ttu-id="e11b4-1490">Ta usługa następnie kompiluje nagłówek TCP przed pakietem (w tym obliczenia sumy kontrolnej).</span><span class="sxs-lookup"><span data-stu-id="e11b4-1490">This service then builds a TCP header in front of the packet (including the checksum calculation).</span></span> <span data-ttu-id="e11b4-1491">Jeśli rozmiar okna odbiornika jest różny od zera, obiekt wywołujący wyśle tyle danych, ile może wypełnić rozmiar okna odbiornika.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1491">If the receiver's window size is not zero, the caller will send as much data as it can to fill up the receiver window size.</span></span> <span data-ttu-id="e11b4-1492">Jeśli okno odbierania przestanie być równe zero, wywołujący może zawiesić się i zaczekać, aż rozmiar okna odbiornika zostanie odpowiednio zwiększony dla tego pakietu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1492">If the receive window becomes zero, the caller may suspend and wait for the receiver's window size to increase enough for this packet to be sent.</span></span> <span data-ttu-id="e11b4-1493">W danym momencie wiele wątków może zawiesić się podczas próby wysłania danych za pomocą tego samego gniazda.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1493">At any given time, multiple threads may suspend while trying to send data through the same socket.</span></span> 

> [!WARNING]  
> <span data-ttu-id="e11b4-1494">*Dane TCP znajdujące się w strukturze NX_PACKET powinny znajdować się na granicy długiego wyrazu. Ponadto musi być wystarczająca ilość miejsca między wskaźnikiem dołączania i wskaźnikiem początku danych do umieszczenia nagłówków TCP, IP i nośnika fizycznego*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1494">*The TCP data residing in the NX_PACKET structure should reside on a long-word boundary. In addition, there needs to be sufficient space between the prepend pointer and the data start pointer to place the TCP, IP, and physical media headers*.</span></span>

### <a name="tcp-packet-retransmit"></a><span data-ttu-id="e11b4-1495">Ponowne przesyłanie pakietów TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1495">TCP Packet Retransmit</span></span>      
<span data-ttu-id="e11b4-1496">Wcześniej przesłane pakiety TCP wysłane faktycznie przechowywane wewnętrznie do momentu zwrócenia potwierdzenia po drugiej stronie połączenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1496">Previously transmitted TCP packets sent actually stored internally until an ACK is returned from the other side of the connection.</span></span> <span data-ttu-id="e11b4-1497">Jeśli przesyłane dane nie są potwierdzone w określonym limicie czasu, przechowywany pakiet jest ponownie wysyłany i ustawiany jest następny limit czasu.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1497">If transmitted data is not acknowledged within the timeout period, the stored packet is re-sent and the next timeout period is set.</span></span> <span data-ttu-id="e11b4-1498">Po odebraniu potwierdzenia wszystkie pakiety objęte numerem potwierdzenia w wewnętrznej kolejce transmisji są ostatecznie wydane.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1498">When an ACK is received, all packets covered by the acknowledgement number in the internal transmit queue are finally released.</span></span>  

> [!WARNING]   
> <span data-ttu-id="e11b4-1499">*Aplikacja nie korzysta ponownie z pakietu ani nie zmienia zawartości pakietu po nx_tcp_socket_send () zwraca z NX_SUCCESS. Przesłany pakiet jest ostatecznie uwalniany przez przetwarzanie wewnętrzne NetX Duo po potwierdzeniu danych przez inne zakończenie*.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1499">*Application shall not reuse the packet or alter the contents of the packet after nx_tcp_socket_send() returns with NX_SUCCESS. The transmitted packet is eventually released by NetX Duo internal processing after the data is acknowledged by the other end*.</span></span>

### <a name="tcp-keepalive"></a><span data-ttu-id="e11b4-1500">Utrzymywanie aktywności TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1500">TCP Keepalive</span></span>     
<span data-ttu-id="e11b4-1501">Funkcja utrzymywania aktywności protokołu TCP umożliwia gnieździi wykrywanie, czy jego element równorzędny rozłącza się bez poprawnego zakończenia (na przykład awaria elementu równorzędnego), czy też uniemożliwiać określonym obiektom monitorowania sieci przerwanie połączenia przez długie okresy bezczynności.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1501">TCP Keepalive feature allows a socket to detect whether or not its peer disconnects without proper termination (for example, the peer crashed), or to prevent certain network monitoring facilities to terminate a connection for long periods of idle.</span></span> <span data-ttu-id="e11b4-1502">Ruch przychodzący TCP działa przez okresowe wysyłanie ramki TCP bez danych, a numer sekwencyjny jest ustawiony na jeden mniejszy niż bieżący numer sekwencyjny.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1502">TCP Keepalive works by periodically sending a TCP frame with no data, and the sequence number set to one less than the current sequence number.</span></span> <span data-ttu-id="e11b4-1503">Po odebraniu takiej ramki utrzymania protokołu TCP odbiorca (Jeśli nadal działa) odpowiedzi z POTWIERDZENIEm dla bieżącego numeru sekwencji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1503">On receiving such TCP Keepalive frame, the recipient, if still alive, responses with an ACK for its current sequence number.</span></span> <span data-ttu-id="e11b4-1504">Spowoduje to zakończenie transakcji utrzymywania aktywności.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1504">This completes the keepalive transaction.</span></span>  

<span data-ttu-id="e11b4-1505">Domyślnie funkcja utrzymywania aktywności nie jest włączona.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1505">By default the keepalive feature is not enabled.</span></span> <span data-ttu-id="e11b4-1506">Aby można było użyć tej funkcji, biblioteka NetX Duo musi być skompilowana przy użyciu funkcji \***NX_ENABLE_TCP_KEEPALIVE** _ zdefiniowanej.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1506">To use this feature, NetX Duo library must be built with \***NX_ENABLE_TCP_KEEPALIVE** _ defined.</span></span> <span data-ttu-id="e11b4-1507">Symbol _ *_NX_TCP_KEEPALIVE_INITIAL_*\* określa liczbę sekund braku aktywności przed zainicjowaniem ramki utrzymywania aktywności.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1507">The symbol _ *_NX_TCP_KEEPALIVE_INITIAL_*\* specifies the number of seconds of inactivity before the keepalive frame is initiated.</span></span>  

### <a name="tcp-packet-receive"></a><span data-ttu-id="e11b4-1508">Odbieranie pakietów TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1508">TCP Packet Receive</span></span>   
<span data-ttu-id="e11b4-1509">Przetwarzanie pakietów odbioru protokołu TCP (wywoływane z wątku pomocnika adresów IP) jest odpowiedzialne za obsługę różnych akcji połączenia i rozłączania, a także przesyłanie potwierdzenia.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1509">The TCP receive packet processing (called from the IP helper thread) is responsible for handling various connection and disconnection actions as well as transmit acknowledge processing.</span></span> <span data-ttu-id="e11b4-1510">Ponadto przetwarzanie pakietów odbioru protokołu TCP jest odpowiedzialne za umieszczanie pakietów z danymi odbieranymi w odpowiedniej kolejce lub dostarczenie pakietu do pierwszego wstrzymanego wątku, oczekując na pakiet.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1510">In addition, the TCP receive packet processing is responsible for placing packets with receive data on the appropriate TCP socket's receive queue or delivering the packet to the first suspended thread waiting for a packet.</span></span>

### <a name="tcp-receive-notify"></a><span data-ttu-id="e11b4-1511">Powiadomienie o odebraniu protokołu TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1511">TCP Receive Notify</span></span>     
<span data-ttu-id="e11b4-1512">Jeśli wątek aplikacji musi przetwarzać odebrane dane z więcej niż jednego gniazda, należy użyć funkcji ***nx_tcp_socket_receive_notify*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-1512">If the application thread needs to process received data from more than one socket, the ***nx_tcp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="e11b4-1513">Ta funkcja rejestruje funkcję odbierania pakietów wywołania zwrotnego dla gniazda.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1513">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="e11b4-1514">Za każdym razem, gdy pakiet jest odbierany w gnieździe, funkcja wywołania zwrotnego jest wykonywana.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1514">Whenever a packet is received on the socket, the callback function is executed.</span></span>  

<span data-ttu-id="e11b4-1515">Zawartość funkcji wywołania zwrotnego to applicationspecific; Jednak funkcja najprawdopodobniej zawiera logikę do informowania wątku przetwarzania, że pakiet jest dostępny w odpowiednim gnieździe.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1515">The contents of the callback function are applicationspecific; however, the function would most likely contain logic to inform the processing thread that a packet is available on the corresponding socket.</span></span> 

### <a name="thread-suspension"></a><span data-ttu-id="e11b4-1516">Zawieszenie wątku</span><span class="sxs-lookup"><span data-stu-id="e11b4-1516">Thread Suspension</span></span>      
<span data-ttu-id="e11b4-1517">Jak wspomniano wcześniej, wątki aplikacji mogą wstrzymywać się podczas próby odebrania danych z określonego portu TCP.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1517">As mentioned previously, application threads can suspend while attempting to receive data from a particular TCP port.</span></span> <span data-ttu-id="e11b4-1518">Po odebraniu pakietu na tym porcie jest on przyznany do pierwszego wątku, a następnie wznowiony.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1518">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="e11b4-1519">Opcjonalny limit czasu jest dostępny w przypadku zawieszania pakietu odbioru TCP, który jest funkcją dostępną dla większości usług NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1519">An optional timeout is available when suspending on a TCP receive packet, a feature available for most NetX Duo services.</span></span>  

<span data-ttu-id="e11b4-1520">Zawieszenie wątku jest również dostępne dla połączenia (zarówno klienta, jak i serwera), powiązania klienta i usług odłączania.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1520">Thread suspension is also available for connection (both client and server), client binding, and disconnection services.</span></span>  

### <a name="tcp-socket-statistics-and-errors"></a><span data-ttu-id="e11b4-1521">Statystyka i błędy gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1521">TCP Socket Statistics and Errors</span></span>     
<span data-ttu-id="e11b4-1522">Jeśli ta opcja jest włączona, oprogramowanie NetX Duo TCP Socket śledzi kilka statystyk i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1522">If enabled, the NetX Duo TCP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="e11b4-1523">Dla każdego wystąpienia protokołu IP/TCP są obsługiwane następujące raporty statystyczne i błędy:</span><span class="sxs-lookup"><span data-stu-id="e11b4-1523">The following statistics and error reports are maintained for each IP/TCP instance:</span></span>   

- <span data-ttu-id="e11b4-1524">Całkowita liczba wysłanych pakietów TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1524">Total TCP Packets Sent</span></span>  
- <span data-ttu-id="e11b4-1525">Całkowita liczba wysłanych bajtów TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1525">Total TCP Bytes Sent</span></span>  
- <span data-ttu-id="e11b4-1526">Całkowita liczba odebranych pakietów TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1526">Total TCP Packets Received</span></span>   
- <span data-ttu-id="e11b4-1527">Całkowita liczba odebranych bajtów TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1527">Total TCP Bytes Received</span></span>   
- <span data-ttu-id="e11b4-1528">Całkowita liczba nieprawidłowych pakietów TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1528">Total TCP Invalid Packets</span></span>   
- <span data-ttu-id="e11b4-1529">Całkowita liczba porzuconych pakietów odbioru protokołu TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1529">Total TCP Receive Packets Dropped</span></span>    
- <span data-ttu-id="e11b4-1530">Łączne błędy sum kontrolnych odbioru TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1530">Total TCP Receive Checksum Errors</span></span>   
- <span data-ttu-id="e11b4-1531">Łączna liczba połączeń TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1531">Total TCP Connections</span></span>   
- <span data-ttu-id="e11b4-1532">Łączna liczba rozłączeń TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1532">Total TCP Disconnections</span></span>   
- <span data-ttu-id="e11b4-1533">Całkowita liczba porzuconych połączeń TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1533">Total TCP Connections Dropped</span></span>    
- <span data-ttu-id="e11b4-1534">Łączna liczba retransmisji pakietów TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1534">Total TCP Packet Retransmits</span></span>   
- <span data-ttu-id="e11b4-1535">Wysłane pakiety gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1535">TCP Socket Packets Sent</span></span>   
- <span data-ttu-id="e11b4-1536">Wysłane bajty gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1536">TCP Socket Bytes Sent</span></span>   
- <span data-ttu-id="e11b4-1537">Odebrane pakiety TCP Socket</span><span class="sxs-lookup"><span data-stu-id="e11b4-1537">TCP Socket Packets Received</span></span>   
- <span data-ttu-id="e11b4-1538">Odebrane bajty gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1538">TCP Socket Bytes Received</span></span>   
- <span data-ttu-id="e11b4-1539">Ponowne przesyłanie pakietów TCP Socket</span><span class="sxs-lookup"><span data-stu-id="e11b4-1539">TCP Socket Packet Retransmits</span></span>    
- <span data-ttu-id="e11b4-1540">Pakiety gniazd TCP dodane do kolejki</span><span class="sxs-lookup"><span data-stu-id="e11b4-1540">TCP Socket Packets Queued</span></span>    
- <span data-ttu-id="e11b4-1541">Błędy sum kontrolnych gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1541">TCP Socket Checksum Errors</span></span>    
- <span data-ttu-id="e11b4-1542">Stan gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1542">TCP Socket State</span></span>    
- <span data-ttu-id="e11b4-1543">Głębokość kolejki transmisji gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1543">TCP Socket Transmit Queue Depth</span></span>    
- <span data-ttu-id="e11b4-1544">Rozmiar okna wysyłania gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1544">TCP Socket Transmit Window Size</span></span>    
- <span data-ttu-id="e11b4-1545">Rozmiar okna odbierania gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1545">TCP Socket Receive Window Size</span></span>    

<span data-ttu-id="e11b4-1546">Wszystkie te statystyki i raporty o błędach są dostępne dla aplikacji z usługą ***nx_tcp_info_get** _ dla łącznej liczby statystyk TCP oraz usługi _ *_nx_tcp_socket_info_get_** dla statystyk TCP na gniazdo.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1546">All these statistics and error reports are available to the application with the ***nx_tcp_info_get** _ service for total TCP statistics and the _ *_nx_tcp_socket_info_get_** service for TCP statistics per socket.</span></span>

### <a name="tcp-socket-control-block-nx_tcp_socket"></a><span data-ttu-id="e11b4-1547">NX_TCP_SOCKET bloku sterowania gniazdem TCP</span><span class="sxs-lookup"><span data-stu-id="e11b4-1547">TCP Socket Control Block NX_TCP_SOCKET</span></span>      
<span data-ttu-id="e11b4-1548">Cechy poszczególnych gniazd TCP znajdują się w skojarzonym bloku sterowania *NX_TCP_SOCKET* , który zawiera przydatne informacje, takie jak link do struktury danych IP, interfejs połączenia sieciowego, port powiązany i kolejka odbierania pakietów.</span><span class="sxs-lookup"><span data-stu-id="e11b4-1548">The characteristics of each TCP socket are found in the associated *NX_TCP_SOCKET* control block, which contains useful information such as the link to the IP data structure, the network connection interface, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="e11b4-1549">Ta struktura jest zdefiniowana w pliku ***nx_api. h*** .</span><span class="sxs-lookup"><span data-stu-id="e11b4-1549">This structure is defined in the ***nx_api.h*** file.</span></span>