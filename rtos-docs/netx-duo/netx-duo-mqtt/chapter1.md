---
title: Rozdział 1 — wprowadzenie do usługi Azure RTO NetX Duo MQTT
description: Pakiet klienta NetX Duo MQTT wymaga zainstalowania programu NetX Duo (w wersji 5,10 lub nowszej), prawidłowej konfiguracji i utworzenia wystąpienia adresu IP.
author: philmea
ms.author: philmea
ms.date: 05/19/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 2e13b997f987e2fd82569bcb1904218908313d70
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/22/2021
ms.locfileid: "104821816"
---
# <a name="chapter-1---introduction-to-azure-rtos-netx-duo-mqtt"></a><span data-ttu-id="d9089-103">Rozdział 1 — wprowadzenie do usługi Azure RTO NetX Duo MQTT</span><span class="sxs-lookup"><span data-stu-id="d9089-103">Chapter 1 - Introduction to Azure RTOS NetX Duo MQTT</span></span>

## <a name="netx-duo-mqtt-requirements"></a><span data-ttu-id="d9089-104">NetX Duo MQTT wymagania</span><span class="sxs-lookup"><span data-stu-id="d9089-104">NetX Duo MQTT Requirements</span></span>

<span data-ttu-id="d9089-105">Pakiet klienta platformy Azure RTO NetX Duo MQTT wymaga, aby NetX Duo (wersja 5,10 lub nowsza) była zainstalowana, prawidłowo skonfigurowana, a wystąpienie adresu IP zostało utworzone.</span><span class="sxs-lookup"><span data-stu-id="d9089-105">The Azure RTOS NetX Duo MQTT client package requires that NetX Duo (version 5.10 or later) be installed, properly configured, and the IP instance has been created.</span></span> <span data-ttu-id="d9089-106">W systemie musi być włączony moduł TCP.</span><span class="sxs-lookup"><span data-stu-id="d9089-106">The TCP module must be enabled in the system.</span></span> <span data-ttu-id="d9089-107">Ponadto, jeśli wymagane jest zabezpieczenie protokołu TLS, moduł bezpiecznego protokołu TLS NetX musi być skonfigurowany zgodnie z parametrem zabezpieczeń wymaganym przez brokera.</span><span class="sxs-lookup"><span data-stu-id="d9089-107">In addition, if TLS security is required, the NetX Secure TLS module needs to be configured according to the security parameter required by the broker.</span></span>

## <a name="netx-duo-mqtt-specification"></a><span data-ttu-id="d9089-108">Specyfikacja NetX Duo MQTT</span><span class="sxs-lookup"><span data-stu-id="d9089-108">NetX Duo MQTT Specification</span></span>

<span data-ttu-id="d9089-109">Implementacja klienta NetX Duo MQTT jest zgodna z języka Oasis MQTT wersja 3.1.1 KTZ 29<sup>th</sup> 2014.</span><span class="sxs-lookup"><span data-stu-id="d9089-109">NetX Duo MQTT client implement is compliant with OASIS MQTT Version 3.1.1 Oct 29<sup>th</sup> 2014.</span></span> <span data-ttu-id="d9089-110">Specyfikację można znaleźć w:</span><span class="sxs-lookup"><span data-stu-id="d9089-110">The specification can be found at:</span></span>

- [http://mqtt.org/](http://mqtt.org/)

## <a name="netx-duo-mqtt-basic-operation"></a><span data-ttu-id="d9089-111">NetX Duo MQTT — operacja podstawowa</span><span class="sxs-lookup"><span data-stu-id="d9089-111">NetX Duo MQTT Basic Operation</span></span>

<span data-ttu-id="d9089-112">MQTT (transport telemetrii kolejki komunikatów) jest oparty na modelu subskrybentów wydawcy.</span><span class="sxs-lookup"><span data-stu-id="d9089-112">MQTT (Message Queue Telemetry Transport) is based on publisher-subscriber model.</span></span> <span data-ttu-id="d9089-113">Klient może publikować informacje na innych klientach za pośrednictwem brokera.</span><span class="sxs-lookup"><span data-stu-id="d9089-113">A client can publish information to other clients through a broker.</span></span> <span data-ttu-id="d9089-114">Klient, Jeśli interesuje temat, może subskrybować temat za pośrednictwem brokera.</span><span class="sxs-lookup"><span data-stu-id="d9089-114">A client, if interested in a topic, can subscribe to the topic through the broker.</span></span> <span data-ttu-id="d9089-115">Broker jest odpowiedzialny za dostarczanie opublikowanych komunikatów do klientów, którzy subskrybują ten temat.</span><span class="sxs-lookup"><span data-stu-id="d9089-115">A broker is responsible for delivering published messages to its clients who subscribe to the topic.</span></span> <span data-ttu-id="d9089-116">W tym modelu subskrybenta wydawcy, wielu klientów może publikować dane w tym samym temacie.</span><span class="sxs-lookup"><span data-stu-id="d9089-116">In this publisher-subscriber model, multiple clients may publish data with the same topic.</span></span> <span data-ttu-id="d9089-117">Klient otrzyma komunikat publikowany, jeśli klient subskrybuje ten sam temat.</span><span class="sxs-lookup"><span data-stu-id="d9089-117">A client will receive a message it publishes if the client subscribes to the same topic.</span></span>

<span data-ttu-id="d9089-118">W zależności od przypadku użycia klient może wybrać jeden z trzech poziomów QoS podczas publikowania wiadomości:</span><span class="sxs-lookup"><span data-stu-id="d9089-118">Depending on the use case, a client may choose one of the 3 QoS levels when publishing a message:</span></span>

- <span data-ttu-id="d9089-119">**Jakość** usług (QoS) 0: komunikat jest dostarczany najwyżej raz.</span><span class="sxs-lookup"><span data-stu-id="d9089-119">**QoS 0**: The message is delivered at most once.</span></span> <span data-ttu-id="d9089-120">Komunikaty wysyłane z użyciem QoS 0 mogą zostać utracone.</span><span class="sxs-lookup"><span data-stu-id="d9089-120">Messages sent with QoS 0 may be lost.</span></span>
- <span data-ttu-id="d9089-121">**QoS 1**: komunikat jest dostarczany co najmniej raz.</span><span class="sxs-lookup"><span data-stu-id="d9089-121">**QoS 1**: The message is delivered at least once.</span></span> <span data-ttu-id="d9089-122">Komunikaty wysyłane za pomocą usługi QoS 1 mogą być dostarczane więcej niż raz.</span><span class="sxs-lookup"><span data-stu-id="d9089-122">Messages sent with QoS 1 may be delivered more than once.</span></span>
- <span data-ttu-id="d9089-123">**Jakość** usług (QoS) 2: komunikat jest dostarczany dokładnie jeden raz.</span><span class="sxs-lookup"><span data-stu-id="d9089-123">**QoS 2**: The message is delivered exactly once.</span></span> <span data-ttu-id="d9089-124">Komunikaty wysyłane z użyciem usługi QoS 2 są gwarantowane, bez duplikowania.</span><span class="sxs-lookup"><span data-stu-id="d9089-124">Messages sent with QoS 2 is guaranteed to be delivered, with no duplication.</span></span>

> [!NOTE]
> <span data-ttu-id="d9089-125">Ta implementacja klienta MQTT nie obsługuje komunikatów poziomu 2 usług QoS.</span><span class="sxs-lookup"><span data-stu-id="d9089-125">This implementation of MQTT client does not support QoS level 2 messages.</span></span>

<span data-ttu-id="d9089-126">Ponieważ usługi QoS 1 i QoS 2 mają być dostarczone, Broker śledzi stan komunikatów QoS 1 i QoS 2 wysyłanych do każdego klienta.</span><span class="sxs-lookup"><span data-stu-id="d9089-126">Since QoS 1 and QoS 2 are guaranteed to be delivered, the broker keeps track the state of QoS 1 and QoS 2 messages sent to each client.</span></span> <span data-ttu-id="d9089-127">Jest to szczególnie ważne w przypadku klientów, którzy oczekują komunikatów QoS1 lub QoS 2.</span><span class="sxs-lookup"><span data-stu-id="d9089-127">This is particularly important for clients that expect QoS1 or QoS 2 messages.</span></span> <span data-ttu-id="d9089-128">Klient może zostać odłączony od brokera (na przykład po ponownym uruchomieniu klienta lub łącze komunikacji).</span><span class="sxs-lookup"><span data-stu-id="d9089-128">The client may be disconnected from the broker (for example when the client reboots, or the communication link is temporarily lost).</span></span> <span data-ttu-id="d9089-129">Broker musi przechowywać komunikaty QoS 1 i QoS 2, aby komunikaty mogły być dostarczane później po ponownym połączeniu klienta z brokerem.</span><span class="sxs-lookup"><span data-stu-id="d9089-129">The broker must store QoS 1 and QoS 2 messages so the messages can be delivered later once the client is reconnected to the broker.</span></span> <span data-ttu-id="d9089-130">Jednak klient może zrezygnować z nieodebrania żadnych starych komunikatów z brokera po ponownej nawiązaniu połączenia.</span><span class="sxs-lookup"><span data-stu-id="d9089-130">However, the client may choose not to receive any stale messages from the broker after reconnection.</span></span> <span data-ttu-id="d9089-131">Klient może to zrobić przez zainicjowanie połączenia z flagą *clean_session* ustawioną na \***NX_TRUE** _.</span><span class="sxs-lookup"><span data-stu-id="d9089-131">The client can do so by initiating the connection with the *clean_session* flag set to \***NX_TRUE** _.</span></span> <span data-ttu-id="d9089-132">W takim przypadku po odebraniu komunikatu MQTT CONNECT Broker odrzuca wszystkie informacje o sesji skojarzone z tym klientem, w tym niedostarczone lub niepotwierdzone komunikaty QoS 1 lub QoS 2.</span><span class="sxs-lookup"><span data-stu-id="d9089-132">In this case, upon receiving the MQTT CONNECT message, the broker shall discard any session information associated with this client, including undelivered or unconfirmed QoS 1 or QoS 2 messages.</span></span> <span data-ttu-id="d9089-133">Jeśli _flaga clean_session \* ma wartość \***NX_FALSE**_, serwer wysyła ponownie komunikaty QoS 1 i QoS 2.</span><span class="sxs-lookup"><span data-stu-id="d9089-133">If the _clean_session\* flag is to \***NX_FALSE**_, the server shall resend the QoS 1 and QoS 2 messages.</span></span> <span data-ttu-id="d9089-134">Klient MQTT również ponownie wysyła wszystkie niepotwierdzone komunikaty, jeśli _clean_session \* jest ustawiona na \*\**NX_TRUE *.**</span><span class="sxs-lookup"><span data-stu-id="d9089-134">The MQTT Client also resends any un-acknowledged messages if _clean_session\* is set to \***NX_TRUE\*.**</span></span> <span data-ttu-id="d9089-135">To potwierdzenie jest inne niż potwierdzenie warstwy protokołu TCP, chociaż taka sytuacja występuje również.</span><span class="sxs-lookup"><span data-stu-id="d9089-135">This acknowledgment is different from the TCP layer ACK, although that happens as well.</span></span> <span data-ttu-id="d9089-136">Klient MQTT wysyła potwierdzenie do brokera.</span><span class="sxs-lookup"><span data-stu-id="d9089-136">The MQTT client sends an acknowledgment to the broker.</span></span>

<span data-ttu-id="d9089-137">Aplikacja tworzy wystąpienie klienta MQTT przez wywołanie \***nxd_mqtt_client_create ()** _.</span><span class="sxs-lookup"><span data-stu-id="d9089-137">An application creates an MQTT client instance by calling \***nxd_mqtt_client_create()** _.</span></span> <span data-ttu-id="d9089-138">Po utworzeniu klienta aplikacja może połączyć się z brokerem, wywołując _*_nxd_mqtt_client_connect ()_*_.</span><span class="sxs-lookup"><span data-stu-id="d9089-138">Once the client is created, the application can connect to the broker by calling _*_nxd_mqtt_client_connect()_*_.</span></span> <span data-ttu-id="d9089-139">Po nawiązaniu połączenia z brokerem klient może subskrybować temat poprzez wywołanie _*_nxd_mqtt_client_subscribe ()_*_ lub opublikowanie tematu przez wywołanie _ *_nxd_mqtt_client_publish ()_* \*.</span><span class="sxs-lookup"><span data-stu-id="d9089-139">After connecting to the broker, the client can subscribe to a topic by calling _*_nxd_mqtt_client_subscribe()_*_, or publish a topic by calling _\*_nxd_mqtt_client_publish()_\*\*.</span></span>

<span data-ttu-id="d9089-140">Przychodzące komunikaty MQTT są przechowywane w kolejce odbierania w wystąpieniu klienta MQTT.</span><span class="sxs-lookup"><span data-stu-id="d9089-140">Incoming MQTT messages are stored in the receive queue in the MQTT client instance.</span></span> <span data-ttu-id="d9089-141">Aplikacja pobiera te komunikaty, wywołując ***nxd_mqtt_client_message_get ()***.</span><span class="sxs-lookup"><span data-stu-id="d9089-141">Application retrieves these message by calling ***nxd_mqtt_client_message_get()***.</span></span> <span data-ttu-id="d9089-142">W przypadku komunikatów w kolejce odbierania pierwszy komunikat (np. najstarsze) z kolejki jest zwracany do obiektu wywołującego.</span><span class="sxs-lookup"><span data-stu-id="d9089-142">If there are messages in the receive queue, the first message (e.g. the oldest) from the queue is returned to the caller.</span></span> <span data-ttu-id="d9089-143">Zwracany jest również ciąg tematu z komunikatu.</span><span class="sxs-lookup"><span data-stu-id="d9089-143">The topic string from the message is also returned.</span></span>

> [!NOTE]
> <span data-ttu-id="d9089-144">Funkcja \***nxd_mqtt_client_message_get ()** _ nie blokuje, jeśli kolejka odbierania MQTT klienta jest pusta.</span><span class="sxs-lookup"><span data-stu-id="d9089-144">The function \***nxd_mqtt_client_message_get()** _ does not block if the MQTT client receive queue is empty.</span></span> <span data-ttu-id="d9089-145">Funkcja wraca bezpośrednio z kodem powrotnym _ *_NXD_MQTT_NO_MESSAGE_* \*.</span><span class="sxs-lookup"><span data-stu-id="d9089-145">The function returns immediately with the return code _\*_NXD_MQTT_NO_MESSAGE_\*\*.</span></span> <span data-ttu-id="d9089-146">Aplikacja traktuje tę wartość zwracaną jako wskazanie, że kolejka odbierania jest pusta, a nie błędu.</span><span class="sxs-lookup"><span data-stu-id="d9089-146">The application shall treat this return value as an indication that the receive queue is empty, not an error.</span></span>

<span data-ttu-id="d9089-147">Aby uniknąć sondowania kolejki odbierania dla wiadomości przychodzących, aplikacja może zarejestrować funkcję wywołania zwrotnego za pomocą klienta MQTT przez wywołanie ***nxd_mqtt_client_recieve_notify_set ()***.</span><span class="sxs-lookup"><span data-stu-id="d9089-147">To avoid polling the receive queue for incoming messages, the application can register a callback function with the MQTT client by calling ***nxd_mqtt_client_recieve_notify_set()***.</span></span> <span data-ttu-id="d9089-148">Funkcja wywołania zwrotnego jest zadeklarowana jako:</span><span class="sxs-lookup"><span data-stu-id="d9089-148">The callback function is declared as:</span></span>

```c
VOID (*receive_notify_callback)(NXD_MQTT_CLIENT *client_ptr, 
    UINT message_count);
```

<span data-ttu-id="d9089-149">Gdy klient MQTT odbiera komunikaty z brokera, wywołuje funkcję wywołania zwrotnego, jeśli funkcja jest ustawiona.</span><span class="sxs-lookup"><span data-stu-id="d9089-149">As the MQTT client receives messages from the broker, it invokes the callback function if the function is set.</span></span> <span data-ttu-id="d9089-150">Funkcja wywołania zwrotnego przekazuje wskaźnik do bloku kontroli klienta i wartość liczby komunikatów.</span><span class="sxs-lookup"><span data-stu-id="d9089-150">The callback function passes the pointer to the client control block and a message count value.</span></span> <span data-ttu-id="d9089-151">Wartość liczby komunikatów wskazuje liczbę komunikatów MQTT w kolejce odbierania.</span><span class="sxs-lookup"><span data-stu-id="d9089-151">The message count value indicates the number of MQTT messages in the receive queue.</span></span> <span data-ttu-id="d9089-152">Należy zauważyć, że ta funkcja wywołania zwrotnego jest wykonywana w kontekście wątku klienta MQTT.</span><span class="sxs-lookup"><span data-stu-id="d9089-152">Note that this callback function executes in the MQTT client thread context.</span></span> <span data-ttu-id="d9089-153">W związku z tym funkcja wywołania zwrotnego nie powinna wykonywać żadnych procedur, które mogą blokować wątek klienta MQTT.</span><span class="sxs-lookup"><span data-stu-id="d9089-153">Therefore, the callback function should not execute any procedures that may block the MQTT client thread.</span></span> <span data-ttu-id="d9089-154">Funkcja wywołania zwrotnego powinna wyzwolić wątek aplikacji, aby wywoływać ***nxd_mqtt_client_message_get ()*** w celu pobrania komunikatów.</span><span class="sxs-lookup"><span data-stu-id="d9089-154">The callback function should trigger the application thread to call ***nxd_mqtt_client_message_get()*** to retrieve the messages.</span></span>

<span data-ttu-id="d9089-155">Aby rozłączyć i zakończyć usługę klienta MQTT, aplikacja używa usługi ***nxd_mqtt_client_disconnect ()** _ i _*_nxd_mqtt_client_delete ()._\*_</span><span class="sxs-lookup"><span data-stu-id="d9089-155">To disconnect and terminate the MQTT client service, the application shall use the service ***nxd_mqtt_client_disconnect()** _ and _*_nxd_mqtt_client_delete()._\*_</span></span> <span data-ttu-id="d9089-156">Wywołanie _*_nxd_mqtt_client_disconnect ()_*_ po prostu ROZŁĄCZA połączenie TCP z brokerem.</span><span class="sxs-lookup"><span data-stu-id="d9089-156">Calling _*_nxd_mqtt_client_disconnect()_*_ simply disconnects the TCP connection to the broker.</span></span> <span data-ttu-id="d9089-157">Zwalnia komunikaty już odebrane i przechowywane w kolejce odbierania.</span><span class="sxs-lookup"><span data-stu-id="d9089-157">It releases messages already received and stored in the receive queue.</span></span> <span data-ttu-id="d9089-158">Nie powoduje to jednak zwolnienia komunikatów poziomu 1 usługi QoS w kolejce transmisji.</span><span class="sxs-lookup"><span data-stu-id="d9089-158">However, it does not release QoS level 1 messages in the transmit queue.</span></span> <span data-ttu-id="d9089-159">Komunikaty poziomu 1 usługi QoS są przesyłane ponownie po nawiązaniu połączenia, przy założeniu, że flaga _*_clean_session_*_ ma wartość _ *_NX_FALSE._*\*</span><span class="sxs-lookup"><span data-stu-id="d9089-159">QoS level 1 messages are retransmitted upon connection, assuming the _*_clean_session_*_ flag is set to _ *_NX_FALSE._*\*</span></span>

<span data-ttu-id="d9089-160">Broker może także rozłączyć się z klientem.</span><span class="sxs-lookup"><span data-stu-id="d9089-160">The broker may also disconnect from the client.</span></span> <span data-ttu-id="d9089-161">Gdy połączenie TCP między klientem i brokerem zostanie zakończone, aplikacja może zostać powiadomiona przez funkcję powiadamiania o rozłączeniu.</span><span class="sxs-lookup"><span data-stu-id="d9089-161">When the TCP connection between the client and the broker is terminated, the application can be notified by the disconnect notify function.</span></span> <span data-ttu-id="d9089-162">Aby można było korzystać z mechanizmu powiadamiania, aplikacja instaluje funkcję odłączania powiadomienia przez wywołanie \*\**nxd_mqtt_client_disconnect_notify_set *.**</span><span class="sxs-lookup"><span data-stu-id="d9089-162">To use the notification mechanism, application installs the disconnect notify function by calling \***nxd_mqtt_client_disconnect_notify_set\*.**</span></span> <span data-ttu-id="d9089-163">Po rozłączeniu protokołu TCP i utworzeniu sesji MQTT zostaje wywołana funkcja powiadomień.</span><span class="sxs-lookup"><span data-stu-id="d9089-163">Once a TCP disconnect is observed and the MQTT session has been created, the notification function is invoked.</span></span>

<span data-ttu-id="d9089-164">Wywołanie ***nxd_mqtt_client_delete ()*** zwalnia wszystkie bloki komunikatów w kolejce transmisji i w kolejce odbierania.</span><span class="sxs-lookup"><span data-stu-id="d9089-164">Calling ***nxd_mqtt_client_delete()*** releases all message blocks in the transmit queue and the receive queue.</span></span> <span data-ttu-id="d9089-165">Niepotwierdzone komunikaty poziomu 1 usługi QoS również są usuwane.</span><span class="sxs-lookup"><span data-stu-id="d9089-165">Unacknowledged QoS level 1 messages are also deleted.</span></span>

## <a name="secure-mqtt-connection"></a><span data-ttu-id="d9089-166">Bezpieczne połączenie MQTT</span><span class="sxs-lookup"><span data-stu-id="d9089-166">Secure MQTT Connection</span></span>

<span data-ttu-id="d9089-167">Klient MQTT nawiązuje bezpieczne połączenie z brokerem przy użyciu modułu NetX Secure TLS.</span><span class="sxs-lookup"><span data-stu-id="d9089-167">The MQTT client makes a secure connection to the broker using the NetX Secure TLS module.</span></span> <span data-ttu-id="d9089-168">Domyślny numer portu dla MQTT z zabezpieczeniami TLS to 8883, zdefiniowany w ***NXD_MQTT_TLS_PORT***.</span><span class="sxs-lookup"><span data-stu-id="d9089-168">The default port number for MQTT with TLS security is 8883, defined in ***NXD_MQTT_TLS_PORT***.</span></span>

<span data-ttu-id="d9089-169">Aby można było utworzyć bezpieczne połączenie usługi MQTT z brokerem, należy wynegocjować sesję protokołu TLS po nawiązaniu połączenia TCP przed wysłaniem komunikatów MQTT CONNECT do brokera.</span><span class="sxs-lookup"><span data-stu-id="d9089-169">To create a secure MQTT connection to the broker, a TLS session needs to be negotiated after a TCP connection is established, before MQTT CONNECT messages can be sent to the broker.</span></span> <span data-ttu-id="d9089-170">Konfiguracja sesji TLS odbywa się przez wywołanie ***nxd_mqtt_client_secure_connect ()*** i przekazanie funkcji wywołania zwrotnego konfiguracji protokołu TLS zdefiniowanej przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d9089-170">The TLS session set up is accomplished by calling ***nxd_mqtt_client_secure_connect()*** and passing in a user-defined TLS setup callback function.</span></span> <span data-ttu-id="d9089-171">W fazie połączenia usługi MQTT po nawiązaniu połączenia TCP klient wywołuje funkcję wywołania zwrotnego konfiguracji protokołu TLS w celu uruchomienia odpowiedniego procesu uzgadniania protokołu TLS.</span><span class="sxs-lookup"><span data-stu-id="d9089-171">During the MQTT connection phase, once the TCP connection is established, the client invokes the TLS setup callback function to start a proper TLS handshake process.</span></span> <span data-ttu-id="d9089-172">Po ustanowieniu sesji TLS klient kontynuuje komunikat MQTT CONNECT za pośrednictwem bezpiecznego kanału.</span><span class="sxs-lookup"><span data-stu-id="d9089-172">After the TLS session is established, the client continues the MQTT CONNECT message over the secure channel.</span></span>

<span data-ttu-id="d9089-173">Funkcja wywołania zwrotnego zdefiniowanego przez użytkownika przyjmuje pięć wartości wejściowych i jest zadeklarowana jako:</span><span class="sxs-lookup"><span data-stu-id="d9089-173">The user defined callback function takes five input values and is declared as:</span></span>

```c
UINT tls_Setup_callback(NXD_MQTT_CLIENT *client_ptr,
    NX_SECURE_TLS_SESSION *session_ptr,
    NX_SECURE_TLS_CERTIFICATE *certificate_ptr,
    NX_SECURE_TLS_CERTIFICATE *trusted_cerfiticate);
```

<span data-ttu-id="d9089-174">Poniżej znajduje się opis parametrów wejściowych:</span><span class="sxs-lookup"><span data-stu-id="d9089-174">Below is a description of the input parameters:</span></span>

- <span data-ttu-id="d9089-175">**client_ptr**: wskaźnik do bloku kontroli klienta MQTT.</span><span class="sxs-lookup"><span data-stu-id="d9089-175">**client_ptr**: Pointer to the MQTT client control block.</span></span>
- <span data-ttu-id="d9089-176">**session_ptr**: wskaźnik do bloku sterowania sesją TLS.</span><span class="sxs-lookup"><span data-stu-id="d9089-176">**session_ptr**: Pointer to the TLS session control block.</span></span>
- <span data-ttu-id="d9089-177">**certificate_ptr**: wskaźnik do bloku kontroli certyfikatu.</span><span class="sxs-lookup"><span data-stu-id="d9089-177">**certificate_ptr**: Pointer to the certificate control block.</span></span> <span data-ttu-id="d9089-178">Funkcja instalacji konfiguruje ten certyfikat przed wysłaniem go do brokera.</span><span class="sxs-lookup"><span data-stu-id="d9089-178">The setup function configures this certificate before sending it to the broker.</span></span>
- <span data-ttu-id="d9089-179">**trusted_certificate_ptr**: wskaźnik do zaufanego certyfikatu.</span><span class="sxs-lookup"><span data-stu-id="d9089-179">**trusted_certificate_ptr**: Pointer to the trusted certificate.</span></span> <span data-ttu-id="d9089-180">Funkcja konfiguracji protokołu TLS konfiguruje zaufany certyfikat w celu uwierzytelnienia serwera.</span><span class="sxs-lookup"><span data-stu-id="d9089-180">TLS setup function configures the trusted certificate to authenticate the server.</span></span>

<span data-ttu-id="d9089-181">W funkcji konfiguracji protokołu TLS aplikacja jest odpowiedzialna za tworzenie sesji TLS i Konfigurowanie sesji przy użyciu odpowiedniego certyfikatu.</span><span class="sxs-lookup"><span data-stu-id="d9089-181">In the TLS setup function, the application is responsible for creating a TLS session, and configuring the session with a proper certificate.</span></span> <span data-ttu-id="d9089-182">Poniższy pseudo kod zawiera opis typowej procedury uruchamiania sesji TLS.</span><span class="sxs-lookup"><span data-stu-id="d9089-182">The following pseudo code outlines a typical TLS session start up procedure.</span></span> <span data-ttu-id="d9089-183">Czytelnik odwołuje się do podręcznika użytkownika usługi NetX Secure TLS, aby uzyskać szczegółowe informacje na temat korzystania z interfejsów API protokołu TLS.</span><span class="sxs-lookup"><span data-stu-id="d9089-183">The reader is referred to the NetX Secure TLS User Guide for details on using TLS APIs.</span></span>

<span data-ttu-id="d9089-184">Poniżej znajduje się przykładowe wywołanie zwrotne konfiguracji protokołu TLS:</span><span class="sxs-lookup"><span data-stu-id="d9089-184">Below is an example TLS setup callback:</span></span>

```c
UINT tls_setup_callback(NXD_MQTT_CLIENT *client_pt
    NX_SECURE_TLS_SESSION *session_ptr,
    NX_SECURE_TLS_CERTIFICATE *certrifcate_ptr,
    NX_SECURE_TLS_CERTIFICATE *trusted_certificate_ptr)
{
    /* Initialize TLS module */
    nx_secure_tls_initialize();

    /* Create a TLS session */
    nx_secure_tls_session_create(session_ptr, …);

    /* Need to allocate space for the certificate coming in from the broker. */
    memset(certificate_ptr), 0, sizeof(NX_SECURE_TLS_CERTIFICATE));

    nx_secure_tls_remote_certificate_allocate(session_ptr, certificate_ptr);

    /* Add a CA Certificate to our trusted store for verifying incomingserver certificates. */
    nx_secure_tls_certificate_initialize(
        trusted_certificate_ptr,
        ca_cert_der,
        ca_cert_der_len, NULL, 0);
    nx_secure_tls_trusted_certificate_add(session_ptr,
        trusted_certificate));
}
```

## <a name="known-limitations-of-the-netx-duo-mqtt-client"></a><span data-ttu-id="d9089-185">Znane ograniczenia dotyczące klienta NetX Duo MQTT</span><span class="sxs-lookup"><span data-stu-id="d9089-185">Known Limitations of the NetX Duo MQTT Client</span></span>

- <span data-ttu-id="d9089-186">NetX Duo MQTT nie obsługuje wysyłania ani otrzymywania komunikatów poziomu 2 usług QoS.</span><span class="sxs-lookup"><span data-stu-id="d9089-186">NetX Duo MQTT does not support sending or receiving QoS level 2 messages.</span></span>
- <span data-ttu-id="d9089-187">NetX Duo MQTT nie obsługuje pakietów łańcucha.</span><span class="sxs-lookup"><span data-stu-id="d9089-187">NetX Duo MQTT does not support chained-packets.</span></span>
