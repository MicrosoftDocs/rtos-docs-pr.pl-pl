---
title: Rozdział 1 — wprowadzenie do translacji adresów sieciowych
description: Translacja adresów sieciowych IP (NAT) została pierwotnie opracowana w celu rozwiązania problemu ograniczonej liczby internetowych adresów IPv4.
author: philmea
ms.author: philmea
ms.date: 07/14/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 3d01aa6f68e21ea82f65a59a19c4f5c7958a6b92
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/22/2021
ms.locfileid: "104821774"
---
# <a name="chapter-1---an-introduction-to-network-address-translation"></a><span data-ttu-id="5b31d-103">Rozdział 1 — wprowadzenie do translacji adresów sieciowych</span><span class="sxs-lookup"><span data-stu-id="5b31d-103">Chapter 1 - An introduction to Network Address Translation</span></span>

## <a name="the-need-for-network-address-translation"></a><span data-ttu-id="5b31d-104">Potrzeba translacji adresów sieciowych</span><span class="sxs-lookup"><span data-stu-id="5b31d-104">The Need for Network Address Translation</span></span>

<span data-ttu-id="5b31d-105">Translacja adresów sieciowych IP (NAT) została pierwotnie opracowana w celu rozwiązania problemu ograniczonej liczby internetowych adresów IPv4.</span><span class="sxs-lookup"><span data-stu-id="5b31d-105">IP Network Address Translation (NAT) was originally developed to solve the problem of a limited number of Internet IPv4 addresses.</span></span> <span data-ttu-id="5b31d-106">Konieczność translatora adresów sieciowych występuje, gdy wiele urządzeń musi uzyskać dostęp do Internetu, ale tylko jeden adres internetowy IPv4 jest przypisywany przez usługodawcę internetowego.</span><span class="sxs-lookup"><span data-stu-id="5b31d-106">The need for NAT arises when multiple devices need to access the Internet but only one IPv4 Internet address is assigned by the Internet Service Provider (ISP).</span></span>

<span data-ttu-id="5b31d-107">Istnieją również inne korzyści wynikające z używania translatora adresów sieciowych.</span><span class="sxs-lookup"><span data-stu-id="5b31d-107">There are other benefits of using NAT as well.</span></span> <span data-ttu-id="5b31d-108">Topologia sieci poza domeną lokalną może ulec zmianie na wiele sposobów.</span><span class="sxs-lookup"><span data-stu-id="5b31d-108">Network topology outside the local domain can change in many ways.</span></span> <span data-ttu-id="5b31d-109">Klienci mogą zmieniać dostawców, firmowych kości lub mogą być scalane lub dzielone.</span><span class="sxs-lookup"><span data-stu-id="5b31d-109">Customers may change providers, company backbones may be reorganized, or providers may merge or split.</span></span> <span data-ttu-id="5b31d-110">Za każdym razem, gdy zewnętrzna zmiana topologii, przydziały adresów dla hostów w domenie lokalnej muszą także ulec zmianie, aby odzwierciedlały te zmiany zewnętrzne.</span><span class="sxs-lookup"><span data-stu-id="5b31d-110">Whenever the external topology changes, address assignments for hosts within the local domain must also change to reflect these external changes.</span></span> <span data-ttu-id="5b31d-111">Zmiany tego typu mogą być ukryte dla użytkowników w domenie przez scentralizowanie zmian w pojedynczym routerze translacji adresów.</span><span class="sxs-lookup"><span data-stu-id="5b31d-111">Changes of this type can be hidden from users within the domain by centralizing changes to a single address translation router.</span></span> <span data-ttu-id="5b31d-112">Translator adresów sieciowych umożliwia dostęp do publicznej sieci Internet i chroni je przed bezpośrednim dostępem z zewnątrz.</span><span class="sxs-lookup"><span data-stu-id="5b31d-112">NAT enables access for local hosts to the public Internet and protects them from direct access from the outside.</span></span> <span data-ttu-id="5b31d-113">Organizacje z konfiguracją sieci głównie do użytku wewnętrznego, którzy potrzebują okazjonalnego dostępu do zewnątrz, są dobrymi kandydatami do tego schematu.</span><span class="sxs-lookup"><span data-stu-id="5b31d-113">Organizations with a network setup predominantly for internal use, with a need for occasional external access are good candidates for this scheme.</span></span>

## <a name="basic-nat-and-network-address-port-translation"></a><span data-ttu-id="5b31d-114">Podstawowe translacja adresów sieciowych i portów adresów sieciowych</span><span class="sxs-lookup"><span data-stu-id="5b31d-114">Basic NAT and Network Address Port Translation</span></span>

<span data-ttu-id="5b31d-115">Router z obsługą translatora adresów sieciowych jest instalowany między siecią publiczną a siecią prywatną.</span><span class="sxs-lookup"><span data-stu-id="5b31d-115">A NAT-enabled router is installed between the public network and the private network.</span></span> <span data-ttu-id="5b31d-116">Rola routera z obsługą translatora adresów sieciowych jest tłumaczona między wewnętrznymi prywatnymi adresami IPv4 i przypisanym publicznym adresem IPv4, więc wszystkie urządzenia w sieci prywatnej mogą współużytkować ten sam publiczny adres IPv4.</span><span class="sxs-lookup"><span data-stu-id="5b31d-116">The role of the NAT-enabled router is to translate between the internal private IPv4 addresses and the assigned public IPv4 address, so all the devices on the private network are able to share the same public IPv4 address.</span></span>

<span data-ttu-id="5b31d-117">W podstawowej implementacji TRANSLATORa adresów sieciowych router translatora adresów sieciowych ma jeden lub więcej adresów IP zarejestrowanych globalnie, które różnią się od własnego adresu IP.</span><span class="sxs-lookup"><span data-stu-id="5b31d-117">In the basic implementation of NAT, the NAT router ‘owns’ one or more globally registered IP addresses different from its own IP address.</span></span> <span data-ttu-id="5b31d-118">Te adresy globalne są dostępne do przypisania do hostów w sieci prywatnej statycznie lub dynamicznie.</span><span class="sxs-lookup"><span data-stu-id="5b31d-118">These global addresses are available to assign to hosts on its private network either statically or dynamically.</span></span> <span data-ttu-id="5b31d-119">NAPT lub translacja portów adresów sieciowych jest odmianą podstawowego NAT, gdzie translacja adresów sieciowych jest rozszerzona w celu uwzględnienia identyfikatora "transport".</span><span class="sxs-lookup"><span data-stu-id="5b31d-119">NAPT, or Network Address Port Translation, is a variation of basic NAT, where network address translation is extended to include a ‘transport’ identifier.</span></span> <span data-ttu-id="5b31d-120">Zwykle jest to numer portu dla pakietów TCP i UDP oraz identyfikator zapytania dla pakietów ICMP.</span><span class="sxs-lookup"><span data-stu-id="5b31d-120">Most typically this is the port number for TCP and UDP packets, and the Query ID for ICMP packets.</span></span>

<span data-ttu-id="5b31d-121">Połączenia między granicami translatora adresów sieciowych są zwykle inicjowane przez hosty w sieci prywatnej wysyłające pakiety wychodzące do hosta zewnętrznego.</span><span class="sxs-lookup"><span data-stu-id="5b31d-121">Connections across the NAT boundary are typically initiated by hosts on the private network sending outbound packets to an external host.</span></span> <span data-ttu-id="5b31d-122">Te hosty mają zwykle przypisane *dynamiczne* (tymczasowe) adresy IP do tego celu.</span><span class="sxs-lookup"><span data-stu-id="5b31d-122">These hosts are usually assigned *dynamic* (temporary) IP addresses for this purpose.</span></span> <span data-ttu-id="5b31d-123">Istnieje również możliwość, że połączenia są inicjowane w odwrotnym kierunku, jeśli sieć prywatna ma serwery HTTP lub FTP, które będą akceptować żądania klientów z sieci zewnętrznej.</span><span class="sxs-lookup"><span data-stu-id="5b31d-123">However, it is also possible to have connections initiated in the opposite direction if the private network has ‘servers’ e.g. HTTP or FTP servers that will accept Client requests from the external network.</span></span> <span data-ttu-id="5b31d-124">Translator adresów sieciowych zazwyczaj przypisze te hosty jako *statyczny* (stały) adres IP: port.</span><span class="sxs-lookup"><span data-stu-id="5b31d-124">NAT will typically assign these local hosts a *static* (permanent) IP address:port.</span></span>

## <a name="how-network-address-translation-works"></a><span data-ttu-id="5b31d-125">Jak działa translacja adresów sieciowych</span><span class="sxs-lookup"><span data-stu-id="5b31d-125">How Network Address Translation Works</span></span>

<span data-ttu-id="5b31d-126">Typową konfigurację sieci przy użyciu routera z obsługą translatora adresów sieciowych przedstawiono na rysunku 1.</span><span class="sxs-lookup"><span data-stu-id="5b31d-126">A typical network setup with a NAT-enabled router is illustrated in Figure 1.</span></span>

![Typowa konfiguracja sieci przy użyciu routera z obsługą translatora adresów sieciowych](media/image2.png)

<span data-ttu-id="5b31d-128">**Rysunek 1. Typowa konfiguracja sieci przy użyciu routera z obsługą translatora adresów sieciowych**</span><span class="sxs-lookup"><span data-stu-id="5b31d-128">**Figure 1 - A typical network setup with a NAT-enabled router**</span></span>

<span data-ttu-id="5b31d-129">Router z obsługą translatora adresów sieciowych ma zazwyczaj dwa interfejsy sieciowe.</span><span class="sxs-lookup"><span data-stu-id="5b31d-129">A NAT-enabled router typically has two network interfaces.</span></span> <span data-ttu-id="5b31d-130">Jeden interfejs jest połączony z publicznym Internetem. druga jest połączona z siecią prywatną.</span><span class="sxs-lookup"><span data-stu-id="5b31d-130">One interface is connected to the public Internet; the other is connected to the private network.</span></span> <span data-ttu-id="5b31d-131">Typowy router w tej konfiguracji jest odpowiedzialny za Routing datagramów IP między siecią prywatną a siecią publiczną na podstawie docelowego adresu IP.</span><span class="sxs-lookup"><span data-stu-id="5b31d-131">A typical router in this setup is responsible for routing IP datagrams between the private network and the public network based on destination IP address.</span></span> <span data-ttu-id="5b31d-132">Router z obsługą translatora adresów sieciowych Wykonuje translację adresów przed kierowaniem datagramu protokołu IPv4 między publicznym i prywatnym interfejsem.</span><span class="sxs-lookup"><span data-stu-id="5b31d-132">A NAT-enabled router performs address translation before routing an IPv4 datagram between the public and the private interface.</span></span> <span data-ttu-id="5b31d-133">Dla każdej sesji TCP lub UDP jest ustanawiane tłumaczenie, na podstawie wewnętrznego adresu źródłowego, numeru portu źródłowego i zewnętrznego adresu docelowego i numeru portu docelowego.</span><span class="sxs-lookup"><span data-stu-id="5b31d-133">A translation is established for each TCP or UDP session, based the internal source address, source port number, and external destination address and destination port number.</span></span> <span data-ttu-id="5b31d-134">W przypadku żądań echa ICMP i datagram odpowiedzi zamiast numeru portu jest używany identyfikator zapytania protokołu ICMP.</span><span class="sxs-lookup"><span data-stu-id="5b31d-134">For ICMP echo request and response datagram, the ICMP query ID is used instead of the port number.</span></span>

<span data-ttu-id="5b31d-135">Aby zilustrować typową implementację translacji adresów sieciowych, należy rozważyć konfigurację sieci na rysunku 2.</span><span class="sxs-lookup"><span data-stu-id="5b31d-135">To illustrate a typical implementation of Network Address Translation, let us consider a network setup in Figure 2.</span></span>

![Typowa implementacja translatora adresów sieciowych](media/image3.png)

<span data-ttu-id="5b31d-137">**Rysunek 2. typowa implementacja translatora adresów sieciowych**</span><span class="sxs-lookup"><span data-stu-id="5b31d-137">**Figure 2 - A typical implementation of Network Address Translation**</span></span>

<span data-ttu-id="5b31d-138">W tym scenariuszu router NAT łączy sieć prywatną z lewej strony i sieć publiczną z prawej strony.</span><span class="sxs-lookup"><span data-stu-id="5b31d-138">In this scenario, the NAT router connects the private network to the left, and the public network to the right.</span></span> <span data-ttu-id="5b31d-139">Załóżmy, że po stronie publicznej sieci adres IP interfejsu routera translatora adresów sieciowych to 202.151.25.14; w interfejsie sieci prywatnej router translatora adresów sieciowych używa adresu IP 192.168.1.254.</span><span class="sxs-lookup"><span data-stu-id="5b31d-139">Let’s assume on the public network side, the NAT router interface IP address is 202.151.25.14; on the private network interface, the NAT router uses the IP address 192.168.1.254.</span></span> <span data-ttu-id="5b31d-140">Węzeł w sieci prywatnej inicjuje połączenie TCP z serwerem sieci Web w Internecie.</span><span class="sxs-lookup"><span data-stu-id="5b31d-140">A node on the private network initiates a TCP connection with a web server on the Internet.</span></span>

<span data-ttu-id="5b31d-141">Rysunek 3 przedstawia widok wysokiego poziomu procesu translacji adresów sieciowych.</span><span class="sxs-lookup"><span data-stu-id="5b31d-141">Figure 3 shows a high-level view of the Network Address Translation process.</span></span>

![Ogólny widok procesu translacji adresów sieciowych](media/image4.png)

<span data-ttu-id="5b31d-143">**Rysunek 3 — ogólny widok procesu translacji adresów sieciowych**</span><span class="sxs-lookup"><span data-stu-id="5b31d-143">**Figure 3 - A high-level view of the Network Address Translation process**</span></span>

1. <span data-ttu-id="5b31d-144">Klient przesyła komunikat SYN protokołu TCP do serwera sieci Web.</span><span class="sxs-lookup"><span data-stu-id="5b31d-144">Client transmits a TCP SYN message to the web server.</span></span> <span data-ttu-id="5b31d-145">Adres nadawcy to 192.168.1.15, numer portu 6732; adres docelowy to 128.15.54.3, numer portu 80.</span><span class="sxs-lookup"><span data-stu-id="5b31d-145">The sender address is 192.168.1.15, port number 6732; the destination address is 128.15.54.3, port number 80.</span></span>
1. <span data-ttu-id="5b31d-146">Pakiet z klienta jest odbierany przez router NAT w interfejsie sieci prywatnej.</span><span class="sxs-lookup"><span data-stu-id="5b31d-146">The packet from the Client is received on the private network interface by the NAT router.</span></span> <span data-ttu-id="5b31d-147">Reguła ruchu wychodzącego ma zastosowanie do pakietu: adres nadawcy (klienta) jest tłumaczony na publiczny adres IP routera NAT 202.15.25.14, a numer portu źródłowego nadawcy (klienta) jest tłumaczony na numer portu TCP 2015 w interfejsie publicznym.</span><span class="sxs-lookup"><span data-stu-id="5b31d-147">The outbound traffic rule applies to the packet: the sender’s (Client’s) address is translated to the NAT router’s public IP address 202.15.25.14, and sender (Client) source port number is translated to the TCP port number 2015 on the public interface.</span></span>
1. <span data-ttu-id="5b31d-148">Pakiet jest następnie przesyłany przez Internet i ostatecznie osiągnie swój 128.15.54.3 hosta docelowego.</span><span class="sxs-lookup"><span data-stu-id="5b31d-148">The packet is then transmitted over the Internet and ultimately reaches its destination host 128.15.54.3.</span></span> <span data-ttu-id="5b31d-149">Zwróć uwagę na to, że po stronie odbiorczej na podstawie adresu źródłowego i numeru portu warstwy IP pakiet prawdopodobnie pochodzi z 202.151.24.14, numer portu 2015.</span><span class="sxs-lookup"><span data-stu-id="5b31d-149">Notice that on the receiving side, based on the IP layer source address and TCP layer port number, the packet appears to have originated from 202.151.24.14, port number 2015.</span></span>
   <span data-ttu-id="5b31d-150">Rysunek 4 przedstawia proces NAT na ścieżce zwracanej.</span><span class="sxs-lookup"><span data-stu-id="5b31d-150">Figure 4 shows the NAT process on the return path.</span></span>

   ![Proces NAT na ścieżce zwracanej](media/image5.png)

   <span data-ttu-id="5b31d-152">**Rysunek 4. proces NAT na ścieżce zwracanej**</span><span class="sxs-lookup"><span data-stu-id="5b31d-152">**Figure 4 - NAT process on the return path**</span></span>
1. <span data-ttu-id="5b31d-153">W tym scenariuszu 128.15.54.3 hosta internetowego wysyła pakiet odpowiedzi z adresem internetowym routera NAT jako miejsce docelowe.</span><span class="sxs-lookup"><span data-stu-id="5b31d-153">In this scenario, the Internet host 128.15.54.3 sends a response packet with the NAT router’s Internet address as its destination.</span></span>
1. <span data-ttu-id="5b31d-154">Pakiet dociera do routera NAT.</span><span class="sxs-lookup"><span data-stu-id="5b31d-154">The packet reaches the NAT router.</span></span> <span data-ttu-id="5b31d-155">Ponieważ jest to pakiet powiązany, stosowane są powiązane z nią reguły Tłumaczenia: adres docelowy został zmieniony z powrotem na adres IP oryginalnego nadawcy: 192.168.1.15, numer portu docelowego 6732.</span><span class="sxs-lookup"><span data-stu-id="5b31d-155">Since this is an in-bound packet, the in-bound translation rules apply: the destination address is changed back to the original sender’s (Client’s) IP address: 192.168.1.15, destination port number 6732.</span></span>
1. <span data-ttu-id="5b31d-156">Pakiet jest następnie przekazywany do klienta za pomocą interfejsu, który jest połączony z siecią wewnętrzną.</span><span class="sxs-lookup"><span data-stu-id="5b31d-156">The packet is then forwarded to the Client through the interface that is connected to the internal network.</span></span>

<span data-ttu-id="5b31d-157">W ten sposób adres sieci Internet i numer portu nadawcy nie są ujawniane innym hostom w publicznym Internecie.</span><span class="sxs-lookup"><span data-stu-id="5b31d-157">In this manner the internet network address and port number of the sender is not exposed to other hosts on the public Internet.</span></span>

## <a name="netx-duo-nat-features"></a><span data-ttu-id="5b31d-158">Funkcje translatora adresów sieciowych NetX Duo</span><span class="sxs-lookup"><span data-stu-id="5b31d-158">NetX Duo NAT Features</span></span>

<span data-ttu-id="5b31d-159">Gdy wystąpienie translatora adresów sieciowych zostanie utworzone przy użyciu wywołania *nx_nat_create* , tabela translacji NAT zostanie utworzona.</span><span class="sxs-lookup"><span data-stu-id="5b31d-159">When the NAT instance is created using *nx_nat_create* call, the NAT translation table is created.</span></span>

```C
UINT nx_nat_create(NX_NAT_DEVICE *nat_ptr, NX_IP *ip_ptr,
    UINT global_interface_index,
    VOID *dynamic_cache_memory,
    UINT dynamic_cache_size);
```

<span data-ttu-id="5b31d-160">Aby śledzić tłumaczenia adresów sieciowych dla wszystkich aktywnych połączeń między sieciami lokalnymi i zewnętrznymi, router z obsługą translatora adresów sieciowych NetX Duo utrzymuje tabelę translacji z informacjami o każdym połączeniu z prywatnym hostem, który zawiera źródłowy i docelowy adres IP i numer portu.</span><span class="sxs-lookup"><span data-stu-id="5b31d-160">To keep track of the network address translations for all active connections between local and external networks, the NetX Duo NAT-enabled router maintains a translation table with information about each private host connection which includes source and destination IP address and port number.</span></span>

<span data-ttu-id="5b31d-161">Lokalizacja tej tabeli translacji ("Cache") jest ustawiana za pomocą wskaźnika dynamic_cache_memory.</span><span class="sxs-lookup"><span data-stu-id="5b31d-161">The location of this translation table (“cache”) is set with the dynamic_cache_memory pointer.</span></span> <span data-ttu-id="5b31d-162">Ten obszar musi zawierać 4-bajtowe miejsce w buforze.</span><span class="sxs-lookup"><span data-stu-id="5b31d-162">This area must be a 4 byte aligned buffer space.</span></span> <span data-ttu-id="5b31d-163">Rozmiar tabeli (lub liczby wpisów) jest określany przez podzielenie rozmiaru pamięci podręcznej dynamic_cache_size przez rozmiar wpisu tabeli NAT.</span><span class="sxs-lookup"><span data-stu-id="5b31d-163">The size of the table (or number of entries) is determined by dividing the cache size dynamic_cache_size by the size of a NAT table entry.</span></span> <span data-ttu-id="5b31d-164">Tabela musi być wystarczająco duża dla minimalnej liczby wpisów określonych przez **NX_NAT_MIN_ENTRY_COUNT, która jest zdefiniowana w *nx_nat. h*. Wartość domyślna to 3.**</span><span class="sxs-lookup"><span data-stu-id="5b31d-164">The table must be large enough for the minimal number of entries specified by **NX_NAT_MIN_ENTRY_COUNT which is defined in *nx_nat.h*. The default value is 3.**</span></span>

<span data-ttu-id="5b31d-165">Limit czasu dla wszystkich wpisów dynamicznych w tabeli translacji NAT NetX Duo jest inicjowany do NX_NAT_ENTRY_RESPONSE_TIMEOUT, który jest zdefiniowany w *nx_nat. h*.</span><span class="sxs-lookup"><span data-stu-id="5b31d-165">The timeout for all dynamic entries in the NetX Duo NAT translation table are initialized to NX_NAT_ENTRY_RESPONSE_TIMEOUT which is defined in *nx_nat.h*.</span></span> <span data-ttu-id="5b31d-166">Wartość domyślna to 4 minuty (lub 240 cykle systemu dla procesora 100 mHz) zgodnie z zaleceniami RFC 2663.</span><span class="sxs-lookup"><span data-stu-id="5b31d-166">The default value is 4 minutes (or 240 system ticks for a 100 mHz processor) as recommended by RFC 2663.</span></span> <span data-ttu-id="5b31d-167">Za każdym razem, gdy NetX Duo, odbierze lub wyśle pakiet pasujący do wpisu dynamicznego w tabeli, resetuje limit czasu tego wpisu do NX_NAT_ENTRY_RESPONSE_TIMEOUT.</span><span class="sxs-lookup"><span data-stu-id="5b31d-167">Each time NetX Duo NAT receives or sends a packet matching a dynamic entry in the table it resets that entry’s time out to NX_NAT_ENTRY_RESPONSE_TIMEOUT.</span></span> <span data-ttu-id="5b31d-168">Podczas wyszukiwania w tabeli NetX Duo translator adresów sieciowych również sprawdza, czy w tabeli znajdują się wygasłe wpisy i usuwać je.</span><span class="sxs-lookup"><span data-stu-id="5b31d-168">When searching the table, NetX Duo NAT will also check the table for expired entries and delete them.</span></span>

<span data-ttu-id="5b31d-169">Aby utworzyć wpisy przychodzące jako statyczne w tabeli, np. w przypadku serwerów w sieci lokalnej, NetX Duo translator adresów sieciowych udostępnia usługę *nx_nat_inbound_entry_create* .</span><span class="sxs-lookup"><span data-stu-id="5b31d-169">To create inbound entries as static in the table e.g. for servers on the local network, NetX Duo NAT provides the *nx_nat_inbound_entry_create* service.</span></span> <span data-ttu-id="5b31d-170">Jeśli wpis tabeli definiuje połączenie hosta lokalnego jako static, nigdy nie wygasa.</span><span class="sxs-lookup"><span data-stu-id="5b31d-170">If a table entry defines the local host connection as static, it never expires.</span></span>

```C
UINT nx_nat_inbound_entry_create(NX_NAT_DEVICE *nat_ptr,
    NX_NAT_TRANSLATION_ENTRY *entry_ptr,
    ULONG local_ip_address, USHORT external_port,
    USHORT local_port, UCHAR protocol);
```

<span data-ttu-id="5b31d-171">Ta usługa została szczegółowo opisana w [rozdziale 4 — Opis usług](chapter4.md)</span><span class="sxs-lookup"><span data-stu-id="5b31d-171">This service is described in more detail in [Chapter 4 - Description of Services](chapter4.md)</span></span>

<span data-ttu-id="5b31d-172">W czasie wykonywania, jeśli tabela translacji jest pełna i nie można dodać kolejnych wpisów, NetX Duo translator adresów sieciowych będzie powiadamiać aplikację NAT z pełnym wywołaniem zwrotnym pamięci podręcznej, jeśli jest on zarejestrowany w wystąpieniu NAT.</span><span class="sxs-lookup"><span data-stu-id="5b31d-172">During runtime, if the translation table is full and no more entries can be added, NetX Duo NAT will notify the NAT application with a cache full callback if one is registered with the NAT instance.</span></span> <span data-ttu-id="5b31d-173">W tym celu należy użyć usługi *nx_nat_cache_notify_set* :</span><span class="sxs-lookup"><span data-stu-id="5b31d-173">This is done using the *nx_nat_cache_notify_set* service:</span></span>

```C
UINT nx_nat_cache_notify_set(NX_NAT_DEVICE *nat_ptr,
    VOID (*cache_full_notify_cb)(NX_NAT_DEVICE *nat_ptr));
```

<span data-ttu-id="5b31d-174">Zobacz [rozdział 4 — Opis usług,](chapter4.md) Aby uzyskać więcej informacji na temat tej usługi.</span><span class="sxs-lookup"><span data-stu-id="5b31d-174">See [Chapter 4 - Description of Services](chapter4.md) for more details about this service.</span></span>

## <a name="nat-packet-processing-in-netx-duo"></a><span data-ttu-id="5b31d-175">Przetwarzanie pakietów NAT w NetX Duo</span><span class="sxs-lookup"><span data-stu-id="5b31d-175">NAT Packet Processing in NetX Duo</span></span>

<span data-ttu-id="5b31d-176">NetX Duo translator adresów sieciowych jest przeznaczony do użycia na routerze IPv4.</span><span class="sxs-lookup"><span data-stu-id="5b31d-176">NetX Duo NAT is intended for use on an IPv4 router.</span></span> <span data-ttu-id="5b31d-177">Aby translator adresów sieciowych działał prawidłowo, NetX Duo musi być skonfigurowany do przekazywania pakietów do serwera NAT.</span><span class="sxs-lookup"><span data-stu-id="5b31d-177">For NAT to work, NetX Duo must be configured for forwarding packets to the NAT server.</span></span> <span data-ttu-id="5b31d-178">Aby dowiedzieć się, jak to zrobić, zobacz rozdział 2 dotyczący instalacji NAT NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="5b31d-178">See Chapter 2 on NetX Duo NAT installation for how to do so.</span></span> <span data-ttu-id="5b31d-179">Serwer NAT wskazuje, czy będzie "zużywać" (próbuje przesłać dalej) pakiet do hosta w jednej z jego sieci.</span><span class="sxs-lookup"><span data-stu-id="5b31d-179">The NAT server then indicates if it will ‘consume’ (attempt to forward) the packet to a host on either of its networks.</span></span> <span data-ttu-id="5b31d-180">Jeśli pakiet nie zostanie zużyty, pakiet jest "zwrócony" do NetX Duo, aby przetworzyć pakiet w miarę jak zwykle.</span><span class="sxs-lookup"><span data-stu-id="5b31d-180">If it will not consume the packet, the packet is ‘returned’ to NetX Duo to process the packet as it normally would.</span></span>

<span data-ttu-id="5b31d-181">Gdy serwer NAT odbiera pakiet do przesyłania dalej z NetX Duo, określa, czy pakiet jest przychodzący czy wychodzący.</span><span class="sxs-lookup"><span data-stu-id="5b31d-181">When the NAT server receives a packet to forward from NetX Duo, it determines if the packet is inbound or outbound.</span></span>

<span data-ttu-id="5b31d-182">W przypadku pakietów wychodzących serwer NAT sprawdza adres i port źródła nagłówka IP pakietu.</span><span class="sxs-lookup"><span data-stu-id="5b31d-182">For outbound packets, the NAT server checks the packet IP header source address and port.</span></span> <span data-ttu-id="5b31d-183">Jeśli tabela translacji nie zawiera wpisu dla pakietu, który został wcześniej Wysłany przez ten host dla tego samego miejsca docelowego, translator adresów sieciowych utworzy nowy wpis, który będzie zawierał unikatowy globalny źródłowy adres IP: port dla połączenia, i zmodyfikuje nagłówki pakietów przy użyciu tego nowego adresu IP: Port przed wysłaniem go do sieci zewnętrznej.</span><span class="sxs-lookup"><span data-stu-id="5b31d-183">If the translation table does not contain an entry for a packet previously sent by this host for the same destination, NAT will create a new entry which will contain a unique global source IP address:port for the connection, and modify the packet headers with this new IP address:port before sending it onto the external network.</span></span>

<span data-ttu-id="5b31d-184">W przypadku pakietów przychodzących serwer NAT szuka poprzedniego wpisu w swojej tabeli translacji z zewnętrznym adresem IP: Port pasujący do docelowego adresu IP pakietu: port.</span><span class="sxs-lookup"><span data-stu-id="5b31d-184">For inbound packets, the NAT server looks for a previous entry in its translation table with an external IP address: port matching the packet destination IP address: port.</span></span> <span data-ttu-id="5b31d-185">Jeśli nie zostanie znalezione żadne dopasowanie, odrzuci pakiet, chyba że adres docelowy: port jest adresem zewnętrznym serwera w sieci lokalnej.</span><span class="sxs-lookup"><span data-stu-id="5b31d-185">If no match is found, it will discard the packet unless the destination address: port is the external address for server on the local network.</span></span> <span data-ttu-id="5b31d-186">W przypadku znalezienia dopasowania zostanie on zastąpiony zewnętrzny docelowy adres IP nagłówka pakietu: port z prywatnym adresem IP: port i wysłać pakiet do sieci lokalnej do zamierzonego hosta prywatnego.</span><span class="sxs-lookup"><span data-stu-id="5b31d-186">If it does find a match, it will replace the packet header’s external destination IP address: port with the private IP address: port and send the packet onto the local network to the intended private host.</span></span>

<span data-ttu-id="5b31d-187">NetX Duo translator adresów sieciowych używa zakresu portów TCP, UDP i ICMP do tworzenia unikatowego adresu lokalnego: połączenia portów dla hostów lokalnych łączących się z hostami zewnętrznymi.</span><span class="sxs-lookup"><span data-stu-id="5b31d-187">NetX Duo NAT uses a range of TCP, UDP and ICMP translation ports for creating unique local address: port connections for local hosts connecting with outside hosts.</span></span> <span data-ttu-id="5b31d-188">Następujące konfigurowalne opcje zdefiniowane w *nx_nat. h* definiują zakres dla każdego protokołu:</span><span class="sxs-lookup"><span data-stu-id="5b31d-188">The following user configurable options, defined in *nx_nat.h,* define the range for each protocol:</span></span>

```C
NX_NAT_START_TCP_PORT

NX_NAT_END_TCP_PORT

NX_NAT_START_UDP_PORT

NX_NAT_END_UDP_PORT

NX_NAT_START_ICMP_QUERY_ID

NX_NAT_END_ICMP_QUERY_ID
```

## <a name="nat-requirements-and-constraints"></a><span data-ttu-id="5b31d-189">Wymagania i ograniczenia dotyczące translatora adresów sieciowych</span><span class="sxs-lookup"><span data-stu-id="5b31d-189">NAT Requirements and Constraints</span></span>

<span data-ttu-id="5b31d-190">NetX Duo translator adresów sieciowych wymaga NetX Duo 5,8 lub nowszego.</span><span class="sxs-lookup"><span data-stu-id="5b31d-190">NetX Duo NAT requires NetX Duo 5.8 or later.</span></span> <span data-ttu-id="5b31d-191">Aplikacja NAT wymaga utworzenia jednego wystąpienia IP i interfejsu do wewnętrznej i zewnętrznej sieci fizycznej.</span><span class="sxs-lookup"><span data-stu-id="5b31d-191">The NAT application requires creation of a single IP instance and an interface to the internal and external physical network.</span></span>

<span data-ttu-id="5b31d-192">Powiązanych</span><span class="sxs-lookup"><span data-stu-id="5b31d-192">Constraints:</span></span>

- <span data-ttu-id="5b31d-193">NetX Duo translator adresów sieciowych obsługuje protokoły TCP, UDP i ICMP.</span><span class="sxs-lookup"><span data-stu-id="5b31d-193">NetX Duo NAT supports TCP, UDP and ICMP.</span></span> <span data-ttu-id="5b31d-194">Protokół IGMP nie jest obsługiwany.</span><span class="sxs-lookup"><span data-stu-id="5b31d-194">IGMP is not supported.</span></span>
- <span data-ttu-id="5b31d-195">Translator adresów sieciowych NetX Duo nie obsługuje adresowania IPv6.</span><span class="sxs-lookup"><span data-stu-id="5b31d-195">NetX Duo NAT does not support IPv6 addressing.</span></span>
- <span data-ttu-id="5b31d-196">Translator adresów sieciowych NetX Duo nie obejmuje usług DNS ani DHCP, chociaż NetX Duo translator adresów sieciowych może zintegrować te usługi z ich operacjami NAT.</span><span class="sxs-lookup"><span data-stu-id="5b31d-196">NetX Duo NAT does not include DNS or DHCP services, although NetX Duo NAT can integrate those services with its NAT operations.</span></span>

## <a name="rfcs-supported-by-netx-duo-nat"></a><span data-ttu-id="5b31d-197">Specyfikacje RFC obsługiwane przez NetX Duo translator adresów sieciowych</span><span class="sxs-lookup"><span data-stu-id="5b31d-197">RFCs Supported by NetX Duo NAT</span></span>

<span data-ttu-id="5b31d-198">Implementacja translatora adresów sieciowych NetX Duo jest oparta na informacjach przedstawionych w następujących dokumentach RFC:</span><span class="sxs-lookup"><span data-stu-id="5b31d-198">NetX Duo NAT implementation is based on information presented in the following RFCs:</span></span>

- <span data-ttu-id="5b31d-199">RFC 2663: Terminologia i zagadnienia dotyczące translatora adresów sieciowych IP</span><span class="sxs-lookup"><span data-stu-id="5b31d-199">RFC 2663: IP Network Address Translator (NAT) Terminology and Considerations</span></span>
- <span data-ttu-id="5b31d-200">RFC 3022: netowrk (tradycyjny NAT) translator adresów IP</span><span class="sxs-lookup"><span data-stu-id="5b31d-200">RFC 3022: Traditional IP Netowrk Address Translator (Traditional NAT)</span></span>
- <span data-ttu-id="5b31d-201">RFC 4787: wymagania dotyczące zachowania translacji adresów sieciowych (NAT) dla protokołu UDP emisji pojedynczej</span><span class="sxs-lookup"><span data-stu-id="5b31d-201">RFC 4787: Network Address Translation (NAT) Behavioral Requirements for Unicast UDP</span></span>
