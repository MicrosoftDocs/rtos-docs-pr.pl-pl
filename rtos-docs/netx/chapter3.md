---
title: Rozdział 3 — funkcjonalne składniki platformy Azure RTO NetX
description: Ten rozdział zawiera opis stosu TCP/IP o wysokiej wydajności usługi Azure RTO NetX z perspektywy funkcjonalnej.
author: philmea
ms.author: philmea
ms.date: 05/19/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: db23aa152b2765ac7cc9be098723fc5df0947484
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/22/2021
ms.locfileid: "104822789"
---
# <a name="chapter-3---functional-components-of-azure-rtos-netx"></a><span data-ttu-id="b6d16-103">Rozdział 3 — funkcjonalne składniki platformy Azure RTO NetX</span><span class="sxs-lookup"><span data-stu-id="b6d16-103">Chapter 3 - Functional Components of Azure RTOS NetX</span></span>

<span data-ttu-id="b6d16-104">Ten rozdział zawiera opis stosu TCP/IP o wysokiej wydajności usługi Azure RTO NetX z perspektywy funkcjonalnej.</span><span class="sxs-lookup"><span data-stu-id="b6d16-104">This chapter contains a description of the high-performance Azure RTOS NetX TCP/IP stack from a functional perspective.</span></span> 

## <a name="execution-overview"></a><span data-ttu-id="b6d16-105">Przegląd wykonywania</span><span class="sxs-lookup"><span data-stu-id="b6d16-105">Execution Overview</span></span>

<span data-ttu-id="b6d16-106">Istnieje pięć typów wykonywania programu w ramach aplikacji NetX: inicjalizacja, wywołania interfejsu aplikacji, wewnętrzny wątek IP, okresowe czasomierze IP i sterownik sieciowy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-106">There are five types of program execution within a NetX application: initialization, application interface calls, internal IP thread, IP periodic timers, and the network driver.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-107">NetX wymaga instalacji ThreadX i zależy od jej wykonywania, zawieszania, okresowych czasomierzy i wzajemnych wykluczeń.</span><span class="sxs-lookup"><span data-stu-id="b6d16-107">NetX requires the installation of ThreadX and depends on its thread execution, suspension, periodic timers, and mutual exclusion facilities.</span></span>

### <a name="initialization"></a><span data-ttu-id="b6d16-108">Inicjalizacja</span><span class="sxs-lookup"><span data-stu-id="b6d16-108">Initialization</span></span>

<span data-ttu-id="b6d16-109">Przed wywołaniem innej usługi NetX należy wywołać usługę \***nx_system_initialize** _.</span><span class="sxs-lookup"><span data-stu-id="b6d16-109">The service \***nx_system_initialize** _ must be called before any other NetX service is called.</span></span> <span data-ttu-id="b6d16-110">Inicjalizację systemu można wywołać z ThreadX _ *_tx_application_define_*\* procedury lub z wątków aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-110">System initialization can be called either from the ThreadX _ *_tx_application_define_*\* routine or from application threads.</span></span>

<span data-ttu-id="b6d16-111">Po znaku \***nx_system_initialize** _ system jest gotowy do tworzenia pul pakietów i wystąpień adresów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-111">After \***nx_system_initialize** _ returns, the system is ready to create packet pools and IP instances.</span></span> <span data-ttu-id="b6d16-112">Ponieważ utworzenie wystąpienia adresu IP wymaga domyślnej puli pakietów, musi istnieć co najmniej jedna pula pakietów NetX przed utworzeniem wystąpienia adresu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-112">Because creating an IP instance requires a default packet pool, at least one NetX packet pool must exist prior to creating an IP instance.</span></span> <span data-ttu-id="b6d16-113">Tworzenie pul pakietów i wystąpień adresów IP jest dozwolone z funkcji inicjowania ThreadX _ *_tx_application_define_*\* i z wątków aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-113">Creating packet pools and IP instances are allowed from the ThreadX initialization function _ *_tx_application_define_*\* and from application threads.</span></span>

<span data-ttu-id="b6d16-114">Wewnętrznie Tworzenie wystąpienia IP jest realizowane w dwóch częściach.</span><span class="sxs-lookup"><span data-stu-id="b6d16-114">Internally, creating an IP instance is accomplished in two parts.</span></span> <span data-ttu-id="b6d16-115">Pierwsza część jest wykonywana w kontekście obiektu wywołującego, z ***tx_application_define*** lub z kontekstu wątku aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-115">The first part is done within the context of the caller, either from ***tx_application_define*** or from an application thread's context.</span></span> <span data-ttu-id="b6d16-116">Obejmuje to Konfigurowanie struktury danych IP i tworzenie różnych zasobów IP, w tym wewnętrznego wątku IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-116">This includes setting up the IP data structure and creating various IP resources, including the internal IP thread.</span></span> <span data-ttu-id="b6d16-117">Druga część jest wykonywana podczas początkowego wykonywania z wewnętrznego wątku IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-117">The second part is performed during the initial execution from the internal IP thread.</span></span> <span data-ttu-id="b6d16-118">Jest to miejsce, w którym sterownik sieciowy dostarczony podczas pierwszej części tworzenia IP jest najpierw wywoływany.</span><span class="sxs-lookup"><span data-stu-id="b6d16-118">This is where the network driver, supplied during the first part of IP creation, is first called.</span></span> <span data-ttu-id="b6d16-119">Wywołanie sterownika sieci z wewnętrznego wątku IP umożliwia sterownikowi wykonywanie operacji we/wy i wstrzymywanie podczas przetwarzania inicjalizacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-119">Calling the network driver from the internal IP thread enables the driver to perform I/O and suspend during its initialization processing.</span></span> <span data-ttu-id="b6d16-120">Gdy sterownik sieciowy wraca z przetwarzania inicjowania, tworzenie adresu IP zostało zakończone.</span><span class="sxs-lookup"><span data-stu-id="b6d16-120">When the network driver returns from its initialization processing, the IP creation is complete.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-121">**Nx_ip_status_check** usługi NetX jest dostępna, aby uzyskać informacje o wystąpieniu adresu IP i jego podstawowym stanie interfejsu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-121">The NetX service **nx_ip_status_check** is available to obtain information on the IP instance and its primary interface status.</span></span> <span data-ttu-id="b6d16-122">Takie informacje o stanie obejmują, czy łącze jest inicjowane, włączone oraz czy adres IP jest rozpoznawany.</span><span class="sxs-lookup"><span data-stu-id="b6d16-122">Such status information includes whether or not the link is initialized, enabled, and IP address is resolved.</span></span> <span data-ttu-id="b6d16-123">Te informacje służą do synchronizowania wątków aplikacji, które wymagają użycia nowo utworzonego wystąpienia adresu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-123">This information is used to synchronize application threads needing to use a newly created IP instance.</span></span> <span data-ttu-id="b6d16-124">W przypadku systemów z wieloma systemami prywatnymi Zobacz "Pomoc techniczna z wieloma domem" poniżej.</span><span class="sxs-lookup"><span data-stu-id="b6d16-124">For multihome systems, see "Multihome Support" below.</span></span> <span data-ttu-id="b6d16-125">**nx_ip_interface_status_check** jest dostępny do uzyskania informacji o określonym interfejsie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-125">**nx_ip_interface_status_check** is available to obtain information on the specified interface.</span></span>

### <a name="application-interface-calls"></a><span data-ttu-id="b6d16-126">Wywołania interfejsu aplikacji</span><span class="sxs-lookup"><span data-stu-id="b6d16-126">Application Interface Calls</span></span>

<span data-ttu-id="b6d16-127">Wywołania z aplikacji są wykonywane w dużej mierze od wątków aplikacji uruchomionych w ramach ThreadX RTO.</span><span class="sxs-lookup"><span data-stu-id="b6d16-127">Calls from the application are largely made from application threads running under the ThreadX RTOS.</span></span> <span data-ttu-id="b6d16-128">Jednak niektóre inicjalizacje, tworzenie i Włączanie usług mogą być wywoływane z ***tx_application_define***.</span><span class="sxs-lookup"><span data-stu-id="b6d16-128">However, some initialization, create, and enable services may be called from ***tx_application_define***.</span></span> <span data-ttu-id="b6d16-129">Sekcje "dozwolone z" w rozdziale 4 wskazują, z której może być wywoływana każda usługa NetX.</span><span class="sxs-lookup"><span data-stu-id="b6d16-129">The "Allowed From" sections in Chapter 4 indicate from which each NetX service can be called.</span></span>

<span data-ttu-id="b6d16-130">W większości przypadków działania z intensywnym przetwarzaniem, takie jak obliczanie sum kontrolnych, są wykonywane w kontekście wątku wywołującego — bez blokowania dostępu innych wątków do wystąpienia IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-130">For the most part, processing intensive activities such as computing checksums is done within the calling thread's context—without blocking the access of other threads to the IP instance.</span></span> <span data-ttu-id="b6d16-131">Na przykład podczas transmisji, obliczenia sumy kontrolnej UDP są wykonywane w ramach usługi ***nx_udp_socket_send*** , przed wywołaniem podstawowej funkcji wysyłania adresów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-131">For example, on transmission, the UDP checksum calculation is performed inside the ***nx_udp_socket_send*** service, prior to calling the underlying IP send function.</span></span> <span data-ttu-id="b6d16-132">W przypadku odebranego pakietu suma kontrolna UDP jest obliczana w ramach usługi ***nx_udp_socket_receive*** wykonywanej w kontekście wątku aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-132">On a received packet, the UDP checksum is calculated in the ***nx_udp_socket_receive*** service, executed in the context of the application thread.</span></span> <span data-ttu-id="b6d16-133">Pomaga to zapobiegać zapewnieniu żądań sieci przez wątki o wyższym priorytecie z powodu przetwarzania obliczeń sum kontrolnych o niższym priorytecie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-133">This helps prevent stalling network requests of higher-priority threads because of processing intensive checksum computation in lower-priority threads.</span></span>

<span data-ttu-id="b6d16-134">Wartości, takie jak adresy IP i numery portów, są przesyłane do funkcji interfejsu API w kolejności bajtów hosta.</span><span class="sxs-lookup"><span data-stu-id="b6d16-134">Values, such as IP addresses and port numbers, are passed to API functions in host byte order.</span></span> <span data-ttu-id="b6d16-135">Wewnętrznie te wartości są przechowywane w kolejności bajtów hosta.</span><span class="sxs-lookup"><span data-stu-id="b6d16-135">Internally these values are stored in host byte order as well.</span></span> <span data-ttu-id="b6d16-136">Dzięki temu deweloperzy mogą łatwo wyświetlać wartości za pomocą debugera.</span><span class="sxs-lookup"><span data-stu-id="b6d16-136">This enables developers to easily view the values via a debugger.</span></span> <span data-ttu-id="b6d16-137">Gdy te wartości są programowane do ramki do transmisji, są konwertowane na kolejność bajtów sieci.</span><span class="sxs-lookup"><span data-stu-id="b6d16-137">When these values are programmed into a frame for transmission, they are converted to network byte order.</span></span>

### <a name="internal-ip-thread"></a><span data-ttu-id="b6d16-138">Wewnętrzny wątek IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-138">Internal IP Thread</span></span>

<span data-ttu-id="b6d16-139">Jak wspomniano, każde wystąpienie protokołu IP w NetX ma swój własny wątek.</span><span class="sxs-lookup"><span data-stu-id="b6d16-139">As mentioned, each IP instance in NetX has its own thread.</span></span> <span data-ttu-id="b6d16-140">Priorytet i rozmiar stosu wewnętrznego wątku IP są zdefiniowane w usłudze ***nx_ip_create*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-140">The priority and stack size of the internal IP thread is defined in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="b6d16-141">Wewnętrzny wątek IP jest tworzony w trybie gotowym do wykonania.</span><span class="sxs-lookup"><span data-stu-id="b6d16-141">The internal IP thread is created in a ready-to-execute mode.</span></span> <span data-ttu-id="b6d16-142">Jeśli wątek IP ma wyższy priorytet niż wątek wywołujący, może wystąpić zastępujący w wywołaniu IP Create.</span><span class="sxs-lookup"><span data-stu-id="b6d16-142">If the IP thread has a higher priority than the calling thread, preemption may occur inside the IP create call.</span></span>

<span data-ttu-id="b6d16-143">Punkt wejścia wewnętrznego wątku IP jest w wewnętrznej funkcji ***_nx_ip_thread_entry***.</span><span class="sxs-lookup"><span data-stu-id="b6d16-143">The entry point of the internal IP thread is at the internal function ***_nx_ip_thread_entry***.</span></span> <span data-ttu-id="b6d16-144">Po uruchomieniu wewnętrzny wątek IP najpierw kończy inicjalizację sterownika sieci, która składa się z trzech wywołań sterownika sieci specyficznego dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-144">When started, the internal IP thread first completes network driver initialization, which consists of making three calls to the application-specific network driver.</span></span> <span data-ttu-id="b6d16-145">Pierwsze wywołanie polega na dołączeniu sterownika sieci do wystąpienia IP, po którym następuje wywołanie inicjacji, które umożliwia sterownikowi sieciowe przechodzenie przez proces inicjalizacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-145">The first call is to attach the network driver to the IP instance, followed by an initialization call, which allows the network driver to go through the initialization process.</span></span> <span data-ttu-id="b6d16-146">Po powrocie sterownika sieci z inicjacji (może on zostać zawieszony podczas oczekiwania na prawidłowe skonfigurowanie sprzętu), wewnętrzny wątek IP wywołuje ponownie sterownik sieciowy, aby włączyć link.</span><span class="sxs-lookup"><span data-stu-id="b6d16-146">After the network driver returns from initialization (it may suspend while waiting for the hardware to be properly set up), the internal IP thread calls the network driver again to enable the link.</span></span> 

<span data-ttu-id="b6d16-147">Po powrocie sterownika sieci z wywołania Włącz łącze, wewnętrzny wątek IP wprowadza pętlę nieskończoną dla różnych zdarzeń, które wymagają przetworzenia dla tego wystąpienia IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-147">After the network driver returns from the link enable call, the internal IP thread enters an endless loop checking for various events that need processing for this IP instance.</span></span> <span data-ttu-id="b6d16-148">Zdarzenia przetwarzane w tej pętli obejmują odroczony przyjmowanie pakietów IP, zestaw fragmentów pakietów IP, przetwarzanie ping protokołu ICMP, przetwarzanie protokołu IGMP, przetwarzanie kolejki pakietów TCP, przetwarzanie przez TCP, przekroczenie limitu czasu zestawu fragmentów adresów IP oraz okresowe przetwarzanie IGMP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-148">Events processed in this loop include deferred IP packet reception, IP packet fragment assembly, ICMP ping processing, IGMP processing, TCP packet queue processing, TCP periodic processing, IP fragment assembly timeouts, and IGMP periodic processing.</span></span> <span data-ttu-id="b6d16-149">Zdarzenia obejmują również działania dotyczące rozpoznawania adresów: Przetwarzanie pakietów ARP i okresowe przetwarzanie ARP w sieci IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-149">Events also include address resolution activities: ARP packet processing and ARP periodic processing in the IP network.</span></span>

> [!NOTE]
> <span data-ttu-id="b6d16-150">*Funkcje wywołania zwrotnego NetX, w tym nasłuchiwanie i rozłączane wywołania zwrotne, są wywoływane z wewnętrznego wątku IP — a nie oryginalnego wątku wywołującego. Aplikacja musi zadbać o to, aby nie wstrzymywać wewnątrz żadnej funkcji wywołania zwrotnego NetX.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-150">*The NetX callback functions, including listen and disconnect callbacks, are called from the internal IP thread—not the original calling thread. The application must take care not to suspend inside any NetX callback function.*</span></span>

### <a name="ip-periodic-timers"></a><span data-ttu-id="b6d16-151">Okresowe czasomierze IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-151">IP Periodic Timers</span></span>
<span data-ttu-id="b6d16-152">Dla każdego wystąpienia IP są używane dwa okresowe czasomierze ThreadX.</span><span class="sxs-lookup"><span data-stu-id="b6d16-152">There are two ThreadX periodic timers used for each IP instance.</span></span> <span data-ttu-id="b6d16-153">Pierwszy z nich to jednorazowy czasomierz dla protokołu ARP, protokołu IGMP, limitu czasu protokołu TCP, a także dyski reasemblera fragmentu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-153">The first one is a one-second timer for ARP, IGMP, TCP timeout, and it also drives IP fragment reassemble processing.</span></span> <span data-ttu-id="b6d16-154">Drugi czasomierz to czasomierz 100 ms, który umożliwia przekroczenie limitu czasu ponownej transmisji protokołu TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-154">The second timer is a 100ms timer to drive the TCP retransmission timeout.</span></span>

### <a name="network-driver"></a><span data-ttu-id="b6d16-155">Sterownik sieciowy</span><span class="sxs-lookup"><span data-stu-id="b6d16-155">Network Driver</span></span>
<span data-ttu-id="b6d16-156">Każde wystąpienie IP w NetX ma interfejs podstawowy, który jest identyfikowany przez jego sterownik urządzenia określony w usłudze ***nx_ip_create*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-156">Each IP instance in NetX has a primary interface, which is identified by its device driver specified in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="b6d16-157">Sterownik sieciowy jest odpowiedzialny za obsługę różnych żądań NetX, w tym transmisja pakietów, odbieranie pakietów i żądania dotyczące stanu i kontroli.</span><span class="sxs-lookup"><span data-stu-id="b6d16-157">The network driver is responsible for handling various NetX requests, including packet transmission, packet reception, and requests for status and control.</span></span>

<span data-ttu-id="b6d16-158">W przypadku systemu wieloznacznego wystąpienie protokołu IP zawiera wiele interfejsów, z których każdy jest skojarzony ze sterownikiem sieciowym wykonującym te zadania dla odpowiedniego interfejsu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-158">For a multi-home system, the IP instance has multiple interfaces, each with an associated network driver that performs these tasks for the respective interface.</span></span>

<span data-ttu-id="b6d16-159">Sterownik sieciowy musi również obsługiwać zdarzenia asynchroniczne występujące na nośniku.</span><span class="sxs-lookup"><span data-stu-id="b6d16-159">The network driver must also handle asynchronous events occurring on the media.</span></span> <span data-ttu-id="b6d16-160">Zdarzenia asynchroniczne z nośnika obejmują odbieranie pakietów, uzupełnianie transmisji pakietów i zmiany stanu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-160">Asynchronous events from the media include packet reception, packet transmission completion, and status changes.</span></span> <span data-ttu-id="b6d16-161">NetX udostępnia sterownik sieciowy z kilkoma funkcjami dostępu do obsługi różnych zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="b6d16-161">NetX provides the network driver with several access functions to handle various events.</span></span> <span data-ttu-id="b6d16-162">Te funkcje są przeznaczone do wywoływania z części procedury usługi przerwania sterownika sieci.</span><span class="sxs-lookup"><span data-stu-id="b6d16-162">These functions are designed to be called from the interrupt service routine portion of the network driver.</span></span> <span data-ttu-id="b6d16-163">W przypadku sieci IP sterownik sieciowy powinien przesłać dalej wszystkie pakiety ARP odebrane do funkcji wewnętrznej \***_nx_arp_packet_deferred_receive** _.</span><span class="sxs-lookup"><span data-stu-id="b6d16-163">For IP networks, the network driver should forward all ARP packets received to the \***_nx_arp_packet_deferred_receive** _ internal function.</span></span> <span data-ttu-id="b6d16-164">Wszystkie pakiety RARP powinny być przekazywane do _ *_ _nx_rarp_packet_deferred_receive_* _ funkcji wewnętrznej.</span><span class="sxs-lookup"><span data-stu-id="b6d16-164">All RARP packets should be forwarded to _ *_ _nx_rarp_packet_deferred_receive_* _ internal function.</span></span> <span data-ttu-id="b6d16-165">Dostępne są dwie opcje pakietów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-165">There are two options for IP packets.</span></span> <span data-ttu-id="b6d16-166">Jeśli jest wymagane szybkie wysyłanie pakietów IP, przychodzące pakiety IP powinny być przekazywane do _ _ *_nx_ip_packet_receive_* _ do natychmiastowego przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="b6d16-166">If fast dispatch of IP packets is required, incoming IP packets should be forwarded to _ *_ _nx_ip_packet_receive_* _ for immediate processing.</span></span> <span data-ttu-id="b6d16-167">Znacznie poprawia to wydajność NetX w obsłudze pakietów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-167">This greatly improves NetX performance in handling IP packets.</span></span> <span data-ttu-id="b6d16-168">W przeciwnym razie sterownik sieciowy powinien przekazywać pakiety IP do _ \* _ _nx_ip_packet_deferred_receive_\* \*.</span><span class="sxs-lookup"><span data-stu-id="b6d16-168">Otherwise, the network driver should forward IP packets to _\*_ _nx_ip_packet_deferred_receive_\*\*.</span></span> <span data-ttu-id="b6d16-169">Ta usługa umieszcza pakiet IP w odroczonej kolejce przetwarzania, w której jest następnie obsługiwany przez wewnętrzny wątek IP, co skutkuje mniejszą ilością czasu przetwarzania ISR.</span><span class="sxs-lookup"><span data-stu-id="b6d16-169">This service places the IP packet in the deferred processing queue where it is then handled by the internal IP thread, which results in the least amount of ISR processing time.</span></span>

<span data-ttu-id="b6d16-170">Sterownik sieciowy może również odroczyć przetwarzanie przerwania w celu uruchomienia z kontekstu wątku IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-170">The network driver can also defer interrupt processing to run out of the context of the IP thread.</span></span> <span data-ttu-id="b6d16-171">W tym trybie procedura ISR zapisze niezbędne informacje, wywołaj wewnętrzną funkcję ***_nx_ip_driver_deferred_processing*** i Potwierdź kontroler przerwań.</span><span class="sxs-lookup"><span data-stu-id="b6d16-171">In this mode, the ISR shall save the necessary information, call the internal function ***_nx_ip_driver_deferred_processing***, and acknowledge the interrupt controller.</span></span> <span data-ttu-id="b6d16-172">Ta usługa powiadamia wątek IP w celu zaplanowania wywołania zwrotnego sterownika urządzenia, aby zakończyć przetwarzanie zdarzenia, które powoduje przerwanie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-172">This service notifies IP thread to schedule a callback to the device driver to complete the processing of the event that causes the interrupt.</span></span>

<span data-ttu-id="b6d16-173">Niektóre kontrolery sieci mogą wykonywać obliczenia i weryfikację sum kontrolnych nagłówka TCP/IP na sprzęcie bez uwzględniania cennych zasobów procesora CPU.</span><span class="sxs-lookup"><span data-stu-id="b6d16-173">Some network controllers are capable of performing TCP/IP header checksum computation and validation in hardware, without taking up valuable CPU resources.</span></span> <span data-ttu-id="b6d16-174">Aby skorzystać z funkcji sprzętowej, NetX oferuje opcje włączania lub wyłączania obliczeń sum kontrolnych oprogramowania w czasie kompilacji, a także włączania lub wyłączania obliczeń sum kontrolnych w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="b6d16-174">To take advantage of the hardware capability feature, NetX provides options to enable or disable various software checksum computation at compilation time, as well as turning on or off checksum computation at run time.</span></span> <span data-ttu-id="b6d16-175">Aby uzyskać bardziej szczegółowe informacje na temat pisania sterowników sieciowych NetX, zobacz "[rozdział 5 NetX Network Drivers](chapter5.md)".</span><span class="sxs-lookup"><span data-stu-id="b6d16-175">See "[Chapter 5 NetX Network Drivers](chapter5.md)" for more detailed information on writing NetX network drivers.</span></span>

### <a name="multihome-support"></a><span data-ttu-id="b6d16-176">Obsługa wielostrona</span><span class="sxs-lookup"><span data-stu-id="b6d16-176">Multihome Support</span></span>
<span data-ttu-id="b6d16-177">NetX obsługuje systemy połączone z wieloma urządzeniami fizycznymi przy użyciu jednego wystąpienia IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-177">NetX supports systems connected to multiple physical devices using a single IP instance.</span></span> <span data-ttu-id="b6d16-178">Każdy interfejs fizyczny jest przypisany do bloku sterowania interfejsem w wystąpieniu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-178">Each physical interface is assigned to an interface control block in the IP instance.</span></span> <span data-ttu-id="b6d16-179">Aplikacje chcące korzystać z systemu wieloznacznego muszą definiować wartość **NX_MAX_PHSYCIAL_INTERFACES** do liczby urządzeń fizycznych podłączonych do systemu i ponownie kompilować bibliotekę NetX.</span><span class="sxs-lookup"><span data-stu-id="b6d16-179">Applications wishing to use a multihome system must define the value for **NX_MAX_PHSYCIAL_INTERFACES** to the number of physical devices attached to the system, and rebuild NetX library.</span></span> <span data-ttu-id="b6d16-180">Domyślnie **NX_MAX_PHYSICAL_INTERFACES** jest ustawiona na jeden, tworząc jeden blok sterowania interfejsem w wystąpieniu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-180">By default **NX_MAX_PHYSICAL_INTERFACES** is set to one, creating one interface control block in the IP instance.</span></span>

<span data-ttu-id="b6d16-181">Aplikacja NetX tworzy pojedyncze wystąpienie adresu IP dla urządzenia podstawowego przy użyciu usługi \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="b6d16-181">The NetX application creates a single IP instance for the primary device using the \***nx_ip_create** _ service.</span></span> <span data-ttu-id="b6d16-182">Dla każdego dodatkowego urządzenia sieciowego aplikacja dołącza urządzenie do wystąpienia IP przy użyciu usługi _ \*_nx_ip_interface_attach_\*\*.</span><span class="sxs-lookup"><span data-stu-id="b6d16-182">For each additional network devices, the application attaches the device to the IP instance using the _ *_nx_ip_interface_attach_*\* service.</span></span>

<span data-ttu-id="b6d16-183">Każda struktura interfejsu sieciowego zawiera podzestaw informacji o sieci o interfejsie sieciowym, który znajduje się w bloku kontroli IP, w tym adres IP interfejsu, maskę podsieci, rozmiar IP jednostki MTU i informacje o adresie warstwy MAC.</span><span class="sxs-lookup"><span data-stu-id="b6d16-183">Each network interface structure contains a subset of network information about the network interface that is contained in the IP control block, including interface IP address, subnet mask, IP MTU size, and MAC-layer address information.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-184">*NetX z obsługą wielodomu jest zgodna z poprzednimi wersjami NetX. Usługi, które nie pobierają domyślnych informacji o interfejsie, do podstawowego urządzenia sieciowego.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-184">*NetX with multihome support is backward compatible with earlier versions of NetX. Services that do not take explicit interface information default to the primary network device.*</span></span>

<span data-ttu-id="b6d16-185">Interfejs podstawowy ma indeks zero na liście wystąpień adresów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-185">The primary interface has index zero in the IP instance list.</span></span> <span data-ttu-id="b6d16-186">Do każdego kolejnego urządzenia dołączonego do wystąpienia protokołu IP jest przypisywany następny indeks.</span><span class="sxs-lookup"><span data-stu-id="b6d16-186">Each subsequent device attached to the IP instance is assigned the next index.</span></span>

<span data-ttu-id="b6d16-187">Wszystkie usługi protokołów warstwy wyższej, dla których jest włączone wystąpienie protokołu IP, w tym protokoły TCP, UDP, ICMP i IGMP, są dostępne dla wszystkich dołączonych urządzeń.</span><span class="sxs-lookup"><span data-stu-id="b6d16-187">All upper layer protocol services for which the IP instance is enabled, including TCP, UDP, ICMP, and IGMP, are available to all the attached devices.</span></span>

<span data-ttu-id="b6d16-188">W większości przypadków NetX może określić najlepszy adres źródłowy do użycia podczas przesyłania pakietu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-188">In most cases, NetX can determine the best source address to use when transmitting a packet.</span></span> <span data-ttu-id="b6d16-189">Wybór adresów źródłowych jest oparty na adresie docelowym.</span><span class="sxs-lookup"><span data-stu-id="b6d16-189">The source address selection is based on the destination address.</span></span> <span data-ttu-id="b6d16-190">Usługi NetX Services są udostępniane, aby umożliwić aplikacjom określenie określonego adresu źródłowego, w przypadkach, gdy najbardziej odpowiedni dla nich nie może być określony przez adres docelowy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-190">NetX services are provided to allow applications to specify a specific source address to use, in cases where the most suitable one cannot be determined by the destination address.</span></span> <span data-ttu-id="b6d16-191">Przykładem może być w systemie z wieloma lokalizacjami, aplikacja musi wysłać pakiet do adresów IP emisji lub multiemisji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-191">An example would be in a multihome system, an application needs to send a packet to an IP broadcast or multicast destination addresses.</span></span>

<span data-ttu-id="b6d16-192">Usługi przeznaczone do tworzenia aplikacji multihomed:</span><span class="sxs-lookup"><span data-stu-id="b6d16-192">Services specifically for developing multihome applications include the following:</span></span>

<span data-ttu-id="b6d16-193">*nx_igmp_multicast_interface_join nx_ip_driver_interface_direct_command nx_ip_interface_address_get nx_ip_interface_address_set nx_ip_interface_attach nx_ip_interface_info_get nx_ip_interface_status_check nx_ip_raw_packet_interface_send nx_udp_socket_interface_send*</span><span class="sxs-lookup"><span data-stu-id="b6d16-193">*nx_igmp_multicast_interface_join nx_ip_driver_interface_direct_command nx_ip_interface_address_get nx_ip_interface_address_set nx_ip_interface_attach nx_ip_interface_info_get nx_ip_interface_status_check nx_ip_raw_packet_interface_send nx_udp_socket_interface_send*</span></span>

<span data-ttu-id="b6d16-194">Te usługi zostały omówione bardziej szczegółowo w[rozdziale 4 — Opis usług Azure RTO NetX Services](chapter4.md).</span><span class="sxs-lookup"><span data-stu-id="b6d16-194">These services are explained in greater detail in "[Chapter 4 - Description of Azure RTOS NetX Services](chapter4.md)".</span></span>

### <a name="loopback-interface"></a><span data-ttu-id="b6d16-195">Interfejs sprzężenia zwrotnego</span><span class="sxs-lookup"><span data-stu-id="b6d16-195">Loopback Interface</span></span>
<span data-ttu-id="b6d16-196">Interfejs sprzężenia zwrotnego jest specjalnym interfejsem sieciowym bez linku fizycznego dołączonego do.</span><span class="sxs-lookup"><span data-stu-id="b6d16-196">The loopback interface is a special network interface without an physical link attached to.</span></span> <span data-ttu-id="b6d16-197">Interfejs sprzężenia zwrotnego umożliwia aplikacjom komunikowanie się przy użyciu adresu IP sprzężenia zwrotnego 127.0.0.1</span><span class="sxs-lookup"><span data-stu-id="b6d16-197">The loopback interface allows applications to communicate using the IP loopback address 127.0.0.1</span></span>

<span data-ttu-id="b6d16-198">Aby użyć logicznego interfejsu sprzężenia zwrotnego, upewnij się, że opcja konfigurowalne ***NX_DISABLE_LOOPBACK_INTERFACE*** nie jest ustawiona.</span><span class="sxs-lookup"><span data-stu-id="b6d16-198">To utilize a logical loopback interface, ensure the configurable option ***NX_DISABLE_LOOPBACK_INTERFACE*** is not set.</span></span>

### <a name="interface-control-blocks"></a><span data-ttu-id="b6d16-199">Bloki sterujące interfejsu</span><span class="sxs-lookup"><span data-stu-id="b6d16-199">Interface Control Blocks</span></span>
<span data-ttu-id="b6d16-200">Liczba bloków sterujących interfejsem w wystąpieniu IP jest liczbą interfejsów fizycznych (zdefiniowanych przez \***NX_MAX_PHYSICAL_INTERFACES** _) i interfejsem sprzężenia zwrotnego, jeśli jest włączony.</span><span class="sxs-lookup"><span data-stu-id="b6d16-200">The number of interface control blocks in the IP instance is the number of physical interfaces (defined by \***NX_MAX_PHYSICAL_INTERFACES** _) plus the loopback interface if it is enabled.</span></span> <span data-ttu-id="b6d16-201">Łączna liczba interfejsów jest zdefiniowana w _ *_NX_MAX_IP_INTERFACES_* \*.</span><span class="sxs-lookup"><span data-stu-id="b6d16-201">The total number of interfaces is defined in _\*_NX_MAX_IP_INTERFACES_\*\*.</span></span>

## <a name="protocol-layering"></a><span data-ttu-id="b6d16-202">Warstwy protokołu</span><span class="sxs-lookup"><span data-stu-id="b6d16-202">Protocol Layering</span></span>

<span data-ttu-id="b6d16-203">Protokół TCP/IP zaimplementowany przez NetX jest protokołem warstwowym, co oznacza, że bardziej złożone protokoły są zbudowane w oparciu o prostsze protokoły bazowe.</span><span class="sxs-lookup"><span data-stu-id="b6d16-203">The TCP/IP implemented by NetX is a layered protocol, which means more complex protocols are built on top of simpler underlying protocols.</span></span> <span data-ttu-id="b6d16-204">W przypadku protokołu TCP/IP najniższy protokół warstwy znajduje się w *warstwie linku* i jest obsługiwany przez sterownik sieciowy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-204">In TCP/ IP, the lowest layer protocol is at the *link Layer* and is handled by the network driver.</span></span> <span data-ttu-id="b6d16-205">Ten poziom jest zwykle przeznaczony do sieci Ethernet, ale może być również Fiber, serial lub praktycznie dowolnym nośnikiem fizycznym.</span><span class="sxs-lookup"><span data-stu-id="b6d16-205">This level is typically targeted towards Ethernet, but it could also be fiber, serial, or virtually any physical media.</span></span>

<span data-ttu-id="b6d16-206">W górnej części warstwy linku znajduje się *warstwa sieciowa*.</span><span class="sxs-lookup"><span data-stu-id="b6d16-206">On top of the link layer is the *Network layer*.</span></span> <span data-ttu-id="b6d16-207">W przypadku protokołu TCP/IP jest to adres IP, który jest zasadniczo odpowiedzialny za wysyłanie i otrzymywanie prostych pakietów, w sposób optymalny w całej sieci.</span><span class="sxs-lookup"><span data-stu-id="b6d16-207">In TCP/IP, this is the IP, which is basically responsible for sending and receiving simple packets, in a best-effort manner, across the network.</span></span> <span data-ttu-id="b6d16-208">Protokoły typu zarządzania, takie jak ICMP i IGMP, są zazwyczaj klasyfikowane jako warstwy sieci, nawet jeśli są oparte na adresie IP do wysyłania i otrzymywania.</span><span class="sxs-lookup"><span data-stu-id="b6d16-208">Management type protocols like ICMP and IGMP are typically also categorized as network layers, even though they rely on IP for sending and receiving.</span></span>

<span data-ttu-id="b6d16-209">*Warstwa transportu* jest zareszcie warstwy sieciowej.</span><span class="sxs-lookup"><span data-stu-id="b6d16-209">The *Transport layer* rests on top of the network layer.</span></span> <span data-ttu-id="b6d16-210">Ta warstwa jest odpowiedzialna za zarządzanie przepływem danych między hostami w sieci.</span><span class="sxs-lookup"><span data-stu-id="b6d16-210">This layer is responsible for managing the flow of data between hosts on the network.</span></span> <span data-ttu-id="b6d16-211">Istnieją dwa typy usług transportowych obsługiwane przez NetX: UDP i TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-211">There are two types of transport services supported by NetX: UDP and TCP.</span></span> <span data-ttu-id="b6d16-212">Usługi UDP zapewniają optymalny sposób wysyłania i otrzymywania danych między dwoma hostami bez połączenia, natomiast protokół TCP zapewnia niezawodne usługi zorientowane na połączenia między dwiema jednostkami hosta.</span><span class="sxs-lookup"><span data-stu-id="b6d16-212">UDP services provide best-effort sending and receiving of data between two hosts in a connectionless manner, while TCP provides reliable connection-oriented service between two host entities.</span></span>

<span data-ttu-id="b6d16-213">Ta warstwa jest odzwierciedlana w rzeczywistych pakietach danych sieciowych.</span><span class="sxs-lookup"><span data-stu-id="b6d16-213">This layering is reflected in the actual network data packets.</span></span> <span data-ttu-id="b6d16-214">Każda warstwa w protokole TCP/IP zawiera blok informacji o nazwie header.</span><span class="sxs-lookup"><span data-stu-id="b6d16-214">Each layer in TCP/IP contains a block of information called a header.</span></span> <span data-ttu-id="b6d16-215">Ta technika otaczających danych (i prawdopodobnie informacji o protokole) z nagłówkiem jest zazwyczaj nazywana hermetyzacją danych.</span><span class="sxs-lookup"><span data-stu-id="b6d16-215">This technique of surrounding data (and possibly protocol information) with a header is typically called data encapsulation.</span></span> <span data-ttu-id="b6d16-216">Rysunek 1 pokazuje przykład warstw NetX i rysunek 2 przedstawia powstający hermetyzację danych dla wysyłanych danych UDP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-216">Figure 1 shows an example of NetX layering and Figure 2 shows the resulting data encapsulation for UDP data being sent.</span></span>

![Warstwy protokołu](./media/user-guide/protocol-layering.png)

<span data-ttu-id="b6d16-218">**RYSUNEK 1. Warstwy protokołu**</span><span class="sxs-lookup"><span data-stu-id="b6d16-218">**FIGURE 1. Protocol Layering**</span></span>

![Hermetyzacja danych UDP](./media/user-guide/udp-data-encapsulation.png)

<span data-ttu-id="b6d16-220">**RYSUNEK 2. Hermetyzacja danych UDP**</span><span class="sxs-lookup"><span data-stu-id="b6d16-220">**FIGURE 2. UDP Data Encapsulation**</span></span>

## <a name="packet-pools"></a><span data-ttu-id="b6d16-221">Pule pakietów</span><span class="sxs-lookup"><span data-stu-id="b6d16-221">Packet Pools</span></span>

<span data-ttu-id="b6d16-222">Przydzielanie pakietów w sposób szybki i deterministyczny jest zawsze wyzwaniem w aplikacjach sieci w czasie rzeczywistym.</span><span class="sxs-lookup"><span data-stu-id="b6d16-222">Allocating packets in a fast and deterministic manner is always a challenge in real-time networking applications.</span></span> <span data-ttu-id="b6d16-223">Z tego względu NetX zapewnia możliwość tworzenia wielu pul pakietów o stałym rozmiarze i zarządzania nimi.</span><span class="sxs-lookup"><span data-stu-id="b6d16-223">With this in mind, NetX provides the ability to create and manage multiple pools of fixed-size network packets.</span></span>

<span data-ttu-id="b6d16-224">Ponieważ pule pakietów NetX składają się z bloków pamięci o stałym rozmiarze, nigdy nie występują żadne wewnętrzne problemy z defragmentacją.</span><span class="sxs-lookup"><span data-stu-id="b6d16-224">Because NetX packet pools consist of fixed-size memory blocks, there are never any internal fragmentation problems.</span></span> <span data-ttu-id="b6d16-225">Oczywiście fragmentacja powoduje, że zachowanie, które jest niedeterministyczne.</span><span class="sxs-lookup"><span data-stu-id="b6d16-225">Of course, fragmentation causes behavior that is inherently nondeterministic.</span></span>

<span data-ttu-id="b6d16-226">Ponadto czas wymagany do przydzielenia i zwolnienia pakietu NetX do prostego manipulowania listą.</span><span class="sxs-lookup"><span data-stu-id="b6d16-226">In addition, the time required to allocate and free a NetX packet amounts to simple linked-list manipulation.</span></span> <span data-ttu-id="b6d16-227">Ponadto alokacja i cofanie pakietów odbywa się na końcu listy dostępnych.</span><span class="sxs-lookup"><span data-stu-id="b6d16-227">Furthermore, packet allocation and deallocation is done at the head of the available list.</span></span> <span data-ttu-id="b6d16-228">Zapewnia to najszybszy możliwy do przetwarzania listy połączonej.</span><span class="sxs-lookup"><span data-stu-id="b6d16-228">This provides the fastest possible linked list processing.</span></span>

<span data-ttu-id="b6d16-229">Brak elastyczności jest zazwyczaj główną wadą dla pul pakietów o stałym rozmiarze.</span><span class="sxs-lookup"><span data-stu-id="b6d16-229">Lack of flexibility is typically the main drawback of fixed-size packet pools.</span></span> <span data-ttu-id="b6d16-230">Określenie optymalnego rozmiaru ładunku pakietu, który również obsługuje pakiet przychodzący najgorszego przypadku, jest trudnym zadaniem.</span><span class="sxs-lookup"><span data-stu-id="b6d16-230">Determining the optimal packet payload size that also handles the worst-case incoming packet is a difficult task.</span></span> <span data-ttu-id="b6d16-231">Pakiety NetX dotyczą tego problemu z opcjonalną funkcją o nazwie tworzenie *łańcucha pakietów*.</span><span class="sxs-lookup"><span data-stu-id="b6d16-231">NetX packets address this problem with an optional feature called *packet chaining*.</span></span> <span data-ttu-id="b6d16-232">Rzeczywisty pakiet sieciowy można połączyć z jednym lub wieloma połączonymi ze sobą pakietami NetX.</span><span class="sxs-lookup"><span data-stu-id="b6d16-232">An actual network packet can be made of one or more NetX packets linked together.</span></span> <span data-ttu-id="b6d16-233">Ponadto nagłówek pakietu zachowuje wskaźnik na górze pakietu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-233">In addition, the packet header maintains a pointer to the top of the packet.</span></span> <span data-ttu-id="b6d16-234">Po dodaniu dodatkowych protokołów wskaźnik ten jest po prostu przenoszony do tyłu, a nowy nagłówek jest zapisywana bezpośrednio przed danymi.</span><span class="sxs-lookup"><span data-stu-id="b6d16-234">As additional protocols are added, this pointer is simply moved backwards and the new header is written directly in front of the data.</span></span> <span data-ttu-id="b6d16-235">Bez elastycznej technologii pakietów, stos będzie musiał przydzielić inny bufor i skopiować dane do nowego buforu z nowym nagłówkiem, który przetwarza intensywne przetwarzanie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-235">Without the flexible packet technology, the stack would have to allocate another buffer and copy the data into a new buffer with the new header, which is processing intensive.</span></span>

<span data-ttu-id="b6d16-236">Ponieważ każdy rozmiar ładunku pakietu został ustalony dla danej puli pakietów, dane aplikacji o rozmiarze większym niż rozmiar ładunku wymagają wielu pakietów połączonych ze sobą.</span><span class="sxs-lookup"><span data-stu-id="b6d16-236">Since each packet payload size is fixed for a given packet pool, application data larger than the payload size  requires multiple packets chained together.</span></span> <span data-ttu-id="b6d16-237">Podczas wypełniania pakietu przy użyciu danych użytkownika aplikacja musi używać ***nx_packet_data_append*** usługi.</span><span class="sxs-lookup"><span data-stu-id="b6d16-237">When filling a packet with user data, the application must use the service ***nx_packet_data_append***.</span></span> <span data-ttu-id="b6d16-238">Ta usługa przenosi dane aplikacji do pakietu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-238">This service moves application data into a packet.</span></span> <span data-ttu-id="b6d16-239">W sytuacjach, gdy pakiet nie wystarcza do przechowywania danych użytkownika, dodatkowe pakiety są przydzieleni do przechowywania danych użytkownika.</span><span class="sxs-lookup"><span data-stu-id="b6d16-239">In situations where a packet is not enough to hold user data, additional packets are allocated to store user data.</span></span> <span data-ttu-id="b6d16-240">Aby można było korzystać z łańcucha pakietów, Sterownik musi mieć możliwość odbierania lub przesyłania z połączonych pakietów.</span><span class="sxs-lookup"><span data-stu-id="b6d16-240">To use packet chaining, the driver must be able to receive into or transmit from chained packets.</span></span>

<span data-ttu-id="b6d16-241">Każda pula pamięci pakietu NetX jest zasobem publicznym.</span><span class="sxs-lookup"><span data-stu-id="b6d16-241">Each NetX packet memory pool is a public resource.</span></span> <span data-ttu-id="b6d16-242">NetX nie ma żadnych ograniczeń dotyczących sposobu używania pul pakietów.</span><span class="sxs-lookup"><span data-stu-id="b6d16-242">NetX places no constraints on how packet pools are used.</span></span>

### <a name="packet-pool-memory-area"></a><span data-ttu-id="b6d16-243">Obszar pamięci puli pakietów</span><span class="sxs-lookup"><span data-stu-id="b6d16-243">Packet Pool Memory Area</span></span>
<span data-ttu-id="b6d16-244">Obszar pamięci dla puli pakietów jest określany podczas tworzenia.</span><span class="sxs-lookup"><span data-stu-id="b6d16-244">The memory area for the packet pool is specified during creation.</span></span> <span data-ttu-id="b6d16-245">Podobnie jak w przypadku innych obszarów pamięci dla obiektów ThreadX i NetX, może ona znajdować się w dowolnym miejscu w przestrzeni adresowej docelowej.</span><span class="sxs-lookup"><span data-stu-id="b6d16-245">Like other memory areas for ThreadX and NetX objects, it can be located anywhere in the target's address space.</span></span> <span data-ttu-id="b6d16-246">Jest to ważna funkcja ze względu na znaczną elastyczność zapewnianą przez aplikację.</span><span class="sxs-lookup"><span data-stu-id="b6d16-246">This is an important feature because of the considerable flexibility it gives the application.</span></span> <span data-ttu-id="b6d16-247">Załóżmy na przykład, że produkt komunikacyjny ma obszar pamięci o dużej szybkości dla buforów sieciowych.</span><span class="sxs-lookup"><span data-stu-id="b6d16-247">For example, suppose that a communication product has a high-speed memory area for network buffers.</span></span> <span data-ttu-id="b6d16-248">Ten obszar pamięci jest łatwo wykorzystywany przez umieszczenie go w puli pamięci pakietu NetX.</span><span class="sxs-lookup"><span data-stu-id="b6d16-248">This memory area is easily utilized by making it into a NetX packet memory pool.</span></span>

### <a name="creating-packet-pools"></a><span data-ttu-id="b6d16-249">Tworzenie pul pakietów</span><span class="sxs-lookup"><span data-stu-id="b6d16-249">Creating Packet Pools</span></span>
<span data-ttu-id="b6d16-250">Pule pakietów są tworzone podczas inicjalizacji lub podczas wykonywania przez wątki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-250">Packet pools are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="b6d16-251">Nie ma ograniczeń dotyczących liczby pul pamięci pakietów w aplikacji NetX.</span><span class="sxs-lookup"><span data-stu-id="b6d16-251">There are no limits on the number of packet memory pools in a NetX application.</span></span>

### <a name="packet-header-nx_packet"></a><span data-ttu-id="b6d16-252">NX_PACKET nagłówka pakietu</span><span class="sxs-lookup"><span data-stu-id="b6d16-252">Packet Header NX_PACKET</span></span>
<span data-ttu-id="b6d16-253">Domyślnie NetX umieszcza nagłówek pakietu bezpośrednio przed obszarem ładunku pakietu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-253">By default, NetX places the packet header immediately before the packet payload area.</span></span> <span data-ttu-id="b6d16-254">Pula pamięci pakietu jest zasadniczo serią pakietów — nagłówkami, a następnie bezpośrednio przez ładunek pakietu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-254">The packet memory pool is basically a series of packets—headers followed immediately by the packet payload.</span></span> <span data-ttu-id="b6d16-255">Nagłówek pakietu (***NX_PACKET***) i układ puli pakietów są przedstawiane na rysunku 3.</span><span class="sxs-lookup"><span data-stu-id="b6d16-255">The packet header (***NX_PACKET***) and the layout of the packet pool are pictured in Figure 3.</span></span>

<span data-ttu-id="b6d16-256">W przypadku sterownika urządzeń sieciowych, który jest w stanie wykonać zero operacji kopiowania, zazwyczaj adres początkowy obszaru ładunku pakietu jest zaprogramowany do logiki DMA.</span><span class="sxs-lookup"><span data-stu-id="b6d16-256">For network devices driver that are able to perform zero copy operations, typically the starting address of the packet payload area is programmed into the DMA logic.</span></span> <span data-ttu-id="b6d16-257">Niektóre aparaty DMA mają wymagania dotyczące wyrównania w obszarze ładunku.</span><span class="sxs-lookup"><span data-stu-id="b6d16-257">Certain DMA engines have alignment requirement on the payload area.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-258">\* Sterownik sieciowy musi wywołać funkcję \***nx_packet_transmit_release** _, gdy transmisja pakietu zostanie zakończona.</span><span class="sxs-lookup"><span data-stu-id="b6d16-258">\*The network driver to must call the \***nx_packet_transmit_release** _ function when the transmission of a packet is complete.</span></span> <span data-ttu-id="b6d16-259">Ta funkcja sprawdza, czy pakiet nie jest częścią kolejki wyjściowej TCP, zanim zostanie w rzeczywistości umieszczony w dostępnej puli.</span><span class="sxs-lookup"><span data-stu-id="b6d16-259">This function checks to make sure the packet is not part of a TCP output queue before it is actually placed back in the available pool.</span></span> <span data-ttu-id="b6d16-260">Nieoczekiwane wywołanie tej funkcji może spowodować nieprzewidywalną behavior._</span><span class="sxs-lookup"><span data-stu-id="b6d16-260">Failure to call this function can result in unpredictable behavior._</span></span>

![Układ nagłówka i puli pakietów](./media/user-guide/packet-header-packet-pool-layout.png)

<span data-ttu-id="b6d16-262">**RYSUNEK 3. Układ nagłówka i puli pakietów**</span><span class="sxs-lookup"><span data-stu-id="b6d16-262">**FIGURE 3. Packet Header and Packet Pool Layout**</span></span>

<span data-ttu-id="b6d16-263">Pola nagłówka pakietu są zdefiniowane, jak pokazano w poniższej tabeli.</span><span class="sxs-lookup"><span data-stu-id="b6d16-263">The fields of the packet header are defined as shown in the following table.</span></span> <span data-ttu-id="b6d16-264">Należy zauważyć, że ta tabela nie jest kompletną listą wszystkich elementów członkowskich w strukturze *NX_PACKET* .</span><span class="sxs-lookup"><span data-stu-id="b6d16-264">Note that this table is not a comprehensive list of all the members in the *NX_PACKET* structure.</span></span>

| <span data-ttu-id="b6d16-265">Nagłówek pakietu</span><span class="sxs-lookup"><span data-stu-id="b6d16-265">Packet header</span></span>          | <span data-ttu-id="b6d16-266">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="b6d16-266">Purpose</span></span>                                                                                                                                                                                                                                                                                                                            |
|------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b6d16-267">*nx_packet_pool_owner*</span><span class="sxs-lookup"><span data-stu-id="b6d16-267">*nx_packet_pool_owner*</span></span>   | <span data-ttu-id="b6d16-268">To pole wskazuje pulę pakietów, do której należy ten konkretny pakiet.</span><span class="sxs-lookup"><span data-stu-id="b6d16-268">This field points to the packet pool that owns this particular packet.</span></span> <span data-ttu-id="b6d16-269">Po wydaniu pakiet jest on wydawany do tej określonej puli.</span><span class="sxs-lookup"><span data-stu-id="b6d16-269">When the packet is released, it is released to this particular pool.</span></span> <span data-ttu-id="b6d16-270">Mając własność puli wewnątrz każdego pakietu, istnieje możliwość, że datagram obejmuje wiele pakietów z wielu pul pakietów.</span><span class="sxs-lookup"><span data-stu-id="b6d16-270">With the pool ownership inside each packet, it is possible for a datagram to span multiple packets from multiple packet pools.</span></span>                                                         |
| <span data-ttu-id="b6d16-271">*nx_packet_next*</span><span class="sxs-lookup"><span data-stu-id="b6d16-271">*nx_packet_next*</span></span>         | <span data-ttu-id="b6d16-272">To pole wskazuje następny pakiet w obrębie tej samej ramki.</span><span class="sxs-lookup"><span data-stu-id="b6d16-272">This field points to the next packet within the same frame.</span></span> <span data-ttu-id="b6d16-273">Jeśli wartość jest równa NULL, nie ma dodatkowych pakietów, które są częścią ramki.</span><span class="sxs-lookup"><span data-stu-id="b6d16-273">If NULL, there are no additional packets that are part of the frame.</span></span> |
| <span data-ttu-id="b6d16-274">*nx_packet_last*</span><span class="sxs-lookup"><span data-stu-id="b6d16-274">*nx_packet_last*</span></span>         | <span data-ttu-id="b6d16-275">To pole wskazuje ostatni pakiet w ramach tego samego pakietu sieciowego.</span><span class="sxs-lookup"><span data-stu-id="b6d16-275">This field points to the last packet within the same network packet.</span></span> <span data-ttu-id="b6d16-276">Jeśli wartość jest równa NULL, ten pakiet reprezentuje cały pakiet sieciowy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-276">If NULL, this packet represents the entire network packet.</span></span>  |
| <span data-ttu-id="b6d16-277">*nx_packet_length*</span><span class="sxs-lookup"><span data-stu-id="b6d16-277">*nx_packet_length*</span></span>       | <span data-ttu-id="b6d16-278">To pole zawiera łączną liczbę bajtów w całym pakiecie sieciowym, w tym łączną liczbę wszystkich bajtów we wszystkich pakietach połączonych przez element członkowski *nx_packet_next* .</span><span class="sxs-lookup"><span data-stu-id="b6d16-278">This field contains the total number of bytes in the entire network packet, including the total of all bytes in all packets chained together by the *nx_packet_next* member.</span></span> |
| <span data-ttu-id="b6d16-279">*nx_packet_ip_interface*</span><span class="sxs-lookup"><span data-stu-id="b6d16-279">*nx_packet_ip_interface*</span></span> | <span data-ttu-id="b6d16-280">To pole jest blokiem sterowania interfejsem przypisanym do pakietu, gdy jest odbierany przez sterownik interfejsu i przez NetX dla pakietów wychodzących.</span><span class="sxs-lookup"><span data-stu-id="b6d16-280">This field is the interface control block which is assigned to the packet when it is received by the interface driver, and by NetX for outgoing packets.</span></span> <span data-ttu-id="b6d16-281">Blok sterowania interfejsem opisuje interfejs, np. adres sieciowy, adres MAC, adres IP i stan interfejsu, takie jak link włączony i wymagane jest mapowanie fizyczne.</span><span class="sxs-lookup"><span data-stu-id="b6d16-281">An interface control block describes the interface e.g. network address, MAC address, IP address and interface status such as link enabled and physical mapping required.</span></span> |
| <span data-ttu-id="b6d16-282">*nx_packet_data_start*</span><span class="sxs-lookup"><span data-stu-id="b6d16-282">*nx_packet_data_start*</span></span>   | <span data-ttu-id="b6d16-283">To pole wskazuje początek obszaru fizycznego ładunku tego pakietu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-283">This field points to the start of the physical payload area of this packet.</span></span> <span data-ttu-id="b6d16-284">Nie musi ona występować bezpośrednio po nagłówku NX_PACKET, ale jest to wartość domyślna dla usługi ***nx_packet_pool_create*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-284">It does not have to be immediately following the NX_PACKET header, but that is the default for the ***nx_packet_pool_create*** service.</span></span> |
| <span data-ttu-id="b6d16-285">*nx_packet_data_end*</span><span class="sxs-lookup"><span data-stu-id="b6d16-285">*nx_packet_data_end*</span></span>     | <span data-ttu-id="b6d16-286">To pole wskazuje koniec obszaru fizycznego ładunku tego pakietu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-286">This field points to the end of the physical payload area of this packet.</span></span> <span data-ttu-id="b6d16-287">Różnica między tym polem a polem nx_packet_data_start reprezentuje rozmiar ładunku.</span><span class="sxs-lookup"><span data-stu-id="b6d16-287">The difference between this field and the nx_packet_data_start field represents the payload size.</span></span> |
| <span data-ttu-id="b6d16-288">*nx_packet_prepend_ptr*</span><span class="sxs-lookup"><span data-stu-id="b6d16-288">*nx_packet_prepend_ptr*</span></span>  | <span data-ttu-id="b6d16-289">To pole wskazuje lokalizację, w której dane pakietów, nagłówek protokołu lub rzeczywiste dane, są dodawane przed istniejącymi danymi pakietu (jeśli istnieją) w obszarze ładunku pakietu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-289">This field points to the location of where packet data, either protocol header or actual data, is added in front of the existing packet data (if any) in the packet payload area.</span></span> <span data-ttu-id="b6d16-290">Wartość musi być większa niż lub równa *nx_packet_data_start* lokalizacji wskaźnika i mniejsza lub równa *nx_packet_append_ptr* wskaźnika.</span><span class="sxs-lookup"><span data-stu-id="b6d16-290">It must be greater than or equal to the *nx_packet_data_start* pointer location and less than or equal to the *nx_packet_append_ptr* pointer.</span></span>  <span data-ttu-id="b6d16-291">*Ze względu na wydajność NetX zakłada, że gdy pakiet jest przekazywany do usługi NetX Services do transmisji, wskaźnik poprzedź wskazuje na długi adres wyrównany do wyrazu.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-291">*For performance reasons, NetX assumes that when the packet is passed into NetX services for transmission, the prepend pointer points to long word aligned address.*</span></span> |
| <span data-ttu-id="b6d16-292">*nx_packet_append_ptr*</span><span class="sxs-lookup"><span data-stu-id="b6d16-292">*nx_packet_append_ptr*</span></span>    | <span data-ttu-id="b6d16-293">To pole wskazuje koniec danych znajdujących się obecnie w obszarze ładunku pakietu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-293">This field points to the end of the data currently in the packet payload area.</span></span> <span data-ttu-id="b6d16-294">Musi znajdować się między lokalizacją pamięci wskazywaną przez *nx_packet_prepend_ptr* i *nx_packet_data_end*.</span><span class="sxs-lookup"><span data-stu-id="b6d16-294">It must be in between the memory location pointed to by *nx_packet_prepend_ptr* and *nx_packet_data_end*.</span></span> <span data-ttu-id="b6d16-295">Różnica między tym polem a polem *nx_packet_prepend_ptr* reprezentuje ilość danych w tym pakiecie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-295">The difference between this field and the *nx_packet_prepend_ptr* field represents the amount of data in this packet.</span></span> |
| <span data-ttu-id="b6d16-296">*nx_packet_fragment_next*</span><span class="sxs-lookup"><span data-stu-id="b6d16-296">*nx_packet_fragment_next*</span></span> | <span data-ttu-id="b6d16-297">To pole jest używane do przechowywania pofragmentowanych pakietów do momentu, w którym cały pakiet będzie można ponownie połączyć.</span><span class="sxs-lookup"><span data-stu-id="b6d16-297">This field is used to hold fragmented packets until the entire packet can be re-assembled.</span></span> |
| <span data-ttu-id="b6d16-298">*nx_packet_pad*</span><span class="sxs-lookup"><span data-stu-id="b6d16-298">*nx_packet_pad*</span></span>           | <span data-ttu-id="b6d16-299">Te pola definiują długość wypełnienia w przypadku wyrazów 4-bajtowych w celu osiągnięcia wymaganego wymagania dotyczącego wyrównania.</span><span class="sxs-lookup"><span data-stu-id="b6d16-299">This fields defines the length of padding in 4- byte words to achieve the desired alignment requirement.</span></span> <span data-ttu-id="b6d16-300">To pole jest usuwane, jeśli nie zdefiniowano *NX_PACKET_HEADER_PAD* .</span><span class="sxs-lookup"><span data-stu-id="b6d16-300">This field is removed if *NX_PACKET_HEADER_PAD* is not defined.</span></span> |
|  |  |

### <a name="packet-header-offsets"></a><span data-ttu-id="b6d16-301">Przesunięcia nagłówka pakietu</span><span class="sxs-lookup"><span data-stu-id="b6d16-301">Packet Header Offsets</span></span>

<span data-ttu-id="b6d16-302">Rozmiar nagłówka pakietu jest zdefiniowany w celu zapewnienia wystarczającej ilości miejsca, aby pomieścić rozmiar nagłówka.</span><span class="sxs-lookup"><span data-stu-id="b6d16-302">Packet header size is defined to allow enough room to accommodate the size of the header.</span></span> <span data-ttu-id="b6d16-303">Usługa *nx_packet_allocate* jest używana do przydzielania pakietu i dostosowywania wskaźnika dołączania w pakiecie zgodnie z typem określonego pakietu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-303">The *nx_packet_allocate* service is used to allocate a packet and adjusts the prepend pointer in the packet according to the type of packet specified.</span></span> <span data-ttu-id="b6d16-304">Typ pakietu informuje NetX o przesunięciu wymaganym do wstawienia nagłówka protokołu (na przykład UDP, TCP lub ICMP) przed danymi protokołu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-304">The packet type tells NetX the offset required for inserting the protocol header (such as UDP, TCP, or ICMP) in front of the protocol data.</span></span>

<span data-ttu-id="b6d16-305">Następujące typy są zdefiniowane w NetX w celu uwzględnienia nagłówka IP i nagłówek warstwy fizycznej (Ethernet) w pakiecie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-305">The following types are defined in NetX to take into account the IP header and physical layer (Ethernet) header in the packet.</span></span> <span data-ttu-id="b6d16-306">W drugim przypadku zakłada się, że jest to 16 bajtów z uwzględnieniem wymaganego 4-bajtowego wyrównania.</span><span class="sxs-lookup"><span data-stu-id="b6d16-306">In the latter case, it is assumed to be 16 bytes taking the required 4-byte alignment into consideration.</span></span> <span data-ttu-id="b6d16-307">Pakiety IP są nadal zdefiniowane w NetX for Applications do alokowania pakietów dla sieci IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-307">IP packets are still defined in NetX for applications to allocate packets for IP networks.</span></span> <span data-ttu-id="b6d16-308">W poniższej tabeli przedstawiono zdefiniowane symbole:</span><span class="sxs-lookup"><span data-stu-id="b6d16-308">The following table shows symbols defined:</span></span>

| <span data-ttu-id="b6d16-309">Typ pakietu</span><span class="sxs-lookup"><span data-stu-id="b6d16-309">Packet Type</span></span>   | <span data-ttu-id="b6d16-310">Wartość</span><span class="sxs-lookup"><span data-stu-id="b6d16-310">Value</span></span> |
|---------------|-------|
| <span data-ttu-id="b6d16-311">NX_IP_PACKET</span><span class="sxs-lookup"><span data-stu-id="b6d16-311">NX_IP_PACKET</span></span>  | <span data-ttu-id="b6d16-312">0x24</span><span class="sxs-lookup"><span data-stu-id="b6d16-312">0x24</span></span>  |
| <span data-ttu-id="b6d16-313">NX_UDP_PACKET</span><span class="sxs-lookup"><span data-stu-id="b6d16-313">NX_UDP_PACKET</span></span> | <span data-ttu-id="b6d16-314">0x2c</span><span class="sxs-lookup"><span data-stu-id="b6d16-314">0x2c</span></span>  |
| <span data-ttu-id="b6d16-315">NX_TCP_PACKET</span><span class="sxs-lookup"><span data-stu-id="b6d16-315">NX_TCP_PACKET</span></span> | <span data-ttu-id="b6d16-316">0x38</span><span class="sxs-lookup"><span data-stu-id="b6d16-316">0x38</span></span>  |
|               |       |

### <a name="pool-capacity"></a><span data-ttu-id="b6d16-317">Pojemność puli</span><span class="sxs-lookup"><span data-stu-id="b6d16-317">Pool Capacity</span></span>
<span data-ttu-id="b6d16-318">Liczba pakietów w puli pakietów jest funkcją rozmiaru ładunku i łączną liczbą bajtów w obszarze pamięci dostarczonym do usługi tworzenia puli pakietów.</span><span class="sxs-lookup"><span data-stu-id="b6d16-318">The number of packets in a packet pool is a function of the payload size and the total number of bytes in the memory area supplied to the packet pool create service.</span></span> <span data-ttu-id="b6d16-319">Pojemność puli jest obliczana przez podzielenie rozmiaru pakietu (w tym rozmiaru nagłówka NX_PACKET, rozmiaru ładunku i właściwego wyrównania) do całkowitej liczby bajtów w podanym obszarze pamięci.</span><span class="sxs-lookup"><span data-stu-id="b6d16-319">The capacity of the pool is calculated by dividing the packet size (including the size of the NX_PACKET header, the payload size, and proper alignment) into the total number of bytes in the supplied memory area.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="b6d16-320">Zawieszenie wątku</span><span class="sxs-lookup"><span data-stu-id="b6d16-320">Thread Suspension</span></span>
<span data-ttu-id="b6d16-321">Wątki aplikacji mogą wstrzymywać się podczas oczekiwania na pakiet z pustej puli.</span><span class="sxs-lookup"><span data-stu-id="b6d16-321">Application threads can suspend while waiting for a packet from an empty pool.</span></span> <span data-ttu-id="b6d16-322">Gdy pakiet jest zwracany do puli, zawieszony wątek zostaje przyznany i wznowiony.</span><span class="sxs-lookup"><span data-stu-id="b6d16-322">When a packet is returned to the pool, the suspended thread is given this packet and resumed.</span></span>

<span data-ttu-id="b6d16-323">Jeśli wiele wątków jest zawieszonych w tej samej puli pakietów, zostaną wznowione w kolejności, w której zostały wstrzymane (FIFO).</span><span class="sxs-lookup"><span data-stu-id="b6d16-323">If multiple threads are suspended on the same packet pool, they are resumed in the order they were suspended (FIFO).</span></span>

### <a name="pool-statistics-and-errors"></a><span data-ttu-id="b6d16-324">Statystyki i błędy puli</span><span class="sxs-lookup"><span data-stu-id="b6d16-324">Pool Statistics and Errors</span></span>
<span data-ttu-id="b6d16-325">Jeśli ta opcja jest włączona, **Błędy** oprogramowania do zarządzania pakietami NetX śledzą kilka statystyk i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-325">If enabled, the NetX packet management software **Errors** keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="b6d16-326">Dla pul pakietów są obsługiwane następujące raporty statystyczne i błędy:</span><span class="sxs-lookup"><span data-stu-id="b6d16-326">The following statistics and error reports are maintained for packet pools:</span></span>

* <span data-ttu-id="b6d16-327">Łączna liczba pakietów w puli</span><span class="sxs-lookup"><span data-stu-id="b6d16-327">Total Packets in Pool</span></span>
* <span data-ttu-id="b6d16-328">Bezpłatne pakiety w puli</span><span class="sxs-lookup"><span data-stu-id="b6d16-328">Free Packets in Pool</span></span>
* <span data-ttu-id="b6d16-329">Puste żądania alokacji puli</span><span class="sxs-lookup"><span data-stu-id="b6d16-329">Pool Empty Allocation Requests</span></span>
* <span data-ttu-id="b6d16-330">Zawieszanie pustej alokacji puli</span><span class="sxs-lookup"><span data-stu-id="b6d16-330">Pool Empty Allocation Suspensions</span></span>
* <span data-ttu-id="b6d16-331">Nieprawidłowe wersje pakietów</span><span class="sxs-lookup"><span data-stu-id="b6d16-331">Invalid Packet Releases</span></span>

<span data-ttu-id="b6d16-332">Wszystkie te statystyki i raporty o błędach, z wyjątkiem całkowitej i bezpłatnej liczby pakietów w puli, są wbudowane w bibliotekę NetX, chyba że określono \***NX_DISABLE_PACKET_INFO** _.</span><span class="sxs-lookup"><span data-stu-id="b6d16-332">All of these statistics and error reports, except for total and free packet count in pool, are built into NetX library unless \***NX_DISABLE_PACKET_INFO** _ is defined.</span></span> <span data-ttu-id="b6d16-333">Te dane są dostępne dla aplikacji za pomocą usługi _ \*_nx_packet_pool_info_get_\*\*.</span><span class="sxs-lookup"><span data-stu-id="b6d16-333">This data is available to the application with the _ *_nx_packet_pool_info_get_*\* service.</span></span>

### <a name="packet-pool-control-block-nx_packet_pool"></a><span data-ttu-id="b6d16-334">NX_PACKET_POOL bloku kontroli puli pakietów</span><span class="sxs-lookup"><span data-stu-id="b6d16-334">Packet Pool Control Block NX_PACKET_POOL</span></span>

<span data-ttu-id="b6d16-335">Charakterystyka każdej puli pamięci pakietów znajduje się w bloku sterowania.</span><span class="sxs-lookup"><span data-stu-id="b6d16-335">The characteristics of each packet memory pool are found in its control block.</span></span> <span data-ttu-id="b6d16-336">Zawiera on przydatne informacje, takie jak połączona lista bezpłatnych pakietów, Liczba bezpłatnych pakietów i rozmiar ładunku dla pakietów w tej puli.</span><span class="sxs-lookup"><span data-stu-id="b6d16-336">It contains useful information such as the linked list of free packets, the number of free packets, and the payload size for packets in this pool.</span></span> <span data-ttu-id="b6d16-337">Ta struktura jest zdefiniowana w pliku *nx_api. h* .</span><span class="sxs-lookup"><span data-stu-id="b6d16-337">This structure is defined in the *nx_api.h* file.</span></span>

<span data-ttu-id="b6d16-338">Bloki sterujące puli pakietów mogą znajdować się w dowolnym miejscu w pamięci, ale najczęściej jest to, że formant blokuje strukturę globalną przez definiowanie jej poza zakresem dowolnej funkcji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-338">Packet pool control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

## <a name="ip-protocol"></a><span data-ttu-id="b6d16-339">Protokół IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-339">IP Protocol</span></span>

<span data-ttu-id="b6d16-340">Składnik protokołu internetowego (IP) NetX jest odpowiedzialny za wysyłanie i otrzymywanie pakietów IP w Internecie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-340">The Internet Protocol (IP) component of NetX is responsible for sending and receiving IP packets on the Internet.</span></span> <span data-ttu-id="b6d16-341">W NetX jest to składnik, który jest ostatecznie odpowiedzialny za wysyłanie i otrzymywanie komunikatów TCP, UDP, ICMP i IGMP przy użyciu podstawowego sterownika sieciowego.</span><span class="sxs-lookup"><span data-stu-id="b6d16-341">In NetX, it is the component ultimately responsible for sending and receiving TCP, UDP, ICMP, and IGMP messages, utilizing the underlying network driver.</span></span>

<span data-ttu-id="b6d16-342">NetX obsługuje protokół IP (RFC 791)</span><span class="sxs-lookup"><span data-stu-id="b6d16-342">NetX supports IP protocol (RFC 791)</span></span>

### <a name="ip-addresses"></a><span data-ttu-id="b6d16-343">Adresy IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-343">IP Addresses</span></span>

<span data-ttu-id="b6d16-344">Każdy host w Internecie ma unikatowy identyfikator 32-bitowy o nazwie adres IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-344">Each host on the Internet has a unique 32-bit identifier called an IP address.</span></span> <span data-ttu-id="b6d16-345">Istnieje pięć klas adresów IP, zgodnie z opisem na rysunku 4.</span><span class="sxs-lookup"><span data-stu-id="b6d16-345">There are five classes of IP addresses as described in Figure 4.</span></span> <span data-ttu-id="b6d16-346">Zakresy pięciu klas adresów IP są następujące:</span><span class="sxs-lookup"><span data-stu-id="b6d16-346">The ranges of the five IP address classes are as follows:</span></span>

| <span data-ttu-id="b6d16-347">Klasa</span><span class="sxs-lookup"><span data-stu-id="b6d16-347">Class</span></span> | <span data-ttu-id="b6d16-348">Zakres</span><span class="sxs-lookup"><span data-stu-id="b6d16-348">Range</span></span>                        |
|-------|------------------------------|
| <span data-ttu-id="b6d16-349">A</span><span class="sxs-lookup"><span data-stu-id="b6d16-349">A</span></span>     | <span data-ttu-id="b6d16-350">od 0.0.0.0 do 127.255.255.255</span><span class="sxs-lookup"><span data-stu-id="b6d16-350">0.0.0.0 to 127.255.255.255</span></span>   |
| <span data-ttu-id="b6d16-351">B</span><span class="sxs-lookup"><span data-stu-id="b6d16-351">B</span></span>     | <span data-ttu-id="b6d16-352">128.0.0.0 do 191.255.255.255</span><span class="sxs-lookup"><span data-stu-id="b6d16-352">128.0.0.0 to 191.255.255.255</span></span> |
| <span data-ttu-id="b6d16-353">C</span><span class="sxs-lookup"><span data-stu-id="b6d16-353">C</span></span>     | <span data-ttu-id="b6d16-354">192.0.0.0 do 223.255.255.255</span><span class="sxs-lookup"><span data-stu-id="b6d16-354">192.0.0.0 to 223.255.255.255</span></span> |
| <span data-ttu-id="b6d16-355">D</span><span class="sxs-lookup"><span data-stu-id="b6d16-355">D</span></span>     | <span data-ttu-id="b6d16-356">od 224.0.0.0 do 239.255.255.255</span><span class="sxs-lookup"><span data-stu-id="b6d16-356">224.0.0.0 to 239.255.255.255</span></span> |
| <span data-ttu-id="b6d16-357">E</span><span class="sxs-lookup"><span data-stu-id="b6d16-357">E</span></span>     | <span data-ttu-id="b6d16-358">240.0.0.0 do 247.255.255.255</span><span class="sxs-lookup"><span data-stu-id="b6d16-358">240.0.0.0 to 247.255.255.255</span></span> |

<span data-ttu-id="b6d16-359">**7 bitów 24 bity**</span><span class="sxs-lookup"><span data-stu-id="b6d16-359">**7 bits 24 bits**</span></span>

![Struktura adresów IP](./media/user-guide/ip-address-structure.png)

<span data-ttu-id="b6d16-361">**RYSUNEK 4. Struktura adresów IP**</span><span class="sxs-lookup"><span data-stu-id="b6d16-361">**FIGURE 4. IP Address Structure**</span></span>

<span data-ttu-id="b6d16-362">Istnieją również trzy typy specyfikacji adresów: *emisja pojedyncza*, *emisja* i *Multiemisja*.</span><span class="sxs-lookup"><span data-stu-id="b6d16-362">There are also three types of address specifications: *unicast*, *broadcast*, and *multicast*.</span></span> <span data-ttu-id="b6d16-363">Adresy emisji pojedynczej to adresy IP, które identyfikują określonego hosta w Internecie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-363">Unicast addresses are those IP addresses that identify a specific host on the Internet.</span></span> <span data-ttu-id="b6d16-364">Adresy emisji pojedynczej mogą być źródłem lub docelowym adresem IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-364">Unicast addresses can be either a source or a destination IP address.</span></span> <span data-ttu-id="b6d16-365">Adres emisji identyfikuje wszystkie hosty w określonej sieci lub podsieci i może być używany tylko jako adresy docelowe.</span><span class="sxs-lookup"><span data-stu-id="b6d16-365">A broadcast address identifies all hosts on a specific network or sub-network and can only be used as destination addresses.</span></span> <span data-ttu-id="b6d16-366">Adresy emisji są określane przez posiadanie części adresu hosta ustawionej na wartość.</span><span class="sxs-lookup"><span data-stu-id="b6d16-366">Broadcast addresses are specified by having the host ID portion of the address set to ones.</span></span> <span data-ttu-id="b6d16-367">Adresy multiemisji (Klasa D) określają dynamiczną grupę hostów w Internecie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-367">Multicast addresses (Class D) specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="b6d16-368">Członkowie grupy multiemisji mogą dołączać się i zostawiać w dowolnym momencie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-368">Members of the multicast group may join and leave whenever they wish.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-369">*Tylko protokoły bezpołączeniowe, takie jak UDP za pośrednictwem protokołu IP, mogą korzystać z emisji i ograniczonej możliwości emisji grupy multiemisji.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-369">*Only connectionless protocols like UDP over IP can utilize broadcast and the limited broadcast capability of the multicast group.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-370">*Makro* IP_address *jest zdefiniowany w*  \* **nx_api. h** _.</span><span class="sxs-lookup"><span data-stu-id="b6d16-370">*The macro* IP_ADDRESS *is defined in* \***nx_api.h** _.</span></span> <span data-ttu-id="b6d16-371">Umożliwia łatwą specyfikację adresów IP przy użyciu przecinków zamiast kropek.</span><span class="sxs-lookup"><span data-stu-id="b6d16-371">It allows easy specification of IP addresses using commas instead of a periods.</span></span> <span data-ttu-id="b6d16-372">Na przykład IP_ADDRESS (128, 0, 0, 0) _specifies pierwszy adres klasy B przedstawiony na rysunku 4. \*</span><span class="sxs-lookup"><span data-stu-id="b6d16-372">For example, IP_ADDRESS(128,0,0,0) _specifies the first class B address shown in Figure 4.\*</span></span>

### <a name="ip-gateway-address"></a><span data-ttu-id="b6d16-373">Adres bramy IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-373">IP Gateway Address</span></span>

<span data-ttu-id="b6d16-374">Bramy sieci ułatwiają hostom w ich sieciach przekazywanie pakietów przeznaczonych do miejsc docelowych poza domeną lokalną.</span><span class="sxs-lookup"><span data-stu-id="b6d16-374">Network gateways assist hosts on their networks to relay packets destined to destinations outside the local domain.</span></span> <span data-ttu-id="b6d16-375">Każdy węzeł ma pewną wiedzę na temat tego, w którym następnym przeskoku ma być wysyłany, do lokalizacji docelowej jednego z jej sąsiadów lub za pomocą wstępnie zaprogramowanej tabeli routingu statycznego.</span><span class="sxs-lookup"><span data-stu-id="b6d16-375">Each node has some knowledge of which next hop to send to, either the destination one of its neighbors, or through a pre-programmed static routing table.</span></span> <span data-ttu-id="b6d16-376">Jeśli jednak te podejścia zakończą się niepowodzeniem, węzeł powinien przekazać pakiet do bramy domyślnej, która zawiera więcej informacji na temat sposobu kierowania pakietu do jego miejsca docelowego.</span><span class="sxs-lookup"><span data-stu-id="b6d16-376">However if these approaches fail, the node should forward the packet to its default gateway which has more information on how to route the packet to its destination.</span></span> <span data-ttu-id="b6d16-377">Należy pamiętać, że brama domyślna musi być bezpośrednio dostępna za pomocą jednego z interfejsów fizycznych dołączonych do wystąpienia protokołu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-377">Note that the default gateway must be directly accessible through one of the physical interfaces attached to the IP instance.</span></span> <span data-ttu-id="b6d16-378">Aplikacja wywołuje ***nx_ip_gateway_address_set*** , aby skonfigurować adres IP bramy domyślnej.</span><span class="sxs-lookup"><span data-stu-id="b6d16-378">The application calls ***nx_ip_gateway_address_set*** to configure IP default gateway address.</span></span>

### <a name="ip-header"></a><span data-ttu-id="b6d16-379">Nagłówek IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-379">IP Header</span></span>

<span data-ttu-id="b6d16-380">Każdy pakiet IP do wysłania przez Internet musi mieć nagłówek IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-380">For any IP packet to be sent on the Internet, it must have an IP header.</span></span> <span data-ttu-id="b6d16-381">Gdy protokoły wyższego poziomu (UDP, TCP, ICMP lub IGMP) wywołują składnik IP w celu wysłania pakietu, moduł przesyłania IP umieszcza nagłówek IP przed danymi.</span><span class="sxs-lookup"><span data-stu-id="b6d16-381">When higher-level protocols (UDP, TCP, ICMP, or IGMP) call the IP component to send a packet, the IP transmit module places an IP header in front of the data.</span></span> <span data-ttu-id="b6d16-382">Z drugiej strony, gdy pakiety IP są odbierane z sieci, składnik IP usuwa nagłówek IP z pakietu przed dostarczeniem do protokołów wyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-382">Conversely, when IP packets are received from the network, the IP component removes the IP header from the packet before delivery to the higher-level protocols.</span></span> <span data-ttu-id="b6d16-383">Rysunek 5 przedstawia format nagłówka IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-383">Figure 5 shows the format of the IP header.</span></span>

![Format nagłówka adresu IP](./media/user-guide/ip-header-format.png)

<span data-ttu-id="b6d16-385">**RYSUNEK 5. Format nagłówka adresu IP**</span><span class="sxs-lookup"><span data-stu-id="b6d16-385">**FIGURE 5. IP Header Format**</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-386">*Oczekuje się, że wszystkie nagłówki w implementacji TCP/IP mają być w formacie big endian. W tym formacie najbardziej znaczący bajt słowa znajduje się na najniższym adresie bajtowym. Na przykład 4-bitowa wersja i 4-bitowe długości nagłówka IP muszą znajdować się na pierwszym bajcie nagłówka.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-386">*All headers in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address. For example, the 4-bit version and the 4-bit header length of the IP header must be located on the first byte of the header.*</span></span>

<span data-ttu-id="b6d16-387">Pola nagłówka IP są zdefiniowane w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="b6d16-387">The fields of the IP header are defined as follows:</span></span>

<span data-ttu-id="b6d16-388">**Cel pola nagłówka adresu IP**</span><span class="sxs-lookup"><span data-stu-id="b6d16-388">**IP Header Field Purpose**</span></span>

<span data-ttu-id="b6d16-389">***4-bitowa wersja*** To pole zawiera wersję protokołu IP reprezentowanego przez ten nagłówek.</span><span class="sxs-lookup"><span data-stu-id="b6d16-389">***4-bit version*** This field contains the version of IP this header represents.</span></span> <span data-ttu-id="b6d16-390">W przypadku protokołu IP w wersji 4, który jest obsługiwany przez NetX, wartość tego pola to 4.</span><span class="sxs-lookup"><span data-stu-id="b6d16-390">For IP version 4, which is what NetX supports, the value of this field is 4.</span></span>

<span data-ttu-id="b6d16-391">***4-bitowa Długość nagłówka*** To pole określa liczbę 32-bitowych wyrazów w nagłówku IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-391">***4-bit header length*** This field specifies the number of 32-bit words in the IP header.</span></span> <span data-ttu-id="b6d16-392">Jeśli nie ma żadnych opcji, wartość dla tego pola to 5.</span><span class="sxs-lookup"><span data-stu-id="b6d16-392">If no option words are present, the value for this field is 5.</span></span>

<span data-ttu-id="b6d16-393">***8-bitowy typ usługi (TOS)*** To pole określa typ usługi żądany dla tego pakietu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-393">***8-bit type of service (TOS)*** This field specifies the type of service requested for this IP packet.</span></span> <span data-ttu-id="b6d16-394">Prawidłowe żądania są następujące:</span><span class="sxs-lookup"><span data-stu-id="b6d16-394">Valid requests are as follows:</span></span>

| <span data-ttu-id="b6d16-395">**Żądanie OT**</span><span class="sxs-lookup"><span data-stu-id="b6d16-395">**TOS Request**</span></span>     | <span data-ttu-id="b6d16-396">**Wartość**</span><span class="sxs-lookup"><span data-stu-id="b6d16-396">**Value**</span></span> |
| ------------------- | --------- |
| <span data-ttu-id="b6d16-397">Normalne</span><span class="sxs-lookup"><span data-stu-id="b6d16-397">Normal</span></span>              | <span data-ttu-id="b6d16-398">0x00</span><span class="sxs-lookup"><span data-stu-id="b6d16-398">0x00</span></span>      |
| <span data-ttu-id="b6d16-399">Minimalne opóźnienie</span><span class="sxs-lookup"><span data-stu-id="b6d16-399">Minimum Delay</span></span>       | <span data-ttu-id="b6d16-400">0x10</span><span class="sxs-lookup"><span data-stu-id="b6d16-400">0x10</span></span>      |
| <span data-ttu-id="b6d16-401">Maksymalne dane</span><span class="sxs-lookup"><span data-stu-id="b6d16-401">Maximum Data</span></span>        | <span data-ttu-id="b6d16-402">0x08</span><span class="sxs-lookup"><span data-stu-id="b6d16-402">0x08</span></span>      |
| <span data-ttu-id="b6d16-403">Maksymalna niezawodność</span><span class="sxs-lookup"><span data-stu-id="b6d16-403">Maximum Reliability</span></span> | <span data-ttu-id="b6d16-404">0x04</span><span class="sxs-lookup"><span data-stu-id="b6d16-404">0x04</span></span>      |
| <span data-ttu-id="b6d16-405">Koszt minimalny</span><span class="sxs-lookup"><span data-stu-id="b6d16-405">Minimum Cost</span></span>        | <span data-ttu-id="b6d16-406">0x02</span><span class="sxs-lookup"><span data-stu-id="b6d16-406">0x02</span></span>      |

<span data-ttu-id="b6d16-407">***16-bitowa łączna długość*** To pole zawiera łączną długość datagramu IP w bajtach, z uwzględnieniem nagłówka IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-407">***16-bit total length*** This field contains the total length of the IP datagram in bytes, including the IP header.</span></span> <span data-ttu-id="b6d16-408">Datagram IP to podstawowa jednostka informacji dostępnych w Internecie TCP/IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-408">An IP datagram is the basic unit of information found on a TCP/IP Internet.</span></span> <span data-ttu-id="b6d16-409">Zawiera adres docelowy i źródłowy oprócz danych.</span><span class="sxs-lookup"><span data-stu-id="b6d16-409">It contains a destination and source address in addition to data.</span></span> <span data-ttu-id="b6d16-410">Ponieważ jest to pole 16-bitowe, maksymalny rozmiar datagramu IP to 65 535 bajtów.</span><span class="sxs-lookup"><span data-stu-id="b6d16-410">Because it is a 16-bit field, the maximum size of an IP datagram is 65,535 bytes.</span></span>

<span data-ttu-id="b6d16-411">***Identyfikacja 16-bitowa*** Pole to numer używany do unikatowego identyfikowania każdego datagramu IP wysyłanego z hosta.</span><span class="sxs-lookup"><span data-stu-id="b6d16-411">***16-bit identification*** The field is a number used to uniquely identify each IP datagram sent from a host.</span></span> <span data-ttu-id="b6d16-412">Ta liczba jest zwykle zwiększana po wysłaniu datagramu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-412">This number is typically incremented after an IP datagram is sent.</span></span> <span data-ttu-id="b6d16-413">Jest to szczególnie przydatne w przypadku asemblera odebranych fragmentów pakietów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-413">It is especially useful in assembling received IP packet fragments.</span></span>

<span data-ttu-id="b6d16-414">***flagi 3-bitowe*** To pole zawiera informacje o fragmentacji adresów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-414">***3-bit flags*** This field contains IP fragmentation information.</span></span> <span data-ttu-id="b6d16-415">Bit 14 to bit "Nie fragmentuj".</span><span class="sxs-lookup"><span data-stu-id="b6d16-415">Bit 14 is the "don't fragment" bit.</span></span> <span data-ttu-id="b6d16-416">Jeśli ten bit jest ustawiony, wychodzący datagram IP nie zostanie pofragmentowany.</span><span class="sxs-lookup"><span data-stu-id="b6d16-416">If this bit is set, the outgoing IP datagram will not be fragmented.</span></span> <span data-ttu-id="b6d16-417">Bit 13 to bit "więcej fragmentów".</span><span class="sxs-lookup"><span data-stu-id="b6d16-417">Bit 13 is the "more fragments" bit.</span></span> <span data-ttu-id="b6d16-418">Jeśli ten bit jest ustawiony, zawiera więcej fragmentów.</span><span class="sxs-lookup"><span data-stu-id="b6d16-418">If this bit is set, there are more fragments.</span></span> <span data-ttu-id="b6d16-419">Jeśli ten bit jest wyczyszczony, jest to ostatni fragment pakietu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-419">If this bit is clear, this is the last fragment of the IP packet.</span></span>

<span data-ttu-id="b6d16-420">**Cel pola nagłówka adresu IP**</span><span class="sxs-lookup"><span data-stu-id="b6d16-420">**IP Header Field Purpose**</span></span>

<span data-ttu-id="b6d16-421">***13-bitowe przesunięcie fragmentu*** To pole zawiera górne 13 bitów przesunięcia fragmentu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-421">***13-bit fragment offset*** This field contains the upper 13-bits of the fragment offset.</span></span> <span data-ttu-id="b6d16-422">Z tego powodu przesunięcia fragmentów są dozwolone tylko dla granic 8-bajtowych.</span><span class="sxs-lookup"><span data-stu-id="b6d16-422">Because of this, fragment offsets are only allowed on 8-byte boundaries.</span></span> <span data-ttu-id="b6d16-423">Pierwszy fragment pofragmentowanego datagramu IP będzie miał ustawiony bit "więcej fragmentów" i ma przesunięcie 0.</span><span class="sxs-lookup"><span data-stu-id="b6d16-423">The first fragment of a fragmented IP datagram will have the “more fragments” bit set and have an offset of 0.</span></span>

<span data-ttu-id="b6d16-424">***8-bitowy czas wygaśnięcia (TTL)*** To pole zawiera liczbę routerów, które mogą być przekazywane przez ten datagram, co ogranicza okres istnienia datagramu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-424">***8-bit time to live (TTL)*** This field contains the number of routers this datagram can pass, which limits the lifetime of the datagram.</span></span>

<span data-ttu-id="b6d16-425">***Protokół 8-bitowy*** To pole określa, który protokół korzysta z datagramu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-425">***8-bit protocol*** This field specifies which protocol is using the IP datagram.</span></span> <span data-ttu-id="b6d16-426">Poniżej znajduje się lista prawidłowych protokołów i ich wartości:</span><span class="sxs-lookup"><span data-stu-id="b6d16-426">The following is a list of valid protocols and their values:</span></span>

| <span data-ttu-id="b6d16-427">Protokół</span><span class="sxs-lookup"><span data-stu-id="b6d16-427">Protocol</span></span> | <span data-ttu-id="b6d16-428">Wartość</span><span class="sxs-lookup"><span data-stu-id="b6d16-428">Value</span></span> |
|----------|-------|
| <span data-ttu-id="b6d16-429">ICMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-429">ICMP</span></span>     | <span data-ttu-id="b6d16-430">0x01</span><span class="sxs-lookup"><span data-stu-id="b6d16-430">0x01</span></span>  |
| <span data-ttu-id="b6d16-431">IGMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-431">IGMP</span></span>     | <span data-ttu-id="b6d16-432">0x02</span><span class="sxs-lookup"><span data-stu-id="b6d16-432">0x02</span></span>  |
| <span data-ttu-id="b6d16-433">TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-433">TCP</span></span>      | <span data-ttu-id="b6d16-434">0X06</span><span class="sxs-lookup"><span data-stu-id="b6d16-434">0X06</span></span>  |
| <span data-ttu-id="b6d16-435">UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-435">UDP</span></span>      | <span data-ttu-id="b6d16-436">0X11</span><span class="sxs-lookup"><span data-stu-id="b6d16-436">0X11</span></span>  |
|          |       |


<span data-ttu-id="b6d16-437">***16-bitowa suma kontrolna*** To pole zawiera 16-bitową sumę kontrolną obejmującą tylko nagłówek IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-437">***16-bit checksum*** This field contains the 16-bit checksum that covers the IP header only.</span></span> <span data-ttu-id="b6d16-438">Istnieją dodatkowe sumy kontrolne w protokołach wyższego poziomu, które obejmują ładunek IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-438">There are additional checksums in the higher level protocols that cover the IP payload.</span></span>

<span data-ttu-id="b6d16-439">***32-bitowy źródłowy adres IP*** To pole zawiera adres IP nadawcy i zawsze jest adresem hosta.</span><span class="sxs-lookup"><span data-stu-id="b6d16-439">***32-bit source IP address*** This field contains the IP address of the sender and is always a host address.</span></span>

<span data-ttu-id="b6d16-440">***32-bitowy docelowy adres IP*** To pole zawiera adres IP odbiorcy lub odbiorników, jeśli adres jest adresem emisji lub multiemisji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-440">***32-bit destination IP address*** This field contains the IP address of the receiver or receivers if the address is a broadcast or multicast address.</span></span>

### <a name="creating-ip-instances"></a><span data-ttu-id="b6d16-441">Tworzenie wystąpień adresów IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-441">Creating IP Instances</span></span>

<span data-ttu-id="b6d16-442">Wystąpienia adresów IP są tworzone podczas inicjowania lub podczas wykonywania przez wątki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-442">IP instances are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="b6d16-443">Początkowy adres IP, maska sieci, domyślna pula pakietów, sterownik nośnika oraz rozmiar pamięci i priorytet wewnętrznego wątku IP są zdefiniowane przez usługę *nx_ip_create* .</span><span class="sxs-lookup"><span data-stu-id="b6d16-443">The initial IP address, network mask, default packet pool, media driver, and memory and priority of the internal IP thread are defined by the *nx_ip_create* service.</span></span> <span data-ttu-id="b6d16-444">Jeśli aplikacja inicjuje wystąpienie IP z ustawionym adresem IP na nieprawidłowy adres (0.0.0.0), zakłada się, że adres interfejsu jest rozpoznawany przez ręczną konfigurację później, za pośrednictwem RARP lub za pośrednictwem protokołu DHCP lub podobnych protokołów.</span><span class="sxs-lookup"><span data-stu-id="b6d16-444">If the application initializes the IP instance with its IP address set to an invalid address(0.0.0.0), it is assumed that the interface address is going to resolved by manual configuration later, via RARP, or through DHCP or similar protocols.</span></span>

<span data-ttu-id="b6d16-445">W przypadku systemów z wieloma interfejsami sieciowymi interfejs podstawowy jest wyznaczany podczas wywoływania *nx_ip_create*.</span><span class="sxs-lookup"><span data-stu-id="b6d16-445">For systems with multiple network interfaces, the primary interface is designated when calling *nx_ip_create*.</span></span> <span data-ttu-id="b6d16-446">Każdy dodatkowy interfejs można dołączyć do tego samego wystąpienia IP, wywołując *nx_ip_interface_attach*.</span><span class="sxs-lookup"><span data-stu-id="b6d16-446">Each additional interface can be attached to the same IP instance by calling *nx_ip_interface_attach*.</span></span> <span data-ttu-id="b6d16-447">Ta usługa przechowuje informacje o interfejsie sieciowym (takim jak adres IP, maska sieci) w bloku sterowania interfejsem i kojarzy wystąpienie sterownika z blokiem sterowania interfejsem w wystąpieniu protokołu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-447">This service stores information about the network interface (such as IP address, network mask) in the interface control block, and associates the driver instance with the interface control block in the IP instance.</span></span> <span data-ttu-id="b6d16-448">Ponieważ sterownik odbiera pakiet danych, musi przechowywać informacje o interfejsie w strukturze NX_PACKET przed przekazaniem ich do logiki odbioru adresów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-448">As the driver receives a data packet, it needs to store the interface information in the NX_PACKET structure before forwarding it to the IP receive logic.</span></span> <span data-ttu-id="b6d16-449">Przed dołączeniem interfejsów należy pamiętać o utworzeniu wystąpienia adresu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-449">Note an IP instance must already be created before attaching any interfaces.</span></span>

 ### <a name="ip-send"></a><span data-ttu-id="b6d16-450">Wysyłanie IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-450">IP Send</span></span>
 <span data-ttu-id="b6d16-451">Przetwarzanie wysyłania IP w NetX jest bardzo usprawnione.</span><span class="sxs-lookup"><span data-stu-id="b6d16-451">The IP send processing in NetX is very streamlined.</span></span>

<span data-ttu-id="b6d16-452">Wskaźnik dołączania w pakiecie jest przenoszony do tyłu w celu uwzględnienia nagłówka IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-452">The prepend pointer in the packet is moved backwards to accommodate the IP header.</span></span> <span data-ttu-id="b6d16-453">Nagłówek IP zostanie ukończony (ze wszystkimi opcjami określonymi przez warstwę protokołu wywołującego), suma kontrolna adresu IP jest obliczana w wierszu, a pakiet jest wysyłany do skojarzonego sterownika sieciowego.</span><span class="sxs-lookup"><span data-stu-id="b6d16-453">The IP header is completed (with all the options specified by the calling protocol layer), the IP checksum is computed in-line, and the packet is dispatched to the associated network driver.</span></span> <span data-ttu-id="b6d16-454">Ponadto wychodząca fragmentacja jest również koordynowana z poziomu przetwarzania wysyłania adresów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-454">In addition, outgoing fragmentation is also coordinated from within the IP send processing.</span></span>

<span data-ttu-id="b6d16-455">W przypadku protokołu IP NetX inicjuje żądania ARP, jeśli do docelowego adresu IP jest wymagana mapowanie fizyczne.</span><span class="sxs-lookup"><span data-stu-id="b6d16-455">For IP, NetX initiates ARP requests if physical mapping is needed for the destination IP address.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-456">*W przypadku połączeń IP pakiety wymagające rozpoznawania adresów IP (tj. mapowanie fizyczne) są umieszczane w kolejce protokołu ARP do momentu, aż liczba pakietów w kolejce przekroczy głębokość kolejki ARP (zdefiniowana przez* *Symbol **NX_ARP_MAX_QUEUE_DEPTH**). Jeśli* *osiągnięto głębokość kolejki, NetX usunie najstarszy pakiet w kolejce i kontynuuje oczekiwanie na rozpoznanie adresu dla pozostałych pakietów w kolejce. Z drugiej strony, Jeśli wpis ARP nie zostanie rozwiązany, oczekujące pakiety we wpisie ARP zostaną wydane po upływie limitu czasu wpisu ARP.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-456">*For IP connectivity, packets that require IP address resolution (i.e., physical mapping) are enqueued on the ARP queue until the number of packets queued exceeds the ARP queue depth (defined by the* *symbol **NX_ARP_MAX_QUEUE_DEPTH**). If the* *queue depth is reached, NetX will remove the oldest packet on the queue and continue waiting for address resolution for the remaining packets enqueued. On the other hand, if an ARP entry is not resolved, the pending packets on the ARP entry are released upon ARP entry timeout.*</span></span>

<span data-ttu-id="b6d16-457">W przypadku systemów z wieloma interfejsami sieciowymi NetX wybiera interfejs oparty na docelowym adresie IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-457">For systems with multiple network interfaces, NetX chooses an interface based on the destination IP address.</span></span> <span data-ttu-id="b6d16-458">Poniższa procedura dotyczy procesu wyboru:</span><span class="sxs-lookup"><span data-stu-id="b6d16-458">The following procedure applies to the selection process:</span></span>

1. <span data-ttu-id="b6d16-459">Jeśli adres docelowy to emisja IP lub Multiemisja, a jeśli określono prawidłowy interfejs wychodzący, należy użyć tego interfejsu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-459">If a destination address is IP broadcast or multicast, and if a valid outgoing interface is specified, use that interface.</span></span> <span data-ttu-id="b6d16-460">W przeciwnym razie używany jest pierwszy interfejs fizyczny.</span><span class="sxs-lookup"><span data-stu-id="b6d16-460">Otherwise, the first physical interface is used.</span></span>

2. <span data-ttu-id="b6d16-461">Jeśli w statycznej tabeli routingu zostanie znaleziony adres docelowy, używany jest interfejs skojarzony z bramą.</span><span class="sxs-lookup"><span data-stu-id="b6d16-461">If the destination address is found in the static routing table, the interface associated with the gateway is used.</span></span>

3. <span data-ttu-id="b6d16-462">Jeśli miejsce docelowe jest połączone z linkiem, używany jest interfejs on-link.</span><span class="sxs-lookup"><span data-stu-id="b6d16-462">If the destination is on-link, the on-link interface is used.</span></span>

4. <span data-ttu-id="b6d16-463">Jeśli adres docelowy jest adresem sprzężenia zwrotnego 127.0.0.1, używany jest interfejs sprzężenia zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="b6d16-463">If the destination address is a loopback address 127.0.0.1, the loopback interface is used.</span></span>

5. <span data-ttu-id="b6d16-464">Jeśli Brama domyślna jest prawidłowo skonfigurowana, użyj interfejsu skojarzonego z bramą domyślną, aby przesłać pakiet.</span><span class="sxs-lookup"><span data-stu-id="b6d16-464">If the default gateway is properly configured, use the interface associated with the default gateway to transmit the packet.</span></span>

6. <span data-ttu-id="b6d16-465">Pakiet wyjściowy jest usuwany w przypadku powyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-465">The output packet is dropped if all the above fails.</span></span>

### <a name="ip-receive"></a><span data-ttu-id="b6d16-466">Odbieranie adresów IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-466">IP Receive</span></span>

<span data-ttu-id="b6d16-467">Przetwarzanie odbierania adresów IP jest wywoływane ze sterownika sieci lub wewnętrznego wątku IP (na potrzeby przetwarzania pakietów w odroczonej kolejce odebranych pakietów).</span><span class="sxs-lookup"><span data-stu-id="b6d16-467">The IP receive processing is either called from the network driver or the internal IP thread (for processing packets on the deferred received packet queue).</span></span> <span data-ttu-id="b6d16-468">Przetwarzanie odbierania adresów IP bada pole Protokół i próbuje wysłać pakiet do odpowiedniego składnika protokołu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-468">The IP receive processing examines the protocol field and attempts to dispatch the packet to the proper protocol component.</span></span> <span data-ttu-id="b6d16-469">Zanim pakiet zostanie faktycznie wysłany, Nagłówek IP zostanie usunięty przez przeciąganie wskaźnika dołączania do nagłówka IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-469">Before the packet is actually dispatched, the IP header is removed by advancing the prepend pointer past the IP header.</span></span>

<span data-ttu-id="b6d16-470">Przetwarzanie odbierania adresów IP również wykrywa pofragmentowane pakiety IP i wykonuje niezbędne kroki, aby ponownie je połączyć w przypadku włączenia fragmentacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-470">IP receive processing also detects fragmented IP packets and performs the necessary steps to reassemble them if fragmentation is enabled.</span></span> <span data-ttu-id="b6d16-471">Jeśli fragmentacja jest potrzebna, ale nie jest włączona, pakiet zostanie porzucony.</span><span class="sxs-lookup"><span data-stu-id="b6d16-471">If fragmentation is needed but not enabled, the packet is dropped.</span></span>

<span data-ttu-id="b6d16-472">NetX określa odpowiedni interfejs sieciowy w oparciu o interfejs określony w pakiecie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-472">NetX determines the appropriate network interface based on the interface specified in the packet.</span></span> <span data-ttu-id="b6d16-473">Jeśli interfejs pakietu ma wartość NULL, NetX domyślnie interfejs podstawowy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-473">If the packet interface is NULL, NetX defaults to the primary interface.</span></span> <span data-ttu-id="b6d16-474">Jest to realizowane w celu zagwarantowania zgodności ze starszymi sterownikami NetX Ethernet.</span><span class="sxs-lookup"><span data-stu-id="b6d16-474">This is done to guarantee compatibility with legacy NetX Ethernet drivers.</span></span>

### <a name="raw-ip-send"></a><span data-ttu-id="b6d16-475">Wysyłanie nieprzetworzonego adresu IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-475">Raw IP Send</span></span>

<span data-ttu-id="b6d16-476">Pakiet Raw IP jest ramką IP, która zawiera ładunek protokołu warstwy wyższej nie jest bezpośrednio obsługiwany (i przetwarzany) przez NetX.</span><span class="sxs-lookup"><span data-stu-id="b6d16-476">A raw IP packet is an IP frame that contains upper layer protocol payload not directly supported (and processed) by NetX.</span></span> <span data-ttu-id="b6d16-477">Pakiet Raw umożliwia deweloperom Definiowanie własnych aplikacji opartych na protokole IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-477">A raw packet allows developers to define their own IP-based applications.</span></span> <span data-ttu-id="b6d16-478">Aplikacja może wysyłać pakiety pierwotnych adresów IP bezpośrednio przy użyciu usługi ***nx_ip_raw_packet_send** _, jeśli w usłudze _*_nx_ip_raw_packet_enabled_\*_ włączono przetwarzanie pakietów pierwotnych adresów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-478">An application may send raw IP packets directly using the ***nx_ip_raw_packet_send** _ service if raw IP packet processing has been enabled with the _*_nx_ip_raw_packet_enabled_\*_ service.</span></span> <span data-ttu-id="b6d16-479">Jeśli adres docelowy jest adresem multiemisji lub emisji, NetX Domyślnie pierwszy (podstawowy) interfejs.</span><span class="sxs-lookup"><span data-stu-id="b6d16-479">If the destination address is a multicast or broadcast address, however, NetX defaults to the first (primary) interface.</span></span> <span data-ttu-id="b6d16-480">W związku z tym, aby wysłać takie pakiety w interfejsach pomocniczych, aplikacja musi używać usługi _ \*_nx_ip_raw_packet_interface_send_\*\*, aby określić adres źródłowy do użycia dla pakietu wychodzącego.</span><span class="sxs-lookup"><span data-stu-id="b6d16-480">Therefore, to send such packets out on secondary interfaces, the application must use the _ *_nx_ip_raw_packet_interface_send_*\* service to specify the source address to use for the outgoing packet.</span></span>

### <a name="raw-ip-receive"></a><span data-ttu-id="b6d16-481">Nieprzetworzony adres IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-481">Raw IP Receive</span></span>

<span data-ttu-id="b6d16-482">Jeśli przetwarzanie pakietów pierwotnych adresów IP jest włączone, aplikacja może odbierać pakiety pierwotnych adresów IP za pomocą usługi \***nx_ip_raw_packet_receive** _.</span><span class="sxs-lookup"><span data-stu-id="b6d16-482">If raw IP packet processing is enabled, the application may receive raw IP packets through the \***nx_ip_raw_packet_receive** _ service.</span></span> <span data-ttu-id="b6d16-483">Wszystkie pakiety przychodzące są przetwarzane zgodnie z protokołem określonym w nagłówku IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-483">All incoming packets are processed according to the protocol specified in the IP header.</span></span> <span data-ttu-id="b6d16-484">Jeśli protokół określa UDP, TCP, IGMP lub ICMP, NetX przetworzy pakiet przy użyciu odpowiedniego programu obsługi dla typu protokołu pakietu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-484">If the protocol specifies UDP, TCP, IGMP or ICMP, NetX will process the packet using the appropriate handler for the packet protocol type.</span></span> <span data-ttu-id="b6d16-485">Jeśli protokół nie jest jednym z tych protokołów, a odbieranie pierwotnego adresu IP jest włączone, pakiet przychodzący zostanie umieszczony w kolejce pakietów nieprzetworzonych, oczekując na uzyskanie przez aplikację za pośrednictwem _ *_nx_ip_raw_packet_receive_*\* usługi.</span><span class="sxs-lookup"><span data-stu-id="b6d16-485">If the protocol is not one of these protocols, and raw IP receive is enabled, the incoming packet will be put into the raw packet queue waiting for the application to receive it via the _ *_nx_ip_raw_packet_receive_*\* service.</span></span> <span data-ttu-id="b6d16-486">Ponadto wątki aplikacji mogą wstrzymywać z opcjonalnym limitem czasu podczas oczekiwania na pakiet Raw IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-486">In addition, application threads may suspend with an optional timeout while waiting for a raw IP packet.</span></span>

### <a name="default-packet-pool"></a><span data-ttu-id="b6d16-487">Domyślna pula pakietów</span><span class="sxs-lookup"><span data-stu-id="b6d16-487">Default Packet Pool</span></span>

<span data-ttu-id="b6d16-488">Każde wystąpienie IP otrzymuje domyślną pulę pakietów podczas tworzenia.</span><span class="sxs-lookup"><span data-stu-id="b6d16-488">Each IP instance is given a default packet pool during creation.</span></span> <span data-ttu-id="b6d16-489">Ta Pula pakietów służy do przydzielania pakietów dla protokołów ARP, RARP, ICMP, IGMP, różnych pakietów kontroli TCP (takich jak SYN, ACK).</span><span class="sxs-lookup"><span data-stu-id="b6d16-489">This packet pool is used to allocate packets for ARP, RARP, ICMP, IGMP, various TCP control packets (such as SYN, ACK).</span></span> <span data-ttu-id="b6d16-490">Jeśli domyślna pula pakietów jest pusta, gdy NetX wymaga przydzielenia pakietu, NetX może być konieczne przerwanie określonej operacji i zwrócenie komunikatu o błędzie, jeśli jest to możliwe.</span><span class="sxs-lookup"><span data-stu-id="b6d16-490">If the default packet pool is empty when NetX needs to allocate a packet, NetX may have to abort the particular operation, and will return an error message if possible.</span></span>

### <a name="ip-helper-thread"></a><span data-ttu-id="b6d16-491">Wątek pomocnika IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-491">IP Helper Thread</span></span>

<span data-ttu-id="b6d16-492">Każde wystąpienie protokołu IP ma wątek pomocnika.</span><span class="sxs-lookup"><span data-stu-id="b6d16-492">Each IP instance has a helper thread.</span></span> <span data-ttu-id="b6d16-493">Ten wątek jest odpowiedzialny za obsługę całego odroczonego przetwarzania pakietów i całego przetwarzania okresowego.</span><span class="sxs-lookup"><span data-stu-id="b6d16-493">This thread is responsible for handling all deferred packet processing and all periodic processing.</span></span> <span data-ttu-id="b6d16-494">Wątek pomocnika IP jest tworzony w ***nx_ip_create.***</span><span class="sxs-lookup"><span data-stu-id="b6d16-494">The IP helper thread is created in ***nx_ip_create.***</span></span> <span data-ttu-id="b6d16-495">Jest to miejsce, w którym wątek otrzymuje swój stos i priorytet.</span><span class="sxs-lookup"><span data-stu-id="b6d16-495">This is where the thread is given its stack and priority.</span></span> <span data-ttu-id="b6d16-496">Należy zauważyć, że pierwsze przetwarzanie w wątku pomocnika IP to zakończenie inicjowania sterownika sieci skojarzonego z usługą IP Create.</span><span class="sxs-lookup"><span data-stu-id="b6d16-496">Note that the first processing in the IP helper thread is to finish the network driver initialization associated with the IP create service.</span></span> <span data-ttu-id="b6d16-497">Po zakończeniu inicjalizacji sterownika sieci wątek pomocniczy uruchamia nieskończoną pętlę, aby przetwarzać pakiety i okresowo żądania.</span><span class="sxs-lookup"><span data-stu-id="b6d16-497">After the network driver initialization is complete, the helper thread starts an endless loop to process packet and periodic requests.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-498">*Jeśli w wątku pomocnika adresów IP jest widoczne niewyjaśnione zachowanie, zwiększenie rozmiaru stosu w trakcie tworzenia usługi IP to pierwszy krok debugowania. Jeśli stos jest za mały, wątek pomocnika IP może spowodować zastępowanie pamięci, co może prowadzić do nietypowych problemów.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-498">*If unexplained behavior is seen within the IP helper thread, increasing its stack size during the IP create service is the first debugging step. If the stack is too small, the IP helper thread could possibly be overwriting memory, which may cause unusual problems.*</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="b6d16-499">Zawieszenie wątku</span><span class="sxs-lookup"><span data-stu-id="b6d16-499">Thread Suspension</span></span>

<span data-ttu-id="b6d16-500">Wątki aplikacji mogą wstrzymywać podczas próby odbierania pakietów pierwotnych adresów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-500">Application threads can suspend while attempting to receive raw IP packets.</span></span> <span data-ttu-id="b6d16-501">Po odebraniu pakietu RAW nowy pakiet jest przyznany do pierwszego wątku zawieszanego i ten wątek zostaje wznowiony.</span><span class="sxs-lookup"><span data-stu-id="b6d16-501">After a raw packet is received, the new packet is given to the first thread suspended and that thread is resumed.</span></span> <span data-ttu-id="b6d16-502">Usługi NetX dla wszystkich odbieranych pakietów mają opcjonalny limit czasu zawieszenia.</span><span class="sxs-lookup"><span data-stu-id="b6d16-502">NetX services for receiving packets all have an optional suspension timeout.</span></span> <span data-ttu-id="b6d16-503">Po odebraniu pakietu lub upływie limitu czasu wątek aplikacji zostaje wznowiony z odpowiednim stanem ukończenia.</span><span class="sxs-lookup"><span data-stu-id="b6d16-503">When a packet is received or the timeout expires, the application thread is resumed with the appropriate completion status.</span></span>

### <a name="ip-statistics-and-errors"></a><span data-ttu-id="b6d16-504">Statystyka i błędy adresów IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-504">IP Statistics and Errors</span></span>

<span data-ttu-id="b6d16-505">Jeśli ta opcja jest włączona, NetX śledzi kilka statystyk i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-505">If enabled, the NetX keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="b6d16-506">Dla każdego wystąpienia IP są obsługiwane następujące raporty statystyczne i błędy:</span><span class="sxs-lookup"><span data-stu-id="b6d16-506">The following statistics and error reports are maintained for each IP instance:</span></span>

- <span data-ttu-id="b6d16-507">Całkowita liczba wysłanych pakietów IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-507">Total IP Packets Sent</span></span>
- <span data-ttu-id="b6d16-508">Całkowita liczba wysłanych bajtów IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-508">Total IP Bytes Sent</span></span>
- <span data-ttu-id="b6d16-509">Całkowita liczba odebranych pakietów IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-509">Total IP Packets Received</span></span>
- <span data-ttu-id="b6d16-510">Całkowita liczba odebranych bajtów IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-510">Total IP Bytes Received</span></span>
- <span data-ttu-id="b6d16-511">Łączna liczba nieprawidłowych pakietów adresu IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-511">Total IP Invalid Packets</span></span>
- <span data-ttu-id="b6d16-512">Całkowita liczba porzuconych pakietów odebranych adresów IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-512">Total IP Receive Packets Dropped</span></span>
- <span data-ttu-id="b6d16-513">Łączne błędy sum kontrolnych odbierania adresów IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-513">Total IP Receive Checksum Errors</span></span>
- <span data-ttu-id="b6d16-514">Całkowita liczba porzuconych pakietów wysłanych przez protokół IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-514">Total IP Send Packets Dropped</span></span>
- <span data-ttu-id="b6d16-515">Całkowita liczba wysłanych fragmentów adresów IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-515">Total IP Fragments Sent</span></span>
- <span data-ttu-id="b6d16-516">Całkowita liczba odebranych fragmentów adresów IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-516">Total IP Fragments Received</span></span>

<span data-ttu-id="b6d16-517">Wszystkie te statystyki i raporty o błędach są dostępne dla aplikacji z usługą ***nx_ip_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-517">All of these statistics and error reports are available to the application with the ***nx_ip_info_get*** service.</span></span>

### <a name="ip-control-block-nx_ip"></a><span data-ttu-id="b6d16-518">NX_IP bloku kontroli adresów IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-518">IP Control Block NX_IP</span></span>

<span data-ttu-id="b6d16-519">Charakterystyka każdego wystąpienia IP znajduje się w jego bloku sterowania.</span><span class="sxs-lookup"><span data-stu-id="b6d16-519">The characteristics of each IP instance are found in its control block.</span></span> <span data-ttu-id="b6d16-520">Zawiera ona przydatne informacje, takie jak adresy IP i maski sieci poszczególnych urządzeń sieciowych, a także tabela z oddzielnym adresem IP sąsiada i fizycznymi adresami sprzętowymi.</span><span class="sxs-lookup"><span data-stu-id="b6d16-520">It contains useful information such as the IP addresses and network masks of each network device, and a table of neighbor IP and physical hardware address mapping.</span></span> <span data-ttu-id="b6d16-521">Ta struktura jest zdefiniowana w ***nx_api. h*** bloki sterujące wystąpieniem IP mogą znajdować się w dowolnym miejscu w pamięci, ale najczęściej jest to, że formant blokuje strukturę globalną, definiując ją poza zakresem dowolnej funkcji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-521">This structure is defined in the ***nx_api.h*** IP instance control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

### <a name="static-ip-routing"></a><span data-ttu-id="b6d16-522">Statyczny routing adresów IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-522">Static IP Routing</span></span>

<span data-ttu-id="b6d16-523">Funkcja statycznego routingu umożliwia aplikacji określenie adresu IP sieci i następnego przeskoku dla określonych poza siecią docelowych adresów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-523">The static routing feature allows an application to specify an IP network and next hop address for specific out of network destination IP addresses.</span></span> <span data-ttu-id="b6d16-524">Jeśli routing statyczny jest włączony, NetX wyszukuje w statycznej tabeli routingu wpis pasujący do adresu docelowego pakietu do wysłania.</span><span class="sxs-lookup"><span data-stu-id="b6d16-524">If static routing is enabled, NetX searches through the static routing table for an entry matching the destination address of the packet to send.</span></span> <span data-ttu-id="b6d16-525">Jeśli nie zostanie znalezione dopasowanie, NetX przeszukuje listę interfejsów fizycznych i wybiera źródłowy adres IP i adres następnego przeskoku na podstawie docelowego adresu IP i maski sieci.</span><span class="sxs-lookup"><span data-stu-id="b6d16-525">If no match is found, NetX searches through the list of physical interfaces and chooses a source IP address and next hop address based on the destination IP address and the network mask.</span></span> <span data-ttu-id="b6d16-526">Jeśli miejsce docelowe nie jest zgodne z żadnym z adresów IP sterowników sieciowych dołączonych do wystąpienia IP, NetX wybiera interfejs, który jest bezpośrednio połączony z bramą domyślną, i używa adresu IP interfejsu jako adresu źródłowego i bramy domyślnej jako następnego przeskoku.</span><span class="sxs-lookup"><span data-stu-id="b6d16-526">If the destination does not match any of the IP addresses of the network drivers attached to the IP instance, NetX chooses an interface that is directly connected to the default gateway, and uses the IP address of the interface as source address, and the default gateway as the next hop.</span></span>

<span data-ttu-id="b6d16-527">Wpisy można dodawać i usuwać z tabeli routingu statycznego odpowiednio przy użyciu ***nx_ip_static_route_add*** i \***nx_ip_static_route_delete** _ usług.</span><span class="sxs-lookup"><span data-stu-id="b6d16-527">Entries can be added and removed from the static routing table using the ***nx_ip_static_route_add*** and \***nx_ip_static_route_delete** _ services, respectively.</span></span> <span data-ttu-id="b6d16-528">Aby można było używać routingu statycznego, aplikacja hosta musi włączyć tę funkcję, definiując _ *_NX_ENABLE_IP_STATIC_ROUTING_*. \*</span><span class="sxs-lookup"><span data-stu-id="b6d16-528">To use static routing, the host application must enable this feature by defining _ *_NX_ENABLE_IP_STATIC_ROUTING_*.\*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-529">*Podczas dodawania wpisu do statycznej tabeli routingu NetX sprawdza pasujący wpis dla określonego adresu docelowego, który znajduje się już w tabeli. Jeśli taki istnieje, zapewnia preferencję dla wpisu z mniejszą siecią (dłuższym prefiksem) w masce sieci.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-529">*When adding an entry to the static routing table, NetX checks for a matching entry for the specified destination address already in the table. If one exists, it gives preference to the entry with the smaller network (longer prefix) in the network mask.*</span></span>

### <a name="ip-fragmentation"></a><span data-ttu-id="b6d16-530">Fragmentacja IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-530">IP Fragmentation</span></span>

<span data-ttu-id="b6d16-531">Urządzenie sieciowe może mieć limity rozmiaru pakietów wychodzących.</span><span class="sxs-lookup"><span data-stu-id="b6d16-531">The network device may have limits on the size of outgoing packets.</span></span> <span data-ttu-id="b6d16-532">Ten limit jest określany jako maksymalna jednostka transmisji (MTU).</span><span class="sxs-lookup"><span data-stu-id="b6d16-532">This limit is called the maximum transmission unit (MTU).</span></span> <span data-ttu-id="b6d16-533">Jednostka MTU protokołu IP to największy rozmiar ramki IP, który sterownik warstwy linku jest w stanie przesłać bez fragmentacji pakietu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-533">IP MTU is the largest IP frame size a link layer driver is able to transmit without fragmenting the IP packet.</span></span> <span data-ttu-id="b6d16-534">Podczas fazy inicjowania sterownika urządzenia moduł sterownika musi skonfigurować jego rozmiar jednostki MTU dla adresu IP za pośrednictwem usługi \***nx_ip_interface_mtu_set**. \*</span><span class="sxs-lookup"><span data-stu-id="b6d16-534">During a device driver initialization phase, the driver module must configure its IP MTU size via the service \***nx_ip_interface_mtu_set**.\*</span></span>

<span data-ttu-id="b6d16-535">Chociaż nie jest to zalecane, aplikacja może generować datagramy większe niż bazowa Jednostka MTU IP obsługiwana przez urządzenie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-535">Although not recommended, the application may generate datagrams larger than the underlying IP MTU supported by the device.</span></span> <span data-ttu-id="b6d16-536">Przed przesłaniem takiego datagramu IP warstwa IP musi być pofragmentowana tych pakietów.</span><span class="sxs-lookup"><span data-stu-id="b6d16-536">Before transmitting such IP datagram, the IP layer must fragment these packets.</span></span> <span data-ttu-id="b6d16-537">W przypadku odebrania pofragmentowanych ramek IP na końcu musi być przechowywane wszystkie pofragmentowane ramki IP o tym samym IDENTYFIKATORze fragmentacji, a następnie ponownie nastąpić ich umieszczenie w określonej kolejności.</span><span class="sxs-lookup"><span data-stu-id="b6d16-537">On receiving fragmented IP frames, the receiving end must store all fragmented IP frames with the same fragmentation ID, and reassemble them in order.</span></span> <span data-ttu-id="b6d16-538">Jeśli logika odbierania IP nie może zebrać wszystkich fragmentów, aby przywrócić pierwotną ramkę IP w czasie, wszystkie fragmenty zostaną wydane.</span><span class="sxs-lookup"><span data-stu-id="b6d16-538">If the IP receive logic is unable to collect all the fragments to restore the original IP frame in time, all the fragments are released.</span></span> <span data-ttu-id="b6d16-539">Jest on do protokołu warstwy wyższej, aby wykryć tę utratę pakietów i odzyskać ją z niej.</span><span class="sxs-lookup"><span data-stu-id="b6d16-539">It is up to the upper layer protocol to detect such packet loss and recover from it.</span></span>

<span data-ttu-id="b6d16-540">Aby można było obsługiwać fragmentację i operacje ponownego montażu IP, projektant systemu musi włączyć funkcję fragmentacji IP w NetX przy użyciu usługi ***nx_ip_fragment_enable*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-540">In order to support IP fragmentation and reassembly operation, the system designer must enable the IP fragmentation feature in NetX using the ***nx_ip_fragment_enable*** service.</span></span> <span data-ttu-id="b6d16-541">Jeśli ta funkcja nie jest włączona, przychodzące pofragmentowane pakiety IP są odrzucane, a także pakiety, które przekraczają jednostkę MTU sterownika sieci.</span><span class="sxs-lookup"><span data-stu-id="b6d16-541">If this feature is not enabled, incoming fragmented IP packets are discarded, as well as packets that exceed the network driver's MTU.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-542">*Logikę fragmentacji adresów IP można całkowicie usunąć, definiując*  \* **NX_DISABLE_FRAGMENTATION** _ _when kompilowania biblioteki theNetX.</span><span class="sxs-lookup"><span data-stu-id="b6d16-542">*The IP Fragmentation logic can be removed completely by defining* \***NX_DISABLE_FRAGMENTATION** _ _when building theNetX library.</span></span> <span data-ttu-id="b6d16-543">Wykonanie tej czynności pomaga zmniejszyć rozmiar kodu NetX. \*</span><span class="sxs-lookup"><span data-stu-id="b6d16-543">Doing so helps reduce the code size of NetX.\*</span></span>

## <a name="address-resolution-protocol-arp-in-ip"></a><span data-ttu-id="b6d16-544">Protokół ARP (Address Resolution Protocol) w adresie IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-544">Address Resolution Protocol (ARP) in IP</span></span>

<span data-ttu-id="b6d16-545">Protokół ARP (Address Resolution Protocol) jest odpowiedzialny za dynamiczne mapowanie 32-bitowych adresów IP na podstawowe nośniki fizyczne (RFC 826).</span><span class="sxs-lookup"><span data-stu-id="b6d16-545">The Address Resolution Protocol (ARP) is responsible for dynamically mapping 32-bit IP addresses to those of the underlying physical media (RFC 826).</span></span> <span data-ttu-id="b6d16-546">Ethernet jest najbardziej typowym nośnikiem fizycznym i obsługuje adresy 48-bitowe.</span><span class="sxs-lookup"><span data-stu-id="b6d16-546">Ethernet is the most typical physical media, and it supports 48-bit addresses.</span></span> <span data-ttu-id="b6d16-547">Potrzeba protokołu ARP jest określana przez sterownik sieciowy dostarczany do usługi ***nx_ip_create*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-547">The need for ARP is determined by the network driver supplied to the ***nx_ip_create*** service.</span></span> <span data-ttu-id="b6d16-548">Jeśli wymagane jest mapowanie fizyczne, Sterownik sieciowy musi ustawić flagę ***nx_interface_address_mapping_needed*** w interfejsie logiczna.</span><span class="sxs-lookup"><span data-stu-id="b6d16-548">If physical mapping is required, the network driver must set the flag ***nx_interface_address_mapping_needed*** in the interface strcuture.</span></span>

### <a name="arp-enable"></a><span data-ttu-id="b6d16-549">Włączanie protokołu ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-549">ARP Enable</span></span>
<span data-ttu-id="b6d16-550">Aby protokół ARP działał prawidłowo, musi on być najpierw włączony przez aplikację z usługą ***nx_arp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-550">For ARP to function properly, it must first be enabled by the application with the ***nx_arp_enable*** service.</span></span> <span data-ttu-id="b6d16-551">Ta usługa konfiguruje różne struktury danych na potrzeby przetwarzania ARP, w tym tworzenie obszaru pamięci podręcznej ARP z pamięci dostarczonej do usługi ARP Enable.</span><span class="sxs-lookup"><span data-stu-id="b6d16-551">This service sets up various data structures for ARP processing, including the creation of an ARP cache area from the memory supplied to the ARP enable service.</span></span>

### <a name="arp-cache"></a><span data-ttu-id="b6d16-552">Pamięć podręczna ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-552">ARP Cache</span></span>
<span data-ttu-id="b6d16-553">Pamięć podręczna ARP może być wyświetlana jako tablica wewnętrznych struktur danych mapowania ARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-553">The ARP cache can be viewed as an array of internal ARP mapping data structures.</span></span> <span data-ttu-id="b6d16-554">Każda struktura wewnętrzna może utrzymywać relacje między adresem IP a fizycznym adresem sprzętowym.</span><span class="sxs-lookup"><span data-stu-id="b6d16-554">Each internal structure is capable of maintaining the relationship between an IP address and a physical hardware address.</span></span> <span data-ttu-id="b6d16-555">Ponadto każda struktura danych ma wskaźniki łączy, więc może być częścią wielu połączonych list.</span><span class="sxs-lookup"><span data-stu-id="b6d16-555">In addition, each data structure has link pointers so it can be part of multiple linked lists.</span></span>

<span data-ttu-id="b6d16-556">Aplikacja może wyszukiwać adres IP z pamięci podręcznej ARP przez dostarczenie sprzętowego adresu MAC przy użyciu usługi \***nx_arp_ip_address_find** _, jeśli mapowanie istnieje w tabeli ARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-556">Application can look up an IP address from the ARP cache by supplying hardware MAC address using the service \***nx_arp_ip_address_find** _ if the mapping exists in the ARP table.</span></span> <span data-ttu-id="b6d16-557">Podobnie usługa _ *_nx_arp_hardware_address_find_*\* zwraca adres MAC dla danego adresu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-557">Similarly, the service _ *_nx_arp_hardware_address_find_*\* returns the MAC address for a given IP address.</span></span>


### <a name="arp-dynamic-entries"></a><span data-ttu-id="b6d16-558">Dynamiczne wpisy ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-558">ARP Dynamic Entries</span></span>

<span data-ttu-id="b6d16-559">Domyślnie usługa ARP Enable umieszcza wszystkie wpisy w pamięci podręcznej ARP na liście dostępnych dynamicznych wpisów ARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-559">By default, the ARP enable service places all entries in the ARP cache on the list of available dynamic ARP entries.</span></span> <span data-ttu-id="b6d16-560">Dynamiczny wpis ARP jest przypisywany z tej listy przez NetX w przypadku wykrycia żądania wysłania do niemapowanego adresu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-560">A dynamic ARP entry is allocated from this list by NetX when a send request to an unmapped IP address is detected.</span></span> <span data-ttu-id="b6d16-561">Po przydzieleniu wpis ARP zostaje skonfigurowany, a żądanie ARP jest wysyłane do nośnika fizycznego.</span><span class="sxs-lookup"><span data-stu-id="b6d16-561">After allocation, the ARP entry is set up and an ARP request is sent to the physical media.</span></span>

<span data-ttu-id="b6d16-562">Wpis dynamiczny może być również utworzony przez ***nx_arp_dynamic_entry_set*** usługi.</span><span class="sxs-lookup"><span data-stu-id="b6d16-562">A dynamic entry can also be created by the service ***nx_arp_dynamic_entry_set***.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-563">*Jeśli wszystkie dynamiczne wpisy ARP są używane, co najmniej ostatnio używany wpis ARP zostanie zastąpiony nowym mapowaniem.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-563">*If all dynamic ARP entries are in use, the least recently used ARP entry is replaced with a new mapping.*</span></span>

### <a name="arp-static-entries"></a><span data-ttu-id="b6d16-564">Statyczne wpisy ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-564">ARP Static Entries</span></span>
<span data-ttu-id="b6d16-565">Aplikacja może również skonfigurować statyczne mapowanie ARP przy użyciu usługi ***nx_arp_static_entry_create*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-565">The application can also set up static ARP mapping by using the ***nx_arp_static_entry_create*** service.</span></span> <span data-ttu-id="b6d16-566">Ta usługa przydziela wpis ARP z listy dynamicznego wpisu ARP i umieszcza ją na liście statycznej z informacjami o mapowaniu dostarczanymi przez aplikację.</span><span class="sxs-lookup"><span data-stu-id="b6d16-566">This service allocates an ARP entry from the dynamic ARP entry list and places it on the static list with the mapping information supplied by the application.</span></span> <span data-ttu-id="b6d16-567">Statyczne wpisy ARP nie mogą być ponownie używane ani przedawnianie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-567">Static ARP entries are not subject to reuse or aging.</span></span> <span data-ttu-id="b6d16-568">Aplikacja może usunąć wpis statyczny przy użyciu ***nx_arp_static_entry_delete*** usługi.</span><span class="sxs-lookup"><span data-stu-id="b6d16-568">The application can delete a static entry by using the service ***nx_arp_static_entry_delete***.</span></span>
<span data-ttu-id="b6d16-569">Aby usunąć wszystkie wpisy statyczne w tabeli ARP, aplikacja może używać ***nx_arp_static_entries_delete*** usługi.</span><span class="sxs-lookup"><span data-stu-id="b6d16-569">To remove all static entries in the ARP table, the application may use the service ***nx_arp_static_entries_delete***.</span></span>

### <a name="automatic-arp-entry"></a><span data-ttu-id="b6d16-570">Wpis automatyczny ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-570">Automatic ARP Entry</span></span>
<span data-ttu-id="b6d16-571">NetX rejestruje mapowanie adresów IP/MAC elementu równorzędnego po odpowiedzi elementu równorzędnego na żądanie protokołu ARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-571">NetX records the peer's IP/MAC mapping after the peer responses to the ARP request.</span></span> <span data-ttu-id="b6d16-572">NetX implementuje również funkcję automatycznego wpisu ARP, gdzie rejestruje adresy IP równorzędnego mapowania adresów MAC na podstawie niezamówionych żądań ARP z sieci.</span><span class="sxs-lookup"><span data-stu-id="b6d16-572">NetX also implements the automatic ARP entry feature where it records peer IP/MAC address mapping based on unsolicited ARP requests from the network.</span></span> <span data-ttu-id="b6d16-573">Ta funkcja umożliwia wypełnienie tabeli ARP informacjami o komunikacji równorzędnej, co zmniejsza opóźnienie potrzebne do przechodzenia przez cykl żądania/odpowiedzi ARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-573">This feature allows the ARP table to be populated with peer information, reducing the delay needed to go through the ARP request/response cycle.</span></span> <span data-ttu-id="b6d16-574">Jednak minusem z włączaniem automatycznego protokołu ARP polega na tym, że tabela ARP jest w stanie szybko zapełniać się siecią z wieloma węzłami w łączu lokalnym, co ostatecznie doprowadziłoby do zamiany pozycji ARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-574">However the downside with enabling automatic ARP is that the ARP table tend to fill up quickly on a busy network with many nodes on the local link, which would eventually lead to ARP entry replacement.</span></span>

<span data-ttu-id="b6d16-575">Ta funkcja jest domyślnie włączona.</span><span class="sxs-lookup"><span data-stu-id="b6d16-575">This feature is enabled by default.</span></span> <span data-ttu-id="b6d16-576">Aby go wyłączyć, biblioteka NetX musi być skompilowana przy użyciu zdefiniowanego symbolu ***NX_DISABLE_ARP_AUTO_ENTRY*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-576">To disable it, the NetX library must be compiled with the symbol ***NX_DISABLE_ARP_AUTO_ENTRY*** defined.</span></span>

### <a name="arp-messages"></a><span data-ttu-id="b6d16-577">Komunikaty ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-577">ARP Messages</span></span>

<span data-ttu-id="b6d16-578">Jak wspomniano wcześniej, komunikat żądania ARP jest wysyłany, gdy zadanie IP wykryje, że mapowanie jest niezbędne dla adresu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-578">As mentioned previously, an ARP request message is sent when the IP task detects that mapping is needed for an IP address.</span></span> <span data-ttu-id="b6d16-579">Żądania ARP są wysyłane okresowo (co \***NX_ARP_UPDATE_RATE** _ sekund) do momentu otrzymania odpowiedniej odpowiedzi ARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-579">ARP requests are sent periodically (every \***NX_ARP_UPDATE_RATE** _ seconds) until a corresponding ARP response is received.</span></span> <span data-ttu-id="b6d16-580">Całkowita liczba żądań ARP wynosząca _ *_NX_ARP_MAXIMUM_RETRIES_*\* przed porzucić próbą ARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-580">A total of _ *_NX_ARP_MAXIMUM_RETRIES_*\* ARP requests are made before the ARP attempt is abandoned.</span></span> <span data-ttu-id="b6d16-581">Po odebraniu odpowiedzi ARP skojarzone informacje o adresie fizycznym są przechowywane we wpisie ARP, który znajduje się w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="b6d16-581">When an ARP response is received, the associated physical address information is stored in the ARP entry that is in the cache.</span></span>

<span data-ttu-id="b6d16-582">W przypadku systemów wielodomowych NetX określa, który interfejs wysyła żądania ARP i odpowiedzi na podstawie określonego adresu docelowego.</span><span class="sxs-lookup"><span data-stu-id="b6d16-582">For multihome systems, NetX determines which interface to send the ARP requests and responses based on destination address specified.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-583">*Wychodzące pakiety IP są umieszczane w kolejce, podczas gdy NetX czeka na odpowiedź ARP. Liczba wychodzących pakietów IP* *umieszczonych w kolejce jest definiowana przez stałą*  \* **NX_ARP_MAX_QUEUE_DEPTH**. \*</span><span class="sxs-lookup"><span data-stu-id="b6d16-583">*Outgoing IP packets are queued while NetX waits for the ARP response. The number of outgoing IP* *packets queued is defined by the constant* \***NX_ARP_MAX_QUEUE_DEPTH**.\*</span></span>

<span data-ttu-id="b6d16-584">NetX reaguje także na żądania ARP z innych węzłów w lokalnej sieci IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-584">NetX also responds to ARP requests from other nodes on the local IP network.</span></span> <span data-ttu-id="b6d16-585">Gdy zostanie wprowadzone zewnętrzne żądanie ARP zgodne z bieżącym adresem IP interfejsu, który odbiera żądanie ARP, NetX kompiluje komunikat odpowiedzi ARP zawierający bieżący adres fizyczny.</span><span class="sxs-lookup"><span data-stu-id="b6d16-585">When an external ARP request is made that matches the current IP address of the interface that receives the ARP request, NetX builds an ARP response message that contains the current physical address.</span></span>

<span data-ttu-id="b6d16-586">Formaty żądań i odpowiedzi Ethernet ARP przedstawiono na rysunku 6 i opisano poniżej:</span><span class="sxs-lookup"><span data-stu-id="b6d16-586">The formats of Ethernet ARP requests and responses are shown in Figure 6 and are described below:</span></span>

| <span data-ttu-id="b6d16-587">Pole żądania/odpowiedzi</span><span class="sxs-lookup"><span data-stu-id="b6d16-587">Request/Response Field</span></span>       | <span data-ttu-id="b6d16-588">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="b6d16-588">Purpose</span></span>    |
|------------------------------|-----------------|
| <span data-ttu-id="b6d16-589">Adres docelowy sieci Ethernet</span><span class="sxs-lookup"><span data-stu-id="b6d16-589">Ethernet Destination Address</span></span> | <span data-ttu-id="b6d16-590">To 6-bajtowe pole zawiera adres docelowy odpowiedzi ARP i jest emisją (wszystkie) dla żądań ARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-590">This 6-byte field contains the destination address for the ARP response and is a broadcast (all ones) for ARP requests.</span></span> <span data-ttu-id="b6d16-591">To pole jest konfiguracją przez sterownik sieciowy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-591">This field is setup by the network driver.</span></span> |
| <span data-ttu-id="b6d16-592">Adres źródłowy sieci Ethernet</span><span class="sxs-lookup"><span data-stu-id="b6d16-592">Ethernet Source Address</span></span>      | <span data-ttu-id="b6d16-593">To 6-bajtowe pole zawiera adres nadawcy żądania lub odpowiedzi ARP i jest skonfigurowany przez sterownik sieciowy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-593">This 6-byte field contains the address of the sender of the ARP request or response and is set up by the network driver.</span></span> |
| <span data-ttu-id="b6d16-594">Typ ramki</span><span class="sxs-lookup"><span data-stu-id="b6d16-594">Frame Type</span></span>                   | <span data-ttu-id="b6d16-595">To pole 2-bajtowe zawiera typ ramki Ethernet, a w przypadku żądań i odpowiedzi ARP jest to równe 0x0806.</span><span class="sxs-lookup"><span data-stu-id="b6d16-595">This 2-byte field contains the type of Ethernet frame present and, for ARP requests and responses, this is equal to 0x0806.</span></span> <span data-ttu-id="b6d16-596">Jest to ostatnie pole, za pomocą którego sterownik sieciowy jest odpowiedzialny za konfigurowanie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-596">This is the last field the network driver is responsible for setting up.</span></span> |
| <span data-ttu-id="b6d16-597">Typ sprzętu</span><span class="sxs-lookup"><span data-stu-id="b6d16-597">Hardware Type</span></span>                | <span data-ttu-id="b6d16-598">To pole 2-bajtowe zawiera typ sprzętu, który jest 0x0001 dla sieci Ethernet.</span><span class="sxs-lookup"><span data-stu-id="b6d16-598">This 2-byte field contains the hardware type, which is 0x0001 for Ethernet.</span></span> |
| <span data-ttu-id="b6d16-599">Typ protokołu</span><span class="sxs-lookup"><span data-stu-id="b6d16-599">Protocol Type</span></span>                | <span data-ttu-id="b6d16-600">To pole 2-bajtowe zawiera typ protokołu, który jest 0x0800 dla adresów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-600">This 2-byte field contains the protocol type, which is 0x0800 for IP addresses.</span></span> |
| <span data-ttu-id="b6d16-601">Rozmiar sprzętu</span><span class="sxs-lookup"><span data-stu-id="b6d16-601">Hardware Size</span></span>                | <span data-ttu-id="b6d16-602">To pole 1-bajtowe zawiera rozmiar sprzętowy, który jest 6 dla adresów Ethernet.</span><span class="sxs-lookup"><span data-stu-id="b6d16-602">This 1-byte field contains the hardware address size, which is 6 for Ethernet addresses.</span></span> |


![Format pakietu ARP](./media/user-guide/arp-packet-format.png)

<span data-ttu-id="b6d16-604">**RYSUNEK 6. Format pakietu ARP**</span><span class="sxs-lookup"><span data-stu-id="b6d16-604">**FIGURE 6. ARP Packet Format**</span></span>

| <span data-ttu-id="b6d16-605">Pole żądania/odpowiedzi</span><span class="sxs-lookup"><span data-stu-id="b6d16-605">Request/Response Field</span></span> | <span data-ttu-id="b6d16-606">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="b6d16-606">Purpose</span></span>  |
|---|---|
| <span data-ttu-id="b6d16-607">Rozmiar protokołu</span><span class="sxs-lookup"><span data-stu-id="b6d16-607">Protocol Size</span></span> | <span data-ttu-id="b6d16-608">To pole 1-bajtowe zawiera rozmiar adresu IP, czyli 4 dla adresów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-608">This 1-byte field contains the IP address size, which is 4 for IP addresses.</span></span>  |
| <span data-ttu-id="b6d16-609">Kod operacji</span><span class="sxs-lookup"><span data-stu-id="b6d16-609">Operation Code</span></span> | <span data-ttu-id="b6d16-610">To pole 2-bajtowe zawiera operację dla tego pakietu ARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-610">This 2-byte field contains the operation for this ARP packet.</span></span> <span data-ttu-id="b6d16-611">W żądaniu ARP jest określana wartość 0x0001, podczas gdy odpowiedź ARP jest reprezentowana przez wartość 0x0002.</span><span class="sxs-lookup"><span data-stu-id="b6d16-611">An ARP request is specified with the value of 0x0001, while an ARP response is represented by a value of 0x0002.</span></span>  |
| <span data-ttu-id="b6d16-612">Adres Ethernet nadawcy</span><span class="sxs-lookup"><span data-stu-id="b6d16-612">Sender Ethernet Address</span></span> | <span data-ttu-id="b6d16-613">To 6-bajtowe pole zawiera adres Ethernet nadawcy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-613">This 6-byte field contains the sender's Ethernet address.</span></span> |
| <span data-ttu-id="b6d16-614">Adres IP nadawcy</span><span class="sxs-lookup"><span data-stu-id="b6d16-614">Sender IP Address</span></span> | <span data-ttu-id="b6d16-615">To pole 4-bajtowe zawiera adres IP nadawcy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-615">This 4-byte field contains the sender's IP address.</span></span> |
| <span data-ttu-id="b6d16-616">Docelowy adres ethernetowy</span><span class="sxs-lookup"><span data-stu-id="b6d16-616">Target Ethernet Address</span></span> | <span data-ttu-id="b6d16-617">To pole 6-bajtowe zawiera adres Ethernet docelowy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-617">This 6-byte field contains the target's Ethernet address.</span></span> |
| <span data-ttu-id="b6d16-618">Docelowy adres IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-618">Target IP Address</span></span> | <span data-ttu-id="b6d16-619">To pole 4-bajtowe zawiera adres IP miejsca docelowego.</span><span class="sxs-lookup"><span data-stu-id="b6d16-619">This 4-byte field contains the target's IP address.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="b6d16-620">*Żądania i odpowiedzi ARP są pakietami na poziomie sieci Ethernet. Wszystkie inne pakiety TCP/IP są hermetyzowane przez nagłówek pakietu IP.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-620">*ARP requests and responses are Ethernet-level packets. All other TCP/IP packets are encapsulated by an IP packet header.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-621">*Oczekuje się, że wszystkie komunikaty ARP w implementacji protokołu TCP/IP mają być w formacie big endian. W tym formacie najbardziej znaczący bajt słowa znajduje się na najniższym adresie bajtowym.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-621">*All ARP messages in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="arp-aging"></a><span data-ttu-id="b6d16-622">Przedawnianie protokołu ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-622">ARP Aging</span></span>

<span data-ttu-id="b6d16-623">NetX obsługuje automatyczne unieważnianie wpisów dynamicznego ARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-623">NetX supports automatic dynamic ARP entry invalidation.</span></span><span data-ttu-id="b6d16-624">\ ***NX_ARP_EXPIRATION_RATE** _specifies liczbę sekund, przez które ustanowiony adres IP dla mapowania fizycznego pozostaje prawidłowy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-624">\ ***NX_ARP_EXPIRATION_RATE** _specifies the number of seconds an established IP address to physical mapping stays valid.</span></span> <span data-ttu-id="b6d16-625">Po wygaśnięciu wpis ARP zostanie usunięty z pamięci podręcznej ARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-625">After expiration, the ARP entry is removed from the ARP cache.</span></span> <span data-ttu-id="b6d16-626">Kolejna próba wysłania do odpowiedniego adresu IP spowoduje powstanie nowego żądania protokołu ARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-626">The next attempt to send to the corresponding IP address will result in a new ARP request.</span></span> <span data-ttu-id="b6d16-627">Ustawienie _ *_NX_ARP_EXPIRATION_RATE_*\* na zero powoduje wyłączenie przedawnienia ARP, co jest konfiguracją domyślną.</span><span class="sxs-lookup"><span data-stu-id="b6d16-627">Setting _ *_NX_ARP_EXPIRATION_RATE_*\* to zero disables ARP aging, which is the default configuration.</span></span>

### <a name="arp-defend"></a><span data-ttu-id="b6d16-628">Obrona protokołu ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-628">ARP Defend</span></span>

<span data-ttu-id="b6d16-629">Po odebraniu żądania ARP lub pakietu odpowiedzi ARP, gdy nadawca ma ten sam adres IP, który powoduje konflikt z adresem IP tego węzła, NetX wysyła żądanie ARP dla tego adresu jako obronność.</span><span class="sxs-lookup"><span data-stu-id="b6d16-629">When an ARP request or ARP response packet is received and the sender has the same IP address, which conflicts with the IP address of this node, NetX sends an ARP request for that address as a defense.</span></span> <span data-ttu-id="b6d16-630">Jeśli pakiet rozwiązywania konfliktów ARP jest odbierany więcej niż raz w ciągu 10 sekund, NetX nie wyśle więcej pakietów obrony.</span><span class="sxs-lookup"><span data-stu-id="b6d16-630">If the conflict ARP packet is received more than once in 10 seconds, NetX does not send more defend packets.</span></span> <span data-ttu-id="b6d16-631">Domyślny interwał 10 sekund można zdefiniować ponownie przez \***NX_ARP_DEFEND_INTERVAL** _.</span><span class="sxs-lookup"><span data-stu-id="b6d16-631">The default interval 10 seconds can be redefined by \***NX_ARP_DEFEND_INTERVAL** _.</span></span> <span data-ttu-id="b6d16-632">To zachowanie jest zgodne z zasadami określonymi w 2.4 (c) RFC5227.</span><span class="sxs-lookup"><span data-stu-id="b6d16-632">This behavior follows the policy specified in 2.4(c) of RFC5227.</span></span> <span data-ttu-id="b6d16-633">Ponieważ system Windows XP ignoruje anons protokołu ARP jako odpowiedź na sondę ARP, użytkownik może zdefiniować _ *_NX_ARP_DEFEND_BY_REPLY_* \*, aby wysłać odpowiedź ARP jako dodatkową obronę.</span><span class="sxs-lookup"><span data-stu-id="b6d16-633">Since Windows XP ignores ARP announcement as a response for its ARP probe, user can define _\*_NX_ARP_DEFEND_BY_REPLY_\*\*to send ARP response as additional defence.</span></span>

### <a name="arp-statistics-and-errors"></a><span data-ttu-id="b6d16-634">Statystyki i błędy dotyczące protokołu ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-634">ARP Statistics and Errors</span></span>

<span data-ttu-id="b6d16-635">Jeśli ta opcja jest włączona, oprogramowanie NetX ARP śledzi kilka statystyk i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-635">If enabled, the NetX ARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="b6d16-636">Następujące raporty statystyczne i błędy są obsługiwane dla każdego przetwarzania ARP IP:</span><span class="sxs-lookup"><span data-stu-id="b6d16-636">The following statistics and error reports are maintained for each IP's ARP processing:</span></span>

- <span data-ttu-id="b6d16-637">Całkowita liczba wysłanych żądań ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-637">Total ARP Requests Sent</span></span>
- <span data-ttu-id="b6d16-638">Całkowita liczba odebranych żądań ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-638">Total ARP Requests Received</span></span>
- <span data-ttu-id="b6d16-639">Całkowita liczba wysłanych odpowiedzi ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-639">Total ARP Responses Sent</span></span>
- <span data-ttu-id="b6d16-640">Całkowita liczba odebranych odpowiedzi ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-640">Total ARP Responses Received</span></span>
- <span data-ttu-id="b6d16-641">Łączna liczba wpisów dynamicznych ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-641">Total ARP Dynamic Entries</span></span>
- <span data-ttu-id="b6d16-642">Łączna liczba wpisów statycznych ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-642">Total ARP Static Entries</span></span>
- <span data-ttu-id="b6d16-643">Łączna liczba przestarzałych wpisów ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-643">Total ARP Aged Entries</span></span>
- <span data-ttu-id="b6d16-644">Całkowita liczba nieprawidłowych komunikatów ARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-644">Total ARP Invalid Messages</span></span>

<span data-ttu-id="b6d16-645">Wszystkie te statystyki i raporty o błędach są dostępne dla aplikacji z usługą ***nx_arp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-645">All these statistics and error reports are available to the application with the ***nx_arp_info_get*** service.</span></span>

## <a name="reverse-address-resolution-protocol-rarp-in-ip"></a><span data-ttu-id="b6d16-646">Protokół odwrotnego rozpoznawania adresów (RARP) w adresie IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-646">Reverse Address Resolution Protocol (RARP) in IP</span></span>

<span data-ttu-id="b6d16-647">Protokół odwrotnego rozpoznawania adresów (RARP) to protokół służący do żądania przypisania sieci na 32-bitowe adresy IP hosta (RFC 903).</span><span class="sxs-lookup"><span data-stu-id="b6d16-647">The Reverse Address Resolution Protocol (RARP) is the protocol for requesting network assignment of the host's 32-bit IP addresses (RFC 903).</span></span> <span data-ttu-id="b6d16-648">Odbywa się to za pomocą żądania RARP i kontynuuje okresowo, dopóki członek sieci przypisze adres IP do interfejsu sieciowego hosta w odpowiedzi RARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-648">This is done through an RARP request and continues periodically until a network member assigns an IP address to the host network interface in an RARP response.</span></span> <span data-ttu-id="b6d16-649">Aplikacja tworzy wystąpienie IP przez usługę ***nx_ip_create*** z zerowym adresem IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-649">The application creates an IP instance by the service ***nx_ip_create*** with a zero IP address.</span></span> <span data-ttu-id="b6d16-650">Jeśli RARP jest włączona przez aplikację, może użyć protokołu RARP, aby zażądać adresu IP z serwera sieciowego dostępnego za pośrednictwem interfejsu, który ma zerowy adres IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-650">If RARP is enabled by the application, it can use the RARP protocol to request an IP address from the network server accessible through the interface that has a zero IP address.</span></span>

### <a name="rarp-enable"></a><span data-ttu-id="b6d16-651">Włącz RARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-651">RARP Enable</span></span>

<span data-ttu-id="b6d16-652">Aby użyć RARP, aplikacja musi utworzyć wystąpienie IP z adresem IP zerowym, a następnie włączyć RARP przy użyciu ***nx_rarp_enable*** usługi.</span><span class="sxs-lookup"><span data-stu-id="b6d16-652">To use RARP, the application must create the IP instance with an IP address of zero, then enable RARP using the service ***nx_rarp_enable***.</span></span> <span data-ttu-id="b6d16-653">W przypadku systemów wielodomowych co najmniej jedno urządzenie sieciowe skojarzone z wystąpieniem IP musi mieć adres IP równy zero.</span><span class="sxs-lookup"><span data-stu-id="b6d16-653">For multihome systems, at least one network device associated with the IP instance must have an IP address of zero.</span></span> <span data-ttu-id="b6d16-654">Przetwarzanie RARP okresowo wysyła komunikaty żądania RARP dla systemu NetX wymagającego adresu IP do momentu otrzymania prawidłowej odpowiedzi RARP z wydzielonym adresem IP w sieci.</span><span class="sxs-lookup"><span data-stu-id="b6d16-654">The RARP processing periodically sends RARP request messages for the NetX system requiring an IP address until a valid RARP reply with the network designated IP address is received.</span></span> <span data-ttu-id="b6d16-655">W tym momencie przetwarzanie RARP zostało zakończone.</span><span class="sxs-lookup"><span data-stu-id="b6d16-655">At this point, RARP processing is complete.</span></span>

<span data-ttu-id="b6d16-656">Po włączeniu RARP jest on automatycznie wyłączany po rozwiązaniu wszystkich adresów interfejsu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-656">After RARP has been enabled, it is disabled automatically after all interface addresses are resolved.</span></span> <span data-ttu-id="b6d16-657">Aplikacja może wymusić zakończenie RARP przy użyciu usługi ***nx_rarp_disable***.</span><span class="sxs-lookup"><span data-stu-id="b6d16-657">The application may force RARP to terminate by using the service ***nx_rarp_disable***.</span></span>

###  <a name="rarp-request"></a><span data-ttu-id="b6d16-658">Żądanie RARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-658">RARP Request</span></span>

<span data-ttu-id="b6d16-659">Format pakietu żądania RARP jest niemal identyczny z pakietem ARP pokazanym na rysunku 6 w temacie [komunikaty ARP](#arp-messages). Jedyną różnicą jest pole Typ ramki to 0x8035, a pole *kod operacji* to 3, które wyznacza żądanie RARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-659">The format of an RARP request packet is almost identical to the ARP packet shown in Figure 6 in the topic [ARP Messages](#arp-messages).The only difference is the frame type field is 0x8035 and the *Operation Code* field is 3, designating an RARP request.</span></span> <span data-ttu-id="b6d16-660">Jak wspomniano wcześniej, żądania RARP będą wysyłane okresowo (co ***NX_RARP_UPDATE_RATE*** sekund) do momentu otrzymania odpowiedzi RARP z przypisanym adresem IP sieci.</span><span class="sxs-lookup"><span data-stu-id="b6d16-660">As mentioned previously, RARP requests will be sent periodically (every ***NX_RARP_UPDATE_RATE*** seconds) until a RARP reply with the network assigned IP address is received.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-661">*Oczekuje się, że wszystkie komunikaty RARP w implementacji protokołu TCP/IP będą w formacie big endian. W tym formacie najbardziej znaczący bajt słowa znajduje się na najniższym adresie bajtowym.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-661">*All RARP messages in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="rarp-reply"></a><span data-ttu-id="b6d16-662">Odpowiedź RARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-662">RARP Reply</span></span>

<span data-ttu-id="b6d16-663">Komunikaty odpowiedzi RARP są odbierane z sieci i zawierają adres IP przypisany do sieci dla tego hosta.</span><span class="sxs-lookup"><span data-stu-id="b6d16-663">RARP reply messages are received from the network and contain the network assigned IP address for this host.</span></span> <span data-ttu-id="b6d16-664">Format pakietu odpowiedzi RARP jest niemal identyczny z pakietem ARP pokazanym na rysunku 6.</span><span class="sxs-lookup"><span data-stu-id="b6d16-664">The format of an RARP reply packet is almost identical to the ARP packet shown in Figure 6.</span></span> <span data-ttu-id="b6d16-665">Jedyną różnicą jest pole Typ ramki to 0x8035, a pole *kod operacji* to 4, które wyznacza odpowiedź RARP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-665">The only difference is the frame type field is 0x8035 and the *Operation Code* field is 4, which designates an RARP reply.</span></span> <span data-ttu-id="b6d16-666">Po odebraniu adres IP jest skonfigurowany w wystąpieniu IP, okresowe żądanie RARP jest wyłączone, a wystąpienie protokołu IP jest teraz gotowe do normalnego działania sieci.</span><span class="sxs-lookup"><span data-stu-id="b6d16-666">After received, the IP address is setup in the IP instance, the periodic RARP request is disabled, and the IP instance is now ready for normal network operation.</span></span>

<span data-ttu-id="b6d16-667">W przypadku hostów wielomacierzystych adres IP jest stosowany do żądającego interfejsu sieciowego.</span><span class="sxs-lookup"><span data-stu-id="b6d16-667">For multihome hosts, the IP address is applied to the requesting network interface.</span></span> <span data-ttu-id="b6d16-668">Jeśli inne interfejsy sieciowe nadal żądają przypisania adresu IP, okresowa usługa RARP będzie kontynuowana do momentu rozwiązania wszystkich żądań adresów IP interfejsu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-668">If there are other network interfaces still requesting an IP address assignment, the periodic RARP service continues until all interface IP address requests are resolved.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-669">*Aplikacja nie powinna używać wystąpienia protokołu IP do momentu ukończenia przetwarzania RARP. **Nx_ip_status_check** mogą być używane przez aplikacje w celu oczekiwania na ukończenie RARP. W przypadku systemów wielodomowych aplikacja nie powinna używać interfejsu żądającego do momentu ukończenia przetwarzania RARP w tym interfejsie. Stan adresu IP na urządzeniu pomocniczym można sprawdzić za pomocą usługi **nx_ip_interface_status_check** .*</span><span class="sxs-lookup"><span data-stu-id="b6d16-669">*The application should not use the IP instance until the RARP processing is complete. The **nx_ip_status_check** may be used by applications to wait for the RARP completion. For multihome systems, the application should not use the requesting interface until the RARP processing is complete on that interface. Status of the IP address on the secondary device can be checked with the **nx_ip_interface_status_check** service.*</span></span>

### <a name="rarp-statistics-and-errors"></a><span data-ttu-id="b6d16-670">RARP statystyk i błędów</span><span class="sxs-lookup"><span data-stu-id="b6d16-670">RARP Statistics and Errors</span></span>

<span data-ttu-id="b6d16-671">Jeśli to ustawienie jest włączone, oprogramowanie NetX RARP śledzi kilka statystyk i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-671">If enabled, the NetX RARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="b6d16-672">Następujące raporty statystyczne i błędy są obsługiwane dla każdego RARP IP:</span><span class="sxs-lookup"><span data-stu-id="b6d16-672">The following statistics and error reports are maintained for each IP's RARP processing:</span></span>

- <span data-ttu-id="b6d16-673">Całkowita liczba wysłanych żądań RARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-673">Total RARP Requests Sent</span></span>
- <span data-ttu-id="b6d16-674">Całkowita liczba odebranych odpowiedzi RARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-674">Total RARP Responses Received</span></span>
- <span data-ttu-id="b6d16-675">Całkowita liczba nieprawidłowych komunikatów RARP</span><span class="sxs-lookup"><span data-stu-id="b6d16-675">Total RARP Invalid Messages</span></span>

<span data-ttu-id="b6d16-676">Wszystkie te statystyki i raporty o błędach są dostępne dla aplikacji z usługą ***nx_rarp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-676">All these statistics and error reports are available to the application with the ***nx_rarp_info_get*** service.</span></span>

## <a name="internet-control-message-protocol-icmp"></a><span data-ttu-id="b6d16-677">Protokół ICMP (Internet Control Message Protocol)</span><span class="sxs-lookup"><span data-stu-id="b6d16-677">Internet Control Message Protocol (ICMP)</span></span>

<span data-ttu-id="b6d16-678">Protokół komunikacyjnego sterowania Internetem dla protokołu IP (ICMP) jest ograniczony do przekazywania informacji o błędach i kontroli między członkami sieci IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-678">Internet Control Message Protocol for IP (ICMP) is limited to passing error and control information between IP network members.</span></span>

<span data-ttu-id="b6d16-679">Podobnie jak w przypadku większości innych komunikatów warstwy aplikacji (np. protokołu TCP/IP), komunikaty ICMP są hermetyzowane przez nagłówek IP przy użyciu oznaczenia protokołu ICMP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-679">Like most other application layer (e.g., TCP/IP) messages, ICMP messages are encapsulated by an IP header with the ICMP protocol designation.</span></span>

### <a name="icmp-statistics-and-errors"></a><span data-ttu-id="b6d16-680">Statystyki i błędy protokołu ICMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-680">ICMP Statistics and Errors</span></span>

<span data-ttu-id="b6d16-681">Jeśli ta opcja jest włączona, NetX śledzi kilka statystyk ICMP i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-681">If enabled, NetX keeps track of several ICMP statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="b6d16-682">Następujące raporty statystyczne i komunikaty o błędach są obsługiwane dla każdego przetworzenia protokołu ICMP IP:</span><span class="sxs-lookup"><span data-stu-id="b6d16-682">The following statistics and error reports are maintained for each IP's ICMP processing:</span></span>

- <span data-ttu-id="b6d16-683">Całkowita liczba wysłanych poleceń ping protokołu ICMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-683">Total ICMP Pings Sent</span></span>
- <span data-ttu-id="b6d16-684">Łączny limit czasu polecenia ping protokołu ICMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-684">Total ICMP Ping Timeouts</span></span>
- <span data-ttu-id="b6d16-685">Całkowita liczba wstrzymanych wątków ping protokołu ICMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-685">Total ICMP Ping Threads Suspended</span></span>
- <span data-ttu-id="b6d16-686">Całkowita liczba odebranych odpowiedzi ping protokołu ICMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-686">Total ICMP Ping Responses Received</span></span>
- <span data-ttu-id="b6d16-687">Całkowita liczba błędów sumy kontrolnej protokołu ICMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-687">Total ICMP Checksum Errors</span></span>
- <span data-ttu-id="b6d16-688">Całkowita liczba nieobsłużonych komunikatów protokołu ICMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-688">Total ICMP Unhandled Messages</span></span>

<span data-ttu-id="b6d16-689">Wszystkie te statystyki i raporty o błędach są dostępne dla aplikacji z usługą ***nx_icmp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-689">All these statistics and error reports are available to the application with the ***nx_icmp_info_get*** service.</span></span>

### <a name="icmp-enable"></a><span data-ttu-id="b6d16-690">Włączanie protokołu ICMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-690">ICMP Enable</span></span>
<span data-ttu-id="b6d16-691">Przed przetworzeniem komunikatów ICMP przez NetX aplikacja musi wywołać usługę ***nx_icmp_enable*** , aby umożliwić przetwarzanie protokołu ICMP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-691">Before ICMP messages can be processed by NetX, the application must call the ***nx_icmp_enable*** service to enable ICMP processing.</span></span> <span data-ttu-id="b6d16-692">Po wykonaniu tej czynności aplikacja może wysyłać żądania ping i przychodzące pakiety ping.</span><span class="sxs-lookup"><span data-stu-id="b6d16-692">After this is done, the application can issue ping requests and field incoming ping packets.</span></span>

### <a name="icmp-echo-request"></a><span data-ttu-id="b6d16-693">Żądanie echa ICMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-693">ICMP Echo Request</span></span>
<span data-ttu-id="b6d16-694">Żądanie echa to jeden typ komunikatu ICMP, który jest zazwyczaj używany do sprawdzania istnienia określonego węzła w sieci, zgodnie z jego adresem IP hosta.</span><span class="sxs-lookup"><span data-stu-id="b6d16-694">An echo request is one type of ICMP message that is typically used to check for the existence of a specific node on the network, as identified by its host IP address.</span></span> <span data-ttu-id="b6d16-695">Popularne polecenie ping jest zaimplementowane przy użyciu komunikatów żądania echa ICMP/echo odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="b6d16-695">The popular ping command is implemented using ICMP echo request/echo reply messages.</span></span> <span data-ttu-id="b6d16-696">Jeśli określony host jest obecny, jego stos sieciowy przetwarza żądanie ping i odpowiedzi z odpowiedzią ping.</span><span class="sxs-lookup"><span data-stu-id="b6d16-696">If the specific host is present, its network stack processes the ping request and responses with a ping response.</span></span> <span data-ttu-id="b6d16-697">Rysunek 7. Szczegóły formatu wiadomości ping protokołu ICMP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-697">Figure 7 details the ICMP ping message format.</span></span>

![Komunikat ping protokołu ICMP](./media/user-guide/icmp-ping-message.png)

<span data-ttu-id="b6d16-699">**RYSUNEK 7. Komunikat ping protokołu ICMP**</span><span class="sxs-lookup"><span data-stu-id="b6d16-699">**FIGURE 7. ICMP Ping Message**</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-700">*Oczekuje się, że wszystkie komunikaty ICMP w implementacji protokołu TCP/IP będą w formacie big endian. W tym formacie najbardziej znaczący bajt słowa znajduje się na najniższym adresie bajtowym.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-700">*All ICMP messages in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="b6d16-701">W poniższej tabeli opisano format nagłówka ICMP:</span><span class="sxs-lookup"><span data-stu-id="b6d16-701">The following table describes the ICMP header format:</span></span>

| <span data-ttu-id="b6d16-702">Pole nagłówka</span><span class="sxs-lookup"><span data-stu-id="b6d16-702">Header Field</span></span>    | <span data-ttu-id="b6d16-703">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="b6d16-703">Purpose</span></span> |
|-----------------|---------------------------------------------------|
| <span data-ttu-id="b6d16-704">Typ</span><span class="sxs-lookup"><span data-stu-id="b6d16-704">Type</span></span>            | <span data-ttu-id="b6d16-705">To pole określa komunikat ICMP (BITS 31-24).</span><span class="sxs-lookup"><span data-stu-id="b6d16-705">This field specifies the ICMP message (bits 31- 24).</span></span> <span data-ttu-id="b6d16-706">Najczęstsze: 0 echo odpowiedź 8 żądanie echa</span><span class="sxs-lookup"><span data-stu-id="b6d16-706">The most common are:   0 Echo Reply   8 Echo Request</span></span> |
| <span data-ttu-id="b6d16-707">Kod</span><span class="sxs-lookup"><span data-stu-id="b6d16-707">Code</span></span>            | <span data-ttu-id="b6d16-708">To pole jest specyficzne dla kontekstu w polu Typ (bity 23-16).</span><span class="sxs-lookup"><span data-stu-id="b6d16-708">This field is context specific on the type field (bits 23-16).</span></span> <span data-ttu-id="b6d16-709">Dla żądania echa lub Odpowiedz kod jest ustawiony na zero.</span><span class="sxs-lookup"><span data-stu-id="b6d16-709">For an echo request or reply the code is set to zero.</span></span> |
| <span data-ttu-id="b6d16-710">Suma kontrolna</span><span class="sxs-lookup"><span data-stu-id="b6d16-710">Checksum</span></span>        | <span data-ttu-id="b6d16-711">To pole zawiera 16-bitową sumę kontrolną łącznej wartości tego komunikatu ICMP, w tym cały nagłówek ICMP, zaczynając od pola typ.</span><span class="sxs-lookup"><span data-stu-id="b6d16-711">This field contains the 16-bit checksum of the one's complement sum of the ICMP message including the entire the ICMP header starting with the Type field.</span></span> <span data-ttu-id="b6d16-712">Przed wygenerowaniem sumy kontrolnej, pole sumy kontrolnej jest wyczyszczone.</span><span class="sxs-lookup"><span data-stu-id="b6d16-712">Before generating the checksum, the checksum field is cleared.</span></span>                 |
| <span data-ttu-id="b6d16-713">Identyfikacja</span><span class="sxs-lookup"><span data-stu-id="b6d16-713">Identification</span></span>  | <span data-ttu-id="b6d16-714">To pole zawiera wartość identyfikatora identyfikującą hosta; Host powinien używać identyfikatora wyodrębnionego z żądania echa w odpowiedzi echa (bity 31-16).</span><span class="sxs-lookup"><span data-stu-id="b6d16-714">This field contains an ID value identifying the host; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span> |
| <span data-ttu-id="b6d16-715">Numer sekwencyjny</span><span class="sxs-lookup"><span data-stu-id="b6d16-715">Sequence number</span></span> | <span data-ttu-id="b6d16-716">To pole zawiera wartość identyfikatora; Host powinien używać identyfikatora wyodrębnionego z żądania echa w odpowiedzi echa (bity 31-16).</span><span class="sxs-lookup"><span data-stu-id="b6d16-716">This field contains an ID value; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span> <span data-ttu-id="b6d16-717">W przeciwieństwie do pola identyfikatora ta wartość zmieni się w kolejnych żądaniach ECHA z tego samego hosta (bity 15-0).</span><span class="sxs-lookup"><span data-stu-id="b6d16-717">Unlike the identifier field, this value will change in a subsequent Echo request from the same host (bits 15-0).</span></span> |


### <a name="icmp-echo-response"></a><span data-ttu-id="b6d16-718">Odpowiedź echa ICMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-718">ICMP Echo Response</span></span>
<span data-ttu-id="b6d16-719">Odpowiedź ping to inny typ komunikatu ICMP, który jest generowany wewnętrznie przez składnik ICMP w odpowiedzi na zewnętrzne żądanie ping.</span><span class="sxs-lookup"><span data-stu-id="b6d16-719">A ping response is another type of ICMP message that is generated internally by the ICMP component in response to an external ping request.</span></span> <span data-ttu-id="b6d16-720">Oprócz potwierdzenia, odpowiedź na polecenie ping zawiera również kopię danych użytkownika dostarczonych w żądaniu ping.</span><span class="sxs-lookup"><span data-stu-id="b6d16-720">In addition to acknowledgement, the ping response also contains a copy of the user data supplied in the ping request.</span></span>

## <a name="internet-group-management-protocol-igmp"></a><span data-ttu-id="b6d16-721">Protokół IGMP (Internet Group Management Protocol)</span><span class="sxs-lookup"><span data-stu-id="b6d16-721">Internet Group Management Protocol (IGMP)</span></span>

<span data-ttu-id="b6d16-722">Protokół IGMP (Internet Group Management Protocol) udostępnia urządzenie do komunikowania się z jego sąsiadami i routerami, które zamierzają odebrać lub dołączyć do grupy multiemisji IP (RFC 1112 i RFC 2236).</span><span class="sxs-lookup"><span data-stu-id="b6d16-722">The Internet Group Management Protocol (IGMP) provides a device to communicate with its neighbors and its routers that it intends to receive, or join, an IP multicast group (RFC 1112 and RFC 2236).</span></span> <span data-ttu-id="b6d16-723">Grupa multiemisji jest zasadniczo dynamicznym zbiorem elementów członkowskich sieci i jest reprezentowana przez adres IP klasy D.</span><span class="sxs-lookup"><span data-stu-id="b6d16-723">A multicast group is basically a dynamic collection of network members and is represented by a Class D IP address.</span></span> <span data-ttu-id="b6d16-724">Członkowie grupy multiemisji mogą opuścić w dowolnym momencie, a nowi członkowie mogą dołączyć w dowolnym momencie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-724">Members of the multicast group may leave at any time, and new members may join at any time.</span></span> <span data-ttu-id="b6d16-725">Koordynacja związana z przyłączaniem i opuszczeniem grupy jest odpowiedzialna za IGMP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-725">The coordination involved in joining and leaving the group is the responsibility of IGMP.</span></span>

### <a name="igmp-enable"></a><span data-ttu-id="b6d16-726">Włączanie IGMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-726">IGMP Enable</span></span>

<span data-ttu-id="b6d16-727">Przed rozpoczęciem dowolnego działania multiemisji w NetX, aplikacja musi wywoływać usługę ***nx_igmp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-727">Before any multicasting activity can take place in NetX, the application must call the ***nx_igmp_enable*** service.</span></span> <span data-ttu-id="b6d16-728">Ta usługa wykonuje podstawowe inicjowanie protokołu IGMP w przygotowaniu do obsługi żądań multiemisji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-728">This service performs basic IGMP initialization in preparation for multicast requests.</span></span>

### <a name="multicast-ip-addressing"></a><span data-ttu-id="b6d16-729">Adresowanie IP multiemisji</span><span class="sxs-lookup"><span data-stu-id="b6d16-729">Multicast IP Addressing</span></span>

<span data-ttu-id="b6d16-730">Jak wspomniano wcześniej, adresy multiemisji w rzeczywistości są adresami IP klasy D, jak pokazano na rysunku 4 na stronie 58.</span><span class="sxs-lookup"><span data-stu-id="b6d16-730">As mentioned previously, multicast addresses are actually Class D IP addresses as shown in Figure 4 on page 58.</span></span> <span data-ttu-id="b6d16-731">Mniejsze 28 bitów adresu klasy D odpowiada IDENTYFIKATORowi grupy multiemisji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-731">The lower 28-bits of the Class D address correspond to the multicast group ID.</span></span> <span data-ttu-id="b6d16-732">Istnieje szereg wstępnie zdefiniowanych adresów multiemisji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-732">There are a series of pre-defined multicast addresses.</span></span> <span data-ttu-id="b6d16-733">Jednak *adres wszystkich hostów* (244.0.0.1) jest szczególnie istotny dla przetwarzania IGMP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-733">However, the *all hosts address* (244.0.0.1) is particularly important to IGMP processing.</span></span> <span data-ttu-id="b6d16-734">*Adres wszystkie hosty* jest używany przez routery do wysyłania zapytań do wszystkich elementów członkowskich multiemisji w celu raportowania, do których grup multiemisji należą.</span><span class="sxs-lookup"><span data-stu-id="b6d16-734">The *all hosts address* is used by routers to query all multicast members to report on which multicast groups they belong to.</span></span>

### <a name="physical-address-mapping-in-ip"></a><span data-ttu-id="b6d16-735">Mapowanie adresów fizycznych w adresie IP</span><span class="sxs-lookup"><span data-stu-id="b6d16-735">Physical Address Mapping in IP</span></span>

<span data-ttu-id="b6d16-736">Adresy multiemisji klasy D mapują bezpośrednio do fizycznych adresów Ethernet od 01.00.5 e. 00.00.00 do 01.00.5 e. 7F. FF. FF.</span><span class="sxs-lookup"><span data-stu-id="b6d16-736">Class D multicast addresses map directly to physical Ethernet addresses ranging from 01.00.5e.00.00.00 through 01.00.5e.7f.ff.ff.</span></span> <span data-ttu-id="b6d16-737">Mniejsze 23 bity adresu multiemisji IP są mapowane bezpośrednio do mniejszej liczby 23 bitów adresu Ethernet.</span><span class="sxs-lookup"><span data-stu-id="b6d16-737">The lower 23 bits of the IP multicast address map directly to the lower 23 bits of the Ethernet address.</span></span>

### <a name="multicast-group-join"></a><span data-ttu-id="b6d16-738">Przyłączanie do grupy multiemisji</span><span class="sxs-lookup"><span data-stu-id="b6d16-738">Multicast Group Join</span></span>

<span data-ttu-id="b6d16-739">Aplikacje, które muszą przyłączyć się do konkretnej grupy multiemisji, mogą to zrobić, wywołując usługę ***nx_igmp_multicast_join*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-739">Applications that need to join a particular multicast group may do so by calling the ***nx_igmp_multicast_join*** service.</span></span> <span data-ttu-id="b6d16-740">Ta usługa śledzi liczbę żądań dołączenia do tej grupy multiemisji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-740">This service keeps track of the number of requests to join this multicast group.</span></span> <span data-ttu-id="b6d16-741">Jeśli jest to pierwsze żądanie aplikacji do dołączenia do grupy multiemisji, raport IGMP jest wysyłany w sieci podstawowej wskazującej zamiar tego hosta do przyłączenia do grupy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-741">If this is the first application request to join the multicast group, an IGMP report is sent out on the primary network indicating this host's intention to join the group.</span></span> <span data-ttu-id="b6d16-742">Następnie sterownik sieciowy jest wywoływany w celu skonfigurowania nasłuchiwania pakietów z adresem Ethernet dla tej grupy multiemisji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-742">Next, the network driver is called to set up for listening for packets with the Ethernet address for this multicast group.</span></span>

<span data-ttu-id="b6d16-743">W systemie wielodostępnym, jeśli grupa multiemisji jest dostępna za pośrednictwem określonego interfejsu, aplikacja użyje ***nx_igmp_multicast_interface_join*** usługi zamiast \***nx_igmp_multicast_join**, \* który jest ograniczony do grup multiemisji w sieci podstawowej.</span><span class="sxs-lookup"><span data-stu-id="b6d16-743">In a multihome system, if the multicast group is accessible via a specific interface, application shall use the service ***nx_igmp_multicast_interface_join*** instead of \***nx_igmp_multicast_join**,\* which is limited to multicast groups on the primary network.</span></span>

### <a name="multicast-group-leave"></a><span data-ttu-id="b6d16-744">Opuszczenie grupy multiemisji</span><span class="sxs-lookup"><span data-stu-id="b6d16-744">Multicast Group Leave</span></span>

<span data-ttu-id="b6d16-745">Aplikacje, które muszą opuścić wcześniej dołączoną grupę multiemisji, mogą to zrobić, wywołując usługę ***nx_igmp_multicast_leave*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-745">Applications that need to leave a previously joined multicast group may do so by calling the ***nx_igmp_multicast_leave*** service.</span></span> <span data-ttu-id="b6d16-746">Ta usługa zmniejsza liczbę wewnętrzną skojarzoną z tym, ile razy Grupa została przyłączona.</span><span class="sxs-lookup"><span data-stu-id="b6d16-746">This service reduces the internal count associated with how many times the group was joined.</span></span> <span data-ttu-id="b6d16-747">Jeśli nie ma żadnych oczekujących żądań dołączenia do grupy, Sterownik sieciowy jest wywoływany, aby wyłączyć nasłuchiwanie pakietów z adresem Ethernet tego grupy multiemisji</span><span class="sxs-lookup"><span data-stu-id="b6d16-747">If there are no outstanding join requests for a group, the network driver is called to disable listening for packets with this multicast group's Ethernet address</span></span>

### <a name="multicast-loopback"></a><span data-ttu-id="b6d16-748">Sprzężenie zwrotne multiemisji</span><span class="sxs-lookup"><span data-stu-id="b6d16-748">Multicast Loopback</span></span>

<span data-ttu-id="b6d16-749">Aplikacja może chcieć odebrać ruch multiemisji pochodzący z jednego ze źródeł w tym samym węźle.</span><span class="sxs-lookup"><span data-stu-id="b6d16-749">An application may wish to receive multicast traffic originated from one of the sources on the same node.</span></span> <span data-ttu-id="b6d16-750">Wymaga to, aby składnik multiemisji protokołu IP miał włączoną funkcję sprzężenia zwrotnego przy użyciu ***nx_igmp_loopback_enable*** usługi.</span><span class="sxs-lookup"><span data-stu-id="b6d16-750">This requires the IP multicast component to have loopback enabled by using the service ***nx_igmp_loopback_enable***.</span></span>

### <a name="igmp-report-message"></a><span data-ttu-id="b6d16-751">Komunikat raportu IGMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-751">IGMP Report Message</span></span>

<span data-ttu-id="b6d16-752">Gdy aplikacja jest dołączana do grupy multiemisji, komunikat raportu IGMP jest wysyłany za pośrednictwem sieci, aby wskazać zamiar hosta do przyłączenia do określonej grupy multiemisji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-752">When the application joins a multicast group, an IGMP report message is sent via the network to indicate the host's intention to join a particular multicast group.</span></span> <span data-ttu-id="b6d16-753">Format komunikatu IGMP jest przedstawiony na rysunku 8.</span><span class="sxs-lookup"><span data-stu-id="b6d16-753">The format of the IGMP report message is shown in Figure 8.</span></span> <span data-ttu-id="b6d16-754">Adres grupy multiemisji jest używany zarówno w komunikacie grupy w komunikacie z raportem IGMP, jak i docelowym adresie IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-754">The multicast group address is used for both the group message in the IGMP report message and the destination IP address.</span></span>

![Komunikat raportu IGMP](./media/user-guide/igmp-report-message.png)

<span data-ttu-id="b6d16-756">**RYSUNEK 8. Komunikat raportu IGMP**</span><span class="sxs-lookup"><span data-stu-id="b6d16-756">**FIGURE 8. IGMP Report Message**</span></span>

<span data-ttu-id="b6d16-757">Na powyższym rysunku (rysunek 8) nagłówek IGMP zawiera pole Version/Type, maksymalny czas odpowiedzi, pole sumy kontrolnej i pole adres grupy multiemisji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-757">In the figure above (Figure 8), the IGMP header contains a version/type field, maximum response time, a checksum field, and a multicast group address field.</span></span> <span data-ttu-id="b6d16-758">W przypadku komunikatów IGMPv1 wartość pola Maksymalny czas odpowiedzi jest zawsze równa zero, ponieważ nie jest to część protokołu IGMPv1.</span><span class="sxs-lookup"><span data-stu-id="b6d16-758">For IGMPv1 messages, the Maximum Response Time field is always set to zero, as this is not part of the IGMPv1 protocol.</span></span> <span data-ttu-id="b6d16-759">Pole Maksymalny czas odpowiedzi jest ustawiane, gdy host odbierze komunikat IGMP i wyczyszczony, gdy host odbierze komunikat typu raport innego hosta określony przez protokół IGMPv2.</span><span class="sxs-lookup"><span data-stu-id="b6d16-759">The Maximum Response Time field is set when the host receives a Query type IGMP message and cleared when a host receives another host's Report type message as defined by the IGMPv2 protocol.</span></span>

<span data-ttu-id="b6d16-760">Poniżej opisano format nagłówka IGMP:</span><span class="sxs-lookup"><span data-stu-id="b6d16-760">The following describes the IGMP header format:</span></span>

| <span data-ttu-id="b6d16-761">**Pole nagłówka**</span><span class="sxs-lookup"><span data-stu-id="b6d16-761">**Header Field**</span></span>          | <span data-ttu-id="b6d16-762">**Cel**</span><span class="sxs-lookup"><span data-stu-id="b6d16-762">**Purpose**</span></span> |
|-----------------------|--------------------------------------------------------------------|
| <span data-ttu-id="b6d16-763">Wersja</span><span class="sxs-lookup"><span data-stu-id="b6d16-763">Version</span></span>               | <span data-ttu-id="b6d16-764">To pole określa wersję protokołu IGMP (BITS 31-28).</span><span class="sxs-lookup"><span data-stu-id="b6d16-764">This field specifies the IGMP version (bits 31- 28).</span></span>                                                                               |
| <span data-ttu-id="b6d16-765">Typ</span><span class="sxs-lookup"><span data-stu-id="b6d16-765">Type</span></span>                  | <span data-ttu-id="b6d16-766">To pole określa typ komunikatu IGMP (bity 27 -24).</span><span class="sxs-lookup"><span data-stu-id="b6d16-766">This field specifies the type of IGMP message (bits 27 -24).</span></span>                                                                       |
| <span data-ttu-id="b6d16-767">Maksymalny czas odpowiedzi</span><span class="sxs-lookup"><span data-stu-id="b6d16-767">Maximum Response Time</span></span> | <span data-ttu-id="b6d16-768">Nieużywane w IGMPv1.</span><span class="sxs-lookup"><span data-stu-id="b6d16-768">Not used in IGMPv1.</span></span> <span data-ttu-id="b6d16-769">W IGMPv2 to pole służy jako maksymalny czas odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="b6d16-769">In IGMPv2 this field serves as the maximum response time.</span></span>                                                      |
| <span data-ttu-id="b6d16-770">Suma kontrolna</span><span class="sxs-lookup"><span data-stu-id="b6d16-770">Checksum</span></span>              | <span data-ttu-id="b6d16-771">To pole zawiera 16-bitową sumę kontrolną podsumowania dla komunikatu IGMP rozpoczynającego się od wersji IGMP (bity 0-15).</span><span class="sxs-lookup"><span data-stu-id="b6d16-771">This field contains the 16-bit checksum of the one's complement sum of the IGMP message starting with the IGMP version (bits 0-15)</span></span> |
| <span data-ttu-id="b6d16-772">Adres grupy</span><span class="sxs-lookup"><span data-stu-id="b6d16-772">Group Address</span></span>         | <span data-ttu-id="b6d16-773">32-bitowy adres IP grupy klasy D</span><span class="sxs-lookup"><span data-stu-id="b6d16-773">32-bit class D group IP address</span></span> |


<span data-ttu-id="b6d16-774">Komunikaty raportów IGMP są również wysyłane w odpowiedzi na komunikaty zapytania IGMP wysyłane przez router multiemisji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-774">IGMP report messages are also sent in response to IGMP query messages sent by a multicast router.</span></span> <span data-ttu-id="b6d16-775">Routery multiemisji okresowo wysyłają komunikaty zapytania, aby zobaczyć, które hosty nadal wymagają członkostwa w grupie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-775">Multicast routers periodically send query messages out to see which hosts still require group membership.</span></span> <span data-ttu-id="b6d16-776">Komunikaty zapytania mają taki sam format, jak komunikat raportu IGMP przedstawiony na rysunku 8.</span><span class="sxs-lookup"><span data-stu-id="b6d16-776">Query messages have the same format as the IGMP Report message shown in Figure 8.</span></span> <span data-ttu-id="b6d16-777">Jedyną różnicą jest to, że typ IGMP jest równy 1, a pole adres grupy jest ustawione na 0.</span><span class="sxs-lookup"><span data-stu-id="b6d16-777">The only differences are the IGMP type is equal to 1 and the group address field is set to 0.</span></span> <span data-ttu-id="b6d16-778">Komunikaty protokołu IGMP są wysyłane do adresu IP *wszystkie hosty* przez router multiemisji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-778">IGMP Query messages are sent to the *all hosts* IP address by the multicast router.</span></span> <span data-ttu-id="b6d16-779">Host, który nadal chce zachować członkostwo w grupie odpowiada, wysyłając inny komunikat raportu IGMP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-779">A host that still wishes to maintain group membership responds by sending another IGMP Report message.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-780">*Oczekuje się, że wszystkie komunikaty w implementacji protokołu TCP/IP będą w formacie **big endian** . W tym formacie najbardziej znaczący bajt słowa znajduje się na najniższym adresie bajtowym.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-780">*All messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="igmp-statistics-and-errors"></a><span data-ttu-id="b6d16-781">Statystyka i błędy IGMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-781">IGMP Statistics and Errors</span></span>

<span data-ttu-id="b6d16-782">Jeśli ta opcja jest włączona, oprogramowanie NetX IGMP śledzi kilka statystyk i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-782">If enabled, the NetX IGMP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="b6d16-783">Następujące raporty statystyczne i błędy są obsługiwane dla każdego przetwarzania IGMP IP:</span><span class="sxs-lookup"><span data-stu-id="b6d16-783">The following statistics and error reports are maintained for each IP's IGMP processing:</span></span>

- <span data-ttu-id="b6d16-784">Całkowita liczba wysłanych raportów IGMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-784">Total IGMP Reports Sent</span></span>
- <span data-ttu-id="b6d16-785">Całkowita liczba odebranych zapytań IGMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-785">Total IGMP Queries Received</span></span>
- <span data-ttu-id="b6d16-786">Łączna liczba błędów sum kontrolnych IGMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-786">Total IGMP Checksum Errors</span></span>
- <span data-ttu-id="b6d16-787">Łączna liczba przyłączonych bieżących grup protokołu IGMP</span><span class="sxs-lookup"><span data-stu-id="b6d16-787">Total IGMP Current Groups Joined</span></span>

<span data-ttu-id="b6d16-788">Wszystkie te statystyki i raporty o błędach są dostępne dla aplikacji z usługą ***nx_igmp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-788">All these statistics and error reports are available to the application with the ***nx_igmp_info_get*** service.</span></span>

## <a name="user-datagram-protocol-udp"></a><span data-ttu-id="b6d16-789">User Datagram Protocol (UDP)</span><span class="sxs-lookup"><span data-stu-id="b6d16-789">User Datagram Protocol (UDP)</span></span>

<span data-ttu-id="b6d16-790">Protokół UDP (User Datagram Protocol) zapewnia najprostszą formę transferu danych między elementami członkowskimi sieci (RFC 768).</span><span class="sxs-lookup"><span data-stu-id="b6d16-790">The User Datagram Protocol (UDP) provides the simplest form of data transfer between network members (RFC 768).</span></span> <span data-ttu-id="b6d16-791">Pakiety danych UDP są wysyłane z jednego członka sieci do innego w najlepszym wysiłku. oznacza to, że nie ma wbudowanego mechanizmu potwierdzania przez odbiorcę pakietu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-791">UDP data packets are sent from one network member to another in a best effort fashion; i.e., there is no built-in mechanism for acknowledgement by the packet recipient.</span></span> <span data-ttu-id="b6d16-792">Ponadto wysyłanie pakietu UDP nie wymaga wcześniejszego nawiązania połączenia.</span><span class="sxs-lookup"><span data-stu-id="b6d16-792">In addition, sending a UDP packet does not require any connection to be established in advance.</span></span> <span data-ttu-id="b6d16-793">Z tego powodu transmisja pakietów UDP jest bardzo wydajna.</span><span class="sxs-lookup"><span data-stu-id="b6d16-793">Because of this, UDP packet transmission is very efficient.</span></span>

### <a name="udp-header"></a><span data-ttu-id="b6d16-794">Nagłówek UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-794">UDP Header</span></span>
<span data-ttu-id="b6d16-795">Protokół UDP umieszcza prosty nagłówek pakietu przed danymi aplikacji podczas transmisji i usuwa podobny nagłówek UDP z pakietu przy odbiorze przed dostarczeniem odebranego pakietu UDP do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-795">UDP places a simple packet header in front of the application's data on transmission, and removes a similar UDP header from the packet on reception before delivering a received UDP packet to the application.</span></span> <span data-ttu-id="b6d16-796">Protokół UDP korzysta z protokołu IP do wysyłania i otrzymywania pakietów, co oznacza, że na początku nagłówka UDP znajduje się nagłówek IP, gdy pakiet znajduje się w sieci.</span><span class="sxs-lookup"><span data-stu-id="b6d16-796">UDP utilizes the IP protocol for sending and receiving packets, which means there is an IP header in front of the UDP header when the packet is on the network.</span></span> <span data-ttu-id="b6d16-797">Rysunek 9 przedstawia format nagłówka UDP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-797">Figure 9 shows the format of the UDP header.</span></span>

![Nagłówek UDP](./media/user-guide/udp-header.png)

<span data-ttu-id="b6d16-799">**RYSUNEK 9. Nagłówek UDP**</span><span class="sxs-lookup"><span data-stu-id="b6d16-799">**FIGURE 9. UDP Header**</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-800">*Oczekuje się, że wszystkie nagłówki w implementacji protokołu UDP/IP mają być w formacie big endian. W tym formacie najbardziej znaczący bajt słowa znajduje się na najniższym adresie bajtowym.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-800">*All headers in the UDP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="b6d16-801">Poniżej opisano format nagłówka UDP:</span><span class="sxs-lookup"><span data-stu-id="b6d16-801">The following describes the UDP header format:</span></span>

| <span data-ttu-id="b6d16-802">Pole nagłówka</span><span class="sxs-lookup"><span data-stu-id="b6d16-802">Header Field</span></span>                   | <span data-ttu-id="b6d16-803">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="b6d16-803">Purpose</span></span> |
|--------------------------------|---------------------------------------------|
| <span data-ttu-id="b6d16-804">16-bitowy numer portu źródłowego</span><span class="sxs-lookup"><span data-stu-id="b6d16-804">16-bit source port number</span></span>      | <span data-ttu-id="b6d16-805">To pole zawiera port, z którego jest wysyłany pakiet UDP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-805">This field contains the port on which the UDP packet is being sent from.</span></span> <span data-ttu-id="b6d16-806">Prawidłowe porty UDP mieszczą się w zakresie od 1 do 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="b6d16-806">Valid UDP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="b6d16-807">16-bitowy numer portu docelowego</span><span class="sxs-lookup"><span data-stu-id="b6d16-807">16-bit destination port number</span></span> | <span data-ttu-id="b6d16-808">To pole zawiera port UDP, do którego jest wysyłany pakiet.</span><span class="sxs-lookup"><span data-stu-id="b6d16-808">This field contains the UDP port to which the packet is being sent to.</span></span> <span data-ttu-id="b6d16-809">Prawidłowe porty UDP mieszczą się w zakresie od 1 do 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="b6d16-809">Valid UDP ports range from 1 through 0xFFFF.</span></span>   |
| <span data-ttu-id="b6d16-810">16-bitowa długość protokołu UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-810">16-bit UDP length</span></span>   | <span data-ttu-id="b6d16-811">To pole zawiera liczbę bajtów w pakiecie UDP, w tym rozmiar nagłówka UDP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-811">This field contains the number of bytes in the UDP packet, including the size of the UDP header.</span></span>                                  |
| <span data-ttu-id="b6d16-812">16-bitowa suma kontrolna UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-812">16-bit UDP checksum</span></span> | <span data-ttu-id="b6d16-813">To pole zawiera 16-bitową sumę kontrolną pakietu, w tym nagłówek UDP, obszar danych pakietu i nagłówek pseudo IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-813">This field contains the 16-bit checksum for the packet, including the UDP header, the packet data area, and the pseudo IP header.</span></span> |

### <a name="udp-enable"></a><span data-ttu-id="b6d16-814">Włączanie protokołu UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-814">UDP Enable</span></span>

<span data-ttu-id="b6d16-815">Przed przekazaniem pakietów UDP aplikacja musi najpierw włączyć protokół UDP, wywołując usługę ***nx_udp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-815">Before UDP packet transmission is possible, the application must first enable UDP by calling the ***nx_udp_enable*** service.</span></span> <span data-ttu-id="b6d16-816">Po włączeniu aplikacja jest bezpłatna do wysyłania i odbierania pakietów UDP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-816">After enabled, the application is free to send and receive UDP packets.</span></span>

### <a name="udp-socket-create"></a><span data-ttu-id="b6d16-817">Tworzenie gniazda UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-817">UDP Socket Create</span></span>

<span data-ttu-id="b6d16-818">Gniazda UDP są tworzone podczas inicjowania lub podczas wykonywania przez wątki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-818">UDP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="b6d16-819">Początkowy typ usługi, czas wygaśnięcia i głębokość kolejki odbierania są zdefiniowane przez usługę ***nx_udp_socket_create*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-819">The initial type of service, time to live, and receive queue depth are defined by the ***nx_udp_socket_create*** service.</span></span> <span data-ttu-id="b6d16-820">Liczba gniazd UDP w aplikacji nie jest ograniczona.</span><span class="sxs-lookup"><span data-stu-id="b6d16-820">There are no limits on the number of UDP sockets in an application.</span></span>

### <a name="udp-checksum"></a><span data-ttu-id="b6d16-821">Suma kontrolna UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-821">UDP Checksum</span></span>

<span data-ttu-id="b6d16-822">Protokół UDP określa 16-bitową sumę kontrolną, która pokrywa się z pseudo nagłówka adresu IP (składa się ze źródłowego adresu IP, docelowego adresu IP oraz słowa protokołu IP o długości), nagłówka UDP i danych pakietów UDP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-822">UDP specifies a one's complement 16-bit checksum that covers the IP pseudo header (consisting of the source IP address, destination IP address, and the protocol/length IP word), the UDP header, and the UDP packet data.</span></span> <span data-ttu-id="b6d16-823">Jeśli obliczona suma kontrolna UDP to 0, jest ona przechowywana jako wszystkie (0xFFFF).</span><span class="sxs-lookup"><span data-stu-id="b6d16-823">If the calculated UDP checksum is 0, it is stored as all ones (0xFFFF).</span></span> <span data-ttu-id="b6d16-824">Jeśli gniazdo wysyłania ma wyłączoną logikę sumy kontrolnej UDP, wartość zero jest umieszczana w polu sumy kontrolnej UDP, aby wskazać, że suma kontrolna nie została obliczona.</span><span class="sxs-lookup"><span data-stu-id="b6d16-824">If the sending socket has the UDP checksum logic disabled, a zero is placed in the UDP checksum field to indicate the checksum was not calculated.</span></span> <span data-ttu-id="b6d16-825">Jeśli suma kontrolna UDP nie jest zgodna z obliczoną sumą kontrolną przez odbiorcę, pakiet UDP jest po prostu odrzucony.</span><span class="sxs-lookup"><span data-stu-id="b6d16-825">If the UDP checksum does not match the computed checksum by the receiver, the UDP packet is simply discarded.</span></span>

<span data-ttu-id="b6d16-826">W sieci IP suma kontrolna UDP jest opcjonalna.</span><span class="sxs-lookup"><span data-stu-id="b6d16-826">On the IP network, UDP checksum is optional.</span></span> <span data-ttu-id="b6d16-827">NetX umożliwia aplikacji Włączanie lub wyłączanie obliczeń sum kontrolnych UDP na podstawie gniazda.</span><span class="sxs-lookup"><span data-stu-id="b6d16-827">NetX allows an application to enable or disable UDP checksum calculation on a per-socket basis.</span></span> <span data-ttu-id="b6d16-828">Domyślnie logika sumy kontrolnej gniazda UDP jest włączona.</span><span class="sxs-lookup"><span data-stu-id="b6d16-828">By default, the UDP socket checksum logic is enabled.</span></span> <span data-ttu-id="b6d16-829">Aplikacja może wyłączyć logikę sumy kontrolnej dla określonego gniazda UDP przez wywołanie usługi ***nx_udp_socket_checksum_disable*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-829">The application can disable checksum logic for a particular UDP socket by calling the ***nx_udp_socket_checksum_disable*** service.</span></span>

<span data-ttu-id="b6d16-830">Niektóre kontrolery Ethernet mogą generować sumę kontrolną UDP na bieżąco.</span><span class="sxs-lookup"><span data-stu-id="b6d16-830">Certain Ethernet controllers are able to generate the UDP checksum on the fly.</span></span> <span data-ttu-id="b6d16-831">Jeśli system może korzystać z funkcji obliczeń sum kontrolnych sprzętowych, biblioteka NetX może być skompilowana bez logiki sumy kontrolnej.</span><span class="sxs-lookup"><span data-stu-id="b6d16-831">If the system is able to use hardware checksum computation feature, the NetX library can be built without the checksum logic.</span></span> <span data-ttu-id="b6d16-832">Aby wyłączyć sumę kontrolną oprogramowania UDP, biblioteka NetX musi być skompilowana z następującymi zdefiniowanymi symbolami: ***NX_DISABLE_UDP_TX_CHECKSUM*** i \***NX_DISABLE_UDP_RX_CHECKSUM **_ (opisane w [rozdziale 2](chapter2.md)). Opcje konfiguracji usuwają logikę sum kontrolnych UDP ze NetX całkowicie, podczas gdy wywołanie _* nx_udp_socket_checksum_disable*** pozwala aplikacji wyłączyć przetwarzanie sum kontrolnych protokołu IP protokołu UDP dla każdego gniazda.</span><span class="sxs-lookup"><span data-stu-id="b6d16-832">To disable UDP software checksum, the NetX library must be built with the following symbols defined: ***NX_DISABLE_UDP_TX_CHECKSUM*** and ***NX_DISABLE_UDP_RX_CHECKSUM\*\*_ (described in [Chapter 2](chapter2.md)). The configuration options remove UDP checksum logic from NetX entirely, while calling the _* nx_udp_socket_checksum_disable**\* service allows the application to disable IP UDP checksum processing on a per socket basis.</span></span>

### <a name="udp-ports-and-binding"></a><span data-ttu-id="b6d16-833">Porty i powiązania UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-833">UDP Ports and Binding</span></span>

<span data-ttu-id="b6d16-834">Port UDP jest logicznym punktem końcowym protokołu UDP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-834">A UDP port is a logical end point in the UDP protocol.</span></span> <span data-ttu-id="b6d16-835">Istnieje 65 535 prawidłowych portów w składniku UDP NetX z zakresu od 1 do 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="b6d16-835">There are 65,535 valid ports in the UDP component of NetX, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="b6d16-836">Aby wysłać lub odebrać dane UDP, aplikacja musi najpierw utworzyć gniazdo UDP, a następnie powiązać ją z żądanym portem.</span><span class="sxs-lookup"><span data-stu-id="b6d16-836">To send or receive UDP data, the application must first create a UDP socket, then bind it to a desired port.</span></span> <span data-ttu-id="b6d16-837">Po powiązaniu gniazda UDP z portem aplikacja może wysyłać i odbierać dane w tym gnieździe.</span><span class="sxs-lookup"><span data-stu-id="b6d16-837">After binding a UDP socket to a port, the application may send and receive data on that socket.</span></span>

### <a name="udp-fast-pathtrade"></a><span data-ttu-id="b6d16-838">Szybka ścieżka UDP&trade;</span><span class="sxs-lookup"><span data-stu-id="b6d16-838">UDP Fast Path&trade;</span></span>

<span data-ttu-id="b6d16-839">Szybka ścieżka UDP &trade; to nazwa małej ścieżki narzutu na pakiety przez implementację protokołu UDP NetX.</span><span class="sxs-lookup"><span data-stu-id="b6d16-839">The UDP Fast Path&trade; is the name for a low packet overhead path through the NetX UDP implementation.</span></span> <span data-ttu-id="b6d16-840">Wysyłanie pakietu UDP wymaga tylko kilku wywołań funkcji: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_ i ostatecznego wywołania sterownika sieci.</span><span class="sxs-lookup"><span data-stu-id="b6d16-840">Sending a UDP packet requires just a few function calls: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_, and the eventual call to the network driver.</span></span> <span data-ttu-id="b6d16-841">_*_nx_udp_socket_send_*_ jest dostępny w NetX dla istniejących aplikacji NetX i ma zastosowanie tylko do pakietów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-841">_*_nx_udp_socket_send_*_ is available in NetX for existing NetX applications and is only applicable for IP packets.</span></span> <span data-ttu-id="b6d16-842">Preferowaną metodą jest jednak użycie _ *_nx_udp_socket_send_*\* usługi omówionej poniżej.</span><span class="sxs-lookup"><span data-stu-id="b6d16-842">The preferred method, however, is to use _ *_nx_udp_socket_send_*\* service discussed below.</span></span> <span data-ttu-id="b6d16-843">W przypadku odbierania pakietów UDP pakiet UDP jest umieszczany w odpowiedniej kolejce odbioru gniazda UDP lub dostarczany do zawieszonego wątku aplikacji w ramach pojedynczego wywołania funkcji z przetwarzania przerwań odbieranych przez sterownik sieciowy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-843">On UDP packet reception, the UDP packet is either placed on the appropriate UDP socket receive queue or delivered to a suspended application thread in a single function call from the network driver's receive interrupt processing.</span></span> <span data-ttu-id="b6d16-844">Ta wysoce zoptymalizowana logika do wysyłania i otrzymywania pakietów UDP jest istotą technologii szybkiego ścieżki UDP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-844">This highly optimized logic for sending and receiving UDP packets is the essence of UDP Fast Path technology.</span></span>

### <a name="udp-packet-send"></a><span data-ttu-id="b6d16-845">Wysyłanie pakietów UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-845">UDP Packet Send</span></span>

<span data-ttu-id="b6d16-846">Wysyłanie danych UDP za pośrednictwem sieci IP jest łatwo realizowane przez wywołanie funkcji \***nx_udp_socket_send** _.</span><span class="sxs-lookup"><span data-stu-id="b6d16-846">Sending UDP data over IP networks is easily accomplished by calling the \***nx_udp_socket_send** _ function.</span></span> <span data-ttu-id="b6d16-847">Obiekt wywołujący musi ustawić wersję protokołu IP w polu _IP Address \*.</span><span class="sxs-lookup"><span data-stu-id="b6d16-847">The caller must set the IP version in the _IP address\* field.</span></span> <span data-ttu-id="b6d16-848">NetX określi najlepszy adres źródłowy przesyłanych pakietów UDP na podstawie docelowego adresu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-848">NetX will determine the best source address for transmitted UDP packets based on the destination IP address.</span></span> <span data-ttu-id="b6d16-849">Ta usługa umieszcza nagłówek UDP przed danymi pakietu i wysyła je do sieci przy użyciu procedury wysyłania wewnętrznego adresu IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-849">This service places a UDP header in front of the packet data and sends it out onto the network using an internal IP send routine.</span></span> <span data-ttu-id="b6d16-850">Nie ma zawieszania wątku podczas wysyłania pakietów UDP, ponieważ wszystkie transporty pakietów UDP są przetwarzane natychmiast.</span><span class="sxs-lookup"><span data-stu-id="b6d16-850">There is no thread suspension on sending UDP packets because all UDP packet transmissions are processed immediately.</span></span>

<span data-ttu-id="b6d16-851">W przypadku docelowych multiemisji lub emisji aplikacja powinna określić źródłowy adres IP, który ma być używany, jeśli urządzenie NetX ma wiele adresów IP do wyboru.</span><span class="sxs-lookup"><span data-stu-id="b6d16-851">For multicast or broadcast destinations, the application should specify the source IP address to use if the NetX device has multiple IP addresses to choose from.</span></span> <span data-ttu-id="b6d16-852">Można to zrobić za pomocą usług ***nx_udp_socket_interface_send.***</span><span class="sxs-lookup"><span data-stu-id="b6d16-852">This can be done with the services ***nx_udp_socket_interface_send.***</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-853">*Jeśli **nx_udp_socket_send** jest używany do przesyłania pakietów multiemisji lub emisji, adres IP pierwszego interfejsu jest używany jako adres źródłowy.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-853">*If **nx_udp_socket_send** is used for transmitting multicast or broadcast packets, the IP address of the first interface is used as source address.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-854">*Jeśli dla tego gniazda jest włączona logika sumy kontrolnej UDP, operacja sumy kontrolnej jest wykonywana w kontekście wątku wywołującego bez blokowania dostępu do struktur danych protokołu UDP lub IP.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-854">*If UDP checksum logic is enabled for this socket, the checksum operation is performed in the context of the calling thread, without blocking access to the UDP or IP data structures.*</span></span>

> [!NOTE]
> <span data-ttu-id="b6d16-855">*Dane ładunku UDP znajdujące się w strukturze **NX_PACKET** powinny znajdować się na granicy długiego wyrazu. Aplikacja musi pozostawić wystarczającą ilość miejsca między wskaźnikiem dołączania i wskaźnikiem początkowym danych dla NetX, aby umieścić nagłówki UDP, IP i nośnika fizycznego.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-855">*The UDP payload data residing in the **NX_PACKET** structure should reside on a long-word boundary. The application needs to leave sufficient space between the prepend pointer and the data start pointer for NetX to place the UDP, IP, and physical media headers.*</span></span>

### <a name="udp-packet-receive"></a><span data-ttu-id="b6d16-856">Odbieranie pakietów UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-856">UDP Packet Receive</span></span>

<span data-ttu-id="b6d16-857">Wątki aplikacji mogą odbierać pakiety UDP z określonego gniazda przez wywołanie ***nx_udp_socket_receive***.</span><span class="sxs-lookup"><span data-stu-id="b6d16-857">Application threads may receive UDP packets from a particular socket by calling ***nx_udp_socket_receive***.</span></span> <span data-ttu-id="b6d16-858">Funkcja odbioru gniazda udostępnia najstarszy pakiet w kolejce odbioru gniazda.</span><span class="sxs-lookup"><span data-stu-id="b6d16-858">The socket receive function delivers the oldest packet on the socket's receive queue.</span></span> <span data-ttu-id="b6d16-859">Jeśli w kolejce odbierania nie ma pakietów, wątek wywołujący może zawiesić (z opcjonalnym limitem czasu) do momentu otrzymania pakietu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-859">If there are no packets on the receive queue, the calling thread can suspend (with an optional timeout) until a packet arrives.</span></span>

<span data-ttu-id="b6d16-860">Przetwarzanie pakietów protokołu UDP odbierane (zwykle wywoływane z procedury obsługi przerwania odbierania przez sterownik sieciowy) jest odpowiedzialne za umieszczenie pakietu w kolejce odbioru gniazda UDP lub dostarczenie go do pierwszego wstrzymanego wątku oczekującego na pakiet.</span><span class="sxs-lookup"><span data-stu-id="b6d16-860">The UDP receive packet processing (usually called from the network driver's receive interrupt handler) is responsible for either placing the packet on the UDP socket's receive queue or delivering it to the first suspended thread waiting for a packet.</span></span> <span data-ttu-id="b6d16-861">Jeśli pakiet jest umieszczany w kolejce, przetwarzanie odbiera również sprawdza maksymalną głębokość kolejki odbierania skojarzoną z gniazdem.</span><span class="sxs-lookup"><span data-stu-id="b6d16-861">If the packet is queued, the receive processing also checks the maximum receive queue depth associated with the socket.</span></span> <span data-ttu-id="b6d16-862">Jeśli ten nowo umieszczony w kolejce pakiet przekracza głębokość kolejki, najstarszy pakiet w kolejce zostanie odrzucony.</span><span class="sxs-lookup"><span data-stu-id="b6d16-862">If this newly queued packet exceeds the queue depth, the oldest packet in the queue is discarded.</span></span>

### <a name="udp-receive-notify"></a><span data-ttu-id="b6d16-863">Powiadomienie o odebraniu protokołu UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-863">UDP Receive Notify</span></span>

<span data-ttu-id="b6d16-864">Jeśli wątek aplikacji musi przetwarzać odebrane dane z więcej niż jednego gniazda, należy użyć funkcji ***nx_udp_socket_receive_notify*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-864">If the application thread needs to process received data from more than one socket, the ***nx_udp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="b6d16-865">Ta funkcja rejestruje funkcję odbierania pakietów wywołania zwrotnego dla gniazda.</span><span class="sxs-lookup"><span data-stu-id="b6d16-865">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="b6d16-866">Za każdym razem, gdy pakiet jest odbierany w gnieździe, funkcja wywołania zwrotnego jest wykonywana.</span><span class="sxs-lookup"><span data-stu-id="b6d16-866">Whenever a packet is received on the socket, the callback function is executed.</span></span>

<span data-ttu-id="b6d16-867">Zawartość funkcji wywołania zwrotnego jest specyficzna dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-867">The contents of the callback function is application-specific.</span></span> <span data-ttu-id="b6d16-868">Jednak najprawdopodobniej zawiera logikę do informowania wątku przetwarzania, że pakiet jest teraz dostępny w odpowiednim gnieździe.</span><span class="sxs-lookup"><span data-stu-id="b6d16-868">However, it would most likely contain logic to inform the processing thread that a packet is now available on the corresponding socket.</span></span>

### <a name="peer-address-and-port"></a><span data-ttu-id="b6d16-869">Adres i port elementu równorzędnego</span><span class="sxs-lookup"><span data-stu-id="b6d16-869">Peer Address and Port</span></span>

<span data-ttu-id="b6d16-870">W przypadku odebrania pakietu UDP aplikacja może znaleźć adres IP i numer portu nadawcy przy użyciu ***nx_udp_packet_info_extract*** usługi.</span><span class="sxs-lookup"><span data-stu-id="b6d16-870">On receiving a UDP packet, application may find the sender's IP address and port number by using the service ***nx_udp_packet_info_extract***.</span></span> <span data-ttu-id="b6d16-871">Po pomyślnym powrocie usługa ta udostępnia informacje o adresie IP nadawcy, numerze portu nadawcy i interfejsie lokalnym, za pomocą którego został odebrany pakiet.</span><span class="sxs-lookup"><span data-stu-id="b6d16-871">On successful return, this service provides information on the sender's IP address, sender's port number, and the local interface through which the packet was received.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="b6d16-872">Zawieszenie wątku</span><span class="sxs-lookup"><span data-stu-id="b6d16-872">Thread Suspension</span></span>

<span data-ttu-id="b6d16-873">Jak wspomniano wcześniej, wątki aplikacji mogą wstrzymywać się podczas próby odebrania pakietu UDP na określonym porcie UDP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-873">As mentioned previously, application threads can suspend while attempting to receive a UDP packet on a particular UDP port.</span></span> <span data-ttu-id="b6d16-874">Po odebraniu pakietu na tym porcie jest on przyznany do pierwszego wątku, a następnie wznowiony.</span><span class="sxs-lookup"><span data-stu-id="b6d16-874">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="b6d16-875">Opcjonalny limit czasu jest dostępny w przypadku zawieszania pakietu odbioru protokołu UDP, który jest funkcją dostępną dla większości usług NetX.</span><span class="sxs-lookup"><span data-stu-id="b6d16-875">An optional timeout is available when suspending on a UDP receive packet, a feature available for most NetX services.</span></span>

### <a name="udp-socket-statistics-and-errors"></a><span data-ttu-id="b6d16-876">Statystyka i błędy gniazda UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-876">UDP Socket Statistics and Errors</span></span>

<span data-ttu-id="b6d16-877">Jeśli to ustawienie jest włączone, oprogramowanie NetX UDP śledzi kilka statystyk i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-877">If enabled, the NetX UDP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="b6d16-878">Dla każdego wystąpienia protokołu IP/UDP są obsługiwane następujące raporty statystyczne i błędy:</span><span class="sxs-lookup"><span data-stu-id="b6d16-878">The following statistics and error reports are maintained for each IP/UDP instance:</span></span>

- <span data-ttu-id="b6d16-879">Całkowita liczba wysłanych pakietów UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-879">Total UDP Packets Sent</span></span>
- <span data-ttu-id="b6d16-880">Całkowita liczba wysłanych bajtów UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-880">Total UDP Bytes Sent</span></span>
- <span data-ttu-id="b6d16-881">Całkowita liczba odebranych pakietów UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-881">Total UDP Packets Received</span></span>
- <span data-ttu-id="b6d16-882">Całkowita liczba odebranych bajtów UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-882">Total UDP Bytes Received</span></span>
- <span data-ttu-id="b6d16-883">Całkowita liczba nieprawidłowych pakietów UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-883">Total UDP Invalid Packets</span></span>
- <span data-ttu-id="b6d16-884">Całkowita liczba porzuconych pakietów odbioru protokołu UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-884">Total UDP Receive Packets Dropped</span></span>
- <span data-ttu-id="b6d16-885">Łączne błędy sum kontrolnych odbierania UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-885">Total UDP Receive Checksum Errors</span></span>
- <span data-ttu-id="b6d16-886">Wysłane pakiety gniazd UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-886">UDP Socket Packets Sent</span></span>
- <span data-ttu-id="b6d16-887">Wysłane bajty gniazda UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-887">UDP Socket Bytes Sent</span></span>
- <span data-ttu-id="b6d16-888">Odebrane pakiety UDP Socket</span><span class="sxs-lookup"><span data-stu-id="b6d16-888">UDP Socket Packets Received</span></span>
- <span data-ttu-id="b6d16-889">Odebrane bajty gniazda UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-889">UDP Socket Bytes Received</span></span>
- <span data-ttu-id="b6d16-890">Pakiety gniazd UDP w kolejce</span><span class="sxs-lookup"><span data-stu-id="b6d16-890">UDP Socket Packets Queued</span></span>
- <span data-ttu-id="b6d16-891">Odebrane pakiety UDP w gnieździe</span><span class="sxs-lookup"><span data-stu-id="b6d16-891">UDP Socket Receive Packets Dropped</span></span>
- <span data-ttu-id="b6d16-892">Błędy sum kontrolnych gniazda UDP</span><span class="sxs-lookup"><span data-stu-id="b6d16-892">UDP Socket Checksum Errors</span></span>

<span data-ttu-id="b6d16-893">Wszystkie te statystyki i raporty o błędach są dostępne dla aplikacji z usługą ***nx_udp_info_get*** dla statystyk UDP amassed przez wszystkie gniazda UDP i usługę ***NX_UDP_SOCKET_INFO_GET*** dla statystyk UDP w określonym gnieździe UDP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-893">All these statistics and error reports are available to the application with the ***nx_udp_info_get*** service for UDP statistics amassed over all UDP sockets, and the ***nx_udp_socket_info_get*** service for UDP statistics on the specified UDP socket.</span></span>

### <a name="udp-socket-control-block-nx_udp_socket"></a><span data-ttu-id="b6d16-894">Blok sterowania gniazdem UDP NX_UDP_SOCKET</span><span class="sxs-lookup"><span data-stu-id="b6d16-894">UDP Socket Control Block NX_UDP_SOCKET</span></span>

<span data-ttu-id="b6d16-895">Cechy poszczególnych gniazd UDP są dostępne w skojarzonym bloku sterowania **NX_UDP_SOCKET** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-895">The characteristics of each UDP socket are found in the associated **NX_UDP_SOCKET** control block.</span></span> <span data-ttu-id="b6d16-896">Zawiera użyteczne informacje, takie jak link do struktury danych IP, interfejs sieciowy dla ścieżki wysyłania i odbierania, port powiązany i kolejka odbierania pakietów.</span><span class="sxs-lookup"><span data-stu-id="b6d16-896">It contains useful information such as the link to the IP data structure, the network interface for the sending and receiving paths, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="b6d16-897">Ta struktura jest zdefiniowana w pliku **_nx_api. h_** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-897">This structure is defined in the **_nx_api.h_** file.</span></span>

## <a name="transmission-control-protocol-tcp"></a><span data-ttu-id="b6d16-898">Transmission Control Protocol (TCP)</span><span class="sxs-lookup"><span data-stu-id="b6d16-898">Transmission Control Protocol (TCP)</span></span>

<span data-ttu-id="b6d16-899">Transmission Control Protocol (TCP) zapewnia niezawodny transfer danych przesyłanych strumieniowo między dwoma członkami sieci (RFC 793).</span><span class="sxs-lookup"><span data-stu-id="b6d16-899">The Transmission Control Protocol (TCP) provides reliable stream data transfer between two network members (RFC 793).</span></span> <span data-ttu-id="b6d16-900">Wszystkie dane wysyłane z jednego członka sieci są weryfikowane i potwierdzane przez element członkowski odbiorcy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-900">All data sent from one network member are verified and acknowledged by the receiving member.</span></span> <span data-ttu-id="b6d16-901">Ponadto dwóch członków musi nawiązać połączenie przed jakimkolwiek transferem danych.</span><span class="sxs-lookup"><span data-stu-id="b6d16-901">In addition, the two members must have established a connection prior to any data transfer.</span></span> <span data-ttu-id="b6d16-902">Wszystkie te wyniki są niezawodnym transferem danych; jednak wymaga to znacznie więcej obciążenia niż poprzednio opisany w tym transfer danych UDP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-902">All this results in reliable data transfer; however, it does require substantially more overhead than the previously described UDP data transfer.</span></span>

### <a name="tcp-header"></a><span data-ttu-id="b6d16-903">Nagłówek TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-903">TCP Header</span></span>

<span data-ttu-id="b6d16-904">W przypadku przesyłania nagłówek TCP jest umieszczany przed danymi od użytkownika.</span><span class="sxs-lookup"><span data-stu-id="b6d16-904">On transmission, TCP header is placed in front of the data from the user.</span></span> <span data-ttu-id="b6d16-905">Przy odbiorze nagłówek TCP zostaje usunięty z przychodzącego pakietu, pozostawiając tylko te dane użytkownika, które są dostępne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-905">On reception, TCP header is removed from the incoming packet, leaving only the user data available to the application.</span></span> <span data-ttu-id="b6d16-906">Protokół TCP korzysta z protokołu IP do wysyłania i odbierania pakietów, co oznacza, że na początku nagłówka TCP znajduje się nagłówek IP, gdy pakiet znajduje się w sieci.</span><span class="sxs-lookup"><span data-stu-id="b6d16-906">TCP utilizes the IP protocol to send and receive packets, which means there is an IP header in front of the TCP header when the packet is on the network.</span></span> <span data-ttu-id="b6d16-907">Rysunek 10 przedstawia format nagłówka TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-907">Figure 10 shows the format of the TCP header.</span></span>

![Nagłówek TCP](./media/user-guide/tcp-header.png)

<span data-ttu-id="b6d16-909">**RYSUNEK 10. Nagłówek TCP**</span><span class="sxs-lookup"><span data-stu-id="b6d16-909">**FIGURE 10. TCP Header**</span></span>

<span data-ttu-id="b6d16-910">Poniżej opisano format nagłówka TCP:</span><span class="sxs-lookup"><span data-stu-id="b6d16-910">The following describes the TCP header format:</span></span>

| <span data-ttu-id="b6d16-911">Pole nagłówka</span><span class="sxs-lookup"><span data-stu-id="b6d16-911">Header Field</span></span> | <span data-ttu-id="b6d16-912">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="b6d16-912">Purpose</span></span> |
|---|---|
| <span data-ttu-id="b6d16-913">16-bitowy numer portu źródłowego</span><span class="sxs-lookup"><span data-stu-id="b6d16-913">16-bit source port number</span></span> | <span data-ttu-id="b6d16-914">To pole zawiera port, na którym jest wysyłany pakiet TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-914">This field contains the port the TCP packet is being sent out on.</span></span> <span data-ttu-id="b6d16-915">Prawidłowe porty TCP mieszczą się w zakresie od 1 do 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="b6d16-915">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="b6d16-916">16-bitowy numer portu docelowego</span><span class="sxs-lookup"><span data-stu-id="b6d16-916">16-bit destination port number</span></span> | <span data-ttu-id="b6d16-917">To pole zawiera port TCP, na który jest wysyłany pakiet.</span><span class="sxs-lookup"><span data-stu-id="b6d16-917">This field contains the TCP port the packet is being sent to.</span></span> <span data-ttu-id="b6d16-918">Prawidłowe porty TCP mieszczą się w zakresie od 1 do 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="b6d16-918">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="b6d16-919">32-bitowy numer sekwencji</span><span class="sxs-lookup"><span data-stu-id="b6d16-919">32-bit sequence number</span></span> | <span data-ttu-id="b6d16-920">To pole zawiera numer sekwencyjny dla danych wysyłanych z tego końca połączenia.</span><span class="sxs-lookup"><span data-stu-id="b6d16-920">This field contains the sequence number for data sent from this end of the connection.</span></span> <span data-ttu-id="b6d16-921">Oryginalna sekwencja jest określana podczas początkowej sekwencji połączeń między dwoma węzłami TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-921">The original sequence is established during the initial connection sequence between two TCP nodes.</span></span> <span data-ttu-id="b6d16-922">Każdy transfer danych od tego momentu powoduje zwiększenie liczby sekwencji o ilość wysłanych bajtów.</span><span class="sxs-lookup"><span data-stu-id="b6d16-922">Every data transfer from that point results in an increment of the sequence number by the amount bytes sent.</span></span> |
| <span data-ttu-id="b6d16-923">32-bitowy numer potwierdzenia</span><span class="sxs-lookup"><span data-stu-id="b6d16-923">32-bit acknowledgement number</span></span> | <span data-ttu-id="b6d16-924">To pole zawiera numer sekwencyjny odpowiadający ostatniemu bajtowi odebranemu po tej stronie połączenia.</span><span class="sxs-lookup"><span data-stu-id="b6d16-924">This field contains the sequence number corresponding to the last byte received by this side of the connection.</span></span> <span data-ttu-id="b6d16-925">Służy do określenia, czy dane wysłane wcześniej zostały pomyślnie odebrane przez inne zakończenie połączenia.</span><span class="sxs-lookup"><span data-stu-id="b6d16-925">This is used to determine whether or not data previously sent has successfully been received by the other end of the connection.</span></span> |
| <span data-ttu-id="b6d16-926">4-bitowa Długość nagłówka</span><span class="sxs-lookup"><span data-stu-id="b6d16-926">4-bit header length</span></span>           | <span data-ttu-id="b6d16-927">To pole zawiera liczbę 32-bitowych wyrazów w nagłówku TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-927">This field contains the number of 32-bit words in the TCP header.</span></span> <span data-ttu-id="b6d16-928">Jeśli w nagłówku TCP nie ma żadnych opcji, to pole ma wartość 5.</span><span class="sxs-lookup"><span data-stu-id="b6d16-928">If no options are present in the TCP header, this field is 5.</span></span> |
| <span data-ttu-id="b6d16-929">6-bitowe bity kodu</span><span class="sxs-lookup"><span data-stu-id="b6d16-929">6-bit code bits</span></span>               | <span data-ttu-id="b6d16-930">To pole zawiera sześć różnych bitów kodu używanych do wskazywania różnych informacji o kontroli skojarzonych z połączeniem.</span><span class="sxs-lookup"><span data-stu-id="b6d16-930">This field contains the six different code bits used to indicate various control information associated with the connection.</span></span> <span data-ttu-id="b6d16-931">Bity sterujące są zdefiniowane w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="b6d16-931">The control bits are defined as follows:</span></span> |



| <span data-ttu-id="b6d16-932">Nazwa</span><span class="sxs-lookup"><span data-stu-id="b6d16-932">Name</span></span> | <span data-ttu-id="b6d16-933">Bit</span><span class="sxs-lookup"><span data-stu-id="b6d16-933">Bit</span></span> | <span data-ttu-id="b6d16-934">Znaczenie</span><span class="sxs-lookup"><span data-stu-id="b6d16-934">Meaning</span></span>                                                     |
|------|-----|-------------------------------------------------------------|
| <span data-ttu-id="b6d16-935">URG</span><span class="sxs-lookup"><span data-stu-id="b6d16-935">URG</span></span>  | <span data-ttu-id="b6d16-936">21</span><span class="sxs-lookup"><span data-stu-id="b6d16-936">21</span></span>  | <span data-ttu-id="b6d16-937">Pilne dane obecne</span><span class="sxs-lookup"><span data-stu-id="b6d16-937">Urgent data present</span></span>                                         |
| <span data-ttu-id="b6d16-938">KOMUNIKATY</span><span class="sxs-lookup"><span data-stu-id="b6d16-938">ACK</span></span>  | <span data-ttu-id="b6d16-939">20</span><span class="sxs-lookup"><span data-stu-id="b6d16-939">20</span></span>  | <span data-ttu-id="b6d16-940">Numer potwierdzenia jest prawidłowy</span><span class="sxs-lookup"><span data-stu-id="b6d16-940">Acknowledgement number is valid</span></span>                             |
| <span data-ttu-id="b6d16-941">PSH —</span><span class="sxs-lookup"><span data-stu-id="b6d16-941">PSH</span></span>  | <span data-ttu-id="b6d16-942">19</span><span class="sxs-lookup"><span data-stu-id="b6d16-942">19</span></span>  | <span data-ttu-id="b6d16-943">Natychmiast Obsługuj te dane</span><span class="sxs-lookup"><span data-stu-id="b6d16-943">Handle this data immediately</span></span>                                |
| <span data-ttu-id="b6d16-944">RST</span><span class="sxs-lookup"><span data-stu-id="b6d16-944">RST</span></span>  | <span data-ttu-id="b6d16-945">18</span><span class="sxs-lookup"><span data-stu-id="b6d16-945">18</span></span>  | <span data-ttu-id="b6d16-946">Zresetuj połączenie</span><span class="sxs-lookup"><span data-stu-id="b6d16-946">Reset the connection</span></span>                                        |
| <span data-ttu-id="b6d16-947">SYN</span><span class="sxs-lookup"><span data-stu-id="b6d16-947">SYN</span></span>  | <span data-ttu-id="b6d16-948">17</span><span class="sxs-lookup"><span data-stu-id="b6d16-948">17</span></span>  | <span data-ttu-id="b6d16-949">Synchronizuj numery sekwencji (używane do nawiązania połączenia)</span><span class="sxs-lookup"><span data-stu-id="b6d16-949">Synchronize sequence numbers (used to establish connection)</span></span> |
| <span data-ttu-id="b6d16-950">FIN</span><span class="sxs-lookup"><span data-stu-id="b6d16-950">FIN</span></span>  | <span data-ttu-id="b6d16-951">16</span><span class="sxs-lookup"><span data-stu-id="b6d16-951">16</span></span>  | <span data-ttu-id="b6d16-952">Nadawca zakończył wysyłanie (używane do zamknięcia połączenia)</span><span class="sxs-lookup"><span data-stu-id="b6d16-952">Sender is finished with transmit (used to close connection)</span></span> |

<span data-ttu-id="b6d16-953">**okno 16-bitowe**</span><span class="sxs-lookup"><span data-stu-id="b6d16-953">**16-bit window**</span></span>

<span data-ttu-id="b6d16-954">To pole jest używane do sterowania przepływem.</span><span class="sxs-lookup"><span data-stu-id="b6d16-954">This field is used for flow control.</span></span> <span data-ttu-id="b6d16-955">Zawiera ilość bajtów, które gniazdo może obecnie odbierać.</span><span class="sxs-lookup"><span data-stu-id="b6d16-955">It contains the amount of bytes the socket can currently receive.</span></span> <span data-ttu-id="b6d16-956">Ta w istocie jest używana do sterowania przepływem.</span><span class="sxs-lookup"><span data-stu-id="b6d16-956">This basically is used for flow control.</span></span> <span data-ttu-id="b6d16-957">Nadawca jest odpowiedzialny za upewnienie się, że dane do wysłania mieszczą się w oknie anonsowanym odbiorcy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-957">The sender is responsible for making sure the data to send will fit into the receiver’s advertised window.</span></span>

| <span data-ttu-id="b6d16-958">**Pole nagłówka**</span><span class="sxs-lookup"><span data-stu-id="b6d16-958">**Header Field**</span></span>          | <span data-ttu-id="b6d16-959">**Cel**</span><span class="sxs-lookup"><span data-stu-id="b6d16-959">**Purpose**</span></span> |
| ------------------------- | --- |
| <span data-ttu-id="b6d16-960">**16-bitowa suma kontrolna TCP**</span><span class="sxs-lookup"><span data-stu-id="b6d16-960">**16-bit TCP checksum**</span></span>   | <span data-ttu-id="b6d16-961">To pole zawiera 16-bitową sumę kontrolną pakietu, w tym nagłówek TCP, obszar danych pakietu i nagłówek pseudo IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-961">This field contains the 16-bit checksum for the packet including the TCP header, the packet data area, and the pseudo IP header.</span></span>                |
| <span data-ttu-id="b6d16-962">**16-bitowy wskaźnik pilny**</span><span class="sxs-lookup"><span data-stu-id="b6d16-962">**16-bit urgent pointer**</span></span> | <span data-ttu-id="b6d16-963">To pole zawiera dodatnie przesunięcie ostatniego bajtu pilnych danych.</span><span class="sxs-lookup"><span data-stu-id="b6d16-963">This field contains the positive offset of the last byte of the urgent data.</span></span> <span data-ttu-id="b6d16-964">To pole jest prawidłowe tylko wtedy, gdy w nagłówku jest ustawiony bit kodu URG.</span><span class="sxs-lookup"><span data-stu-id="b6d16-964">This field is only valid if the URG code bit is set in the header.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="b6d16-965">*Oczekuje się, że wszystkie nagłówki w implementacji TCP/IP mają być w formacie big endian. W tym formacie najbardziej znaczący bajt słowa znajduje się na najniższym adresie bajtowym.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-965">*All headers in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="tcp-enable"></a><span data-ttu-id="b6d16-966">Włączanie protokołu TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-966">TCP Enable</span></span>

<span data-ttu-id="b6d16-967">Przed przystąpieniem do połączeń TCP i przesyłania pakietów aplikacja musi najpierw włączyć protokół TCP, wywołując usługę nx_tcp_enable.</span><span class="sxs-lookup"><span data-stu-id="b6d16-967">Before TCP connections and packet transmissions are possible, the application must first enable TCP by calling the nx_tcp_enable service.</span></span> <span data-ttu-id="b6d16-968">Po włączeniu aplikacja jest bezpłatna, aby uzyskać dostęp do wszystkich usług TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-968">After enabled, the application is free to access all TCP services.</span></span>

### <a name="tcp-socket-create"></a><span data-ttu-id="b6d16-969">Tworzenie gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-969">TCP Socket Create</span></span>

<span data-ttu-id="b6d16-970">Gniazda TCP są tworzone podczas inicjowania lub podczas wykonywania przez wątki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-970">TCP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="b6d16-971">Początkowy typ usługi, czas wygaśnięcia i rozmiar okna są zdefiniowane przez usługę ***nx_tcp_socket_create*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-971">The initial type of service, time to live, and window size are defined by the ***nx_tcp_socket_create*** service.</span></span> <span data-ttu-id="b6d16-972">W aplikacji nie ma ograniczeń dotyczących liczby gniazd TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-972">There are no limits on the number of TCP sockets in an application.</span></span>

### <a name="tcp-checksum"></a><span data-ttu-id="b6d16-973">Suma kontrolna TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-973">TCP Checksum</span></span>

<span data-ttu-id="b6d16-974">Protokół TCP określa 16-bitową sumę kontrolną, która pokrywa się z pseudo nagłówka IP (składa się ze źródłowego adresu IP, docelowego adresu IP oraz słowa IP protokołu/długości), nagłówka TCP i danych pakietu TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-974">TCP specifies a one’s complement 16-bit checksum that covers the IP pseudo header, (consisting of the source IP address, destination IP address, and the protocol/length IP word), the TCP header, and the TCP packet data.</span></span>

<span data-ttu-id="b6d16-975">Niektóre kontrolery sieci mogą wykonywać obliczenia sum kontrolnych TCP i walidację sprzętu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-975">Certain network controllers are able to perform TCP checksum computation and validation in hardware.</span></span> <span data-ttu-id="b6d16-976">W przypadku takich systemów aplikacje mogą chcieć używać logiki sum kontrolnych sprzętowych, jak to możliwe, aby zmniejszyć obciążenie środowiska uruchomieniowego.</span><span class="sxs-lookup"><span data-stu-id="b6d16-976">For such systems, applications may want to use hardware checksum logic as much as possible to reduce runtime overhead.</span></span> <span data-ttu-id="b6d16-977">Aplikacje mogą wyłączać logikę obliczeń sum kontrolnych protokołu TCP z biblioteki NetX w czasie kompilacji, definiując **NX_DISABLE_TCP_TX_CHECKSUM** i **NX_DISABLE_TCP_RX_CHECKSUM**.</span><span class="sxs-lookup"><span data-stu-id="b6d16-977">Applications may disable TCP checksum computation logic from the NetX library altogether at build time by defining **NX_DISABLE_TCP_TX_CHECKSUM** and **NX_DISABLE_TCP_RX_CHECKSUM**.</span></span> <span data-ttu-id="b6d16-978">W ten sposób kod sumy kontrolnej protokołu TCP nie jest kompilowany w.</span><span class="sxs-lookup"><span data-stu-id="b6d16-978">This way, the TCP checksum code is not compiled in.</span></span>

### <a name="tcp-port"></a><span data-ttu-id="b6d16-979">Port TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-979">TCP Port</span></span>

<span data-ttu-id="b6d16-980">Port TCP jest logicznym punktem połączenia w protokole TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-980">A TCP port is a logical connection point in the TCP protocol.</span></span> <span data-ttu-id="b6d16-981">Istnieje 65 535 prawidłowych portów w składniku TCP NetX, z zakresu od 1 do 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="b6d16-981">There are 65,535 valid ports in the TCP component of NetX, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="b6d16-982">W przeciwieństwie do protokołu UDP, w którym dane z jednego portu mogą być wysyłane do dowolnego innego portu docelowego, port TCP jest połączony z innym określonym portem TCP i tylko wtedy, gdy połączenie jest nawiązywane, może mieć miejsce transfer danych — i tylko między dwoma portami.</span><span class="sxs-lookup"><span data-stu-id="b6d16-982">Unlike UDP in which data from one port can be sent to any other destination port, a TCP port is connected to another specific TCP port, and only when this connection is established can any data transfer take place—and only between the two ports making up the connection.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-983">*Porty TCP są całkowicie niezależne od portów UDP; na przykład port UDP numer 1 nie ma powiązania z portem TCP o numerze 1.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-983">*TCP ports are completely separate from UDP ports; e.g., UDP port number 1 has no relation to TCP port number 1.*</span></span>

## <a name="client-server-model"></a><span data-ttu-id="b6d16-984">Model Client-Server</span><span class="sxs-lookup"><span data-stu-id="b6d16-984">Client-Server Model</span></span>

<span data-ttu-id="b6d16-985">Aby można było korzystać z protokołu TCP na potrzeby transferu danych, należy najpierw nawiązać połączenie między dwoma gniazdami TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-985">To use TCP for data transfer, a connection must first be established between the two TCP sockets.</span></span> <span data-ttu-id="b6d16-986">Ustanowienie połączenia odbywa się na serwerze klienta.</span><span class="sxs-lookup"><span data-stu-id="b6d16-986">The establishment of the connection is done in a client-server fashion.</span></span> <span data-ttu-id="b6d16-987">Po stronie klienta połączenia znajduje się Strona, która inicjuje połączenie, a po stronie serwera po prostu czeka na żądania połączenia klienta przed ukończeniem przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="b6d16-987">The client side of the connection is the side that initiates the connection, while the server side simply waits for client connection requests before any processing is done.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-988">*W przypadku urządzeń z wieloma domem NetX automatycznie określa adres źródłowy do użycia w połączeniu, a adres następnego przeskoku na podstawie docelowego adresu IP połączenia.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-988">*For multihome devices, NetX automatically determines the source address to use for the connection, and the next hop address based on the destination IP address of the connection.*</span></span>

### <a name="tcp-socket-state-machine"></a><span data-ttu-id="b6d16-989">Komputer stanu gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-989">TCP Socket State Machine</span></span>

<span data-ttu-id="b6d16-990">Połączenie między dwoma gniazdami TCP (jeden klient i jeden serwer) jest złożone i jest zarządzane w sposób komputerowy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-990">The connection between two TCP sockets (one client and one server) is complex and is managed in a state machine manner.</span></span> <span data-ttu-id="b6d16-991">Każde gniazdo TCP zostanie uruchomione w stanie ZAMKNIĘTYm.</span><span class="sxs-lookup"><span data-stu-id="b6d16-991">Each TCP socket starts in a CLOSED state.</span></span> <span data-ttu-id="b6d16-992">Za pośrednictwem zdarzeń połączeń każda maszyna stanu gniazda jest migrowana w stan USTANOWIONy, który jest miejscem, w którym odbywa się zbiorczo transfer danych w protokole TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-992">Through connection events each socket's state machine migrates into the ESTABLISHED state, which is where the bulk of the data transfer in TCP takes place.</span></span> <span data-ttu-id="b6d16-993">Gdy jedna strona połączenia nie chce już wysyłać danych, zostanie odłączona.</span><span class="sxs-lookup"><span data-stu-id="b6d16-993">When one side of the connection no longer wishes to send data, it disconnects.</span></span> <span data-ttu-id="b6d16-994">Po rozłączeniu z drugą stroną, gdy gniazdo TCP powróci do stanu ZAMKNIĘTEgo.</span><span class="sxs-lookup"><span data-stu-id="b6d16-994">After the other side disconnects, eventually the TCP socket returns to the CLOSED state.</span></span> <span data-ttu-id="b6d16-995">Ten proces jest powtarzany za każdym razem, gdy klient i serwer TCP nawiązują połączenie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-995">This process repeats each time a TCP client and server establish and close a connection.</span></span> <span data-ttu-id="b6d16-996">Rysunek 11 przedstawia różne stany komputera stanu TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-996">Figure 11 shows the various states of the TCP state machine.</span></span>

![Stany komputera stanu TCP](./media/user-guide/states-tcp-state-machine.png)

### <a name="figure-11-states-of-the-tcp-state-machine"></a><span data-ttu-id="b6d16-998">RYSUNEK 11.</span><span class="sxs-lookup"><span data-stu-id="b6d16-998">FIGURE 11.</span></span> <span data-ttu-id="b6d16-999">Stany komputera stanu TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-999">States of the TCP State Machine</span></span>

### <a name="tcp-client-connection"></a><span data-ttu-id="b6d16-1000">Połączenie klienta TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1000">TCP Client Connection</span></span>

<span data-ttu-id="b6d16-1001">Jak wspomniano wcześniej, po stronie klienta połączenia TCP zostaje zainicjowany żądanie połączenia z serwerem TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1001">As mentioned previously, the client side of the TCP connection initiates a connection request to a TCP server.</span></span> <span data-ttu-id="b6d16-1002">Aby można było wykonać żądanie połączenia, należy włączyć protokół TCP w wystąpieniu adresu IP klienta.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1002">Before a connection request can be made, TCP must be enabled on the client IP instance.</span></span> <span data-ttu-id="b6d16-1003">Ponadto należy utworzyć gniazdo TCP klienta przy użyciu usługi ***nx_tcp_socket_create** _ i powiązana z portem za pośrednictwem usługi _*_nx_tcp_client_socket_bind_\*_ .</span><span class="sxs-lookup"><span data-stu-id="b6d16-1003">In addition, the client TCP socket must next be created with the ***nx_tcp_socket_create** _ service and bound to a port via the _*_nx_tcp_client_socket_bind_\*_ service.</span></span> <span data-ttu-id="b6d16-1004">Gdy gniazdo klienta jest powiązane, usługa _ *_nx_tcp_client_socket_connect_*\* zostanie użyta do nawiązania połączenia z serwerem TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1004">After the client socket is bound, the _ *_nx_tcp_client_socket_connect_*\* service is used to establish a connection with a TCP server.</span></span> <span data-ttu-id="b6d16-1005">Należy pamiętać, że gniazdo musi być w stanie ZAMKNIĘTYm, aby można było zainicjować próbę połączenia.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1005">Note the socket must be in a CLOSED state to initiate a connection attempt.</span></span> <span data-ttu-id="b6d16-1006">Ustanowienie połączenia rozpoczyna się od NetX wystawiającego pakiet SYN, a następnie oczekiwanie na zwrotny pakiet SYN ACK z serwera, który oznacza akceptację żądania połączenia.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1006">Establishing the connection starts with NetX issuing a SYN packet and then waiting for a SYN ACK packet back from the server, which signifies acceptance of the connection request.</span></span> <span data-ttu-id="b6d16-1007">Po otrzymaniu potwierdzenia SYN NetX reaguje na pakiet ACK i promuje gniazdo klienta do stanu ustanowione.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1007">After the SYN ACK is received, NetX responds with an ACK packet and promotes the client socket to the ESTABLISHED state.</span></span>

### <a name="tcp-client-disconnection"></a><span data-ttu-id="b6d16-1008">Odłączanie klienta TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1008">TCP Client Disconnection</span></span>

<span data-ttu-id="b6d16-1009">Zamykanie połączenia odbywa się przez wywołanie ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1009">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="b6d16-1010">Jeśli nie określono zawieszenia, gniazdo klienta wysyła do gniazda serwerowego pakiet RST i umieszcza gniazdo w stanie ZAMKNIĘTYm.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1010">If no suspension is specified, the client socket sends a RST packet to the server socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="b6d16-1011">W przeciwnym razie, jeśli zażądano zawieszenia, zostaje wykonany pełny protokół Disconnect protokołu TCP w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="b6d16-1011">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows:</span></span>

- <span data-ttu-id="b6d16-1012">Jeśli serwer zainicjował wcześniej żądanie rozłączenia (gniazdo klienta już otrzymał pakiet FIN, odpowiedział na ACK i znajduje się w stanie oczekiwania na zamknięcie), NetX podwyższa stan gniazda TCP klienta do ostatniego potwierdzenia i wysyła pakiet FIN.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1012">If the server previously initiated a disconnect request (the client socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX promotes the client TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="b6d16-1013">Następnie czeka na potwierdzenie z serwera przed ukończeniem rozłączenia i przeprowadzeniem stanu ZAMKNIĘTEgo.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1013">It then waits for an ACK from the server before completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="b6d16-1014">Jeśli z drugiej strony, klient jest pierwszym zainicjowaniem żądania rozłączenia (serwer nie został odłączony, a gniazdo nadal jest w stanie), NetX wysyła pakiet FIN do zainicjowania rozłączenia i czeka na otrzymanie elementu FIN i ACK z serwera przed ukończeniem rozłączenia i umieszczenie gniazda w stanie ZAMKNIĘTYm.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1014">If on the other hand, the client is the first to initiate a disconnect request (the server has not disconnected and the socket is still in the ESTABLISHED state), NetX sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the server before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="b6d16-1015">Jeśli w kolejce transmisji gniazda nadal istnieją pakiety, NetX zawiesza się dla określonego limitu czasu, aby umożliwić potwierdzenie pakietów.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1015">If there are still packets on the socket transmit queue, NetX suspends for the specified timeout to allow the packets to be acknowledged.</span></span> <span data-ttu-id="b6d16-1016">Jeśli limit czasu wygaśnie, NetX opróżnia kolejkę transmisji gniazda klienta.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1016">If the timeout expires, NetX empties the transmit queue of the client socket.</span></span>

<span data-ttu-id="b6d16-1017">Aby usunąć powiązanie portu z gniazda klienta, aplikacja wywołuje ***nx_tcp_client_socket_unbind***.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1017">To unbind the port from the client socket, the application calls ***nx_tcp_client_socket_unbind***.</span></span> <span data-ttu-id="b6d16-1018">Gniazdo musi znajdować się w stanie ZAMKNIĘTYm lub w trakcie rozłączania (tj. czas oczekiwania na stan) przed zwolnieniem portu; w przeciwnym razie zwracany jest błąd.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1018">The socket must be in a CLOSED state or in the process of disconnecting (i.e., TIMED WAIT state) before the port is released; otherwise, an error is returned.</span></span>

<span data-ttu-id="b6d16-1019">Na koniec, jeśli aplikacja nie potrzebuje już gniazda klienta, wywołuje ***nx_tcp_socket_delete*** , aby usunąć gniazdo.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1019">Finally, if the application no longer needs the client socket, it calls ***nx_tcp_socket_delete*** to delete the socket.</span></span>

### <a name="tcp-server-connection"></a><span data-ttu-id="b6d16-1020">Połączenie z serwerem TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1020">TCP Server Connection</span></span>

<span data-ttu-id="b6d16-1021">Po stronie serwera połączenia TCP jest pasywny; oznacza to, że serwer czeka na zainicjowanie żądania połączenia przez klienta.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1021">The server side of a TCP connection is passive; i.e., the server waits for a client to initiate connection request.</span></span> <span data-ttu-id="b6d16-1022">Aby zaakceptować połączenie z klientem, należy najpierw włączyć protokół TCP w wystąpieniu adresu IP, wywołując usługę \***nx_tcp_enable** _.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1022">To accept a client connection, TCP must first be enabled on the IP instance by calling the service \***nx_tcp_enable** _.</span></span> <span data-ttu-id="b6d16-1023">Następnie aplikacja musi utworzyć gniazdo TCP przy użyciu usługi _ \*_nx_tcp_socket_create_\*\*.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1023">Next, the application must create a TCP socket using the _ *_nx_tcp_socket_create_*\* service.</span></span>

<span data-ttu-id="b6d16-1024">Należy również skonfigurować gniazdo serwera do nasłuchiwania żądań połączeń.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1024">The server socket must also be set up for listening for connection requests.</span></span> <span data-ttu-id="b6d16-1025">Jest to realizowane za pomocą usługi ***nx_tcp_server_socket_listen*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-1025">This is achieved by using the ***nx_tcp_server_socket_listen*** service.</span></span> <span data-ttu-id="b6d16-1026">Ta usługa umieszcza gniazdo serwera w stanie nasłuchiwania i wiąże określony port serwera z gniazdem.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1026">This service places the server socket in the LISTEN state and binds the specified server port to the socket.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-1027">*Aby ustawić procedurę wywołania zwrotnego gniazda Socket, aplikacja określa odpowiednią funkcję wywołania zwrotnego dla tcp_listen_callback argumentu usługi **nx_tcp_server_socket_listen** . Ta funkcja wywołania zwrotnego aplikacji jest następnie wykonywana przez NetX za każdym razem, gdy na tym porcie serwera zostanie żądane nowe połączenie. Przetwarzanie w wywołaniu zwrotnym jest pod kontrolą aplikacji.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-1027">*To set a socket listen callback routine the application specifies the appropriate callback function for the tcp_listen_callback argument of the **nx_tcp_server_socket_listen** service. This application callback function is then executed by NetX whenever a new connection is requested on this server port. The processing in the callback is under application control.*</span></span>

<span data-ttu-id="b6d16-1028">Aby akceptować żądania połączenia klienta, aplikacja wywołuje usługę \***nx_tcp_server_socket_accept** _.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1028">To accept client connection requests, the application calls the \***nx_tcp_server_socket_accept** _ service.</span></span> <span data-ttu-id="b6d16-1029">Gniazdo serwera musi znajdować się w stanie nasłuchiwania lub zostać ODEBRANe (tj. serwer jest w stanie nasłuchiwania i odebrał pakiet SYN z klienta wysyłającego żądanie połączenia) w celu wywołania usługi Accept.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1029">The server socket must either be in a LISTEN state or a SYN RECEIVED state (i.e., the server is in the LISTEN state and has received a SYN packet from a client requesting a connection) to call the accept service.</span></span> <span data-ttu-id="b6d16-1030">Pomyślne zwrócenie stanu z _ *_nx_tcp_server_socket_accept_*\* wskazuje, że połączenie zostało skonfigurowane i że gniazdo serwera jest w stanie nawiązane.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1030">A successful return status from _ *_nx_tcp_server_socket_accept_*\* indicates the connection has been set up and the server socket is in the ESTABLISHED state.</span></span>

<span data-ttu-id="b6d16-1031">Gdy gniazdo serwera ma prawidłowe połączenie, dodatkowe żądania połączenia klientów są umieszczane w kolejce do głębokości określonej przez *listen_queue_size*, przekazaną do usługi \***nx_tcp_server_socket_listen** _.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1031">After the server socket has a valid connection, additional client connection requests are queued up to the depth specified by the *listen_queue_size*, passed into the \***nx_tcp_server_socket_listen** _ service.</span></span> <span data-ttu-id="b6d16-1032">W celu przetworzenia kolejnych połączeń na porcie serwera aplikacja musi wywołać _ *_nx_tcp_server_socket_relisten_*\* z dostępnym gniazdem (tj. gniazdem w stanie zamkniętym).</span><span class="sxs-lookup"><span data-stu-id="b6d16-1032">In order to process subsequent connections on a server port, the application must call _ *_nx_tcp_server_socket_relisten_*\* with an available socket (i.e., a socket in a CLOSED state).</span></span> <span data-ttu-id="b6d16-1033">Należy pamiętać, że tego samego gniazda serwerowego można użyć, jeśli poprzednie połączenie skojarzone z gniazdem zostanie zakończone, a gniazdo jest w stanie ZAMKNIĘTYm.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1033">Note that the same server socket could be used if the previous connection associated with the socket is now finished and the socket is in the CLOSED state.</span></span>

### <a name="tcp-server-disconnection"></a><span data-ttu-id="b6d16-1034">Odłączanie serwera TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1034">TCP Server Disconnection</span></span>

<span data-ttu-id="b6d16-1035">Zamykanie połączenia odbywa się przez wywołanie ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1035">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="b6d16-1036">Jeśli nie określono zawieszenia, gniazdo serwera wysyła do gniazda klienta parametr RST i umieszcza gniazdo w stanie ZAMKNIĘTYm.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1036">If no suspension is specified, the server socket sends a RST packet to the client socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="b6d16-1037">W przeciwnym razie, jeśli zażądano zawieszenia, zostaje wykonany pełny protokół Disconnect protokołu TCP w następujący sposób: |</span><span class="sxs-lookup"><span data-stu-id="b6d16-1037">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows: |</span></span>

- <span data-ttu-id="b6d16-1038">Jeśli klient zainicjował wcześniej żądanie rozłączenia (gniazdo serwera już odebrał pakiet FIN, odpowiedział na ACK i znajduje się w stanie oczekiwania na zamknięcie), NetX podwyższa stan gniazda TCP do ostatniego potwierdzenia i wysyła pakiet FIN.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1038">If the client previously initiated a disconnect request (the server socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX promotes the TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="b6d16-1039">Następnie czeka na potwierdzenie z klienta przed ukończeniem rozłączenia i przeprowadzeniem stanu ZAMKNIĘTEgo.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1039">It then waits for an ACK from the client before completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="b6d16-1040">Jeśli z drugiej strony, serwer jest pierwszym zainicjowaniem żądania rozłączenia (klient nie został odłączony, a gniazdo nadal jest w stanie), NetX wysyła pakiet FIN do zainicjowania rozłączenia i czeka na odebranie noty i potwierdzenie od klienta przed ukończeniem odłączenia i umieszczenie gniazda w stanie ZAMKNIĘTYm.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1040">If on the other hand, the server is the first to initiate a disconnect request (the client has not disconnected and the socket is still in the ESTABLISHED state), NetX sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the client before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="b6d16-1041">Jeśli w kolejce transmisji gniazda nadal istnieją pakiety, NetX zawiesza się dla określonego limitu czasu, aby umożliwić potwierdzenie tych pakietów.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1041">If there are still packets on the socket transmit queue, NetX suspends for the specified timeout to allow those packets to be acknowledged.</span></span> <span data-ttu-id="b6d16-1042">Jeśli limit czasu wygaśnie, NetX opróżnia kolejkę transmisji w gnieździe serwera.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1042">If the timeout expires, NetX flushes the transmit queue of the server socket.</span></span>

<span data-ttu-id="b6d16-1043">Po zakończeniu przetwarzania rozłączenia, gdy gniazdo serwera jest w stanie ZAMKNIĘTYm, aplikacja musi wywoływać usługę ***nx_tcp_server_socket_unaccept*** , aby zakończyć skojarzenie tego gniazda z portem serwera.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1043">After the disconnect processing is complete and the server socket is in the CLOSED state, the application must call the ***nx_tcp_server_socket_unaccept*** service to end the association of this socket with the server port.</span></span> <span data-ttu-id="b6d16-1044">Należy pamiętać, że ta usługa musi być wywoływana przez aplikację, nawet jeśli ***nx_tcp_socket_disconnect*** lub \***nx_tcp_server_socket_accept** _ zwróci stan błędu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1044">Note this service must be called by the application even if ***nx_tcp_socket_disconnect*** or \***nx_tcp_server_socket_accept** _ return an error status.</span></span> <span data-ttu-id="b6d16-1045">Po powrocie _ *_nx_tcp_server_socket_unaccept_*\* gniazdo może być używane jako gniazdo klienta lub serwera, a nawet usunięte, jeśli nie jest już potrzebne.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1045">After the _ *_nx_tcp_server_socket_unaccept_*\* returns, the socket can be used as a client or server socket, or even deleted if it is no longer needed.</span></span> <span data-ttu-id="b6d16-1046">Jeśli pożądane jest zaakceptowanie innego połączenia klienta na tym samym porcie serwera, usługa ***nx_tcp_server_socket_relisten*** powinna być wywoływana w tym gnieździe.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1046">If accepting another client connection on the same server port is desired, the ***nx_tcp_server_socket_relisten*** service should be called on this socket.</span></span>

<span data-ttu-id="b6d16-1047">Poniższy segment kodu ilustruje sekwencję wywołań typowego serwera TCP używa:</span><span class="sxs-lookup"><span data-stu-id="b6d16-1047">The following code segment illustrates the sequence of calls a typical TCP server uses:</span></span>

```c
/* Set up a previously created TCP socket to listen on port 12 */

nx_tcp_server_socket_listen()

/* Loop to make a (another) connection. */
while(1) {

    /* Wait for a client socket connection request for 100 ticks. */
    nx_tcp_server_socket_accept();

    /* (Send and receive TCP messages with the TCP client) */

    /* Disconnect the server socket. */
    nx_tcp_socket_disconnect();

    /* Remove this server socket from listening on the port. */

    nx_tcp_server_socket_unaccept(&server_socket);

    /* Set up server socket to relisten on the same port for the next
    client. */
    nx_tcp_server_socket_relisten();
}
```

### <a name="mss-validation"></a><span data-ttu-id="b6d16-1048">Sprawdzanie poprawności</span><span class="sxs-lookup"><span data-stu-id="b6d16-1048">MSS Validation</span></span>

<span data-ttu-id="b6d16-1049">Maksymalny rozmiar segmentu (Maximum) to maksymalna ilość bajtów odbieranych przez hosta TCP bez fragmentacji przez podstawową warstwę adresów IP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1049">The Maximum Segment Size (MSS) is the maximum amount of bytes a TCP host can receive without being fragmented by the underlying IP layer.</span></span> <span data-ttu-id="b6d16-1050">Podczas fazy ustanowienia połączenia TCP oba punkty końcowe wymieniają własną wartość TCP, tak że nadawca nie wyśle segmentu danych TCP, który jest większy niż rozmiar tego odbiorcy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1050">During TCP connection establishment phase, both ends exchanges its own TCP MSS value, so that the sender does not send a TCP data segment that is larger than the receiver's MSS.</span></span> <span data-ttu-id="b6d16-1051">Moduł TCP NetX będzie opcjonalnie sprawdzać anonsowaną wartość tego obiektu równorzędnego przed nawiązaniem połączenia.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1051">NetX TCP module will optionally validate its peer's advertised MSS value before establishing a connection.</span></span> <span data-ttu-id="b6d16-1052">Domyślnie NetX nie zezwala na takie sprawdzenie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1052">By default NetX does not enable such a check.</span></span> <span data-ttu-id="b6d16-1053">W przypadku aplikacji, które chcą wykonać weryfikację o kluczu, należy zdefiniować ***NX_ENABLE_TCP_MSS_CHECKING** _ podczas kompilowania biblioteki NetX, a wartość minimalna powinna być zdefiniowana w _*_NX_TCP_MSS_MINIMUM_\*_.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1053">Applications wishing to perform MSS validation shall define ***NX_ENABLE_TCP_MSS_CHECKING** _ when building the NetX library, and the minimum value shall be defined in _*_NX_TCP_MSS_MINIMUM_\*_.</span></span> <span data-ttu-id="b6d16-1054">Przychodzące połączenia TCP o wartościach o wielkości/mniej więcej niż _ *_NX_TCP_MSS_MINIMUM_*\* są porzucane.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1054">Incoming TCP connections with MSS values below _ *_NX_TCP_MSS_MINIMUM_*\* are dropped.</span></span>

### <a name="stop-listening-on-a-server-port"></a><span data-ttu-id="b6d16-1055">Zatrzymaj nasłuchiwanie na porcie serwera</span><span class="sxs-lookup"><span data-stu-id="b6d16-1055">Stop Listening on a Server Port</span></span>

<span data-ttu-id="b6d16-1056">Jeśli aplikacja nie chce już nasłuchiwać żądań połączenia klienta na porcie serwera, który został wcześniej określony przez wywołanie usługi \***nx_tcp_server_socket_listen** _, aplikacja po prostu wywołuje usługę _ \*_nx_tcp_server_socket_unlisten_\*\*.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1056">If the application no longer wishes to listen for client connection requests on a server port that was previously specified by a call to the ***nx_tcp_server_socket_listen** _ service, the application simply calls the _ *_nx_tcp_server_socket_unlisten_** service.</span></span> <span data-ttu-id="b6d16-1057">Ta usługa umieszcza wszystkie gniazda oczekujące na połączenie z powrotem w stanie ZAMKNIĘTYm i zwalnia wszystkie pakiety żądań połączeń klienta umieszczonych w kolejce.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1057">This service places any socket waiting for a connection back in the CLOSED state and releases any queued client connection request packets.</span></span>

### <a name="tcp-window-size"></a><span data-ttu-id="b6d16-1058">Rozmiar okna TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1058">TCP Window Size</span></span>

<span data-ttu-id="b6d16-1059">Podczas fazy instalacji i transferu danych połączenia każdy port raportuje ilość danych, które może obsłużyć, czyli rozmiar okna.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1059">During both the setup and data transfer phases of the connection, each port reports the amount of data it can handle, which is called its window size.</span></span> <span data-ttu-id="b6d16-1060">Gdy dane są odbierane i przetwarzane, rozmiar tego okna jest dostosowywany dynamicznie.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1060">As data are received and processed, this window size is adjusted dynamically.</span></span> <span data-ttu-id="b6d16-1061">W przypadku protokołu TCP nadawca może wysłać tylko ilość danych, które pasują do okna odbiorcy.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1061">In TCP, a sender can only send an amount of data that fits into the receiver's window.</span></span> <span data-ttu-id="b6d16-1062">W zasadzie rozmiar okna zapewnia kontrolę przepływu na potrzeby transferu danych w każdym kierunku połączenia.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1062">In essence, the window size provides flow control for data transfer in each direction of the connection.</span></span>

### <a name="tcp-packet-send"></a><span data-ttu-id="b6d16-1063">Wysyłanie pakietów TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1063">TCP Packet Send</span></span>

<span data-ttu-id="b6d16-1064">Wysyłanie danych TCP jest łatwo realizowane przez wywołanie funkcji ***nx_tcp_socket_send*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-1064">Sending TCP data is easily accomplished by calling the ***nx_tcp_socket_send*** function.</span></span> <span data-ttu-id="b6d16-1065">Jeśli rozmiar przesyłanych danych jest większy niż wartość rozmiaru w gnieździe lub bieżący rozmiar okna odbioru elementu równorzędnego, w zależności od tego, który z nich jest mniejszy, wewnętrzna logika TCP carves dane, które pasują do minimalnej (rozmiaru pasma, okna odbierania równorzędnego) do transmisji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1065">If the size of the data being transmitted is larger than the MSS value of the socket or the current peer receive window size, whichever is smaller, TCP internal logic carves off the data that fits into min (MSS, peer receive Window) for transmission.</span></span> <span data-ttu-id="b6d16-1066">Ta usługa następnie kompiluje nagłówek TCP przed pakietem (w tym obliczenia sumy kontrolnej).</span><span class="sxs-lookup"><span data-stu-id="b6d16-1066">This service then builds a TCP header in front of the packet (including the checksum calculation).</span></span> <span data-ttu-id="b6d16-1067">Jeśli rozmiar okna odbiornika jest różny od zera, obiekt wywołujący wyśle tyle danych, ile może wypełnić rozmiar okna odbiornika.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1067">If the receiver's window size is not zero, the caller will send as much data as it can to fill up the receiver window size.</span></span> <span data-ttu-id="b6d16-1068">Jeśli okno odbierania przestanie być równe zero, wywołujący może zawiesić się i zaczekać, aż rozmiar okna odbiornika zostanie odpowiednio zwiększony dla tego pakietu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1068">If the receive window becomes zero, the caller may suspend and wait for the receiver's window size to increase enough for this packet to be sent.</span></span> <span data-ttu-id="b6d16-1069">W danym momencie wiele wątków może zawiesić się podczas próby wysłania danych za pomocą tego samego gniazda.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1069">At any given time, multiple threads may suspend while trying to send data through the same socket.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-1070">*Dane TCP znajdujące się w strukturze NX_PACKET powinny znajdować się na granicy długiego wyrazu. Ponadto musi być wystarczająca ilość miejsca między wskaźnikiem dołączania i wskaźnikiem początku danych do umieszczenia nagłówków TCP, IP i nośnika fizycznego.*</span><span class="sxs-lookup"><span data-stu-id="b6d16-1070">*The TCP data residing in the NX_PACKET structure should reside on a long-word boundary. In addition, there needs to be sufficient space between the prepend pointer and the data start pointer to place the TCP, IP, and physical media headers.*</span></span>

### <a name="tcp-packet-retransmit"></a><span data-ttu-id="b6d16-1071">Ponowne przesyłanie pakietów TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1071">TCP Packet Retransmit</span></span>

<span data-ttu-id="b6d16-1072">Wcześniej przesłane pakiety TCP wysłane faktycznie przechowywane wewnętrznie do momentu zwrócenia potwierdzenia po drugiej stronie połączenia.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1072">Previously transmitted TCP packets sent actually stored internally until an ACK is returned from the other side of the connection.</span></span> <span data-ttu-id="b6d16-1073">Jeśli przesyłane dane nie są potwierdzone w określonym limicie czasu, przechowywany pakiet jest ponownie wysyłany i ustawiany jest następny limit czasu.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1073">If transmitted data is not acknowledged within the timeout period, the stored packet is re-sent and the next timeout period is set.</span></span> <span data-ttu-id="b6d16-1074">Po odebraniu potwierdzenia wszystkie pakiety objęte numerem potwierdzenia w wewnętrznej kolejce transmisji są ostatecznie wydane.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1074">When an ACK is received, all packets covered by the acknowledgement number in the internal transmit queue are finally released.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b6d16-1075">\* Aplikacja nie wykorzystuje ponownie pakietu lub nie zmienia zawartości pakietu po powrocie funkcji \***nx_tcp_socket_send** _ z NX_SUCCESS.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1075">\*Application shall not reuse the packet or alter the contents of the packet after the \***nx_tcp_socket_send** _ function returns with NX_SUCCESS.</span></span> <span data-ttu-id="b6d16-1076">Przesłany pakiet jest ostatecznie uwalniany przez NetX przetwarzanie wewnętrzne po potwierdzeniu danych przez inne end._</span><span class="sxs-lookup"><span data-stu-id="b6d16-1076">The transmitted packet is eventually released by NetX internal processing after the data is acknowledged by the other end._</span></span>

### <a name="tcp-keepalive"></a><span data-ttu-id="b6d16-1077">Utrzymywanie aktywności TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1077">TCP Keepalive</span></span>

<span data-ttu-id="b6d16-1078">Funkcja utrzymywania aktywności protokołu TCP umożliwia gnieździi wykrywanie, czy jego element równorzędny rozłącza się bez poprawnego zakończenia (na przykład awaria elementu równorzędnego), czy też uniemożliwiać określonym obiektom monitorowania sieci przerwanie połączenia przez długie okresy bezczynności.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1078">TCP Keepalive feature allows a socket to detect whether or not its peer disconnects without proper termination (for example, the peer crashed), or to prevent certain network monitoring facilities to terminate a connection for long periods of idle.</span></span> <span data-ttu-id="b6d16-1079">Ruch przychodzący TCP działa przez okresowe wysyłanie ramki TCP bez danych, a numer sekwencyjny jest ustawiony na jeden mniejszy niż bieżący numer sekwencyjny.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1079">TCP Keepalive works by periodically sending a TCP frame with no data, and the sequence number set to one less than the current sequence number.</span></span> <span data-ttu-id="b6d16-1080">Po odebraniu takiej ramki utrzymania protokołu TCP odbiorca (Jeśli nadal działa) odpowiedzi z POTWIERDZENIEm dla bieżącego numeru sekwencji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1080">On receiving such TCP Keepalive frame, the recipient, if still alive, responses with an ACK for its current sequence number.</span></span> <span data-ttu-id="b6d16-1081">Spowoduje to zakończenie transakcji utrzymywania aktywności.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1081">This completes the keepalive transaction.</span></span>

<span data-ttu-id="b6d16-1082">Domyślnie funkcja utrzymywania aktywności nie jest włączona.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1082">By default the keepalive feature is not enabled.</span></span> <span data-ttu-id="b6d16-1083">Aby można było korzystać z tej funkcji, biblioteka NetX musi być skompilowana przy użyciu funkcji \***NX_ENABLE_TCP_KEEPALIVE** _ zdefiniowanej.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1083">To use this feature, NetX library must be built with \***NX_ENABLE_TCP_KEEPALIVE** _ defined.</span></span> <span data-ttu-id="b6d16-1084">Symbol _ *_NX_TCP_KEEPALIVE_INITIAL_*\* określa liczbę sekund braku aktywności przed zainicjowaniem ramki utrzymywania aktywności.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1084">The symbol _ *_NX_TCP_KEEPALIVE_INITIAL_*\* specifies the number of seconds of inactivity before the keepalive frame is initiated.</span></span>

### <a name="tcp-packet-receive"></a><span data-ttu-id="b6d16-1085">Odbieranie pakietów TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1085">TCP Packet Receive</span></span>

<span data-ttu-id="b6d16-1086">Przetwarzanie pakietów odbioru protokołu TCP (wywoływane z wątku pomocnika adresów IP) jest odpowiedzialne za obsługę różnych akcji połączenia i rozłączania, a także przesyłanie potwierdzenia.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1086">The TCP receive packet processing (called from the IP helper thread) is responsible for handling various connection and disconnection actions as well as transmit acknowledge processing.</span></span> <span data-ttu-id="b6d16-1087">Ponadto przetwarzanie pakietów odbioru protokołu TCP jest odpowiedzialne za umieszczanie pakietów z danymi odbieranymi w odpowiedniej kolejce lub dostarczenie pakietu do pierwszego wstrzymanego wątku, oczekując na pakiet.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1087">In addition, the TCP receive packet processing is responsible for placing packets with receive data on the appropriate TCP socket's receive queue or delivering the packet to the first suspended thread waiting for a packet.</span></span>

### <a name="tcp-receive-notify"></a><span data-ttu-id="b6d16-1088">Powiadomienie o odebraniu protokołu TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1088">TCP Receive Notify</span></span>

<span data-ttu-id="b6d16-1089">Jeśli wątek aplikacji musi przetwarzać odebrane dane z więcej niż jednego gniazda, należy użyć funkcji ***nx_tcp_socket_receive_notify*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-1089">If the application thread needs to process received data from more than one socket, the ***nx_tcp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="b6d16-1090">Ta funkcja rejestruje funkcję odbierania pakietów wywołania zwrotnego dla gniazda.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1090">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="b6d16-1091">Za każdym razem, gdy pakiet jest odbierany w gnieździe, funkcja wywołania zwrotnego jest wykonywana.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1091">Whenever a packet is received on the socket, the callback function is executed.</span></span>

<span data-ttu-id="b6d16-1092">Zawartość funkcji wywołania zwrotnego jest specyficzna dla aplikacji; Jednak funkcja najprawdopodobniej zawiera logikę do informowania wątku przetwarzania, że pakiet jest dostępny w odpowiednim gnieździe.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1092">The contents of the callback function are application-specific; however, the function would most likely contain logic to inform the processing thread that a packet is available on the corresponding socket.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="b6d16-1093">Zawieszenie wątku</span><span class="sxs-lookup"><span data-stu-id="b6d16-1093">Thread Suspension</span></span>

<span data-ttu-id="b6d16-1094">Jak wspomniano wcześniej, wątki aplikacji mogą wstrzymywać się podczas próby odebrania danych z określonego portu TCP.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1094">As mentioned previously, application threads can suspend while attempting to receive data from a particular TCP port.</span></span> <span data-ttu-id="b6d16-1095">Po odebraniu pakietu na tym porcie jest on przyznany do pierwszego wątku, a następnie wznowiony.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1095">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="b6d16-1096">Opcjonalny limit czasu jest dostępny w przypadku zawieszania pakietu odbioru TCP, który jest funkcją dostępną dla większości usług NetX.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1096">An optional timeout is available when suspending on a TCP receive packet, a feature available for most NetX services.</span></span>

<span data-ttu-id="b6d16-1097">Zawieszenie wątku jest również dostępne dla połączenia (zarówno klienta, jak i serwera), powiązania klienta i usług odłączania.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1097">Thread suspension is also available for connection (both client and server), client binding, and disconnection services.</span></span>

### <a name="tcp-socket-statistics-and-errors"></a><span data-ttu-id="b6d16-1098">Statystyka i błędy gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1098">TCP Socket Statistics and Errors</span></span>

<span data-ttu-id="b6d16-1099">W przypadku włączenia oprogramowania NetX TCP Socket śledzi kilka statystyk i błędów, które mogą być przydatne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1099">If enabled, the NetX TCP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="b6d16-1100">Dla każdego wystąpienia protokołu IP/TCP są obsługiwane następujące raporty statystyczne i błędy:</span><span class="sxs-lookup"><span data-stu-id="b6d16-1100">The following statistics and error reports are maintained for each IP/TCP instance:</span></span>

- <span data-ttu-id="b6d16-1101">Całkowita liczba wysłanych pakietów TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1101">Total TCP Packets Sent</span></span>
- <span data-ttu-id="b6d16-1102">Całkowita liczba wysłanych bajtów TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1102">Total TCP Bytes Sent</span></span>
- <span data-ttu-id="b6d16-1103">Całkowita liczba odebranych pakietów TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1103">Total TCP Packets Received</span></span>
- <span data-ttu-id="b6d16-1104">Całkowita liczba odebranych bajtów TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1104">Total TCP Bytes Received</span></span>
- <span data-ttu-id="b6d16-1105">Całkowita liczba nieprawidłowych pakietów TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1105">Total TCP Invalid Packets</span></span>
- <span data-ttu-id="b6d16-1106">Całkowita liczba porzuconych pakietów odbioru protokołu TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1106">Total TCP Receive Packets Dropped</span></span>
- <span data-ttu-id="b6d16-1107">Łączne błędy sum kontrolnych odbioru TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1107">Total TCP Receive Checksum Errors</span></span>
- <span data-ttu-id="b6d16-1108">Łączna liczba połączeń TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1108">Total TCP Connections</span></span>
- <span data-ttu-id="b6d16-1109">Łączna liczba rozłączeń TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1109">Total TCP Disconnections</span></span>
- <span data-ttu-id="b6d16-1110">Całkowita liczba porzuconych połączeń TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1110">Total TCP Connections Dropped</span></span>
- <span data-ttu-id="b6d16-1111">Łączna liczba retransmisji pakietów TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1111">Total TCP Packet Retransmits</span></span>
- <span data-ttu-id="b6d16-1112">Wysłane pakiety gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1112">TCP Socket Packets Sent</span></span>
- <span data-ttu-id="b6d16-1113">Wysłane bajty gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1113">TCP Socket Bytes Sent</span></span>
- <span data-ttu-id="b6d16-1114">Odebrane pakiety TCP Socket</span><span class="sxs-lookup"><span data-stu-id="b6d16-1114">TCP Socket Packets Received</span></span>
- <span data-ttu-id="b6d16-1115">Odebrane bajty gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1115">TCP Socket Bytes Received</span></span>
- <span data-ttu-id="b6d16-1116">Ponowne przesyłanie pakietów TCP Socket</span><span class="sxs-lookup"><span data-stu-id="b6d16-1116">TCP Socket Packet Retransmits</span></span>
- <span data-ttu-id="b6d16-1117">Pakiety gniazd TCP dodane do kolejki</span><span class="sxs-lookup"><span data-stu-id="b6d16-1117">TCP Socket Packets Queued</span></span>
- <span data-ttu-id="b6d16-1118">Błędy sum kontrolnych gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1118">TCP Socket Checksum Errors</span></span>
- <span data-ttu-id="b6d16-1119">Stan gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1119">TCP Socket State</span></span>
- <span data-ttu-id="b6d16-1120">Głębokość kolejki transmisji gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1120">TCP Socket Transmit Queue Depth</span></span>
- <span data-ttu-id="b6d16-1121">Rozmiar okna wysyłania gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1121">TCP Socket Transmit Window Size</span></span>
- <span data-ttu-id="b6d16-1122">Rozmiar okna odbierania gniazda TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1122">TCP Socket Receive Window Size</span></span>

<span data-ttu-id="b6d16-1123">Wszystkie te statystyki i raporty o błędach są dostępne dla aplikacji z usługą ***nx_tcp_info_get** _ dla łącznej liczby statystyk TCP oraz usługi _ *_nx_tcp_socket_info_get_** dla statystyk TCP na gniazdo.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1123">All these statistics and error reports are available to the application with the ***nx_tcp_info_get** _ service for total TCP statistics and the _ *_nx_tcp_socket_info_get_** service for TCP statistics per socket.</span></span>

## <a name="tcp-socket-control-block-nx_tcp_socket"></a><span data-ttu-id="b6d16-1124">NX_TCP_SOCKET bloku sterowania gniazdem TCP</span><span class="sxs-lookup"><span data-stu-id="b6d16-1124">TCP Socket Control Block NX_TCP_SOCKET</span></span>

<span data-ttu-id="b6d16-1125">Cechy poszczególnych gniazd TCP znajdują się w skojarzonym bloku sterowania *NX_TCP_SOCKET* , który zawiera przydatne informacje, takie jak link do struktury danych IP, interfejs połączenia sieciowego, port powiązany i kolejka odbierania pakietów.</span><span class="sxs-lookup"><span data-stu-id="b6d16-1125">The characteristics of each TCP socket are found in the associated *NX_TCP_SOCKET* control block, which contains useful information such as the link to the IP data structure, the network connection interface, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="b6d16-1126">Ta struktura jest zdefiniowana w pliku ***nx_api. h*** .</span><span class="sxs-lookup"><span data-stu-id="b6d16-1126">This structure is defined in the ***nx_api.h*** file.</span></span>
